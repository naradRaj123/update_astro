var dfe=Object.defineProperty;var ufe=(n,i,o)=>i in n?dfe(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o;var vN=(n,i,o)=>(ufe(n,typeof i!="symbol"?i+"":i,o),o);function hfe(n,i){for(var o=0;o<i.length;o++){const c=i[o];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in n)){const f=Object.getOwnPropertyDescriptor(c,d);f&&Object.defineProperty(n,d,f.get?f:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const _ of f.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&c(_)}).observe(document,{childList:!0,subtree:!0});function o(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function c(d){if(d.ep)return;d.ep=!0;const f=o(d);fetch(d.href,f)}})();var En=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $T(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function pfe(n){if(n.__esModule)return n;var i=n.default;if(typeof i=="function"){var o=function c(){return this instanceof c?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};o.prototype=i.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(n).forEach(function(c){var d=Object.getOwnPropertyDescriptor(n,c);Object.defineProperty(o,c,d.get?d:{enumerable:!0,get:function(){return n[c]}})}),o}var vz={exports:{}},XT={},yz={exports:{}},Hn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE=Symbol.for("react.element"),ffe=Symbol.for("react.portal"),mfe=Symbol.for("react.fragment"),gfe=Symbol.for("react.strict_mode"),_fe=Symbol.for("react.profiler"),Efe=Symbol.for("react.provider"),vfe=Symbol.for("react.context"),yfe=Symbol.for("react.forward_ref"),Sfe=Symbol.for("react.suspense"),xfe=Symbol.for("react.memo"),Tfe=Symbol.for("react.lazy"),$9=Symbol.iterator;function bfe(n){return n===null||typeof n!="object"?null:(n=$9&&n[$9]||n["@@iterator"],typeof n=="function"?n:null)}var Sz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xz=Object.assign,Tz={};function Xm(n,i,o){this.props=n,this.context=i,this.refs=Tz,this.updater=o||Sz}Xm.prototype.isReactComponent={};Xm.prototype.setState=function(n,i){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,i,"setState")};Xm.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function bz(){}bz.prototype=Xm.prototype;function iP(n,i,o){this.props=n,this.context=i,this.refs=Tz,this.updater=o||Sz}var sP=iP.prototype=new bz;sP.constructor=iP;xz(sP,Xm.prototype);sP.isPureReactComponent=!0;var X9=Array.isArray,wz=Object.prototype.hasOwnProperty,oP={current:null},Cz={key:!0,ref:!0,__self:!0,__source:!0};function Rz(n,i,o){var c,d={},f=null,_=null;if(i!=null)for(c in i.ref!==void 0&&(_=i.ref),i.key!==void 0&&(f=""+i.key),i)wz.call(i,c)&&!Cz.hasOwnProperty(c)&&(d[c]=i[c]);var v=arguments.length-2;if(v===1)d.children=o;else if(1<v){for(var x=Array(v),T=0;T<v;T++)x[T]=arguments[T+2];d.children=x}if(n&&n.defaultProps)for(c in v=n.defaultProps,v)d[c]===void 0&&(d[c]=v[c]);return{$$typeof:fE,type:n,key:f,ref:_,props:d,_owner:oP.current}}function wfe(n,i){return{$$typeof:fE,type:n.type,key:i,ref:n.ref,props:n.props,_owner:n._owner}}function aP(n){return typeof n=="object"&&n!==null&&n.$$typeof===fE}function Cfe(n){var i={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(o){return i[o]})}var J9=/\/+/g;function yN(n,i){return typeof n=="object"&&n!==null&&n.key!=null?Cfe(""+n.key):i.toString(36)}function yx(n,i,o,c,d){var f=typeof n;(f==="undefined"||f==="boolean")&&(n=null);var _=!1;if(n===null)_=!0;else switch(f){case"string":case"number":_=!0;break;case"object":switch(n.$$typeof){case fE:case ffe:_=!0}}if(_)return _=n,d=d(_),n=c===""?"."+yN(_,0):c,X9(d)?(o="",n!=null&&(o=n.replace(J9,"$&/")+"/"),yx(d,i,o,"",function(T){return T})):d!=null&&(aP(d)&&(d=wfe(d,o+(!d.key||_&&_.key===d.key?"":(""+d.key).replace(J9,"$&/")+"/")+n)),i.push(d)),1;if(_=0,c=c===""?".":c+":",X9(n))for(var v=0;v<n.length;v++){f=n[v];var x=c+yN(f,v);_+=yx(f,i,o,x,d)}else if(x=bfe(n),typeof x=="function")for(n=x.call(n),v=0;!(f=n.next()).done;)f=f.value,x=c+yN(f,v++),_+=yx(f,i,o,x,d);else if(f==="object")throw i=String(n),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return _}function BS(n,i,o){if(n==null)return n;var c=[],d=0;return yx(n,c,"","",function(f){return i.call(o,f,d++)}),c}function Rfe(n){if(n._status===-1){var i=n._result;i=i(),i.then(function(o){(n._status===0||n._status===-1)&&(n._status=1,n._result=o)},function(o){(n._status===0||n._status===-1)&&(n._status=2,n._result=o)}),n._status===-1&&(n._status=0,n._result=i)}if(n._status===1)return n._result.default;throw n._result}var ao={current:null},Sx={transition:null},Afe={ReactCurrentDispatcher:ao,ReactCurrentBatchConfig:Sx,ReactCurrentOwner:oP};function Az(){throw Error("act(...) is not supported in production builds of React.")}Hn.Children={map:BS,forEach:function(n,i,o){BS(n,function(){i.apply(this,arguments)},o)},count:function(n){var i=0;return BS(n,function(){i++}),i},toArray:function(n){return BS(n,function(i){return i})||[]},only:function(n){if(!aP(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Hn.Component=Xm;Hn.Fragment=mfe;Hn.Profiler=_fe;Hn.PureComponent=iP;Hn.StrictMode=gfe;Hn.Suspense=Sfe;Hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Afe;Hn.act=Az;Hn.cloneElement=function(n,i,o){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var c=xz({},n.props),d=n.key,f=n.ref,_=n._owner;if(i!=null){if(i.ref!==void 0&&(f=i.ref,_=oP.current),i.key!==void 0&&(d=""+i.key),n.type&&n.type.defaultProps)var v=n.type.defaultProps;for(x in i)wz.call(i,x)&&!Cz.hasOwnProperty(x)&&(c[x]=i[x]===void 0&&v!==void 0?v[x]:i[x])}var x=arguments.length-2;if(x===1)c.children=o;else if(1<x){v=Array(x);for(var T=0;T<x;T++)v[T]=arguments[T+2];c.children=v}return{$$typeof:fE,type:n.type,key:d,ref:f,props:c,_owner:_}};Hn.createContext=function(n){return n={$$typeof:vfe,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Efe,_context:n},n.Consumer=n};Hn.createElement=Rz;Hn.createFactory=function(n){var i=Rz.bind(null,n);return i.type=n,i};Hn.createRef=function(){return{current:null}};Hn.forwardRef=function(n){return{$$typeof:yfe,render:n}};Hn.isValidElement=aP;Hn.lazy=function(n){return{$$typeof:Tfe,_payload:{_status:-1,_result:n},_init:Rfe}};Hn.memo=function(n,i){return{$$typeof:xfe,type:n,compare:i===void 0?null:i}};Hn.startTransition=function(n){var i=Sx.transition;Sx.transition={};try{n()}finally{Sx.transition=i}};Hn.unstable_act=Az;Hn.useCallback=function(n,i){return ao.current.useCallback(n,i)};Hn.useContext=function(n){return ao.current.useContext(n)};Hn.useDebugValue=function(){};Hn.useDeferredValue=function(n){return ao.current.useDeferredValue(n)};Hn.useEffect=function(n,i){return ao.current.useEffect(n,i)};Hn.useId=function(){return ao.current.useId()};Hn.useImperativeHandle=function(n,i,o){return ao.current.useImperativeHandle(n,i,o)};Hn.useInsertionEffect=function(n,i){return ao.current.useInsertionEffect(n,i)};Hn.useLayoutEffect=function(n,i){return ao.current.useLayoutEffect(n,i)};Hn.useMemo=function(n,i){return ao.current.useMemo(n,i)};Hn.useReducer=function(n,i,o){return ao.current.useReducer(n,i,o)};Hn.useRef=function(n){return ao.current.useRef(n)};Hn.useState=function(n){return ao.current.useState(n)};Hn.useSyncExternalStore=function(n,i,o){return ao.current.useSyncExternalStore(n,i,o)};Hn.useTransition=function(){return ao.current.useTransition()};Hn.version="18.3.1";yz.exports=Hn;var X=yz.exports;const wt=$T(X),cP=hfe({__proto__:null,default:wt},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nfe=X,Ife=Symbol.for("react.element"),Ofe=Symbol.for("react.fragment"),Dfe=Object.prototype.hasOwnProperty,Pfe=Nfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kfe={key:!0,ref:!0,__self:!0,__source:!0};function Nz(n,i,o){var c,d={},f=null,_=null;o!==void 0&&(f=""+o),i.key!==void 0&&(f=""+i.key),i.ref!==void 0&&(_=i.ref);for(c in i)Dfe.call(i,c)&&!kfe.hasOwnProperty(c)&&(d[c]=i[c]);if(n&&n.defaultProps)for(c in i=n.defaultProps,i)d[c]===void 0&&(d[c]=i[c]);return{$$typeof:Ife,type:n,key:f,ref:_,props:d,_owner:Pfe.current}}XT.Fragment=Ofe;XT.jsx=Nz;XT.jsxs=Nz;vz.exports=XT;var h=vz.exports,gO={},Iz={exports:{}},ca={},Oz={exports:{}},Dz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function i(He,et){var ut=He.length;He.push(et);e:for(;0<ut;){var Ae=ut-1>>>1,Le=He[Ae];if(0<d(Le,et))He[Ae]=et,He[ut]=Le,ut=Ae;else break e}}function o(He){return He.length===0?null:He[0]}function c(He){if(He.length===0)return null;var et=He[0],ut=He.pop();if(ut!==et){He[0]=ut;e:for(var Ae=0,Le=He.length,ze=Le>>>1;Ae<ze;){var qe=2*(Ae+1)-1,fn=He[qe],qt=qe+1,Dn=He[qt];if(0>d(fn,ut))qt<Le&&0>d(Dn,fn)?(He[Ae]=Dn,He[qt]=ut,Ae=qt):(He[Ae]=fn,He[qe]=ut,Ae=qe);else if(qt<Le&&0>d(Dn,ut))He[Ae]=Dn,He[qt]=ut,Ae=qt;else break e}}return et}function d(He,et){var ut=He.sortIndex-et.sortIndex;return ut!==0?ut:He.id-et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;n.unstable_now=function(){return f.now()}}else{var _=Date,v=_.now();n.unstable_now=function(){return _.now()-v}}var x=[],T=[],w=1,R=null,I=3,j=!1,P=!1,k=!1,W=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function V(He){for(var et=o(T);et!==null;){if(et.callback===null)c(T);else if(et.startTime<=He)c(T),et.sortIndex=et.expirationTime,i(x,et);else break;et=o(T)}}function K(He){if(k=!1,V(He),!P)if(o(x)!==null)P=!0,at(te);else{var et=o(T);et!==null&&lt(K,et.startTime-He)}}function te(He,et){P=!1,k&&(k=!1,H(de),de=-1),j=!0;var ut=I;try{for(V(et),R=o(x);R!==null&&(!(R.expirationTime>et)||He&&!ye());){var Ae=R.callback;if(typeof Ae=="function"){R.callback=null,I=R.priorityLevel;var Le=Ae(R.expirationTime<=et);et=n.unstable_now(),typeof Le=="function"?R.callback=Le:R===o(x)&&c(x),V(et)}else c(x);R=o(x)}if(R!==null)var ze=!0;else{var qe=o(T);qe!==null&&lt(K,qe.startTime-et),ze=!1}return ze}finally{R=null,I=ut,j=!1}}var ie=!1,A=null,de=-1,ue=5,oe=-1;function ye(){return!(n.unstable_now()-oe<ue)}function Ee(){if(A!==null){var He=n.unstable_now();oe=He;var et=!0;try{et=A(!0,He)}finally{et?xe():(ie=!1,A=null)}}else ie=!1}var xe;if(typeof L=="function")xe=function(){L(Ee)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,ct=Oe.port2;Oe.port1.onmessage=Ee,xe=function(){ct.postMessage(null)}}else xe=function(){W(Ee,0)};function at(He){A=He,ie||(ie=!0,xe())}function lt(He,et){de=W(function(){He(n.unstable_now())},et)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(He){He.callback=null},n.unstable_continueExecution=function(){P||j||(P=!0,at(te))},n.unstable_forceFrameRate=function(He){0>He||125<He?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ue=0<He?Math.floor(1e3/He):5},n.unstable_getCurrentPriorityLevel=function(){return I},n.unstable_getFirstCallbackNode=function(){return o(x)},n.unstable_next=function(He){switch(I){case 1:case 2:case 3:var et=3;break;default:et=I}var ut=I;I=et;try{return He()}finally{I=ut}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(He,et){switch(He){case 1:case 2:case 3:case 4:case 5:break;default:He=3}var ut=I;I=He;try{return et()}finally{I=ut}},n.unstable_scheduleCallback=function(He,et,ut){var Ae=n.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?Ae+ut:Ae):ut=Ae,He){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ut+Le,He={id:w++,callback:et,priorityLevel:He,startTime:ut,expirationTime:Le,sortIndex:-1},ut>Ae?(He.sortIndex=ut,i(T,He),o(x)===null&&He===o(T)&&(k?(H(de),de=-1):k=!0,lt(K,ut-Ae))):(He.sortIndex=Le,i(x,He),P||j||(P=!0,at(te))),He},n.unstable_shouldYield=ye,n.unstable_wrapCallback=function(He){var et=I;return function(){var ut=I;I=et;try{return He.apply(this,arguments)}finally{I=ut}}}})(Dz);Oz.exports=Dz;var Lfe=Oz.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mfe=X,ia=Lfe;function pt(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Pz=new Set,V_={};function Ep(n,i){Om(n,i),Om(n+"Capture",i)}function Om(n,i){for(V_[n]=i,n=0;n<i.length;n++)Pz.add(i[n])}var rd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_O=Object.prototype.hasOwnProperty,jfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Q9={},Z9={};function Ufe(n){return _O.call(Z9,n)?!0:_O.call(Q9,n)?!1:jfe.test(n)?Z9[n]=!0:(Q9[n]=!0,!1)}function Ffe(n,i,o,c){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Vfe(n,i,o,c){if(i===null||typeof i>"u"||Ffe(n,i,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function co(n,i,o,c,d,f,_){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=o,this.propertyName=n,this.type=i,this.sanitizeURL=f,this.removeEmptyString=_}var Cs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Cs[n]=new co(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];Cs[i]=new co(i,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Cs[n]=new co(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Cs[n]=new co(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Cs[n]=new co(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Cs[n]=new co(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Cs[n]=new co(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Cs[n]=new co(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Cs[n]=new co(n,5,!1,n.toLowerCase(),null,!1,!1)});var lP=/[\-:]([a-z])/g;function dP(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(lP,dP);Cs[i]=new co(i,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(lP,dP);Cs[i]=new co(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(lP,dP);Cs[i]=new co(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Cs[n]=new co(n,1,!1,n.toLowerCase(),null,!1,!1)});Cs.xlinkHref=new co("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Cs[n]=new co(n,1,!1,n.toLowerCase(),null,!0,!0)});function uP(n,i,o,c){var d=Cs.hasOwnProperty(i)?Cs[i]:null;(d!==null?d.type!==0:c||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(Vfe(i,o,d,c)&&(o=null),c||d===null?Ufe(i)&&(o===null?n.removeAttribute(i):n.setAttribute(i,""+o)):d.mustUseProperty?n[d.propertyName]=o===null?d.type===3?!1:"":o:(i=d.attributeName,c=d.attributeNamespace,o===null?n.removeAttribute(i):(d=d.type,o=d===3||d===4&&o===!0?"":""+o,c?n.setAttributeNS(c,i,o):n.setAttribute(i,o))))}var ud=Mfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,WS=Symbol.for("react.element"),am=Symbol.for("react.portal"),cm=Symbol.for("react.fragment"),hP=Symbol.for("react.strict_mode"),EO=Symbol.for("react.profiler"),kz=Symbol.for("react.provider"),Lz=Symbol.for("react.context"),pP=Symbol.for("react.forward_ref"),vO=Symbol.for("react.suspense"),yO=Symbol.for("react.suspense_list"),fP=Symbol.for("react.memo"),nu=Symbol.for("react.lazy"),Mz=Symbol.for("react.offscreen"),e7=Symbol.iterator;function Jg(n){return n===null||typeof n!="object"?null:(n=e7&&n[e7]||n["@@iterator"],typeof n=="function"?n:null)}var mi=Object.assign,SN;function p_(n){if(SN===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);SN=i&&i[1]||""}return`
`+SN+n}var xN=!1;function TN(n,i){if(!n||xN)return"";xN=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(T){var c=T}Reflect.construct(n,[],i)}else{try{i.call()}catch(T){c=T}n.call(i.prototype)}else{try{throw Error()}catch(T){c=T}n()}}catch(T){if(T&&c&&typeof T.stack=="string"){for(var d=T.stack.split(`
`),f=c.stack.split(`
`),_=d.length-1,v=f.length-1;1<=_&&0<=v&&d[_]!==f[v];)v--;for(;1<=_&&0<=v;_--,v--)if(d[_]!==f[v]){if(_!==1||v!==1)do if(_--,v--,0>v||d[_]!==f[v]){var x=`
`+d[_].replace(" at new "," at ");return n.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",n.displayName)),x}while(1<=_&&0<=v);break}}}finally{xN=!1,Error.prepareStackTrace=o}return(n=n?n.displayName||n.name:"")?p_(n):""}function Bfe(n){switch(n.tag){case 5:return p_(n.type);case 16:return p_("Lazy");case 13:return p_("Suspense");case 19:return p_("SuspenseList");case 0:case 2:case 15:return n=TN(n.type,!1),n;case 11:return n=TN(n.type.render,!1),n;case 1:return n=TN(n.type,!0),n;default:return""}}function SO(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case cm:return"Fragment";case am:return"Portal";case EO:return"Profiler";case hP:return"StrictMode";case vO:return"Suspense";case yO:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Lz:return(n.displayName||"Context")+".Consumer";case kz:return(n._context.displayName||"Context")+".Provider";case pP:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case fP:return i=n.displayName||null,i!==null?i:SO(n.type)||"Memo";case nu:i=n._payload,n=n._init;try{return SO(n(i))}catch{}}return null}function Wfe(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return SO(i);case 8:return i===hP?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function xu(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function jz(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Hfe(n){var i=jz(n)?"checked":"value",o=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),c=""+n[i];if(!n.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,f=o.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return d.call(this)},set:function(_){c=""+_,f.call(this,_)}}),Object.defineProperty(n,i,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(_){c=""+_},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function HS(n){n._valueTracker||(n._valueTracker=Hfe(n))}function Uz(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),c="";return n&&(c=jz(n)?n.checked?"true":"false":n.value),n=c,n!==o?(i.setValue(n),!0):!1}function qx(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function xO(n,i){var o=i.checked;return mi({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??n._wrapperState.initialChecked})}function t7(n,i){var o=i.defaultValue==null?"":i.defaultValue,c=i.checked!=null?i.checked:i.defaultChecked;o=xu(i.value!=null?i.value:o),n._wrapperState={initialChecked:c,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Fz(n,i){i=i.checked,i!=null&&uP(n,"checked",i,!1)}function TO(n,i){Fz(n,i);var o=xu(i.value),c=i.type;if(o!=null)c==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+o):n.value!==""+o&&(n.value=""+o);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?bO(n,i.type,o):i.hasOwnProperty("defaultValue")&&bO(n,i.type,xu(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function n7(n,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var c=i.type;if(!(c!=="submit"&&c!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,o||i===n.value||(n.value=i),n.defaultValue=i}o=n.name,o!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,o!==""&&(n.name=o)}function bO(n,i,o){(i!=="number"||qx(n.ownerDocument)!==n)&&(o==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+o&&(n.defaultValue=""+o))}var f_=Array.isArray;function bm(n,i,o,c){if(n=n.options,i){i={};for(var d=0;d<o.length;d++)i["$"+o[d]]=!0;for(o=0;o<n.length;o++)d=i.hasOwnProperty("$"+n[o].value),n[o].selected!==d&&(n[o].selected=d),d&&c&&(n[o].defaultSelected=!0)}else{for(o=""+xu(o),i=null,d=0;d<n.length;d++){if(n[d].value===o){n[d].selected=!0,c&&(n[d].defaultSelected=!0);return}i!==null||n[d].disabled||(i=n[d])}i!==null&&(i.selected=!0)}}function wO(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(pt(91));return mi({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function r7(n,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(pt(92));if(f_(o)){if(1<o.length)throw Error(pt(93));o=o[0]}i=o}i==null&&(i=""),o=i}n._wrapperState={initialValue:xu(o)}}function Vz(n,i){var o=xu(i.value),c=xu(i.defaultValue);o!=null&&(o=""+o,o!==n.value&&(n.value=o),i.defaultValue==null&&n.defaultValue!==o&&(n.defaultValue=o)),c!=null&&(n.defaultValue=""+c)}function i7(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function Bz(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function CO(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?Bz(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var GS,Wz=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,c,d){MSApp.execUnsafeLocalFunction(function(){return n(i,o,c,d)})}:n}(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(GS=GS||document.createElement("div"),GS.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=GS.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function B_(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var S_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gfe=["Webkit","ms","Moz","O"];Object.keys(S_).forEach(function(n){Gfe.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),S_[i]=S_[n]})});function Hz(n,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||S_.hasOwnProperty(n)&&S_[n]?(""+i).trim():i+"px"}function Gz(n,i){n=n.style;for(var o in i)if(i.hasOwnProperty(o)){var c=o.indexOf("--")===0,d=Hz(o,i[o],c);o==="float"&&(o="cssFloat"),c?n.setProperty(o,d):n[o]=d}}var zfe=mi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function RO(n,i){if(i){if(zfe[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(pt(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(pt(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(pt(61))}if(i.style!=null&&typeof i.style!="object")throw Error(pt(62))}}function AO(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var NO=null;function mP(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var IO=null,wm=null,Cm=null;function s7(n){if(n=_E(n)){if(typeof IO!="function")throw Error(pt(280));var i=n.stateNode;i&&(i=tb(i),IO(n.stateNode,n.type,i))}}function zz(n){wm?Cm?Cm.push(n):Cm=[n]:wm=n}function Kz(){if(wm){var n=wm,i=Cm;if(Cm=wm=null,s7(n),i)for(n=0;n<i.length;n++)s7(i[n])}}function qz(n,i){return n(i)}function Yz(){}var bN=!1;function $z(n,i,o){if(bN)return n(i,o);bN=!0;try{return qz(n,i,o)}finally{bN=!1,(wm!==null||Cm!==null)&&(Yz(),Kz())}}function W_(n,i){var o=n.stateNode;if(o===null)return null;var c=tb(o);if(c===null)return null;o=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(pt(231,i,typeof o));return o}var OO=!1;if(rd)try{var Qg={};Object.defineProperty(Qg,"passive",{get:function(){OO=!0}}),window.addEventListener("test",Qg,Qg),window.removeEventListener("test",Qg,Qg)}catch{OO=!1}function Kfe(n,i,o,c,d,f,_,v,x){var T=Array.prototype.slice.call(arguments,3);try{i.apply(o,T)}catch(w){this.onError(w)}}var x_=!1,Yx=null,$x=!1,DO=null,qfe={onError:function(n){x_=!0,Yx=n}};function Yfe(n,i,o,c,d,f,_,v,x){x_=!1,Yx=null,Kfe.apply(qfe,arguments)}function $fe(n,i,o,c,d,f,_,v,x){if(Yfe.apply(this,arguments),x_){if(x_){var T=Yx;x_=!1,Yx=null}else throw Error(pt(198));$x||($x=!0,DO=T)}}function vp(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,i.flags&4098&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function Xz(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function o7(n){if(vp(n)!==n)throw Error(pt(188))}function Xfe(n){var i=n.alternate;if(!i){if(i=vp(n),i===null)throw Error(pt(188));return i!==n?null:n}for(var o=n,c=i;;){var d=o.return;if(d===null)break;var f=d.alternate;if(f===null){if(c=d.return,c!==null){o=c;continue}break}if(d.child===f.child){for(f=d.child;f;){if(f===o)return o7(d),n;if(f===c)return o7(d),i;f=f.sibling}throw Error(pt(188))}if(o.return!==c.return)o=d,c=f;else{for(var _=!1,v=d.child;v;){if(v===o){_=!0,o=d,c=f;break}if(v===c){_=!0,c=d,o=f;break}v=v.sibling}if(!_){for(v=f.child;v;){if(v===o){_=!0,o=f,c=d;break}if(v===c){_=!0,c=f,o=d;break}v=v.sibling}if(!_)throw Error(pt(189))}}if(o.alternate!==c)throw Error(pt(190))}if(o.tag!==3)throw Error(pt(188));return o.stateNode.current===o?n:i}function Jz(n){return n=Xfe(n),n!==null?Qz(n):null}function Qz(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=Qz(n);if(i!==null)return i;n=n.sibling}return null}var Zz=ia.unstable_scheduleCallback,a7=ia.unstable_cancelCallback,Jfe=ia.unstable_shouldYield,Qfe=ia.unstable_requestPaint,Di=ia.unstable_now,Zfe=ia.unstable_getCurrentPriorityLevel,gP=ia.unstable_ImmediatePriority,eK=ia.unstable_UserBlockingPriority,Xx=ia.unstable_NormalPriority,eme=ia.unstable_LowPriority,tK=ia.unstable_IdlePriority,JT=null,El=null;function tme(n){if(El&&typeof El.onCommitFiberRoot=="function")try{El.onCommitFiberRoot(JT,n,void 0,(n.current.flags&128)===128)}catch{}}var Cc=Math.clz32?Math.clz32:ime,nme=Math.log,rme=Math.LN2;function ime(n){return n>>>=0,n===0?32:31-(nme(n)/rme|0)|0}var zS=64,KS=4194304;function m_(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Jx(n,i){var o=n.pendingLanes;if(o===0)return 0;var c=0,d=n.suspendedLanes,f=n.pingedLanes,_=o&268435455;if(_!==0){var v=_&~d;v!==0?c=m_(v):(f&=_,f!==0&&(c=m_(f)))}else _=o&~d,_!==0?c=m_(_):f!==0&&(c=m_(f));if(c===0)return 0;if(i!==0&&i!==c&&!(i&d)&&(d=c&-c,f=i&-i,d>=f||d===16&&(f&4194240)!==0))return i;if(c&4&&(c|=o&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=c;0<i;)o=31-Cc(i),d=1<<o,c|=n[o],i&=~d;return c}function sme(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ome(n,i){for(var o=n.suspendedLanes,c=n.pingedLanes,d=n.expirationTimes,f=n.pendingLanes;0<f;){var _=31-Cc(f),v=1<<_,x=d[_];x===-1?(!(v&o)||v&c)&&(d[_]=sme(v,i)):x<=i&&(n.expiredLanes|=v),f&=~v}}function PO(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function nK(){var n=zS;return zS<<=1,!(zS&4194240)&&(zS=64),n}function wN(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function mE(n,i,o){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-Cc(i),n[i]=o}function ame(n,i){var o=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<o;){var d=31-Cc(o),f=1<<d;i[d]=0,c[d]=-1,n[d]=-1,o&=~f}}function _P(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var c=31-Cc(o),d=1<<c;d&i|n[c]&i&&(n[c]|=i),o&=~d}}var Cr=0;function rK(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var iK,EP,sK,oK,aK,kO=!1,qS=[],uu=null,hu=null,pu=null,H_=new Map,G_=new Map,su=[],cme="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function c7(n,i){switch(n){case"focusin":case"focusout":uu=null;break;case"dragenter":case"dragleave":hu=null;break;case"mouseover":case"mouseout":pu=null;break;case"pointerover":case"pointerout":H_.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":G_.delete(i.pointerId)}}function Zg(n,i,o,c,d,f){return n===null||n.nativeEvent!==f?(n={blockedOn:i,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[d]},i!==null&&(i=_E(i),i!==null&&EP(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,d!==null&&i.indexOf(d)===-1&&i.push(d),n)}function lme(n,i,o,c,d){switch(i){case"focusin":return uu=Zg(uu,n,i,o,c,d),!0;case"dragenter":return hu=Zg(hu,n,i,o,c,d),!0;case"mouseover":return pu=Zg(pu,n,i,o,c,d),!0;case"pointerover":var f=d.pointerId;return H_.set(f,Zg(H_.get(f)||null,n,i,o,c,d)),!0;case"gotpointercapture":return f=d.pointerId,G_.set(f,Zg(G_.get(f)||null,n,i,o,c,d)),!0}return!1}function cK(n){var i=zh(n.target);if(i!==null){var o=vp(i);if(o!==null){if(i=o.tag,i===13){if(i=Xz(o),i!==null){n.blockedOn=i,aK(n.priority,function(){sK(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function xx(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=LO(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);NO=c,o.target.dispatchEvent(c),NO=null}else return i=_E(o),i!==null&&EP(i),n.blockedOn=o,!1;i.shift()}return!0}function l7(n,i,o){xx(n)&&o.delete(i)}function dme(){kO=!1,uu!==null&&xx(uu)&&(uu=null),hu!==null&&xx(hu)&&(hu=null),pu!==null&&xx(pu)&&(pu=null),H_.forEach(l7),G_.forEach(l7)}function e_(n,i){n.blockedOn===i&&(n.blockedOn=null,kO||(kO=!0,ia.unstable_scheduleCallback(ia.unstable_NormalPriority,dme)))}function z_(n){function i(d){return e_(d,n)}if(0<qS.length){e_(qS[0],n);for(var o=1;o<qS.length;o++){var c=qS[o];c.blockedOn===n&&(c.blockedOn=null)}}for(uu!==null&&e_(uu,n),hu!==null&&e_(hu,n),pu!==null&&e_(pu,n),H_.forEach(i),G_.forEach(i),o=0;o<su.length;o++)c=su[o],c.blockedOn===n&&(c.blockedOn=null);for(;0<su.length&&(o=su[0],o.blockedOn===null);)cK(o),o.blockedOn===null&&su.shift()}var Rm=ud.ReactCurrentBatchConfig,Qx=!0;function ume(n,i,o,c){var d=Cr,f=Rm.transition;Rm.transition=null;try{Cr=1,vP(n,i,o,c)}finally{Cr=d,Rm.transition=f}}function hme(n,i,o,c){var d=Cr,f=Rm.transition;Rm.transition=null;try{Cr=4,vP(n,i,o,c)}finally{Cr=d,Rm.transition=f}}function vP(n,i,o,c){if(Qx){var d=LO(n,i,o,c);if(d===null)LN(n,i,c,Zx,o),c7(n,c);else if(lme(d,n,i,o,c))c.stopPropagation();else if(c7(n,c),i&4&&-1<cme.indexOf(n)){for(;d!==null;){var f=_E(d);if(f!==null&&iK(f),f=LO(n,i,o,c),f===null&&LN(n,i,c,Zx,o),f===d)break;d=f}d!==null&&c.stopPropagation()}else LN(n,i,c,null,o)}}var Zx=null;function LO(n,i,o,c){if(Zx=null,n=mP(c),n=zh(n),n!==null)if(i=vp(n),i===null)n=null;else if(o=i.tag,o===13){if(n=Xz(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return Zx=n,null}function lK(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zfe()){case gP:return 1;case eK:return 4;case Xx:case eme:return 16;case tK:return 536870912;default:return 16}default:return 16}}var cu=null,yP=null,Tx=null;function dK(){if(Tx)return Tx;var n,i=yP,o=i.length,c,d="value"in cu?cu.value:cu.textContent,f=d.length;for(n=0;n<o&&i[n]===d[n];n++);var _=o-n;for(c=1;c<=_&&i[o-c]===d[f-c];c++);return Tx=d.slice(n,1<c?1-c:void 0)}function bx(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function YS(){return!0}function d7(){return!1}function la(n){function i(o,c,d,f,_){this._reactName=o,this._targetInst=d,this.type=c,this.nativeEvent=f,this.target=_,this.currentTarget=null;for(var v in n)n.hasOwnProperty(v)&&(o=n[v],this[v]=o?o(f):f[v]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?YS:d7,this.isPropagationStopped=d7,this}return mi(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=YS)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=YS)},persist:function(){},isPersistent:YS}),i}var Jm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},SP=la(Jm),gE=mi({},Jm,{view:0,detail:0}),pme=la(gE),CN,RN,t_,QT=mi({},gE,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xP,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==t_&&(t_&&n.type==="mousemove"?(CN=n.screenX-t_.screenX,RN=n.screenY-t_.screenY):RN=CN=0,t_=n),CN)},movementY:function(n){return"movementY"in n?n.movementY:RN}}),u7=la(QT),fme=mi({},QT,{dataTransfer:0}),mme=la(fme),gme=mi({},gE,{relatedTarget:0}),AN=la(gme),_me=mi({},Jm,{animationName:0,elapsedTime:0,pseudoElement:0}),Eme=la(_me),vme=mi({},Jm,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),yme=la(vme),Sme=mi({},Jm,{data:0}),h7=la(Sme),xme={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tme={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bme={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wme(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=bme[n])?!!i[n]:!1}function xP(){return wme}var Cme=mi({},gE,{key:function(n){if(n.key){var i=xme[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=bx(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Tme[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xP,charCode:function(n){return n.type==="keypress"?bx(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?bx(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Rme=la(Cme),Ame=mi({},QT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),p7=la(Ame),Nme=mi({},gE,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xP}),Ime=la(Nme),Ome=mi({},Jm,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dme=la(Ome),Pme=mi({},QT,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),kme=la(Pme),Lme=[9,13,27,32],TP=rd&&"CompositionEvent"in window,T_=null;rd&&"documentMode"in document&&(T_=document.documentMode);var Mme=rd&&"TextEvent"in window&&!T_,uK=rd&&(!TP||T_&&8<T_&&11>=T_),f7=String.fromCharCode(32),m7=!1;function hK(n,i){switch(n){case"keyup":return Lme.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pK(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var lm=!1;function jme(n,i){switch(n){case"compositionend":return pK(i);case"keypress":return i.which!==32?null:(m7=!0,f7);case"textInput":return n=i.data,n===f7&&m7?null:n;default:return null}}function Ume(n,i){if(lm)return n==="compositionend"||!TP&&hK(n,i)?(n=dK(),Tx=yP=cu=null,lm=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return uK&&i.locale!=="ko"?null:i.data;default:return null}}var Fme={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g7(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Fme[n.type]:i==="textarea"}function fK(n,i,o,c){zz(c),i=eT(i,"onChange"),0<i.length&&(o=new SP("onChange","change",null,o,c),n.push({event:o,listeners:i}))}var b_=null,K_=null;function Vme(n){wK(n,0)}function ZT(n){var i=hm(n);if(Uz(i))return n}function Bme(n,i){if(n==="change")return i}var mK=!1;if(rd){var NN;if(rd){var IN="oninput"in document;if(!IN){var _7=document.createElement("div");_7.setAttribute("oninput","return;"),IN=typeof _7.oninput=="function"}NN=IN}else NN=!1;mK=NN&&(!document.documentMode||9<document.documentMode)}function E7(){b_&&(b_.detachEvent("onpropertychange",gK),K_=b_=null)}function gK(n){if(n.propertyName==="value"&&ZT(K_)){var i=[];fK(i,K_,n,mP(n)),$z(Vme,i)}}function Wme(n,i,o){n==="focusin"?(E7(),b_=i,K_=o,b_.attachEvent("onpropertychange",gK)):n==="focusout"&&E7()}function Hme(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ZT(K_)}function Gme(n,i){if(n==="click")return ZT(i)}function zme(n,i){if(n==="input"||n==="change")return ZT(i)}function Kme(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Ic=typeof Object.is=="function"?Object.is:Kme;function q_(n,i){if(Ic(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),c=Object.keys(i);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var d=o[c];if(!_O.call(i,d)||!Ic(n[d],i[d]))return!1}return!0}function v7(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function y7(n,i){var o=v7(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=i&&c>=i)return{node:o,offset:i-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=v7(o)}}function _K(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?_K(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function EK(){for(var n=window,i=qx();i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=qx(n.document)}return i}function bP(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function qme(n){var i=EK(),o=n.focusedElem,c=n.selectionRange;if(i!==o&&o&&o.ownerDocument&&_K(o.ownerDocument.documentElement,o)){if(c!==null&&bP(o)){if(i=c.start,n=c.end,n===void 0&&(n=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(n,o.value.length);else if(n=(i=o.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var d=o.textContent.length,f=Math.min(c.start,d);c=c.end===void 0?f:Math.min(c.end,d),!n.extend&&f>c&&(d=c,c=f,f=d),d=y7(o,f);var _=y7(o,c);d&&_&&(n.rangeCount!==1||n.anchorNode!==d.node||n.anchorOffset!==d.offset||n.focusNode!==_.node||n.focusOffset!==_.offset)&&(i=i.createRange(),i.setStart(d.node,d.offset),n.removeAllRanges(),f>c?(n.addRange(i),n.extend(_.node,_.offset)):(i.setEnd(_.node,_.offset),n.addRange(i)))}}for(i=[],n=o;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)n=i[o],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Yme=rd&&"documentMode"in document&&11>=document.documentMode,dm=null,MO=null,w_=null,jO=!1;function S7(n,i,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;jO||dm==null||dm!==qx(c)||(c=dm,"selectionStart"in c&&bP(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),w_&&q_(w_,c)||(w_=c,c=eT(MO,"onSelect"),0<c.length&&(i=new SP("onSelect","select",null,i,o),n.push({event:i,listeners:c}),i.target=dm)))}function $S(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var um={animationend:$S("Animation","AnimationEnd"),animationiteration:$S("Animation","AnimationIteration"),animationstart:$S("Animation","AnimationStart"),transitionend:$S("Transition","TransitionEnd")},ON={},vK={};rd&&(vK=document.createElement("div").style,"AnimationEvent"in window||(delete um.animationend.animation,delete um.animationiteration.animation,delete um.animationstart.animation),"TransitionEvent"in window||delete um.transitionend.transition);function eb(n){if(ON[n])return ON[n];if(!um[n])return n;var i=um[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in vK)return ON[n]=i[o];return n}var yK=eb("animationend"),SK=eb("animationiteration"),xK=eb("animationstart"),TK=eb("transitionend"),bK=new Map,x7="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ru(n,i){bK.set(n,i),Ep(i,[n])}for(var DN=0;DN<x7.length;DN++){var PN=x7[DN],$me=PN.toLowerCase(),Xme=PN[0].toUpperCase()+PN.slice(1);Ru($me,"on"+Xme)}Ru(yK,"onAnimationEnd");Ru(SK,"onAnimationIteration");Ru(xK,"onAnimationStart");Ru("dblclick","onDoubleClick");Ru("focusin","onFocus");Ru("focusout","onBlur");Ru(TK,"onTransitionEnd");Om("onMouseEnter",["mouseout","mouseover"]);Om("onMouseLeave",["mouseout","mouseover"]);Om("onPointerEnter",["pointerout","pointerover"]);Om("onPointerLeave",["pointerout","pointerover"]);Ep("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ep("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ep("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ep("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ep("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ep("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var g_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jme=new Set("cancel close invalid load scroll toggle".split(" ").concat(g_));function T7(n,i,o){var c=n.type||"unknown-event";n.currentTarget=o,$fe(c,i,void 0,n),n.currentTarget=null}function wK(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],d=c.event;c=c.listeners;e:{var f=void 0;if(i)for(var _=c.length-1;0<=_;_--){var v=c[_],x=v.instance,T=v.currentTarget;if(v=v.listener,x!==f&&d.isPropagationStopped())break e;T7(d,v,T),f=x}else for(_=0;_<c.length;_++){if(v=c[_],x=v.instance,T=v.currentTarget,v=v.listener,x!==f&&d.isPropagationStopped())break e;T7(d,v,T),f=x}}}if($x)throw n=DO,$x=!1,DO=null,n}function Wr(n,i){var o=i[WO];o===void 0&&(o=i[WO]=new Set);var c=n+"__bubble";o.has(c)||(CK(i,n,2,!1),o.add(c))}function kN(n,i,o){var c=0;i&&(c|=4),CK(o,n,c,i)}var XS="_reactListening"+Math.random().toString(36).slice(2);function Y_(n){if(!n[XS]){n[XS]=!0,Pz.forEach(function(o){o!=="selectionchange"&&(Jme.has(o)||kN(o,!1,n),kN(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[XS]||(i[XS]=!0,kN("selectionchange",!1,i))}}function CK(n,i,o,c){switch(lK(i)){case 1:var d=ume;break;case 4:d=hme;break;default:d=vP}o=d.bind(null,i,o,n),d=void 0,!OO||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(d=!0),c?d!==void 0?n.addEventListener(i,o,{capture:!0,passive:d}):n.addEventListener(i,o,!0):d!==void 0?n.addEventListener(i,o,{passive:d}):n.addEventListener(i,o,!1)}function LN(n,i,o,c,d){var f=c;if(!(i&1)&&!(i&2)&&c!==null)e:for(;;){if(c===null)return;var _=c.tag;if(_===3||_===4){var v=c.stateNode.containerInfo;if(v===d||v.nodeType===8&&v.parentNode===d)break;if(_===4)for(_=c.return;_!==null;){var x=_.tag;if((x===3||x===4)&&(x=_.stateNode.containerInfo,x===d||x.nodeType===8&&x.parentNode===d))return;_=_.return}for(;v!==null;){if(_=zh(v),_===null)return;if(x=_.tag,x===5||x===6){c=f=_;continue e}v=v.parentNode}}c=c.return}$z(function(){var T=f,w=mP(o),R=[];e:{var I=bK.get(n);if(I!==void 0){var j=SP,P=n;switch(n){case"keypress":if(bx(o)===0)break e;case"keydown":case"keyup":j=Rme;break;case"focusin":P="focus",j=AN;break;case"focusout":P="blur",j=AN;break;case"beforeblur":case"afterblur":j=AN;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=u7;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=mme;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=Ime;break;case yK:case SK:case xK:j=Eme;break;case TK:j=Dme;break;case"scroll":j=pme;break;case"wheel":j=kme;break;case"copy":case"cut":case"paste":j=yme;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=p7}var k=(i&4)!==0,W=!k&&n==="scroll",H=k?I!==null?I+"Capture":null:I;k=[];for(var L=T,V;L!==null;){V=L;var K=V.stateNode;if(V.tag===5&&K!==null&&(V=K,H!==null&&(K=W_(L,H),K!=null&&k.push($_(L,K,V)))),W)break;L=L.return}0<k.length&&(I=new j(I,P,null,o,w),R.push({event:I,listeners:k}))}}if(!(i&7)){e:{if(I=n==="mouseover"||n==="pointerover",j=n==="mouseout"||n==="pointerout",I&&o!==NO&&(P=o.relatedTarget||o.fromElement)&&(zh(P)||P[id]))break e;if((j||I)&&(I=w.window===w?w:(I=w.ownerDocument)?I.defaultView||I.parentWindow:window,j?(P=o.relatedTarget||o.toElement,j=T,P=P?zh(P):null,P!==null&&(W=vp(P),P!==W||P.tag!==5&&P.tag!==6)&&(P=null)):(j=null,P=T),j!==P)){if(k=u7,K="onMouseLeave",H="onMouseEnter",L="mouse",(n==="pointerout"||n==="pointerover")&&(k=p7,K="onPointerLeave",H="onPointerEnter",L="pointer"),W=j==null?I:hm(j),V=P==null?I:hm(P),I=new k(K,L+"leave",j,o,w),I.target=W,I.relatedTarget=V,K=null,zh(w)===T&&(k=new k(H,L+"enter",P,o,w),k.target=V,k.relatedTarget=W,K=k),W=K,j&&P)t:{for(k=j,H=P,L=0,V=k;V;V=Jf(V))L++;for(V=0,K=H;K;K=Jf(K))V++;for(;0<L-V;)k=Jf(k),L--;for(;0<V-L;)H=Jf(H),V--;for(;L--;){if(k===H||H!==null&&k===H.alternate)break t;k=Jf(k),H=Jf(H)}k=null}else k=null;j!==null&&b7(R,I,j,k,!1),P!==null&&W!==null&&b7(R,W,P,k,!0)}}e:{if(I=T?hm(T):window,j=I.nodeName&&I.nodeName.toLowerCase(),j==="select"||j==="input"&&I.type==="file")var te=Bme;else if(g7(I))if(mK)te=zme;else{te=Hme;var ie=Wme}else(j=I.nodeName)&&j.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(te=Gme);if(te&&(te=te(n,T))){fK(R,te,o,w);break e}ie&&ie(n,I,T),n==="focusout"&&(ie=I._wrapperState)&&ie.controlled&&I.type==="number"&&bO(I,"number",I.value)}switch(ie=T?hm(T):window,n){case"focusin":(g7(ie)||ie.contentEditable==="true")&&(dm=ie,MO=T,w_=null);break;case"focusout":w_=MO=dm=null;break;case"mousedown":jO=!0;break;case"contextmenu":case"mouseup":case"dragend":jO=!1,S7(R,o,w);break;case"selectionchange":if(Yme)break;case"keydown":case"keyup":S7(R,o,w)}var A;if(TP)e:{switch(n){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else lm?hK(n,o)&&(de="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(de="onCompositionStart");de&&(uK&&o.locale!=="ko"&&(lm||de!=="onCompositionStart"?de==="onCompositionEnd"&&lm&&(A=dK()):(cu=w,yP="value"in cu?cu.value:cu.textContent,lm=!0)),ie=eT(T,de),0<ie.length&&(de=new h7(de,n,null,o,w),R.push({event:de,listeners:ie}),A?de.data=A:(A=pK(o),A!==null&&(de.data=A)))),(A=Mme?jme(n,o):Ume(n,o))&&(T=eT(T,"onBeforeInput"),0<T.length&&(w=new h7("onBeforeInput","beforeinput",null,o,w),R.push({event:w,listeners:T}),w.data=A))}wK(R,i)})}function $_(n,i,o){return{instance:n,listener:i,currentTarget:o}}function eT(n,i){for(var o=i+"Capture",c=[];n!==null;){var d=n,f=d.stateNode;d.tag===5&&f!==null&&(d=f,f=W_(n,o),f!=null&&c.unshift($_(n,f,d)),f=W_(n,i),f!=null&&c.push($_(n,f,d))),n=n.return}return c}function Jf(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function b7(n,i,o,c,d){for(var f=i._reactName,_=[];o!==null&&o!==c;){var v=o,x=v.alternate,T=v.stateNode;if(x!==null&&x===c)break;v.tag===5&&T!==null&&(v=T,d?(x=W_(o,f),x!=null&&_.unshift($_(o,x,v))):d||(x=W_(o,f),x!=null&&_.push($_(o,x,v)))),o=o.return}_.length!==0&&n.push({event:i,listeners:_})}var Qme=/\r\n?/g,Zme=/\u0000|\uFFFD/g;function w7(n){return(typeof n=="string"?n:""+n).replace(Qme,`
`).replace(Zme,"")}function JS(n,i,o){if(i=w7(i),w7(n)!==i&&o)throw Error(pt(425))}function tT(){}var UO=null,FO=null;function VO(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var BO=typeof setTimeout=="function"?setTimeout:void 0,e0e=typeof clearTimeout=="function"?clearTimeout:void 0,C7=typeof Promise=="function"?Promise:void 0,t0e=typeof queueMicrotask=="function"?queueMicrotask:typeof C7<"u"?function(n){return C7.resolve(null).then(n).catch(n0e)}:BO;function n0e(n){setTimeout(function(){throw n})}function MN(n,i){var o=i,c=0;do{var d=o.nextSibling;if(n.removeChild(o),d&&d.nodeType===8)if(o=d.data,o==="/$"){if(c===0){n.removeChild(d),z_(i);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=d}while(o);z_(i)}function fu(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function R7(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return n;i--}else o==="/$"&&i++}n=n.previousSibling}return null}var Qm=Math.random().toString(36).slice(2),ml="__reactFiber$"+Qm,X_="__reactProps$"+Qm,id="__reactContainer$"+Qm,WO="__reactEvents$"+Qm,r0e="__reactListeners$"+Qm,i0e="__reactHandles$"+Qm;function zh(n){var i=n[ml];if(i)return i;for(var o=n.parentNode;o;){if(i=o[id]||o[ml]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=R7(n);n!==null;){if(o=n[ml])return o;n=R7(n)}return i}n=o,o=n.parentNode}return null}function _E(n){return n=n[ml]||n[id],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function hm(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(pt(33))}function tb(n){return n[X_]||null}var HO=[],pm=-1;function Au(n){return{current:n}}function zr(n){0>pm||(n.current=HO[pm],HO[pm]=null,pm--)}function jr(n,i){pm++,HO[pm]=n.current,n.current=i}var Tu={},zs=Au(Tu),Do=Au(!1),sp=Tu;function Dm(n,i){var o=n.type.contextTypes;if(!o)return Tu;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===i)return c.__reactInternalMemoizedMaskedChildContext;var d={},f;for(f in o)d[f]=i[f];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=d),d}function Po(n){return n=n.childContextTypes,n!=null}function nT(){zr(Do),zr(zs)}function A7(n,i,o){if(zs.current!==Tu)throw Error(pt(168));jr(zs,i),jr(Do,o)}function RK(n,i,o){var c=n.stateNode;if(i=i.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var d in c)if(!(d in i))throw Error(pt(108,Wfe(n)||"Unknown",d));return mi({},o,c)}function rT(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Tu,sp=zs.current,jr(zs,n),jr(Do,Do.current),!0}function N7(n,i,o){var c=n.stateNode;if(!c)throw Error(pt(169));o?(n=RK(n,i,sp),c.__reactInternalMemoizedMergedChildContext=n,zr(Do),zr(zs),jr(zs,n)):zr(Do),jr(Do,o)}var $l=null,nb=!1,jN=!1;function AK(n){$l===null?$l=[n]:$l.push(n)}function s0e(n){nb=!0,AK(n)}function Nu(){if(!jN&&$l!==null){jN=!0;var n=0,i=Cr;try{var o=$l;for(Cr=1;n<o.length;n++){var c=o[n];do c=c(!0);while(c!==null)}$l=null,nb=!1}catch(d){throw $l!==null&&($l=$l.slice(n+1)),Zz(gP,Nu),d}finally{Cr=i,jN=!1}}return null}var fm=[],mm=0,iT=null,sT=0,Fa=[],Va=0,op=null,Xl=1,Jl="";function Fh(n,i){fm[mm++]=sT,fm[mm++]=iT,iT=n,sT=i}function NK(n,i,o){Fa[Va++]=Xl,Fa[Va++]=Jl,Fa[Va++]=op,op=n;var c=Xl;n=Jl;var d=32-Cc(c)-1;c&=~(1<<d),o+=1;var f=32-Cc(i)+d;if(30<f){var _=d-d%5;f=(c&(1<<_)-1).toString(32),c>>=_,d-=_,Xl=1<<32-Cc(i)+d|o<<d|c,Jl=f+n}else Xl=1<<f|o<<d|c,Jl=n}function wP(n){n.return!==null&&(Fh(n,1),NK(n,1,0))}function CP(n){for(;n===iT;)iT=fm[--mm],fm[mm]=null,sT=fm[--mm],fm[mm]=null;for(;n===op;)op=Fa[--Va],Fa[Va]=null,Jl=Fa[--Va],Fa[Va]=null,Xl=Fa[--Va],Fa[Va]=null}var ra=null,na=null,ti=!1,xc=null;function IK(n,i){var o=Ba(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=n,i=n.deletions,i===null?(n.deletions=[o],n.flags|=16):i.push(o)}function I7(n,i){switch(n.tag){case 5:var o=n.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,ra=n,na=fu(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,ra=n,na=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=op!==null?{id:Xl,overflow:Jl}:null,n.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=Ba(18,null,null,0),o.stateNode=i,o.return=n,n.child=o,ra=n,na=null,!0):!1;default:return!1}}function GO(n){return(n.mode&1)!==0&&(n.flags&128)===0}function zO(n){if(ti){var i=na;if(i){var o=i;if(!I7(n,i)){if(GO(n))throw Error(pt(418));i=fu(o.nextSibling);var c=ra;i&&I7(n,i)?IK(c,o):(n.flags=n.flags&-4097|2,ti=!1,ra=n)}}else{if(GO(n))throw Error(pt(418));n.flags=n.flags&-4097|2,ti=!1,ra=n}}}function O7(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ra=n}function QS(n){if(n!==ra)return!1;if(!ti)return O7(n),ti=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!VO(n.type,n.memoizedProps)),i&&(i=na)){if(GO(n))throw OK(),Error(pt(418));for(;i;)IK(n,i),i=fu(i.nextSibling)}if(O7(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(pt(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"){if(i===0){na=fu(n.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}n=n.nextSibling}na=null}}else na=ra?fu(n.stateNode.nextSibling):null;return!0}function OK(){for(var n=na;n;)n=fu(n.nextSibling)}function Pm(){na=ra=null,ti=!1}function RP(n){xc===null?xc=[n]:xc.push(n)}var o0e=ud.ReactCurrentBatchConfig;function n_(n,i,o){if(n=o.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(pt(309));var c=o.stateNode}if(!c)throw Error(pt(147,n));var d=c,f=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===f?i.ref:(i=function(_){var v=d.refs;_===null?delete v[f]:v[f]=_},i._stringRef=f,i)}if(typeof n!="string")throw Error(pt(284));if(!o._owner)throw Error(pt(290,n))}return n}function ZS(n,i){throw n=Object.prototype.toString.call(i),Error(pt(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function D7(n){var i=n._init;return i(n._payload)}function DK(n){function i(H,L){if(n){var V=H.deletions;V===null?(H.deletions=[L],H.flags|=16):V.push(L)}}function o(H,L){if(!n)return null;for(;L!==null;)i(H,L),L=L.sibling;return null}function c(H,L){for(H=new Map;L!==null;)L.key!==null?H.set(L.key,L):H.set(L.index,L),L=L.sibling;return H}function d(H,L){return H=Eu(H,L),H.index=0,H.sibling=null,H}function f(H,L,V){return H.index=V,n?(V=H.alternate,V!==null?(V=V.index,V<L?(H.flags|=2,L):V):(H.flags|=2,L)):(H.flags|=1048576,L)}function _(H){return n&&H.alternate===null&&(H.flags|=2),H}function v(H,L,V,K){return L===null||L.tag!==6?(L=GN(V,H.mode,K),L.return=H,L):(L=d(L,V),L.return=H,L)}function x(H,L,V,K){var te=V.type;return te===cm?w(H,L,V.props.children,K,V.key):L!==null&&(L.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===nu&&D7(te)===L.type)?(K=d(L,V.props),K.ref=n_(H,L,V),K.return=H,K):(K=Ox(V.type,V.key,V.props,null,H.mode,K),K.ref=n_(H,L,V),K.return=H,K)}function T(H,L,V,K){return L===null||L.tag!==4||L.stateNode.containerInfo!==V.containerInfo||L.stateNode.implementation!==V.implementation?(L=zN(V,H.mode,K),L.return=H,L):(L=d(L,V.children||[]),L.return=H,L)}function w(H,L,V,K,te){return L===null||L.tag!==7?(L=tp(V,H.mode,K,te),L.return=H,L):(L=d(L,V),L.return=H,L)}function R(H,L,V){if(typeof L=="string"&&L!==""||typeof L=="number")return L=GN(""+L,H.mode,V),L.return=H,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case WS:return V=Ox(L.type,L.key,L.props,null,H.mode,V),V.ref=n_(H,null,L),V.return=H,V;case am:return L=zN(L,H.mode,V),L.return=H,L;case nu:var K=L._init;return R(H,K(L._payload),V)}if(f_(L)||Jg(L))return L=tp(L,H.mode,V,null),L.return=H,L;ZS(H,L)}return null}function I(H,L,V,K){var te=L!==null?L.key:null;if(typeof V=="string"&&V!==""||typeof V=="number")return te!==null?null:v(H,L,""+V,K);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case WS:return V.key===te?x(H,L,V,K):null;case am:return V.key===te?T(H,L,V,K):null;case nu:return te=V._init,I(H,L,te(V._payload),K)}if(f_(V)||Jg(V))return te!==null?null:w(H,L,V,K,null);ZS(H,V)}return null}function j(H,L,V,K,te){if(typeof K=="string"&&K!==""||typeof K=="number")return H=H.get(V)||null,v(L,H,""+K,te);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case WS:return H=H.get(K.key===null?V:K.key)||null,x(L,H,K,te);case am:return H=H.get(K.key===null?V:K.key)||null,T(L,H,K,te);case nu:var ie=K._init;return j(H,L,V,ie(K._payload),te)}if(f_(K)||Jg(K))return H=H.get(V)||null,w(L,H,K,te,null);ZS(L,K)}return null}function P(H,L,V,K){for(var te=null,ie=null,A=L,de=L=0,ue=null;A!==null&&de<V.length;de++){A.index>de?(ue=A,A=null):ue=A.sibling;var oe=I(H,A,V[de],K);if(oe===null){A===null&&(A=ue);break}n&&A&&oe.alternate===null&&i(H,A),L=f(oe,L,de),ie===null?te=oe:ie.sibling=oe,ie=oe,A=ue}if(de===V.length)return o(H,A),ti&&Fh(H,de),te;if(A===null){for(;de<V.length;de++)A=R(H,V[de],K),A!==null&&(L=f(A,L,de),ie===null?te=A:ie.sibling=A,ie=A);return ti&&Fh(H,de),te}for(A=c(H,A);de<V.length;de++)ue=j(A,H,de,V[de],K),ue!==null&&(n&&ue.alternate!==null&&A.delete(ue.key===null?de:ue.key),L=f(ue,L,de),ie===null?te=ue:ie.sibling=ue,ie=ue);return n&&A.forEach(function(ye){return i(H,ye)}),ti&&Fh(H,de),te}function k(H,L,V,K){var te=Jg(V);if(typeof te!="function")throw Error(pt(150));if(V=te.call(V),V==null)throw Error(pt(151));for(var ie=te=null,A=L,de=L=0,ue=null,oe=V.next();A!==null&&!oe.done;de++,oe=V.next()){A.index>de?(ue=A,A=null):ue=A.sibling;var ye=I(H,A,oe.value,K);if(ye===null){A===null&&(A=ue);break}n&&A&&ye.alternate===null&&i(H,A),L=f(ye,L,de),ie===null?te=ye:ie.sibling=ye,ie=ye,A=ue}if(oe.done)return o(H,A),ti&&Fh(H,de),te;if(A===null){for(;!oe.done;de++,oe=V.next())oe=R(H,oe.value,K),oe!==null&&(L=f(oe,L,de),ie===null?te=oe:ie.sibling=oe,ie=oe);return ti&&Fh(H,de),te}for(A=c(H,A);!oe.done;de++,oe=V.next())oe=j(A,H,de,oe.value,K),oe!==null&&(n&&oe.alternate!==null&&A.delete(oe.key===null?de:oe.key),L=f(oe,L,de),ie===null?te=oe:ie.sibling=oe,ie=oe);return n&&A.forEach(function(Ee){return i(H,Ee)}),ti&&Fh(H,de),te}function W(H,L,V,K){if(typeof V=="object"&&V!==null&&V.type===cm&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case WS:e:{for(var te=V.key,ie=L;ie!==null;){if(ie.key===te){if(te=V.type,te===cm){if(ie.tag===7){o(H,ie.sibling),L=d(ie,V.props.children),L.return=H,H=L;break e}}else if(ie.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===nu&&D7(te)===ie.type){o(H,ie.sibling),L=d(ie,V.props),L.ref=n_(H,ie,V),L.return=H,H=L;break e}o(H,ie);break}else i(H,ie);ie=ie.sibling}V.type===cm?(L=tp(V.props.children,H.mode,K,V.key),L.return=H,H=L):(K=Ox(V.type,V.key,V.props,null,H.mode,K),K.ref=n_(H,L,V),K.return=H,H=K)}return _(H);case am:e:{for(ie=V.key;L!==null;){if(L.key===ie)if(L.tag===4&&L.stateNode.containerInfo===V.containerInfo&&L.stateNode.implementation===V.implementation){o(H,L.sibling),L=d(L,V.children||[]),L.return=H,H=L;break e}else{o(H,L);break}else i(H,L);L=L.sibling}L=zN(V,H.mode,K),L.return=H,H=L}return _(H);case nu:return ie=V._init,W(H,L,ie(V._payload),K)}if(f_(V))return P(H,L,V,K);if(Jg(V))return k(H,L,V,K);ZS(H,V)}return typeof V=="string"&&V!==""||typeof V=="number"?(V=""+V,L!==null&&L.tag===6?(o(H,L.sibling),L=d(L,V),L.return=H,H=L):(o(H,L),L=GN(V,H.mode,K),L.return=H,H=L),_(H)):o(H,L)}return W}var km=DK(!0),PK=DK(!1),oT=Au(null),aT=null,gm=null,AP=null;function NP(){AP=gm=aT=null}function IP(n){var i=oT.current;zr(oT),n._currentValue=i}function KO(n,i,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===o)break;n=n.return}}function Am(n,i){aT=n,AP=gm=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&i&&(Io=!0),n.firstContext=null)}function Ha(n){var i=n._currentValue;if(AP!==n)if(n={context:n,memoizedValue:i,next:null},gm===null){if(aT===null)throw Error(pt(308));gm=n,aT.dependencies={lanes:0,firstContext:n}}else gm=gm.next=n;return i}var Kh=null;function OP(n){Kh===null?Kh=[n]:Kh.push(n)}function kK(n,i,o,c){var d=i.interleaved;return d===null?(o.next=o,OP(i)):(o.next=d.next,d.next=o),i.interleaved=o,sd(n,c)}function sd(n,i){n.lanes|=i;var o=n.alternate;for(o!==null&&(o.lanes|=i),o=n,n=n.return;n!==null;)n.childLanes|=i,o=n.alternate,o!==null&&(o.childLanes|=i),o=n,n=n.return;return o.tag===3?o.stateNode:null}var ru=!1;function DP(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LK(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Zl(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function mu(n,i,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,ar&2){var d=c.pending;return d===null?i.next=i:(i.next=d.next,d.next=i),c.pending=i,sd(n,o)}return d=c.interleaved,d===null?(i.next=i,OP(c)):(i.next=d.next,d.next=i),c.interleaved=i,sd(n,o)}function wx(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,_P(n,o)}}function P7(n,i){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var d=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var _={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};f===null?d=f=_:f=f.next=_,o=o.next}while(o!==null);f===null?d=f=i:f=f.next=i}else d=f=i;o={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:f,shared:c.shared,effects:c.effects},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}function cT(n,i,o,c){var d=n.updateQueue;ru=!1;var f=d.firstBaseUpdate,_=d.lastBaseUpdate,v=d.shared.pending;if(v!==null){d.shared.pending=null;var x=v,T=x.next;x.next=null,_===null?f=T:_.next=T,_=x;var w=n.alternate;w!==null&&(w=w.updateQueue,v=w.lastBaseUpdate,v!==_&&(v===null?w.firstBaseUpdate=T:v.next=T,w.lastBaseUpdate=x))}if(f!==null){var R=d.baseState;_=0,w=T=x=null,v=f;do{var I=v.lane,j=v.eventTime;if((c&I)===I){w!==null&&(w=w.next={eventTime:j,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var P=n,k=v;switch(I=i,j=o,k.tag){case 1:if(P=k.payload,typeof P=="function"){R=P.call(j,R,I);break e}R=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=k.payload,I=typeof P=="function"?P.call(j,R,I):P,I==null)break e;R=mi({},R,I);break e;case 2:ru=!0}}v.callback!==null&&v.lane!==0&&(n.flags|=64,I=d.effects,I===null?d.effects=[v]:I.push(v))}else j={eventTime:j,lane:I,tag:v.tag,payload:v.payload,callback:v.callback,next:null},w===null?(T=w=j,x=R):w=w.next=j,_|=I;if(v=v.next,v===null){if(v=d.shared.pending,v===null)break;I=v,v=I.next,I.next=null,d.lastBaseUpdate=I,d.shared.pending=null}}while(1);if(w===null&&(x=R),d.baseState=x,d.firstBaseUpdate=T,d.lastBaseUpdate=w,i=d.shared.interleaved,i!==null){d=i;do _|=d.lane,d=d.next;while(d!==i)}else f===null&&(d.shared.lanes=0);cp|=_,n.lanes=_,n.memoizedState=R}}function k7(n,i,o){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var c=n[i],d=c.callback;if(d!==null){if(c.callback=null,c=o,typeof d!="function")throw Error(pt(191,d));d.call(c)}}}var EE={},vl=Au(EE),J_=Au(EE),Q_=Au(EE);function qh(n){if(n===EE)throw Error(pt(174));return n}function PP(n,i){switch(jr(Q_,i),jr(J_,n),jr(vl,EE),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:CO(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=CO(i,n)}zr(vl),jr(vl,i)}function Lm(){zr(vl),zr(J_),zr(Q_)}function MK(n){qh(Q_.current);var i=qh(vl.current),o=CO(i,n.type);i!==o&&(jr(J_,n),jr(vl,o))}function kP(n){J_.current===n&&(zr(vl),zr(J_))}var ui=Au(0);function lT(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var UN=[];function LP(){for(var n=0;n<UN.length;n++)UN[n]._workInProgressVersionPrimary=null;UN.length=0}var Cx=ud.ReactCurrentDispatcher,FN=ud.ReactCurrentBatchConfig,ap=0,pi=null,Xi=null,us=null,dT=!1,C_=!1,Z_=0,a0e=0;function Us(){throw Error(pt(321))}function MP(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!Ic(n[o],i[o]))return!1;return!0}function jP(n,i,o,c,d,f){if(ap=f,pi=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Cx.current=n===null||n.memoizedState===null?u0e:h0e,n=o(c,d),C_){f=0;do{if(C_=!1,Z_=0,25<=f)throw Error(pt(301));f+=1,us=Xi=null,i.updateQueue=null,Cx.current=p0e,n=o(c,d)}while(C_)}if(Cx.current=uT,i=Xi!==null&&Xi.next!==null,ap=0,us=Xi=pi=null,dT=!1,i)throw Error(pt(300));return n}function UP(){var n=Z_!==0;return Z_=0,n}function hl(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return us===null?pi.memoizedState=us=n:us=us.next=n,us}function Ga(){if(Xi===null){var n=pi.alternate;n=n!==null?n.memoizedState:null}else n=Xi.next;var i=us===null?pi.memoizedState:us.next;if(i!==null)us=i,Xi=n;else{if(n===null)throw Error(pt(310));Xi=n,n={memoizedState:Xi.memoizedState,baseState:Xi.baseState,baseQueue:Xi.baseQueue,queue:Xi.queue,next:null},us===null?pi.memoizedState=us=n:us=us.next=n}return us}function eE(n,i){return typeof i=="function"?i(n):i}function VN(n){var i=Ga(),o=i.queue;if(o===null)throw Error(pt(311));o.lastRenderedReducer=n;var c=Xi,d=c.baseQueue,f=o.pending;if(f!==null){if(d!==null){var _=d.next;d.next=f.next,f.next=_}c.baseQueue=d=f,o.pending=null}if(d!==null){f=d.next,c=c.baseState;var v=_=null,x=null,T=f;do{var w=T.lane;if((ap&w)===w)x!==null&&(x=x.next={lane:0,action:T.action,hasEagerState:T.hasEagerState,eagerState:T.eagerState,next:null}),c=T.hasEagerState?T.eagerState:n(c,T.action);else{var R={lane:w,action:T.action,hasEagerState:T.hasEagerState,eagerState:T.eagerState,next:null};x===null?(v=x=R,_=c):x=x.next=R,pi.lanes|=w,cp|=w}T=T.next}while(T!==null&&T!==f);x===null?_=c:x.next=v,Ic(c,i.memoizedState)||(Io=!0),i.memoizedState=c,i.baseState=_,i.baseQueue=x,o.lastRenderedState=c}if(n=o.interleaved,n!==null){d=n;do f=d.lane,pi.lanes|=f,cp|=f,d=d.next;while(d!==n)}else d===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function BN(n){var i=Ga(),o=i.queue;if(o===null)throw Error(pt(311));o.lastRenderedReducer=n;var c=o.dispatch,d=o.pending,f=i.memoizedState;if(d!==null){o.pending=null;var _=d=d.next;do f=n(f,_.action),_=_.next;while(_!==d);Ic(f,i.memoizedState)||(Io=!0),i.memoizedState=f,i.baseQueue===null&&(i.baseState=f),o.lastRenderedState=f}return[f,c]}function jK(){}function UK(n,i){var o=pi,c=Ga(),d=i(),f=!Ic(c.memoizedState,d);if(f&&(c.memoizedState=d,Io=!0),c=c.queue,FP(BK.bind(null,o,c,n),[n]),c.getSnapshot!==i||f||us!==null&&us.memoizedState.tag&1){if(o.flags|=2048,tE(9,VK.bind(null,o,c,d,i),void 0,null),ps===null)throw Error(pt(349));ap&30||FK(o,i,d)}return d}function FK(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=pi.updateQueue,i===null?(i={lastEffect:null,stores:null},pi.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function VK(n,i,o,c){i.value=o,i.getSnapshot=c,WK(i)&&HK(n)}function BK(n,i,o){return o(function(){WK(i)&&HK(n)})}function WK(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!Ic(n,o)}catch{return!0}}function HK(n){var i=sd(n,1);i!==null&&Rc(i,n,1,-1)}function L7(n){var i=hl();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eE,lastRenderedState:n},i.queue=n,n=n.dispatch=d0e.bind(null,pi,n),[i.memoizedState,n]}function tE(n,i,o,c){return n={tag:n,create:i,destroy:o,deps:c,next:null},i=pi.updateQueue,i===null?(i={lastEffect:null,stores:null},pi.updateQueue=i,i.lastEffect=n.next=n):(o=i.lastEffect,o===null?i.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,i.lastEffect=n)),n}function GK(){return Ga().memoizedState}function Rx(n,i,o,c){var d=hl();pi.flags|=n,d.memoizedState=tE(1|i,o,void 0,c===void 0?null:c)}function rb(n,i,o,c){var d=Ga();c=c===void 0?null:c;var f=void 0;if(Xi!==null){var _=Xi.memoizedState;if(f=_.destroy,c!==null&&MP(c,_.deps)){d.memoizedState=tE(i,o,f,c);return}}pi.flags|=n,d.memoizedState=tE(1|i,o,f,c)}function M7(n,i){return Rx(8390656,8,n,i)}function FP(n,i){return rb(2048,8,n,i)}function zK(n,i){return rb(4,2,n,i)}function KK(n,i){return rb(4,4,n,i)}function qK(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function YK(n,i,o){return o=o!=null?o.concat([n]):null,rb(4,4,qK.bind(null,i,n),o)}function VP(){}function $K(n,i){var o=Ga();i=i===void 0?null:i;var c=o.memoizedState;return c!==null&&i!==null&&MP(i,c[1])?c[0]:(o.memoizedState=[n,i],n)}function XK(n,i){var o=Ga();i=i===void 0?null:i;var c=o.memoizedState;return c!==null&&i!==null&&MP(i,c[1])?c[0]:(n=n(),o.memoizedState=[n,i],n)}function JK(n,i,o){return ap&21?(Ic(o,i)||(o=nK(),pi.lanes|=o,cp|=o,n.baseState=!0),i):(n.baseState&&(n.baseState=!1,Io=!0),n.memoizedState=o)}function c0e(n,i){var o=Cr;Cr=o!==0&&4>o?o:4,n(!0);var c=FN.transition;FN.transition={};try{n(!1),i()}finally{Cr=o,FN.transition=c}}function QK(){return Ga().memoizedState}function l0e(n,i,o){var c=_u(n);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},ZK(n))eq(i,o);else if(o=kK(n,i,o,c),o!==null){var d=so();Rc(o,n,c,d),tq(o,i,c)}}function d0e(n,i,o){var c=_u(n),d={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(ZK(n))eq(i,d);else{var f=n.alternate;if(n.lanes===0&&(f===null||f.lanes===0)&&(f=i.lastRenderedReducer,f!==null))try{var _=i.lastRenderedState,v=f(_,o);if(d.hasEagerState=!0,d.eagerState=v,Ic(v,_)){var x=i.interleaved;x===null?(d.next=d,OP(i)):(d.next=x.next,x.next=d),i.interleaved=d;return}}catch{}finally{}o=kK(n,i,d,c),o!==null&&(d=so(),Rc(o,n,c,d),tq(o,i,c))}}function ZK(n){var i=n.alternate;return n===pi||i!==null&&i===pi}function eq(n,i){C_=dT=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function tq(n,i,o){if(o&4194240){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,_P(n,o)}}var uT={readContext:Ha,useCallback:Us,useContext:Us,useEffect:Us,useImperativeHandle:Us,useInsertionEffect:Us,useLayoutEffect:Us,useMemo:Us,useReducer:Us,useRef:Us,useState:Us,useDebugValue:Us,useDeferredValue:Us,useTransition:Us,useMutableSource:Us,useSyncExternalStore:Us,useId:Us,unstable_isNewReconciler:!1},u0e={readContext:Ha,useCallback:function(n,i){return hl().memoizedState=[n,i===void 0?null:i],n},useContext:Ha,useEffect:M7,useImperativeHandle:function(n,i,o){return o=o!=null?o.concat([n]):null,Rx(4194308,4,qK.bind(null,i,n),o)},useLayoutEffect:function(n,i){return Rx(4194308,4,n,i)},useInsertionEffect:function(n,i){return Rx(4,2,n,i)},useMemo:function(n,i){var o=hl();return i=i===void 0?null:i,n=n(),o.memoizedState=[n,i],n},useReducer:function(n,i,o){var c=hl();return i=o!==void 0?o(i):i,c.memoizedState=c.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},c.queue=n,n=n.dispatch=l0e.bind(null,pi,n),[c.memoizedState,n]},useRef:function(n){var i=hl();return n={current:n},i.memoizedState=n},useState:L7,useDebugValue:VP,useDeferredValue:function(n){return hl().memoizedState=n},useTransition:function(){var n=L7(!1),i=n[0];return n=c0e.bind(null,n[1]),hl().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,o){var c=pi,d=hl();if(ti){if(o===void 0)throw Error(pt(407));o=o()}else{if(o=i(),ps===null)throw Error(pt(349));ap&30||FK(c,i,o)}d.memoizedState=o;var f={value:o,getSnapshot:i};return d.queue=f,M7(BK.bind(null,c,f,n),[n]),c.flags|=2048,tE(9,VK.bind(null,c,f,o,i),void 0,null),o},useId:function(){var n=hl(),i=ps.identifierPrefix;if(ti){var o=Jl,c=Xl;o=(c&~(1<<32-Cc(c)-1)).toString(32)+o,i=":"+i+"R"+o,o=Z_++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=a0e++,i=":"+i+"r"+o.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},h0e={readContext:Ha,useCallback:$K,useContext:Ha,useEffect:FP,useImperativeHandle:YK,useInsertionEffect:zK,useLayoutEffect:KK,useMemo:XK,useReducer:VN,useRef:GK,useState:function(){return VN(eE)},useDebugValue:VP,useDeferredValue:function(n){var i=Ga();return JK(i,Xi.memoizedState,n)},useTransition:function(){var n=VN(eE)[0],i=Ga().memoizedState;return[n,i]},useMutableSource:jK,useSyncExternalStore:UK,useId:QK,unstable_isNewReconciler:!1},p0e={readContext:Ha,useCallback:$K,useContext:Ha,useEffect:FP,useImperativeHandle:YK,useInsertionEffect:zK,useLayoutEffect:KK,useMemo:XK,useReducer:BN,useRef:GK,useState:function(){return BN(eE)},useDebugValue:VP,useDeferredValue:function(n){var i=Ga();return Xi===null?i.memoizedState=n:JK(i,Xi.memoizedState,n)},useTransition:function(){var n=BN(eE)[0],i=Ga().memoizedState;return[n,i]},useMutableSource:jK,useSyncExternalStore:UK,useId:QK,unstable_isNewReconciler:!1};function yc(n,i){if(n&&n.defaultProps){i=mi({},i),n=n.defaultProps;for(var o in n)i[o]===void 0&&(i[o]=n[o]);return i}return i}function qO(n,i,o,c){i=n.memoizedState,o=o(c,i),o=o==null?i:mi({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var ib={isMounted:function(n){return(n=n._reactInternals)?vp(n)===n:!1},enqueueSetState:function(n,i,o){n=n._reactInternals;var c=so(),d=_u(n),f=Zl(c,d);f.payload=i,o!=null&&(f.callback=o),i=mu(n,f,d),i!==null&&(Rc(i,n,d,c),wx(i,n,d))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var c=so(),d=_u(n),f=Zl(c,d);f.tag=1,f.payload=i,o!=null&&(f.callback=o),i=mu(n,f,d),i!==null&&(Rc(i,n,d,c),wx(i,n,d))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=so(),c=_u(n),d=Zl(o,c);d.tag=2,i!=null&&(d.callback=i),i=mu(n,d,c),i!==null&&(Rc(i,n,c,o),wx(i,n,c))}};function j7(n,i,o,c,d,f,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,f,_):i.prototype&&i.prototype.isPureReactComponent?!q_(o,c)||!q_(d,f):!0}function nq(n,i,o){var c=!1,d=Tu,f=i.contextType;return typeof f=="object"&&f!==null?f=Ha(f):(d=Po(i)?sp:zs.current,c=i.contextTypes,f=(c=c!=null)?Dm(n,d):Tu),i=new i(o,f),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=ib,n.stateNode=i,i._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=d,n.__reactInternalMemoizedMaskedChildContext=f),i}function U7(n,i,o,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,c),i.state!==n&&ib.enqueueReplaceState(i,i.state,null)}function YO(n,i,o,c){var d=n.stateNode;d.props=o,d.state=n.memoizedState,d.refs={},DP(n);var f=i.contextType;typeof f=="object"&&f!==null?d.context=Ha(f):(f=Po(i)?sp:zs.current,d.context=Dm(n,f)),d.state=n.memoizedState,f=i.getDerivedStateFromProps,typeof f=="function"&&(qO(n,i,f,o),d.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(i=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),i!==d.state&&ib.enqueueReplaceState(d,d.state,null),cT(n,o,d,c),d.state=n.memoizedState),typeof d.componentDidMount=="function"&&(n.flags|=4194308)}function Mm(n,i){try{var o="",c=i;do o+=Bfe(c),c=c.return;while(c);var d=o}catch(f){d=`
Error generating stack: `+f.message+`
`+f.stack}return{value:n,source:i,stack:d,digest:null}}function WN(n,i,o){return{value:n,source:null,stack:o??null,digest:i??null}}function $O(n,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var f0e=typeof WeakMap=="function"?WeakMap:Map;function rq(n,i,o){o=Zl(-1,o),o.tag=3,o.payload={element:null};var c=i.value;return o.callback=function(){pT||(pT=!0,sD=c),$O(n,i)},o}function iq(n,i,o){o=Zl(-1,o),o.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var d=i.value;o.payload=function(){return c(d)},o.callback=function(){$O(n,i)}}var f=n.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(o.callback=function(){$O(n,i),typeof c!="function"&&(gu===null?gu=new Set([this]):gu.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})}),o}function F7(n,i,o){var c=n.pingCache;if(c===null){c=n.pingCache=new f0e;var d=new Set;c.set(i,d)}else d=c.get(i),d===void 0&&(d=new Set,c.set(i,d));d.has(o)||(d.add(o),n=A0e.bind(null,n,i,o),i.then(n,n))}function V7(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function B7(n,i,o,c,d){return n.mode&1?(n.flags|=65536,n.lanes=d,n):(n===i?n.flags|=65536:(n.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=Zl(-1,1),i.tag=2,mu(o,i,1))),o.lanes|=1),n)}var m0e=ud.ReactCurrentOwner,Io=!1;function ro(n,i,o,c){i.child=n===null?PK(i,null,o,c):km(i,n.child,o,c)}function W7(n,i,o,c,d){o=o.render;var f=i.ref;return Am(i,d),c=jP(n,i,o,c,f,d),o=UP(),n!==null&&!Io?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d,od(n,i,d)):(ti&&o&&wP(i),i.flags|=1,ro(n,i,c,d),i.child)}function H7(n,i,o,c,d){if(n===null){var f=o.type;return typeof f=="function"&&!YP(f)&&f.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=f,sq(n,i,f,c,d)):(n=Ox(o.type,null,c,i,i.mode,d),n.ref=i.ref,n.return=i,i.child=n)}if(f=n.child,!(n.lanes&d)){var _=f.memoizedProps;if(o=o.compare,o=o!==null?o:q_,o(_,c)&&n.ref===i.ref)return od(n,i,d)}return i.flags|=1,n=Eu(f,c),n.ref=i.ref,n.return=i,i.child=n}function sq(n,i,o,c,d){if(n!==null){var f=n.memoizedProps;if(q_(f,c)&&n.ref===i.ref)if(Io=!1,i.pendingProps=c=f,(n.lanes&d)!==0)n.flags&131072&&(Io=!0);else return i.lanes=n.lanes,od(n,i,d)}return XO(n,i,o,c,d)}function oq(n,i,o){var c=i.pendingProps,d=c.children,f=n!==null?n.memoizedState:null;if(c.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},jr(Em,ta),ta|=o;else{if(!(o&1073741824))return n=f!==null?f.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,jr(Em,ta),ta|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=f!==null?f.baseLanes:o,jr(Em,ta),ta|=c}else f!==null?(c=f.baseLanes|o,i.memoizedState=null):c=o,jr(Em,ta),ta|=c;return ro(n,i,d,o),i.child}function aq(n,i){var o=i.ref;(n===null&&o!==null||n!==null&&n.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function XO(n,i,o,c,d){var f=Po(o)?sp:zs.current;return f=Dm(i,f),Am(i,d),o=jP(n,i,o,c,f,d),c=UP(),n!==null&&!Io?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d,od(n,i,d)):(ti&&c&&wP(i),i.flags|=1,ro(n,i,o,d),i.child)}function G7(n,i,o,c,d){if(Po(o)){var f=!0;rT(i)}else f=!1;if(Am(i,d),i.stateNode===null)Ax(n,i),nq(i,o,c),YO(i,o,c,d),c=!0;else if(n===null){var _=i.stateNode,v=i.memoizedProps;_.props=v;var x=_.context,T=o.contextType;typeof T=="object"&&T!==null?T=Ha(T):(T=Po(o)?sp:zs.current,T=Dm(i,T));var w=o.getDerivedStateFromProps,R=typeof w=="function"||typeof _.getSnapshotBeforeUpdate=="function";R||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(v!==c||x!==T)&&U7(i,_,c,T),ru=!1;var I=i.memoizedState;_.state=I,cT(i,c,_,d),x=i.memoizedState,v!==c||I!==x||Do.current||ru?(typeof w=="function"&&(qO(i,o,w,c),x=i.memoizedState),(v=ru||j7(i,o,v,c,I,x,T))?(R||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(i.flags|=4194308)):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=x),_.props=c,_.state=x,_.context=T,c=v):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{_=i.stateNode,LK(n,i),v=i.memoizedProps,T=i.type===i.elementType?v:yc(i.type,v),_.props=T,R=i.pendingProps,I=_.context,x=o.contextType,typeof x=="object"&&x!==null?x=Ha(x):(x=Po(o)?sp:zs.current,x=Dm(i,x));var j=o.getDerivedStateFromProps;(w=typeof j=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(v!==R||I!==x)&&U7(i,_,c,x),ru=!1,I=i.memoizedState,_.state=I,cT(i,c,_,d);var P=i.memoizedState;v!==R||I!==P||Do.current||ru?(typeof j=="function"&&(qO(i,o,j,c),P=i.memoizedState),(T=ru||j7(i,o,T,c,I,P,x)||!1)?(w||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(c,P,x),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(c,P,x)),typeof _.componentDidUpdate=="function"&&(i.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof _.componentDidUpdate!="function"||v===n.memoizedProps&&I===n.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&I===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=P),_.props=c,_.state=P,_.context=x,c=T):(typeof _.componentDidUpdate!="function"||v===n.memoizedProps&&I===n.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&I===n.memoizedState||(i.flags|=1024),c=!1)}return JO(n,i,o,c,f,d)}function JO(n,i,o,c,d,f){aq(n,i);var _=(i.flags&128)!==0;if(!c&&!_)return d&&N7(i,o,!1),od(n,i,f);c=i.stateNode,m0e.current=i;var v=_&&typeof o.getDerivedStateFromError!="function"?null:c.render();return i.flags|=1,n!==null&&_?(i.child=km(i,n.child,null,f),i.child=km(i,null,v,f)):ro(n,i,v,f),i.memoizedState=c.state,d&&N7(i,o,!0),i.child}function cq(n){var i=n.stateNode;i.pendingContext?A7(n,i.pendingContext,i.pendingContext!==i.context):i.context&&A7(n,i.context,!1),PP(n,i.containerInfo)}function z7(n,i,o,c,d){return Pm(),RP(d),i.flags|=256,ro(n,i,o,c),i.child}var QO={dehydrated:null,treeContext:null,retryLane:0};function ZO(n){return{baseLanes:n,cachePool:null,transitions:null}}function lq(n,i,o){var c=i.pendingProps,d=ui.current,f=!1,_=(i.flags&128)!==0,v;if((v=_)||(v=n!==null&&n.memoizedState===null?!1:(d&2)!==0),v?(f=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(d|=1),jr(ui,d&1),n===null)return zO(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(i.mode&1?n.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(_=c.children,n=c.fallback,f?(c=i.mode,f=i.child,_={mode:"hidden",children:_},!(c&1)&&f!==null?(f.childLanes=0,f.pendingProps=_):f=ab(_,c,0,null),n=tp(n,c,o,null),f.return=i,n.return=i,f.sibling=n,i.child=f,i.child.memoizedState=ZO(o),i.memoizedState=QO,n):BP(i,_));if(d=n.memoizedState,d!==null&&(v=d.dehydrated,v!==null))return g0e(n,i,_,c,v,d,o);if(f){f=c.fallback,_=i.mode,d=n.child,v=d.sibling;var x={mode:"hidden",children:c.children};return!(_&1)&&i.child!==d?(c=i.child,c.childLanes=0,c.pendingProps=x,i.deletions=null):(c=Eu(d,x),c.subtreeFlags=d.subtreeFlags&14680064),v!==null?f=Eu(v,f):(f=tp(f,_,o,null),f.flags|=2),f.return=i,c.return=i,c.sibling=f,i.child=c,c=f,f=i.child,_=n.child.memoizedState,_=_===null?ZO(o):{baseLanes:_.baseLanes|o,cachePool:null,transitions:_.transitions},f.memoizedState=_,f.childLanes=n.childLanes&~o,i.memoizedState=QO,c}return f=n.child,n=f.sibling,c=Eu(f,{mode:"visible",children:c.children}),!(i.mode&1)&&(c.lanes=o),c.return=i,c.sibling=null,n!==null&&(o=i.deletions,o===null?(i.deletions=[n],i.flags|=16):o.push(n)),i.child=c,i.memoizedState=null,c}function BP(n,i){return i=ab({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function ex(n,i,o,c){return c!==null&&RP(c),km(i,n.child,null,o),n=BP(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function g0e(n,i,o,c,d,f,_){if(o)return i.flags&256?(i.flags&=-257,c=WN(Error(pt(422))),ex(n,i,_,c)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(f=c.fallback,d=i.mode,c=ab({mode:"visible",children:c.children},d,0,null),f=tp(f,d,_,null),f.flags|=2,c.return=i,f.return=i,c.sibling=f,i.child=c,i.mode&1&&km(i,n.child,null,_),i.child.memoizedState=ZO(_),i.memoizedState=QO,f);if(!(i.mode&1))return ex(n,i,_,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var v=c.dgst;return c=v,f=Error(pt(419)),c=WN(f,c,void 0),ex(n,i,_,c)}if(v=(_&n.childLanes)!==0,Io||v){if(c=ps,c!==null){switch(_&-_){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(c.suspendedLanes|_)?0:d,d!==0&&d!==f.retryLane&&(f.retryLane=d,sd(n,d),Rc(c,n,d,-1))}return qP(),c=WN(Error(pt(421))),ex(n,i,_,c)}return d.data==="$?"?(i.flags|=128,i.child=n.child,i=N0e.bind(null,n),d._reactRetry=i,null):(n=f.treeContext,na=fu(d.nextSibling),ra=i,ti=!0,xc=null,n!==null&&(Fa[Va++]=Xl,Fa[Va++]=Jl,Fa[Va++]=op,Xl=n.id,Jl=n.overflow,op=i),i=BP(i,c.children),i.flags|=4096,i)}function K7(n,i,o){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),KO(n.return,i,o)}function HN(n,i,o,c,d){var f=n.memoizedState;f===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:d}:(f.isBackwards=i,f.rendering=null,f.renderingStartTime=0,f.last=c,f.tail=o,f.tailMode=d)}function dq(n,i,o){var c=i.pendingProps,d=c.revealOrder,f=c.tail;if(ro(n,i,c.children,o),c=ui.current,c&2)c=c&1|2,i.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&K7(n,o,i);else if(n.tag===19)K7(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(jr(ui,c),!(i.mode&1))i.memoizedState=null;else switch(d){case"forwards":for(o=i.child,d=null;o!==null;)n=o.alternate,n!==null&&lT(n)===null&&(d=o),o=o.sibling;o=d,o===null?(d=i.child,i.child=null):(d=o.sibling,o.sibling=null),HN(i,!1,d,o,f);break;case"backwards":for(o=null,d=i.child,i.child=null;d!==null;){if(n=d.alternate,n!==null&&lT(n)===null){i.child=d;break}n=d.sibling,d.sibling=o,o=d,d=n}HN(i,!0,o,null,f);break;case"together":HN(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Ax(n,i){!(i.mode&1)&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function od(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),cp|=i.lanes,!(o&i.childLanes))return null;if(n!==null&&i.child!==n.child)throw Error(pt(153));if(i.child!==null){for(n=i.child,o=Eu(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=Eu(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function _0e(n,i,o){switch(i.tag){case 3:cq(i),Pm();break;case 5:MK(i);break;case 1:Po(i.type)&&rT(i);break;case 4:PP(i,i.stateNode.containerInfo);break;case 10:var c=i.type._context,d=i.memoizedProps.value;jr(oT,c._currentValue),c._currentValue=d;break;case 13:if(c=i.memoizedState,c!==null)return c.dehydrated!==null?(jr(ui,ui.current&1),i.flags|=128,null):o&i.child.childLanes?lq(n,i,o):(jr(ui,ui.current&1),n=od(n,i,o),n!==null?n.sibling:null);jr(ui,ui.current&1);break;case 19:if(c=(o&i.childLanes)!==0,n.flags&128){if(c)return dq(n,i,o);i.flags|=128}if(d=i.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),jr(ui,ui.current),c)break;return null;case 22:case 23:return i.lanes=0,oq(n,i,o)}return od(n,i,o)}var uq,eD,hq,pq;uq=function(n,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)n.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};eD=function(){};hq=function(n,i,o,c){var d=n.memoizedProps;if(d!==c){n=i.stateNode,qh(vl.current);var f=null;switch(o){case"input":d=xO(n,d),c=xO(n,c),f=[];break;case"select":d=mi({},d,{value:void 0}),c=mi({},c,{value:void 0}),f=[];break;case"textarea":d=wO(n,d),c=wO(n,c),f=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=tT)}RO(o,c);var _;o=null;for(T in d)if(!c.hasOwnProperty(T)&&d.hasOwnProperty(T)&&d[T]!=null)if(T==="style"){var v=d[T];for(_ in v)v.hasOwnProperty(_)&&(o||(o={}),o[_]="")}else T!=="dangerouslySetInnerHTML"&&T!=="children"&&T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(V_.hasOwnProperty(T)?f||(f=[]):(f=f||[]).push(T,null));for(T in c){var x=c[T];if(v=d!=null?d[T]:void 0,c.hasOwnProperty(T)&&x!==v&&(x!=null||v!=null))if(T==="style")if(v){for(_ in v)!v.hasOwnProperty(_)||x&&x.hasOwnProperty(_)||(o||(o={}),o[_]="");for(_ in x)x.hasOwnProperty(_)&&v[_]!==x[_]&&(o||(o={}),o[_]=x[_])}else o||(f||(f=[]),f.push(T,o)),o=x;else T==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,v=v?v.__html:void 0,x!=null&&v!==x&&(f=f||[]).push(T,x)):T==="children"?typeof x!="string"&&typeof x!="number"||(f=f||[]).push(T,""+x):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&(V_.hasOwnProperty(T)?(x!=null&&T==="onScroll"&&Wr("scroll",n),f||v===x||(f=[])):(f=f||[]).push(T,x))}o&&(f=f||[]).push("style",o);var T=f;(i.updateQueue=T)&&(i.flags|=4)}};pq=function(n,i,o,c){o!==c&&(i.flags|=4)};function r_(n,i){if(!ti)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Fs(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(i)for(var d=n.child;d!==null;)o|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=n,d=d.sibling;else for(d=n.child;d!==null;)o|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=n,d=d.sibling;return n.subtreeFlags|=c,n.childLanes=o,i}function E0e(n,i,o){var c=i.pendingProps;switch(CP(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fs(i),null;case 1:return Po(i.type)&&nT(),Fs(i),null;case 3:return c=i.stateNode,Lm(),zr(Do),zr(zs),LP(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(QS(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,xc!==null&&(cD(xc),xc=null))),eD(n,i),Fs(i),null;case 5:kP(i);var d=qh(Q_.current);if(o=i.type,n!==null&&i.stateNode!=null)hq(n,i,o,c,d),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!c){if(i.stateNode===null)throw Error(pt(166));return Fs(i),null}if(n=qh(vl.current),QS(i)){c=i.stateNode,o=i.type;var f=i.memoizedProps;switch(c[ml]=i,c[X_]=f,n=(i.mode&1)!==0,o){case"dialog":Wr("cancel",c),Wr("close",c);break;case"iframe":case"object":case"embed":Wr("load",c);break;case"video":case"audio":for(d=0;d<g_.length;d++)Wr(g_[d],c);break;case"source":Wr("error",c);break;case"img":case"image":case"link":Wr("error",c),Wr("load",c);break;case"details":Wr("toggle",c);break;case"input":t7(c,f),Wr("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!f.multiple},Wr("invalid",c);break;case"textarea":r7(c,f),Wr("invalid",c)}RO(o,f),d=null;for(var _ in f)if(f.hasOwnProperty(_)){var v=f[_];_==="children"?typeof v=="string"?c.textContent!==v&&(f.suppressHydrationWarning!==!0&&JS(c.textContent,v,n),d=["children",v]):typeof v=="number"&&c.textContent!==""+v&&(f.suppressHydrationWarning!==!0&&JS(c.textContent,v,n),d=["children",""+v]):V_.hasOwnProperty(_)&&v!=null&&_==="onScroll"&&Wr("scroll",c)}switch(o){case"input":HS(c),n7(c,f,!0);break;case"textarea":HS(c),i7(c);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(c.onclick=tT)}c=d,i.updateQueue=c,c!==null&&(i.flags|=4)}else{_=d.nodeType===9?d:d.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Bz(o)),n==="http://www.w3.org/1999/xhtml"?o==="script"?(n=_.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=_.createElement(o,{is:c.is}):(n=_.createElement(o),o==="select"&&(_=n,c.multiple?_.multiple=!0:c.size&&(_.size=c.size))):n=_.createElementNS(n,o),n[ml]=i,n[X_]=c,uq(n,i,!1,!1),i.stateNode=n;e:{switch(_=AO(o,c),o){case"dialog":Wr("cancel",n),Wr("close",n),d=c;break;case"iframe":case"object":case"embed":Wr("load",n),d=c;break;case"video":case"audio":for(d=0;d<g_.length;d++)Wr(g_[d],n);d=c;break;case"source":Wr("error",n),d=c;break;case"img":case"image":case"link":Wr("error",n),Wr("load",n),d=c;break;case"details":Wr("toggle",n),d=c;break;case"input":t7(n,c),d=xO(n,c),Wr("invalid",n);break;case"option":d=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},d=mi({},c,{value:void 0}),Wr("invalid",n);break;case"textarea":r7(n,c),d=wO(n,c),Wr("invalid",n);break;default:d=c}RO(o,d),v=d;for(f in v)if(v.hasOwnProperty(f)){var x=v[f];f==="style"?Gz(n,x):f==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&Wz(n,x)):f==="children"?typeof x=="string"?(o!=="textarea"||x!=="")&&B_(n,x):typeof x=="number"&&B_(n,""+x):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(V_.hasOwnProperty(f)?x!=null&&f==="onScroll"&&Wr("scroll",n):x!=null&&uP(n,f,x,_))}switch(o){case"input":HS(n),n7(n,c,!1);break;case"textarea":HS(n),i7(n);break;case"option":c.value!=null&&n.setAttribute("value",""+xu(c.value));break;case"select":n.multiple=!!c.multiple,f=c.value,f!=null?bm(n,!!c.multiple,f,!1):c.defaultValue!=null&&bm(n,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(n.onclick=tT)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Fs(i),null;case 6:if(n&&i.stateNode!=null)pq(n,i,n.memoizedProps,c);else{if(typeof c!="string"&&i.stateNode===null)throw Error(pt(166));if(o=qh(Q_.current),qh(vl.current),QS(i)){if(c=i.stateNode,o=i.memoizedProps,c[ml]=i,(f=c.nodeValue!==o)&&(n=ra,n!==null))switch(n.tag){case 3:JS(c.nodeValue,o,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&JS(c.nodeValue,o,(n.mode&1)!==0)}f&&(i.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[ml]=i,i.stateNode=c}return Fs(i),null;case 13:if(zr(ui),c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ti&&na!==null&&i.mode&1&&!(i.flags&128))OK(),Pm(),i.flags|=98560,f=!1;else if(f=QS(i),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(pt(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(pt(317));f[ml]=i}else Pm(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;Fs(i),f=!1}else xc!==null&&(cD(xc),xc=null),f=!0;if(!f)return i.flags&65536?i:null}return i.flags&128?(i.lanes=o,i):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(i.child.flags|=8192,i.mode&1&&(n===null||ui.current&1?Ji===0&&(Ji=3):qP())),i.updateQueue!==null&&(i.flags|=4),Fs(i),null);case 4:return Lm(),eD(n,i),n===null&&Y_(i.stateNode.containerInfo),Fs(i),null;case 10:return IP(i.type._context),Fs(i),null;case 17:return Po(i.type)&&nT(),Fs(i),null;case 19:if(zr(ui),f=i.memoizedState,f===null)return Fs(i),null;if(c=(i.flags&128)!==0,_=f.rendering,_===null)if(c)r_(f,!1);else{if(Ji!==0||n!==null&&n.flags&128)for(n=i.child;n!==null;){if(_=lT(n),_!==null){for(i.flags|=128,r_(f,!1),c=_.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),i.subtreeFlags=0,c=o,o=i.child;o!==null;)f=o,n=c,f.flags&=14680066,_=f.alternate,_===null?(f.childLanes=0,f.lanes=n,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=_.childLanes,f.lanes=_.lanes,f.child=_.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=_.memoizedProps,f.memoizedState=_.memoizedState,f.updateQueue=_.updateQueue,f.type=_.type,n=_.dependencies,f.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),o=o.sibling;return jr(ui,ui.current&1|2),i.child}n=n.sibling}f.tail!==null&&Di()>jm&&(i.flags|=128,c=!0,r_(f,!1),i.lanes=4194304)}else{if(!c)if(n=lT(_),n!==null){if(i.flags|=128,c=!0,o=n.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),r_(f,!0),f.tail===null&&f.tailMode==="hidden"&&!_.alternate&&!ti)return Fs(i),null}else 2*Di()-f.renderingStartTime>jm&&o!==1073741824&&(i.flags|=128,c=!0,r_(f,!1),i.lanes=4194304);f.isBackwards?(_.sibling=i.child,i.child=_):(o=f.last,o!==null?o.sibling=_:i.child=_,f.last=_)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Di(),i.sibling=null,o=ui.current,jr(ui,c?o&1|2:o&1),i):(Fs(i),null);case 22:case 23:return KP(),c=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(i.flags|=8192),c&&i.mode&1?ta&1073741824&&(Fs(i),i.subtreeFlags&6&&(i.flags|=8192)):Fs(i),null;case 24:return null;case 25:return null}throw Error(pt(156,i.tag))}function v0e(n,i){switch(CP(i),i.tag){case 1:return Po(i.type)&&nT(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Lm(),zr(Do),zr(zs),LP(),n=i.flags,n&65536&&!(n&128)?(i.flags=n&-65537|128,i):null;case 5:return kP(i),null;case 13:if(zr(ui),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(pt(340));Pm()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return zr(ui),null;case 4:return Lm(),null;case 10:return IP(i.type._context),null;case 22:case 23:return KP(),null;case 24:return null;default:return null}}var tx=!1,Hs=!1,y0e=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function _m(n,i){var o=n.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){bi(n,i,c)}else o.current=null}function tD(n,i,o){try{o()}catch(c){bi(n,i,c)}}var q7=!1;function S0e(n,i){if(UO=Qx,n=EK(),bP(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var d=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var _=0,v=-1,x=-1,T=0,w=0,R=n,I=null;t:for(;;){for(var j;R!==o||d!==0&&R.nodeType!==3||(v=_+d),R!==f||c!==0&&R.nodeType!==3||(x=_+c),R.nodeType===3&&(_+=R.nodeValue.length),(j=R.firstChild)!==null;)I=R,R=j;for(;;){if(R===n)break t;if(I===o&&++T===d&&(v=_),I===f&&++w===c&&(x=_),(j=R.nextSibling)!==null)break;R=I,I=R.parentNode}R=j}o=v===-1||x===-1?null:{start:v,end:x}}else o=null}o=o||{start:0,end:0}}else o=null;for(FO={focusedElem:n,selectionRange:o},Qx=!1,Mt=i;Mt!==null;)if(i=Mt,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Mt=n;else for(;Mt!==null;){i=Mt;try{var P=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var k=P.memoizedProps,W=P.memoizedState,H=i.stateNode,L=H.getSnapshotBeforeUpdate(i.elementType===i.type?k:yc(i.type,k),W);H.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var V=i.stateNode.containerInfo;V.nodeType===1?V.textContent="":V.nodeType===9&&V.documentElement&&V.removeChild(V.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pt(163))}}catch(K){bi(i,i.return,K)}if(n=i.sibling,n!==null){n.return=i.return,Mt=n;break}Mt=i.return}return P=q7,q7=!1,P}function R_(n,i,o){var c=i.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&n)===n){var f=d.destroy;d.destroy=void 0,f!==void 0&&tD(i,o,f)}d=d.next}while(d!==c)}}function sb(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&n)===n){var c=o.create;o.destroy=c()}o=o.next}while(o!==i)}}function nD(n){var i=n.ref;if(i!==null){var o=n.stateNode;switch(n.tag){case 5:n=o;break;default:n=o}typeof i=="function"?i(n):i.current=n}}function fq(n){var i=n.alternate;i!==null&&(n.alternate=null,fq(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[ml],delete i[X_],delete i[WO],delete i[r0e],delete i[i0e])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function mq(n){return n.tag===5||n.tag===3||n.tag===4}function Y7(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||mq(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function rD(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(n,i):o.insertBefore(n,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(n,o)):(i=o,i.appendChild(n)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=tT));else if(c!==4&&(n=n.child,n!==null))for(rD(n,i,o),n=n.sibling;n!==null;)rD(n,i,o),n=n.sibling}function iD(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(iD(n,i,o),n=n.sibling;n!==null;)iD(n,i,o),n=n.sibling}var bs=null,Sc=!1;function Xd(n,i,o){for(o=o.child;o!==null;)gq(n,i,o),o=o.sibling}function gq(n,i,o){if(El&&typeof El.onCommitFiberUnmount=="function")try{El.onCommitFiberUnmount(JT,o)}catch{}switch(o.tag){case 5:Hs||_m(o,i);case 6:var c=bs,d=Sc;bs=null,Xd(n,i,o),bs=c,Sc=d,bs!==null&&(Sc?(n=bs,o=o.stateNode,n.nodeType===8?n.parentNode.removeChild(o):n.removeChild(o)):bs.removeChild(o.stateNode));break;case 18:bs!==null&&(Sc?(n=bs,o=o.stateNode,n.nodeType===8?MN(n.parentNode,o):n.nodeType===1&&MN(n,o),z_(n)):MN(bs,o.stateNode));break;case 4:c=bs,d=Sc,bs=o.stateNode.containerInfo,Sc=!0,Xd(n,i,o),bs=c,Sc=d;break;case 0:case 11:case 14:case 15:if(!Hs&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var f=d,_=f.destroy;f=f.tag,_!==void 0&&(f&2||f&4)&&tD(o,i,_),d=d.next}while(d!==c)}Xd(n,i,o);break;case 1:if(!Hs&&(_m(o,i),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(v){bi(o,i,v)}Xd(n,i,o);break;case 21:Xd(n,i,o);break;case 22:o.mode&1?(Hs=(c=Hs)||o.memoizedState!==null,Xd(n,i,o),Hs=c):Xd(n,i,o);break;default:Xd(n,i,o)}}function $7(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var o=n.stateNode;o===null&&(o=n.stateNode=new y0e),i.forEach(function(c){var d=I0e.bind(null,n,c);o.has(c)||(o.add(c),c.then(d,d))})}}function _c(n,i){var o=i.deletions;if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];try{var f=n,_=i,v=_;e:for(;v!==null;){switch(v.tag){case 5:bs=v.stateNode,Sc=!1;break e;case 3:bs=v.stateNode.containerInfo,Sc=!0;break e;case 4:bs=v.stateNode.containerInfo,Sc=!0;break e}v=v.return}if(bs===null)throw Error(pt(160));gq(f,_,d),bs=null,Sc=!1;var x=d.alternate;x!==null&&(x.return=null),d.return=null}catch(T){bi(d,i,T)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)_q(i,n),i=i.sibling}function _q(n,i){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(_c(i,n),dl(n),c&4){try{R_(3,n,n.return),sb(3,n)}catch(k){bi(n,n.return,k)}try{R_(5,n,n.return)}catch(k){bi(n,n.return,k)}}break;case 1:_c(i,n),dl(n),c&512&&o!==null&&_m(o,o.return);break;case 5:if(_c(i,n),dl(n),c&512&&o!==null&&_m(o,o.return),n.flags&32){var d=n.stateNode;try{B_(d,"")}catch(k){bi(n,n.return,k)}}if(c&4&&(d=n.stateNode,d!=null)){var f=n.memoizedProps,_=o!==null?o.memoizedProps:f,v=n.type,x=n.updateQueue;if(n.updateQueue=null,x!==null)try{v==="input"&&f.type==="radio"&&f.name!=null&&Fz(d,f),AO(v,_);var T=AO(v,f);for(_=0;_<x.length;_+=2){var w=x[_],R=x[_+1];w==="style"?Gz(d,R):w==="dangerouslySetInnerHTML"?Wz(d,R):w==="children"?B_(d,R):uP(d,w,R,T)}switch(v){case"input":TO(d,f);break;case"textarea":Vz(d,f);break;case"select":var I=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!f.multiple;var j=f.value;j!=null?bm(d,!!f.multiple,j,!1):I!==!!f.multiple&&(f.defaultValue!=null?bm(d,!!f.multiple,f.defaultValue,!0):bm(d,!!f.multiple,f.multiple?[]:"",!1))}d[X_]=f}catch(k){bi(n,n.return,k)}}break;case 6:if(_c(i,n),dl(n),c&4){if(n.stateNode===null)throw Error(pt(162));d=n.stateNode,f=n.memoizedProps;try{d.nodeValue=f}catch(k){bi(n,n.return,k)}}break;case 3:if(_c(i,n),dl(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{z_(i.containerInfo)}catch(k){bi(n,n.return,k)}break;case 4:_c(i,n),dl(n);break;case 13:_c(i,n),dl(n),d=n.child,d.flags&8192&&(f=d.memoizedState!==null,d.stateNode.isHidden=f,!f||d.alternate!==null&&d.alternate.memoizedState!==null||(GP=Di())),c&4&&$7(n);break;case 22:if(w=o!==null&&o.memoizedState!==null,n.mode&1?(Hs=(T=Hs)||w,_c(i,n),Hs=T):_c(i,n),dl(n),c&8192){if(T=n.memoizedState!==null,(n.stateNode.isHidden=T)&&!w&&n.mode&1)for(Mt=n,w=n.child;w!==null;){for(R=Mt=w;Mt!==null;){switch(I=Mt,j=I.child,I.tag){case 0:case 11:case 14:case 15:R_(4,I,I.return);break;case 1:_m(I,I.return);var P=I.stateNode;if(typeof P.componentWillUnmount=="function"){c=I,o=I.return;try{i=c,P.props=i.memoizedProps,P.state=i.memoizedState,P.componentWillUnmount()}catch(k){bi(c,o,k)}}break;case 5:_m(I,I.return);break;case 22:if(I.memoizedState!==null){J7(R);continue}}j!==null?(j.return=I,Mt=j):J7(R)}w=w.sibling}e:for(w=null,R=n;;){if(R.tag===5){if(w===null){w=R;try{d=R.stateNode,T?(f=d.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(v=R.stateNode,x=R.memoizedProps.style,_=x!=null&&x.hasOwnProperty("display")?x.display:null,v.style.display=Hz("display",_))}catch(k){bi(n,n.return,k)}}}else if(R.tag===6){if(w===null)try{R.stateNode.nodeValue=T?"":R.memoizedProps}catch(k){bi(n,n.return,k)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===n)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===n)break e;for(;R.sibling===null;){if(R.return===null||R.return===n)break e;w===R&&(w=null),R=R.return}w===R&&(w=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:_c(i,n),dl(n),c&4&&$7(n);break;case 21:break;default:_c(i,n),dl(n)}}function dl(n){var i=n.flags;if(i&2){try{e:{for(var o=n.return;o!==null;){if(mq(o)){var c=o;break e}o=o.return}throw Error(pt(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(B_(d,""),c.flags&=-33);var f=Y7(n);iD(n,f,d);break;case 3:case 4:var _=c.stateNode.containerInfo,v=Y7(n);rD(n,v,_);break;default:throw Error(pt(161))}}catch(x){bi(n,n.return,x)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function x0e(n,i,o){Mt=n,Eq(n)}function Eq(n,i,o){for(var c=(n.mode&1)!==0;Mt!==null;){var d=Mt,f=d.child;if(d.tag===22&&c){var _=d.memoizedState!==null||tx;if(!_){var v=d.alternate,x=v!==null&&v.memoizedState!==null||Hs;v=tx;var T=Hs;if(tx=_,(Hs=x)&&!T)for(Mt=d;Mt!==null;)_=Mt,x=_.child,_.tag===22&&_.memoizedState!==null?Q7(d):x!==null?(x.return=_,Mt=x):Q7(d);for(;f!==null;)Mt=f,Eq(f),f=f.sibling;Mt=d,tx=v,Hs=T}X7(n)}else d.subtreeFlags&8772&&f!==null?(f.return=d,Mt=f):X7(n)}}function X7(n){for(;Mt!==null;){var i=Mt;if(i.flags&8772){var o=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:Hs||sb(5,i);break;case 1:var c=i.stateNode;if(i.flags&4&&!Hs)if(o===null)c.componentDidMount();else{var d=i.elementType===i.type?o.memoizedProps:yc(i.type,o.memoizedProps);c.componentDidUpdate(d,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var f=i.updateQueue;f!==null&&k7(i,f,c);break;case 3:var _=i.updateQueue;if(_!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}k7(i,_,o)}break;case 5:var v=i.stateNode;if(o===null&&i.flags&4){o=v;var x=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&o.focus();break;case"img":x.src&&(o.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var T=i.alternate;if(T!==null){var w=T.memoizedState;if(w!==null){var R=w.dehydrated;R!==null&&z_(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pt(163))}Hs||i.flags&512&&nD(i)}catch(I){bi(i,i.return,I)}}if(i===n){Mt=null;break}if(o=i.sibling,o!==null){o.return=i.return,Mt=o;break}Mt=i.return}}function J7(n){for(;Mt!==null;){var i=Mt;if(i===n){Mt=null;break}var o=i.sibling;if(o!==null){o.return=i.return,Mt=o;break}Mt=i.return}}function Q7(n){for(;Mt!==null;){var i=Mt;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{sb(4,i)}catch(x){bi(i,o,x)}break;case 1:var c=i.stateNode;if(typeof c.componentDidMount=="function"){var d=i.return;try{c.componentDidMount()}catch(x){bi(i,d,x)}}var f=i.return;try{nD(i)}catch(x){bi(i,f,x)}break;case 5:var _=i.return;try{nD(i)}catch(x){bi(i,_,x)}}}catch(x){bi(i,i.return,x)}if(i===n){Mt=null;break}var v=i.sibling;if(v!==null){v.return=i.return,Mt=v;break}Mt=i.return}}var T0e=Math.ceil,hT=ud.ReactCurrentDispatcher,WP=ud.ReactCurrentOwner,Wa=ud.ReactCurrentBatchConfig,ar=0,ps=null,Fi=null,ws=0,ta=0,Em=Au(0),Ji=0,nE=null,cp=0,ob=0,HP=0,A_=null,Ao=null,GP=0,jm=1/0,ql=null,pT=!1,sD=null,gu=null,nx=!1,lu=null,fT=0,N_=0,oD=null,Nx=-1,Ix=0;function so(){return ar&6?Di():Nx!==-1?Nx:Nx=Di()}function _u(n){return n.mode&1?ar&2&&ws!==0?ws&-ws:o0e.transition!==null?(Ix===0&&(Ix=nK()),Ix):(n=Cr,n!==0||(n=window.event,n=n===void 0?16:lK(n.type)),n):1}function Rc(n,i,o,c){if(50<N_)throw N_=0,oD=null,Error(pt(185));mE(n,o,c),(!(ar&2)||n!==ps)&&(n===ps&&(!(ar&2)&&(ob|=o),Ji===4&&ou(n,ws)),ko(n,c),o===1&&ar===0&&!(i.mode&1)&&(jm=Di()+500,nb&&Nu()))}function ko(n,i){var o=n.callbackNode;ome(n,i);var c=Jx(n,n===ps?ws:0);if(c===0)o!==null&&a7(o),n.callbackNode=null,n.callbackPriority=0;else if(i=c&-c,n.callbackPriority!==i){if(o!=null&&a7(o),i===1)n.tag===0?s0e(Z7.bind(null,n)):AK(Z7.bind(null,n)),t0e(function(){!(ar&6)&&Nu()}),o=null;else{switch(rK(c)){case 1:o=gP;break;case 4:o=eK;break;case 16:o=Xx;break;case 536870912:o=tK;break;default:o=Xx}o=Cq(o,vq.bind(null,n))}n.callbackPriority=i,n.callbackNode=o}}function vq(n,i){if(Nx=-1,Ix=0,ar&6)throw Error(pt(327));var o=n.callbackNode;if(Nm()&&n.callbackNode!==o)return null;var c=Jx(n,n===ps?ws:0);if(c===0)return null;if(c&30||c&n.expiredLanes||i)i=mT(n,c);else{i=c;var d=ar;ar|=2;var f=Sq();(ps!==n||ws!==i)&&(ql=null,jm=Di()+500,ep(n,i));do try{C0e();break}catch(v){yq(n,v)}while(1);NP(),hT.current=f,ar=d,Fi!==null?i=0:(ps=null,ws=0,i=Ji)}if(i!==0){if(i===2&&(d=PO(n),d!==0&&(c=d,i=aD(n,d))),i===1)throw o=nE,ep(n,0),ou(n,c),ko(n,Di()),o;if(i===6)ou(n,c);else{if(d=n.current.alternate,!(c&30)&&!b0e(d)&&(i=mT(n,c),i===2&&(f=PO(n),f!==0&&(c=f,i=aD(n,f))),i===1))throw o=nE,ep(n,0),ou(n,c),ko(n,Di()),o;switch(n.finishedWork=d,n.finishedLanes=c,i){case 0:case 1:throw Error(pt(345));case 2:Vh(n,Ao,ql);break;case 3:if(ou(n,c),(c&130023424)===c&&(i=GP+500-Di(),10<i)){if(Jx(n,0)!==0)break;if(d=n.suspendedLanes,(d&c)!==c){so(),n.pingedLanes|=n.suspendedLanes&d;break}n.timeoutHandle=BO(Vh.bind(null,n,Ao,ql),i);break}Vh(n,Ao,ql);break;case 4:if(ou(n,c),(c&4194240)===c)break;for(i=n.eventTimes,d=-1;0<c;){var _=31-Cc(c);f=1<<_,_=i[_],_>d&&(d=_),c&=~f}if(c=d,c=Di()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*T0e(c/1960))-c,10<c){n.timeoutHandle=BO(Vh.bind(null,n,Ao,ql),c);break}Vh(n,Ao,ql);break;case 5:Vh(n,Ao,ql);break;default:throw Error(pt(329))}}}return ko(n,Di()),n.callbackNode===o?vq.bind(null,n):null}function aD(n,i){var o=A_;return n.current.memoizedState.isDehydrated&&(ep(n,i).flags|=256),n=mT(n,i),n!==2&&(i=Ao,Ao=o,i!==null&&cD(i)),n}function cD(n){Ao===null?Ao=n:Ao.push.apply(Ao,n)}function b0e(n){for(var i=n;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var d=o[c],f=d.getSnapshot;d=d.value;try{if(!Ic(f(),d))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ou(n,i){for(i&=~HP,i&=~ob,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var o=31-Cc(i),c=1<<o;n[o]=-1,i&=~c}}function Z7(n){if(ar&6)throw Error(pt(327));Nm();var i=Jx(n,0);if(!(i&1))return ko(n,Di()),null;var o=mT(n,i);if(n.tag!==0&&o===2){var c=PO(n);c!==0&&(i=c,o=aD(n,c))}if(o===1)throw o=nE,ep(n,0),ou(n,i),ko(n,Di()),o;if(o===6)throw Error(pt(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,Vh(n,Ao,ql),ko(n,Di()),null}function zP(n,i){var o=ar;ar|=1;try{return n(i)}finally{ar=o,ar===0&&(jm=Di()+500,nb&&Nu())}}function lp(n){lu!==null&&lu.tag===0&&!(ar&6)&&Nm();var i=ar;ar|=1;var o=Wa.transition,c=Cr;try{if(Wa.transition=null,Cr=1,n)return n()}finally{Cr=c,Wa.transition=o,ar=i,!(ar&6)&&Nu()}}function KP(){ta=Em.current,zr(Em)}function ep(n,i){n.finishedWork=null,n.finishedLanes=0;var o=n.timeoutHandle;if(o!==-1&&(n.timeoutHandle=-1,e0e(o)),Fi!==null)for(o=Fi.return;o!==null;){var c=o;switch(CP(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&nT();break;case 3:Lm(),zr(Do),zr(zs),LP();break;case 5:kP(c);break;case 4:Lm();break;case 13:zr(ui);break;case 19:zr(ui);break;case 10:IP(c.type._context);break;case 22:case 23:KP()}o=o.return}if(ps=n,Fi=n=Eu(n.current,null),ws=ta=i,Ji=0,nE=null,HP=ob=cp=0,Ao=A_=null,Kh!==null){for(i=0;i<Kh.length;i++)if(o=Kh[i],c=o.interleaved,c!==null){o.interleaved=null;var d=c.next,f=o.pending;if(f!==null){var _=f.next;f.next=d,c.next=_}o.pending=c}Kh=null}return n}function yq(n,i){do{var o=Fi;try{if(NP(),Cx.current=uT,dT){for(var c=pi.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}dT=!1}if(ap=0,us=Xi=pi=null,C_=!1,Z_=0,WP.current=null,o===null||o.return===null){Ji=1,nE=i,Fi=null;break}e:{var f=n,_=o.return,v=o,x=i;if(i=ws,v.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var T=x,w=v,R=w.tag;if(!(w.mode&1)&&(R===0||R===11||R===15)){var I=w.alternate;I?(w.updateQueue=I.updateQueue,w.memoizedState=I.memoizedState,w.lanes=I.lanes):(w.updateQueue=null,w.memoizedState=null)}var j=V7(_);if(j!==null){j.flags&=-257,B7(j,_,v,f,i),j.mode&1&&F7(f,T,i),i=j,x=T;var P=i.updateQueue;if(P===null){var k=new Set;k.add(x),i.updateQueue=k}else P.add(x);break e}else{if(!(i&1)){F7(f,T,i),qP();break e}x=Error(pt(426))}}else if(ti&&v.mode&1){var W=V7(_);if(W!==null){!(W.flags&65536)&&(W.flags|=256),B7(W,_,v,f,i),RP(Mm(x,v));break e}}f=x=Mm(x,v),Ji!==4&&(Ji=2),A_===null?A_=[f]:A_.push(f),f=_;do{switch(f.tag){case 3:f.flags|=65536,i&=-i,f.lanes|=i;var H=rq(f,x,i);P7(f,H);break e;case 1:v=x;var L=f.type,V=f.stateNode;if(!(f.flags&128)&&(typeof L.getDerivedStateFromError=="function"||V!==null&&typeof V.componentDidCatch=="function"&&(gu===null||!gu.has(V)))){f.flags|=65536,i&=-i,f.lanes|=i;var K=iq(f,v,i);P7(f,K);break e}}f=f.return}while(f!==null)}Tq(o)}catch(te){i=te,Fi===o&&o!==null&&(Fi=o=o.return);continue}break}while(1)}function Sq(){var n=hT.current;return hT.current=uT,n===null?uT:n}function qP(){(Ji===0||Ji===3||Ji===2)&&(Ji=4),ps===null||!(cp&268435455)&&!(ob&268435455)||ou(ps,ws)}function mT(n,i){var o=ar;ar|=2;var c=Sq();(ps!==n||ws!==i)&&(ql=null,ep(n,i));do try{w0e();break}catch(d){yq(n,d)}while(1);if(NP(),ar=o,hT.current=c,Fi!==null)throw Error(pt(261));return ps=null,ws=0,Ji}function w0e(){for(;Fi!==null;)xq(Fi)}function C0e(){for(;Fi!==null&&!Jfe();)xq(Fi)}function xq(n){var i=wq(n.alternate,n,ta);n.memoizedProps=n.pendingProps,i===null?Tq(n):Fi=i,WP.current=null}function Tq(n){var i=n;do{var o=i.alternate;if(n=i.return,i.flags&32768){if(o=v0e(o,i),o!==null){o.flags&=32767,Fi=o;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ji=6,Fi=null;return}}else if(o=E0e(o,i,ta),o!==null){Fi=o;return}if(i=i.sibling,i!==null){Fi=i;return}Fi=i=n}while(i!==null);Ji===0&&(Ji=5)}function Vh(n,i,o){var c=Cr,d=Wa.transition;try{Wa.transition=null,Cr=1,R0e(n,i,o,c)}finally{Wa.transition=d,Cr=c}return null}function R0e(n,i,o,c){do Nm();while(lu!==null);if(ar&6)throw Error(pt(327));o=n.finishedWork;var d=n.finishedLanes;if(o===null)return null;if(n.finishedWork=null,n.finishedLanes=0,o===n.current)throw Error(pt(177));n.callbackNode=null,n.callbackPriority=0;var f=o.lanes|o.childLanes;if(ame(n,f),n===ps&&(Fi=ps=null,ws=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||nx||(nx=!0,Cq(Xx,function(){return Nm(),null})),f=(o.flags&15990)!==0,o.subtreeFlags&15990||f){f=Wa.transition,Wa.transition=null;var _=Cr;Cr=1;var v=ar;ar|=4,WP.current=null,S0e(n,o),_q(o,n),qme(FO),Qx=!!UO,FO=UO=null,n.current=o,x0e(o),Qfe(),ar=v,Cr=_,Wa.transition=f}else n.current=o;if(nx&&(nx=!1,lu=n,fT=d),f=n.pendingLanes,f===0&&(gu=null),tme(o.stateNode),ko(n,Di()),i!==null)for(c=n.onRecoverableError,o=0;o<i.length;o++)d=i[o],c(d.value,{componentStack:d.stack,digest:d.digest});if(pT)throw pT=!1,n=sD,sD=null,n;return fT&1&&n.tag!==0&&Nm(),f=n.pendingLanes,f&1?n===oD?N_++:(N_=0,oD=n):N_=0,Nu(),null}function Nm(){if(lu!==null){var n=rK(fT),i=Wa.transition,o=Cr;try{if(Wa.transition=null,Cr=16>n?16:n,lu===null)var c=!1;else{if(n=lu,lu=null,fT=0,ar&6)throw Error(pt(331));var d=ar;for(ar|=4,Mt=n.current;Mt!==null;){var f=Mt,_=f.child;if(Mt.flags&16){var v=f.deletions;if(v!==null){for(var x=0;x<v.length;x++){var T=v[x];for(Mt=T;Mt!==null;){var w=Mt;switch(w.tag){case 0:case 11:case 15:R_(8,w,f)}var R=w.child;if(R!==null)R.return=w,Mt=R;else for(;Mt!==null;){w=Mt;var I=w.sibling,j=w.return;if(fq(w),w===T){Mt=null;break}if(I!==null){I.return=j,Mt=I;break}Mt=j}}}var P=f.alternate;if(P!==null){var k=P.child;if(k!==null){P.child=null;do{var W=k.sibling;k.sibling=null,k=W}while(k!==null)}}Mt=f}}if(f.subtreeFlags&2064&&_!==null)_.return=f,Mt=_;else e:for(;Mt!==null;){if(f=Mt,f.flags&2048)switch(f.tag){case 0:case 11:case 15:R_(9,f,f.return)}var H=f.sibling;if(H!==null){H.return=f.return,Mt=H;break e}Mt=f.return}}var L=n.current;for(Mt=L;Mt!==null;){_=Mt;var V=_.child;if(_.subtreeFlags&2064&&V!==null)V.return=_,Mt=V;else e:for(_=L;Mt!==null;){if(v=Mt,v.flags&2048)try{switch(v.tag){case 0:case 11:case 15:sb(9,v)}}catch(te){bi(v,v.return,te)}if(v===_){Mt=null;break e}var K=v.sibling;if(K!==null){K.return=v.return,Mt=K;break e}Mt=v.return}}if(ar=d,Nu(),El&&typeof El.onPostCommitFiberRoot=="function")try{El.onPostCommitFiberRoot(JT,n)}catch{}c=!0}return c}finally{Cr=o,Wa.transition=i}}return!1}function eW(n,i,o){i=Mm(o,i),i=rq(n,i,1),n=mu(n,i,1),i=so(),n!==null&&(mE(n,1,i),ko(n,i))}function bi(n,i,o){if(n.tag===3)eW(n,n,o);else for(;i!==null;){if(i.tag===3){eW(i,n,o);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(gu===null||!gu.has(c))){n=Mm(o,n),n=iq(i,n,1),i=mu(i,n,1),n=so(),i!==null&&(mE(i,1,n),ko(i,n));break}}i=i.return}}function A0e(n,i,o){var c=n.pingCache;c!==null&&c.delete(i),i=so(),n.pingedLanes|=n.suspendedLanes&o,ps===n&&(ws&o)===o&&(Ji===4||Ji===3&&(ws&130023424)===ws&&500>Di()-GP?ep(n,0):HP|=o),ko(n,i)}function bq(n,i){i===0&&(n.mode&1?(i=KS,KS<<=1,!(KS&130023424)&&(KS=4194304)):i=1);var o=so();n=sd(n,i),n!==null&&(mE(n,i,o),ko(n,o))}function N0e(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),bq(n,o)}function I0e(n,i){var o=0;switch(n.tag){case 13:var c=n.stateNode,d=n.memoizedState;d!==null&&(o=d.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(pt(314))}c!==null&&c.delete(i),bq(n,o)}var wq;wq=function(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps||Do.current)Io=!0;else{if(!(n.lanes&o)&&!(i.flags&128))return Io=!1,_0e(n,i,o);Io=!!(n.flags&131072)}else Io=!1,ti&&i.flags&1048576&&NK(i,sT,i.index);switch(i.lanes=0,i.tag){case 2:var c=i.type;Ax(n,i),n=i.pendingProps;var d=Dm(i,zs.current);Am(i,o),d=jP(null,i,c,n,d,o);var f=UP();return i.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Po(c)?(f=!0,rT(i)):f=!1,i.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,DP(i),d.updater=ib,i.stateNode=d,d._reactInternals=i,YO(i,c,n,o),i=JO(null,i,c,!0,f,o)):(i.tag=0,ti&&f&&wP(i),ro(null,i,d,o),i=i.child),i;case 16:c=i.elementType;e:{switch(Ax(n,i),n=i.pendingProps,d=c._init,c=d(c._payload),i.type=c,d=i.tag=D0e(c),n=yc(c,n),d){case 0:i=XO(null,i,c,n,o);break e;case 1:i=G7(null,i,c,n,o);break e;case 11:i=W7(null,i,c,n,o);break e;case 14:i=H7(null,i,c,yc(c.type,n),o);break e}throw Error(pt(306,c,""))}return i;case 0:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:yc(c,d),XO(n,i,c,d,o);case 1:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:yc(c,d),G7(n,i,c,d,o);case 3:e:{if(cq(i),n===null)throw Error(pt(387));c=i.pendingProps,f=i.memoizedState,d=f.element,LK(n,i),cT(i,c,null,o);var _=i.memoizedState;if(c=_.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},i.updateQueue.baseState=f,i.memoizedState=f,i.flags&256){d=Mm(Error(pt(423)),i),i=z7(n,i,c,o,d);break e}else if(c!==d){d=Mm(Error(pt(424)),i),i=z7(n,i,c,o,d);break e}else for(na=fu(i.stateNode.containerInfo.firstChild),ra=i,ti=!0,xc=null,o=PK(i,null,c,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Pm(),c===d){i=od(n,i,o);break e}ro(n,i,c,o)}i=i.child}return i;case 5:return MK(i),n===null&&zO(i),c=i.type,d=i.pendingProps,f=n!==null?n.memoizedProps:null,_=d.children,VO(c,d)?_=null:f!==null&&VO(c,f)&&(i.flags|=32),aq(n,i),ro(n,i,_,o),i.child;case 6:return n===null&&zO(i),null;case 13:return lq(n,i,o);case 4:return PP(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=km(i,null,c,o):ro(n,i,c,o),i.child;case 11:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:yc(c,d),W7(n,i,c,d,o);case 7:return ro(n,i,i.pendingProps,o),i.child;case 8:return ro(n,i,i.pendingProps.children,o),i.child;case 12:return ro(n,i,i.pendingProps.children,o),i.child;case 10:e:{if(c=i.type._context,d=i.pendingProps,f=i.memoizedProps,_=d.value,jr(oT,c._currentValue),c._currentValue=_,f!==null)if(Ic(f.value,_)){if(f.children===d.children&&!Do.current){i=od(n,i,o);break e}}else for(f=i.child,f!==null&&(f.return=i);f!==null;){var v=f.dependencies;if(v!==null){_=f.child;for(var x=v.firstContext;x!==null;){if(x.context===c){if(f.tag===1){x=Zl(-1,o&-o),x.tag=2;var T=f.updateQueue;if(T!==null){T=T.shared;var w=T.pending;w===null?x.next=x:(x.next=w.next,w.next=x),T.pending=x}}f.lanes|=o,x=f.alternate,x!==null&&(x.lanes|=o),KO(f.return,o,i),v.lanes|=o;break}x=x.next}}else if(f.tag===10)_=f.type===i.type?null:f.child;else if(f.tag===18){if(_=f.return,_===null)throw Error(pt(341));_.lanes|=o,v=_.alternate,v!==null&&(v.lanes|=o),KO(_,o,i),_=f.sibling}else _=f.child;if(_!==null)_.return=f;else for(_=f;_!==null;){if(_===i){_=null;break}if(f=_.sibling,f!==null){f.return=_.return,_=f;break}_=_.return}f=_}ro(n,i,d.children,o),i=i.child}return i;case 9:return d=i.type,c=i.pendingProps.children,Am(i,o),d=Ha(d),c=c(d),i.flags|=1,ro(n,i,c,o),i.child;case 14:return c=i.type,d=yc(c,i.pendingProps),d=yc(c.type,d),H7(n,i,c,d,o);case 15:return sq(n,i,i.type,i.pendingProps,o);case 17:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:yc(c,d),Ax(n,i),i.tag=1,Po(c)?(n=!0,rT(i)):n=!1,Am(i,o),nq(i,c,d),YO(i,c,d,o),JO(null,i,c,!0,n,o);case 19:return dq(n,i,o);case 22:return oq(n,i,o)}throw Error(pt(156,i.tag))};function Cq(n,i){return Zz(n,i)}function O0e(n,i,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ba(n,i,o,c){return new O0e(n,i,o,c)}function YP(n){return n=n.prototype,!(!n||!n.isReactComponent)}function D0e(n){if(typeof n=="function")return YP(n)?1:0;if(n!=null){if(n=n.$$typeof,n===pP)return 11;if(n===fP)return 14}return 2}function Eu(n,i){var o=n.alternate;return o===null?(o=Ba(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&14680064,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o}function Ox(n,i,o,c,d,f){var _=2;if(c=n,typeof n=="function")YP(n)&&(_=1);else if(typeof n=="string")_=5;else e:switch(n){case cm:return tp(o.children,d,f,i);case hP:_=8,d|=8;break;case EO:return n=Ba(12,o,i,d|2),n.elementType=EO,n.lanes=f,n;case vO:return n=Ba(13,o,i,d),n.elementType=vO,n.lanes=f,n;case yO:return n=Ba(19,o,i,d),n.elementType=yO,n.lanes=f,n;case Mz:return ab(o,d,f,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case kz:_=10;break e;case Lz:_=9;break e;case pP:_=11;break e;case fP:_=14;break e;case nu:_=16,c=null;break e}throw Error(pt(130,n==null?n:typeof n,""))}return i=Ba(_,o,i,d),i.elementType=n,i.type=c,i.lanes=f,i}function tp(n,i,o,c){return n=Ba(7,n,c,i),n.lanes=o,n}function ab(n,i,o,c){return n=Ba(22,n,c,i),n.elementType=Mz,n.lanes=o,n.stateNode={isHidden:!1},n}function GN(n,i,o){return n=Ba(6,n,null,i),n.lanes=o,n}function zN(n,i,o){return i=Ba(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function P0e(n,i,o,c,d){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wN(0),this.expirationTimes=wN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wN(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function $P(n,i,o,c,d,f,_,v,x){return n=new P0e(n,i,o,v,x),i===1?(i=1,f===!0&&(i|=8)):i=0,f=Ba(3,null,null,i),n.current=f,f.stateNode=n,f.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},DP(f),n}function k0e(n,i,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:am,key:c==null?null:""+c,children:n,containerInfo:i,implementation:o}}function Rq(n){if(!n)return Tu;n=n._reactInternals;e:{if(vp(n)!==n||n.tag!==1)throw Error(pt(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Po(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(pt(171))}if(n.tag===1){var o=n.type;if(Po(o))return RK(n,o,i)}return i}function Aq(n,i,o,c,d,f,_,v,x){return n=$P(o,c,!0,n,d,f,_,v,x),n.context=Rq(null),o=n.current,c=so(),d=_u(o),f=Zl(c,d),f.callback=i??null,mu(o,f,d),n.current.lanes=d,mE(n,d,c),ko(n,c),n}function cb(n,i,o,c){var d=i.current,f=so(),_=_u(d);return o=Rq(o),i.context===null?i.context=o:i.pendingContext=o,i=Zl(f,_),i.payload={element:n},c=c===void 0?null:c,c!==null&&(i.callback=c),n=mu(d,i,_),n!==null&&(Rc(n,d,_,f),wx(n,d,_)),_}function gT(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function tW(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function XP(n,i){tW(n,i),(n=n.alternate)&&tW(n,i)}function L0e(){return null}var Nq=typeof reportError=="function"?reportError:function(n){console.error(n)};function JP(n){this._internalRoot=n}lb.prototype.render=JP.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(pt(409));cb(n,i,null,null)};lb.prototype.unmount=JP.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;lp(function(){cb(null,n,null,null)}),i[id]=null}};function lb(n){this._internalRoot=n}lb.prototype.unstable_scheduleHydration=function(n){if(n){var i=oK();n={blockedOn:null,target:n,priority:i};for(var o=0;o<su.length&&i!==0&&i<su[o].priority;o++);su.splice(o,0,n),o===0&&cK(n)}};function QP(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function db(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function nW(){}function M0e(n,i,o,c,d){if(d){if(typeof c=="function"){var f=c;c=function(){var T=gT(_);f.call(T)}}var _=Aq(i,c,n,0,null,!1,!1,"",nW);return n._reactRootContainer=_,n[id]=_.current,Y_(n.nodeType===8?n.parentNode:n),lp(),_}for(;d=n.lastChild;)n.removeChild(d);if(typeof c=="function"){var v=c;c=function(){var T=gT(x);v.call(T)}}var x=$P(n,0,!1,null,null,!1,!1,"",nW);return n._reactRootContainer=x,n[id]=x.current,Y_(n.nodeType===8?n.parentNode:n),lp(function(){cb(i,x,o,c)}),x}function ub(n,i,o,c,d){var f=o._reactRootContainer;if(f){var _=f;if(typeof d=="function"){var v=d;d=function(){var x=gT(_);v.call(x)}}cb(i,_,n,d)}else _=M0e(o,i,n,d,c);return gT(_)}iK=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var o=m_(i.pendingLanes);o!==0&&(_P(i,o|1),ko(i,Di()),!(ar&6)&&(jm=Di()+500,Nu()))}break;case 13:lp(function(){var c=sd(n,1);if(c!==null){var d=so();Rc(c,n,1,d)}}),XP(n,1)}};EP=function(n){if(n.tag===13){var i=sd(n,134217728);if(i!==null){var o=so();Rc(i,n,134217728,o)}XP(n,134217728)}};sK=function(n){if(n.tag===13){var i=_u(n),o=sd(n,i);if(o!==null){var c=so();Rc(o,n,i,c)}XP(n,i)}};oK=function(){return Cr};aK=function(n,i){var o=Cr;try{return Cr=n,i()}finally{Cr=o}};IO=function(n,i,o){switch(i){case"input":if(TO(n,o),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var c=o[i];if(c!==n&&c.form===n.form){var d=tb(c);if(!d)throw Error(pt(90));Uz(c),TO(c,d)}}}break;case"textarea":Vz(n,o);break;case"select":i=o.value,i!=null&&bm(n,!!o.multiple,i,!1)}};qz=zP;Yz=lp;var j0e={usingClientEntryPoint:!1,Events:[_E,hm,tb,zz,Kz,zP]},i_={findFiberByHostInstance:zh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},U0e={bundleType:i_.bundleType,version:i_.version,rendererPackageName:i_.rendererPackageName,rendererConfig:i_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ud.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Jz(n),n===null?null:n.stateNode},findFiberByHostInstance:i_.findFiberByHostInstance||L0e,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rx.isDisabled&&rx.supportsFiber)try{JT=rx.inject(U0e),El=rx}catch{}}ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j0e;ca.createPortal=function(n,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!QP(i))throw Error(pt(200));return k0e(n,i,null,o)};ca.createRoot=function(n,i){if(!QP(n))throw Error(pt(299));var o=!1,c="",d=Nq;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),i=$P(n,1,!1,null,null,o,!1,c,d),n[id]=i.current,Y_(n.nodeType===8?n.parentNode:n),new JP(i)};ca.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(pt(188)):(n=Object.keys(n).join(","),Error(pt(268,n)));return n=Jz(i),n=n===null?null:n.stateNode,n};ca.flushSync=function(n){return lp(n)};ca.hydrate=function(n,i,o){if(!db(i))throw Error(pt(200));return ub(null,n,i,!0,o)};ca.hydrateRoot=function(n,i,o){if(!QP(n))throw Error(pt(405));var c=o!=null&&o.hydratedSources||null,d=!1,f="",_=Nq;if(o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),i=Aq(i,null,n,1,o??null,d,!1,f,_),n[id]=i.current,Y_(n),c)for(n=0;n<c.length;n++)o=c[n],d=o._getVersion,d=d(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,d]:i.mutableSourceEagerHydrationData.push(o,d);return new lb(i)};ca.render=function(n,i,o){if(!db(i))throw Error(pt(200));return ub(null,n,i,!1,o)};ca.unmountComponentAtNode=function(n){if(!db(n))throw Error(pt(40));return n._reactRootContainer?(lp(function(){ub(null,null,n,!1,function(){n._reactRootContainer=null,n[id]=null})}),!0):!1};ca.unstable_batchedUpdates=zP;ca.unstable_renderSubtreeIntoContainer=function(n,i,o,c){if(!db(o))throw Error(pt(200));if(n==null||n._reactInternals===void 0)throw Error(pt(38));return ub(n,i,o,!1,c)};ca.version="18.3.1-next-f1338f8080-20240426";function Iq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Iq)}catch(n){console.error(n)}}Iq(),Iz.exports=ca;var hb=Iz.exports;const F0e=$T(hb);var rW=hb;gO.createRoot=rW.createRoot,gO.hydrateRoot=rW.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rE(){return rE=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c])}return n},rE.apply(this,arguments)}var du;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(du||(du={}));const iW="popstate";function V0e(n){n===void 0&&(n={});function i(c,d){let{pathname:f,search:_,hash:v}=c.location;return lD("",{pathname:f,search:_,hash:v},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function o(c,d){return typeof d=="string"?d:_T(d)}return W0e(i,o,null,n)}function fi(n,i){if(n===!1||n===null||typeof n>"u")throw new Error(i)}function Oq(n,i){if(!n){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function B0e(){return Math.random().toString(36).substr(2,8)}function sW(n,i){return{usr:n.state,key:n.key,idx:i}}function lD(n,i,o,c){return o===void 0&&(o=null),rE({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof i=="string"?Zm(i):i,{state:o,key:i&&i.key||c||B0e()})}function _T(n){let{pathname:i="/",search:o="",hash:c=""}=n;return o&&o!=="?"&&(i+=o.charAt(0)==="?"?o:"?"+o),c&&c!=="#"&&(i+=c.charAt(0)==="#"?c:"#"+c),i}function Zm(n){let i={};if(n){let o=n.indexOf("#");o>=0&&(i.hash=n.substr(o),n=n.substr(0,o));let c=n.indexOf("?");c>=0&&(i.search=n.substr(c),n=n.substr(0,c)),n&&(i.pathname=n)}return i}function W0e(n,i,o,c){c===void 0&&(c={});let{window:d=document.defaultView,v5Compat:f=!1}=c,_=d.history,v=du.Pop,x=null,T=w();T==null&&(T=0,_.replaceState(rE({},_.state,{idx:T}),""));function w(){return(_.state||{idx:null}).idx}function R(){v=du.Pop;let W=w(),H=W==null?null:W-T;T=W,x&&x({action:v,location:k.location,delta:H})}function I(W,H){v=du.Push;let L=lD(k.location,W,H);o&&o(L,W),T=w()+1;let V=sW(L,T),K=k.createHref(L);try{_.pushState(V,"",K)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;d.location.assign(K)}f&&x&&x({action:v,location:k.location,delta:1})}function j(W,H){v=du.Replace;let L=lD(k.location,W,H);o&&o(L,W),T=w();let V=sW(L,T),K=k.createHref(L);_.replaceState(V,"",K),f&&x&&x({action:v,location:k.location,delta:0})}function P(W){let H=d.location.origin!=="null"?d.location.origin:d.location.href,L=typeof W=="string"?W:_T(W);return L=L.replace(/ $/,"%20"),fi(H,"No window.location.(origin|href) available to create URL for href: "+L),new URL(L,H)}let k={get action(){return v},get location(){return n(d,_)},listen(W){if(x)throw new Error("A history only accepts one active listener");return d.addEventListener(iW,R),x=W,()=>{d.removeEventListener(iW,R),x=null}},createHref(W){return i(d,W)},createURL:P,encodeLocation(W){let H=P(W);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:I,replace:j,go(W){return _.go(W)}};return k}var oW;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(oW||(oW={}));function H0e(n,i,o){return o===void 0&&(o="/"),G0e(n,i,o,!1)}function G0e(n,i,o,c){let d=typeof i=="string"?Zm(i):i,f=Um(d.pathname||"/",o);if(f==null)return null;let _=Dq(n);z0e(_);let v=null;for(let x=0;v==null&&x<_.length;++x){let T=nge(f);v=ege(_[x],T,c)}return v}function Dq(n,i,o,c){i===void 0&&(i=[]),o===void 0&&(o=[]),c===void 0&&(c="");let d=(f,_,v)=>{let x={relativePath:v===void 0?f.path||"":v,caseSensitive:f.caseSensitive===!0,childrenIndex:_,route:f};x.relativePath.startsWith("/")&&(fi(x.relativePath.startsWith(c),'Absolute route path "'+x.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),x.relativePath=x.relativePath.slice(c.length));let T=vu([c,x.relativePath]),w=o.concat(x);f.children&&f.children.length>0&&(fi(f.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+T+'".')),Dq(f.children,i,w,T)),!(f.path==null&&!f.index)&&i.push({path:T,score:Q0e(T,f.index),routesMeta:w})};return n.forEach((f,_)=>{var v;if(f.path===""||!((v=f.path)!=null&&v.includes("?")))d(f,_);else for(let x of Pq(f.path))d(f,_,x)}),i}function Pq(n){let i=n.split("/");if(i.length===0)return[];let[o,...c]=i,d=o.endsWith("?"),f=o.replace(/\?$/,"");if(c.length===0)return d?[f,""]:[f];let _=Pq(c.join("/")),v=[];return v.push(..._.map(x=>x===""?f:[f,x].join("/"))),d&&v.push(..._),v.map(x=>n.startsWith("/")&&x===""?"/":x)}function z0e(n){n.sort((i,o)=>i.score!==o.score?o.score-i.score:Z0e(i.routesMeta.map(c=>c.childrenIndex),o.routesMeta.map(c=>c.childrenIndex)))}const K0e=/^:[\w-]+$/,q0e=3,Y0e=2,$0e=1,X0e=10,J0e=-2,aW=n=>n==="*";function Q0e(n,i){let o=n.split("/"),c=o.length;return o.some(aW)&&(c+=J0e),i&&(c+=Y0e),o.filter(d=>!aW(d)).reduce((d,f)=>d+(K0e.test(f)?q0e:f===""?$0e:X0e),c)}function Z0e(n,i){return n.length===i.length&&n.slice(0,-1).every((c,d)=>c===i[d])?n[n.length-1]-i[i.length-1]:0}function ege(n,i,o){o===void 0&&(o=!1);let{routesMeta:c}=n,d={},f="/",_=[];for(let v=0;v<c.length;++v){let x=c[v],T=v===c.length-1,w=f==="/"?i:i.slice(f.length)||"/",R=ET({path:x.relativePath,caseSensitive:x.caseSensitive,end:T},w),I=x.route;if(!R&&T&&o&&!c[c.length-1].route.index&&(R=ET({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},w)),!R)return null;Object.assign(d,R.params),_.push({params:d,pathname:vu([f,R.pathname]),pathnameBase:oge(vu([f,R.pathnameBase])),route:I}),R.pathnameBase!=="/"&&(f=vu([f,R.pathnameBase]))}return _}function ET(n,i){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[o,c]=tge(n.path,n.caseSensitive,n.end),d=i.match(o);if(!d)return null;let f=d[0],_=f.replace(/(.)\/+$/,"$1"),v=d.slice(1);return{params:c.reduce((T,w,R)=>{let{paramName:I,isOptional:j}=w;if(I==="*"){let k=v[R]||"";_=f.slice(0,f.length-k.length).replace(/(.)\/+$/,"$1")}const P=v[R];return j&&!P?T[I]=void 0:T[I]=(P||"").replace(/%2F/g,"/"),T},{}),pathname:f,pathnameBase:_,pattern:n}}function tge(n,i,o){i===void 0&&(i=!1),o===void 0&&(o=!0),Oq(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let c=[],d="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,v,x)=>(c.push({paramName:v,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(c.push({paramName:"*"}),d+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?d+="\\/*$":n!==""&&n!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,i?void 0:"i"),c]}function nge(n){try{return n.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return Oq(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),n}}function Um(n,i){if(i==="/")return n;if(!n.toLowerCase().startsWith(i.toLowerCase()))return null;let o=i.endsWith("/")?i.length-1:i.length,c=n.charAt(o);return c&&c!=="/"?null:n.slice(o)||"/"}function rge(n,i){i===void 0&&(i="/");let{pathname:o,search:c="",hash:d=""}=typeof n=="string"?Zm(n):n;return{pathname:o?o.startsWith("/")?o:ige(o,i):i,search:age(c),hash:cge(d)}}function ige(n,i){let o=i.replace(/\/+$/,"").split("/");return n.split("/").forEach(d=>{d===".."?o.length>1&&o.pop():d!=="."&&o.push(d)}),o.length>1?o.join("/"):"/"}function KN(n,i,o,c){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sge(n){return n.filter((i,o)=>o===0||i.route.path&&i.route.path.length>0)}function ZP(n,i){let o=sge(n);return i?o.map((c,d)=>d===o.length-1?c.pathname:c.pathnameBase):o.map(c=>c.pathnameBase)}function ek(n,i,o,c){c===void 0&&(c=!1);let d;typeof n=="string"?d=Zm(n):(d=rE({},n),fi(!d.pathname||!d.pathname.includes("?"),KN("?","pathname","search",d)),fi(!d.pathname||!d.pathname.includes("#"),KN("#","pathname","hash",d)),fi(!d.search||!d.search.includes("#"),KN("#","search","hash",d)));let f=n===""||d.pathname==="",_=f?"/":d.pathname,v;if(_==null)v=o;else{let R=i.length-1;if(!c&&_.startsWith("..")){let I=_.split("/");for(;I[0]==="..";)I.shift(),R-=1;d.pathname=I.join("/")}v=R>=0?i[R]:"/"}let x=rge(d,v),T=_&&_!=="/"&&_.endsWith("/"),w=(f||_===".")&&o.endsWith("/");return!x.pathname.endsWith("/")&&(T||w)&&(x.pathname+="/"),x}const vu=n=>n.join("/").replace(/\/\/+/g,"/"),oge=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),age=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,cge=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function lge(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const kq=["post","put","patch","delete"];new Set(kq);const dge=["get",...kq];new Set(dge);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function iE(){return iE=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c])}return n},iE.apply(this,arguments)}const pb=X.createContext(null),Lq=X.createContext(null),hd=X.createContext(null),fb=X.createContext(null),pd=X.createContext({outlet:null,matches:[],isDataRoute:!1}),Mq=X.createContext(null);function uge(n,i){let{relative:o}=i===void 0?{}:i;e0()||fi(!1);let{basename:c,navigator:d}=X.useContext(hd),{hash:f,pathname:_,search:v}=mb(n,{relative:o}),x=_;return c!=="/"&&(x=_==="/"?c:vu([c,_])),d.createHref({pathname:x,search:v,hash:f})}function e0(){return X.useContext(fb)!=null}function Oc(){return e0()||fi(!1),X.useContext(fb).location}function jq(n){X.useContext(hd).static||X.useLayoutEffect(n)}function Qi(){let{isDataRoute:n}=X.useContext(pd);return n?bge():hge()}function hge(){e0()||fi(!1);let n=X.useContext(pb),{basename:i,future:o,navigator:c}=X.useContext(hd),{matches:d}=X.useContext(pd),{pathname:f}=Oc(),_=JSON.stringify(ZP(d,o.v7_relativeSplatPath)),v=X.useRef(!1);return jq(()=>{v.current=!0}),X.useCallback(function(T,w){if(w===void 0&&(w={}),!v.current)return;if(typeof T=="number"){c.go(T);return}let R=ek(T,JSON.parse(_),f,w.relative==="path");n==null&&i!=="/"&&(R.pathname=R.pathname==="/"?i:vu([i,R.pathname])),(w.replace?c.replace:c.push)(R,w.state,w)},[i,c,_,f,n])}function vE(){let{matches:n}=X.useContext(pd),i=n[n.length-1];return i?i.params:{}}function mb(n,i){let{relative:o}=i===void 0?{}:i,{future:c}=X.useContext(hd),{matches:d}=X.useContext(pd),{pathname:f}=Oc(),_=JSON.stringify(ZP(d,c.v7_relativeSplatPath));return X.useMemo(()=>ek(n,JSON.parse(_),f,o==="path"),[n,_,f,o])}function pge(n,i){return fge(n,i)}function fge(n,i,o,c){e0()||fi(!1);let{navigator:d}=X.useContext(hd),{matches:f}=X.useContext(pd),_=f[f.length-1],v=_?_.params:{};_&&_.pathname;let x=_?_.pathnameBase:"/";_&&_.route;let T=Oc(),w;if(i){var R;let W=typeof i=="string"?Zm(i):i;x==="/"||(R=W.pathname)!=null&&R.startsWith(x)||fi(!1),w=W}else w=T;let I=w.pathname||"/",j=I;if(x!=="/"){let W=x.replace(/^\//,"").split("/");j="/"+I.replace(/^\//,"").split("/").slice(W.length).join("/")}let P=H0e(n,{pathname:j}),k=vge(P&&P.map(W=>Object.assign({},W,{params:Object.assign({},v,W.params),pathname:vu([x,d.encodeLocation?d.encodeLocation(W.pathname).pathname:W.pathname]),pathnameBase:W.pathnameBase==="/"?x:vu([x,d.encodeLocation?d.encodeLocation(W.pathnameBase).pathname:W.pathnameBase])})),f,o,c);return i&&k?X.createElement(fb.Provider,{value:{location:iE({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:du.Pop}},k):k}function mge(){let n=Tge(),i=lge(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),o=n instanceof Error?n.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},f=null;return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},i),o?X.createElement("pre",{style:d},o):null,f)}const gge=X.createElement(mge,null);class _ge extends X.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,o){return o.location!==i.location||o.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:o.error,location:o.location,revalidation:i.revalidation||o.revalidation}}componentDidCatch(i,o){console.error("React Router caught the following error during render",i,o)}render(){return this.state.error!==void 0?X.createElement(pd.Provider,{value:this.props.routeContext},X.createElement(Mq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ege(n){let{routeContext:i,match:o,children:c}=n,d=X.useContext(pb);return d&&d.static&&d.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=o.route.id),X.createElement(pd.Provider,{value:i},c)}function vge(n,i,o,c){var d;if(i===void 0&&(i=[]),o===void 0&&(o=null),c===void 0&&(c=null),n==null){var f;if(!o)return null;if(o.errors)n=o.matches;else if((f=c)!=null&&f.v7_partialHydration&&i.length===0&&!o.initialized&&o.matches.length>0)n=o.matches;else return null}let _=n,v=(d=o)==null?void 0:d.errors;if(v!=null){let w=_.findIndex(R=>R.route.id&&(v==null?void 0:v[R.route.id])!==void 0);w>=0||fi(!1),_=_.slice(0,Math.min(_.length,w+1))}let x=!1,T=-1;if(o&&c&&c.v7_partialHydration)for(let w=0;w<_.length;w++){let R=_[w];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(T=w),R.route.id){let{loaderData:I,errors:j}=o,P=R.route.loader&&I[R.route.id]===void 0&&(!j||j[R.route.id]===void 0);if(R.route.lazy||P){x=!0,T>=0?_=_.slice(0,T+1):_=[_[0]];break}}}return _.reduceRight((w,R,I)=>{let j,P=!1,k=null,W=null;o&&(j=v&&R.route.id?v[R.route.id]:void 0,k=R.route.errorElement||gge,x&&(T<0&&I===0?(wge("route-fallback",!1),P=!0,W=null):T===I&&(P=!0,W=R.route.hydrateFallbackElement||null)));let H=i.concat(_.slice(0,I+1)),L=()=>{let V;return j?V=k:P?V=W:R.route.Component?V=X.createElement(R.route.Component,null):R.route.element?V=R.route.element:V=w,X.createElement(Ege,{match:R,routeContext:{outlet:w,matches:H,isDataRoute:o!=null},children:V})};return o&&(R.route.ErrorBoundary||R.route.errorElement||I===0)?X.createElement(_ge,{location:o.location,revalidation:o.revalidation,component:k,error:j,children:L(),routeContext:{outlet:null,matches:H,isDataRoute:!0}}):L()},null)}var Uq=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Uq||{}),vT=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(vT||{});function yge(n){let i=X.useContext(pb);return i||fi(!1),i}function Sge(n){let i=X.useContext(Lq);return i||fi(!1),i}function xge(n){let i=X.useContext(pd);return i||fi(!1),i}function Fq(n){let i=xge(),o=i.matches[i.matches.length-1];return o.route.id||fi(!1),o.route.id}function Tge(){var n;let i=X.useContext(Mq),o=Sge(vT.UseRouteError),c=Fq(vT.UseRouteError);return i!==void 0?i:(n=o.errors)==null?void 0:n[c]}function bge(){let{router:n}=yge(Uq.UseNavigateStable),i=Fq(vT.UseNavigateStable),o=X.useRef(!1);return jq(()=>{o.current=!0}),X.useCallback(function(d,f){f===void 0&&(f={}),o.current&&(typeof d=="number"?n.navigate(d):n.navigate(d,iE({fromRouteId:i},f)))},[n,i])}const cW={};function wge(n,i,o){!i&&!cW[n]&&(cW[n]=!0)}function Cge(n,i){n==null||n.v7_startTransition,(n==null?void 0:n.v7_relativeSplatPath)===void 0&&(!i||i.v7_relativeSplatPath),i&&(i.v7_fetcherPersist,i.v7_normalizeFormMethod,i.v7_partialHydration,i.v7_skipActionErrorRevalidation)}function qN(n){let{to:i,replace:o,state:c,relative:d}=n;e0()||fi(!1);let{future:f,static:_}=X.useContext(hd),{matches:v}=X.useContext(pd),{pathname:x}=Oc(),T=Qi(),w=ek(i,ZP(v,f.v7_relativeSplatPath),x,d==="path"),R=JSON.stringify(w);return X.useEffect(()=>T(JSON.parse(R),{replace:o,state:c,relative:d}),[T,R,d,o,c]),null}function In(n){fi(!1)}function Rge(n){let{basename:i="/",children:o=null,location:c,navigationType:d=du.Pop,navigator:f,static:_=!1,future:v}=n;e0()&&fi(!1);let x=i.replace(/^\/*/,"/"),T=X.useMemo(()=>({basename:x,navigator:f,static:_,future:iE({v7_relativeSplatPath:!1},v)}),[x,v,f,_]);typeof c=="string"&&(c=Zm(c));let{pathname:w="/",search:R="",hash:I="",state:j=null,key:P="default"}=c,k=X.useMemo(()=>{let W=Um(w,x);return W==null?null:{location:{pathname:W,search:R,hash:I,state:j,key:P},navigationType:d}},[x,w,R,I,j,P,d]);return k==null?null:X.createElement(hd.Provider,{value:T},X.createElement(fb.Provider,{children:o,value:k}))}function Age(n){let{children:i,location:o}=n;return pge(dD(i),o)}new Promise(()=>{});function dD(n,i){i===void 0&&(i=[]);let o=[];return X.Children.forEach(n,(c,d)=>{if(!X.isValidElement(c))return;let f=[...i,d];if(c.type===X.Fragment){o.push.apply(o,dD(c.props.children,f));return}c.type!==In&&fi(!1),!c.props.index||!c.props.children||fi(!1);let _={id:c.props.id||f.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(_.children=dD(c.props.children,f)),o.push(_)}),o}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yT(){return yT=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c])}return n},yT.apply(this,arguments)}function Vq(n,i){if(n==null)return{};var o={},c=Object.keys(n),d,f;for(f=0;f<c.length;f++)d=c[f],!(i.indexOf(d)>=0)&&(o[d]=n[d]);return o}function Nge(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Ige(n,i){return n.button===0&&(!i||i==="_self")&&!Nge(n)}const Oge=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Dge=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Pge="6";try{window.__reactRouterVersion=Pge}catch{}const kge=X.createContext({isTransitioning:!1}),Lge="startTransition",lW=cP[Lge];function Mge(n){let{basename:i,children:o,future:c,window:d}=n,f=X.useRef();f.current==null&&(f.current=V0e({window:d,v5Compat:!0}));let _=f.current,[v,x]=X.useState({action:_.action,location:_.location}),{v7_startTransition:T}=c||{},w=X.useCallback(R=>{T&&lW?lW(()=>x(R)):x(R)},[x,T]);return X.useLayoutEffect(()=>_.listen(w),[_,w]),X.useEffect(()=>Cge(c),[c]),X.createElement(Rge,{basename:i,children:o,location:v.location,navigationType:v.action,navigator:_,future:c})}const jge=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Uge=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xn=X.forwardRef(function(i,o){let{onClick:c,relative:d,reloadDocument:f,replace:_,state:v,target:x,to:T,preventScrollReset:w,viewTransition:R}=i,I=Vq(i,Oge),{basename:j}=X.useContext(hd),P,k=!1;if(typeof T=="string"&&Uge.test(T)&&(P=T,jge))try{let V=new URL(window.location.href),K=T.startsWith("//")?new URL(V.protocol+T):new URL(T),te=Um(K.pathname,j);K.origin===V.origin&&te!=null?T=te+K.search+K.hash:k=!0}catch{}let W=uge(T,{relative:d}),H=Vge(T,{replace:_,state:v,target:x,preventScrollReset:w,relative:d,viewTransition:R});function L(V){c&&c(V),V.defaultPrevented||H(V)}return X.createElement("a",yT({},I,{href:P||W,onClick:k||f?c:L,ref:o,target:x}))}),Lh=X.forwardRef(function(i,o){let{"aria-current":c="page",caseSensitive:d=!1,className:f="",end:_=!1,style:v,to:x,viewTransition:T,children:w}=i,R=Vq(i,Dge),I=mb(x,{relative:R.relative}),j=Oc(),P=X.useContext(Lq),{navigator:k,basename:W}=X.useContext(hd),H=P!=null&&Bge(I)&&T===!0,L=k.encodeLocation?k.encodeLocation(I).pathname:I.pathname,V=j.pathname,K=P&&P.navigation&&P.navigation.location?P.navigation.location.pathname:null;d||(V=V.toLowerCase(),K=K?K.toLowerCase():null,L=L.toLowerCase()),K&&W&&(K=Um(K,W)||K);const te=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let ie=V===L||!_&&V.startsWith(L)&&V.charAt(te)==="/",A=K!=null&&(K===L||!_&&K.startsWith(L)&&K.charAt(L.length)==="/"),de={isActive:ie,isPending:A,isTransitioning:H},ue=ie?c:void 0,oe;typeof f=="function"?oe=f(de):oe=[f,ie?"active":null,A?"pending":null,H?"transitioning":null].filter(Boolean).join(" ");let ye=typeof v=="function"?v(de):v;return X.createElement(Xn,yT({},R,{"aria-current":ue,className:oe,ref:o,style:ye,to:x,viewTransition:T}),typeof w=="function"?w(de):w)});var uD;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(uD||(uD={}));var dW;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(dW||(dW={}));function Fge(n){let i=X.useContext(pb);return i||fi(!1),i}function Vge(n,i){let{target:o,replace:c,state:d,preventScrollReset:f,relative:_,viewTransition:v}=i===void 0?{}:i,x=Qi(),T=Oc(),w=mb(n,{relative:_});return X.useCallback(R=>{if(Ige(R,o)){R.preventDefault();let I=c!==void 0?c:_T(T)===_T(w);x(n,{replace:I,state:d,preventScrollReset:f,relative:_,viewTransition:v})}},[T,x,w,c,d,o,n,f,_,v])}function Bge(n,i){i===void 0&&(i={});let o=X.useContext(kge);o==null&&fi(!1);let{basename:c}=Fge(uD.useViewTransitionState),d=mb(n,{relative:i.relative});if(!o.isTransitioning)return!1;let f=Um(o.currentLocation.pathname,c)||o.currentLocation.pathname,_=Um(o.nextLocation.pathname,c)||o.nextLocation.pathname;return ET(d.pathname,_)!=null||ET(d.pathname,f)!=null}function Bq(n){var i,o,c="";if(typeof n=="string"||typeof n=="number")c+=n;else if(typeof n=="object")if(Array.isArray(n)){var d=n.length;for(i=0;i<d;i++)n[i]&&(o=Bq(n[i]))&&(c&&(c+=" "),c+=o)}else for(o in n)n[o]&&(c&&(c+=" "),c+=o);return c}function Wq(){for(var n,i,o=0,c="",d=arguments.length;o<d;o++)(n=arguments[o])&&(i=Bq(n))&&(c&&(c+=" "),c+=i);return c}function Wge(){for(var n=0,i,o,c="";n<arguments.length;)(i=arguments[n++])&&(o=Hq(i))&&(c&&(c+=" "),c+=o);return c}function Hq(n){if(typeof n=="string")return n;for(var i,o="",c=0;c<n.length;c++)n[c]&&(i=Hq(n[c]))&&(o&&(o+=" "),o+=i);return o}var tk="-";function Hge(n){var i=zge(n),o=n.conflictingClassGroups,c=n.conflictingClassGroupModifiers,d=c===void 0?{}:c;function f(v){var x=v.split(tk);return x[0]===""&&x.length!==1&&x.shift(),Gq(x,i)||Gge(v)}function _(v,x){var T=o[v]||[];return x&&d[v]?[].concat(T,d[v]):T}return{getClassGroupId:f,getConflictingClassGroupIds:_}}function Gq(n,i){var _;if(n.length===0)return i.classGroupId;var o=n[0],c=i.nextPart.get(o),d=c?Gq(n.slice(1),c):void 0;if(d)return d;if(i.validators.length!==0){var f=n.join(tk);return(_=i.validators.find(function(v){var x=v.validator;return x(f)}))==null?void 0:_.classGroupId}}var uW=/^\[(.+)\]$/;function Gge(n){if(uW.test(n)){var i=uW.exec(n)[1],o=i==null?void 0:i.substring(0,i.indexOf(":"));if(o)return"arbitrary.."+o}}function zge(n){var i=n.theme,o=n.prefix,c={nextPart:new Map,validators:[]},d=qge(Object.entries(n.classGroups),o);return d.forEach(function(f){var _=f[0],v=f[1];hD(v,c,_,i)}),c}function hD(n,i,o,c){n.forEach(function(d){if(typeof d=="string"){var f=d===""?i:hW(i,d);f.classGroupId=o;return}if(typeof d=="function"){if(Kge(d)){hD(d(c),i,o,c);return}i.validators.push({validator:d,classGroupId:o});return}Object.entries(d).forEach(function(_){var v=_[0],x=_[1];hD(x,hW(i,v),o,c)})})}function hW(n,i){var o=n;return i.split(tk).forEach(function(c){o.nextPart.has(c)||o.nextPart.set(c,{nextPart:new Map,validators:[]}),o=o.nextPart.get(c)}),o}function Kge(n){return n.isThemeGetter}function qge(n,i){return i?n.map(function(o){var c=o[0],d=o[1],f=d.map(function(_){return typeof _=="string"?i+_:typeof _=="object"?Object.fromEntries(Object.entries(_).map(function(v){var x=v[0],T=v[1];return[i+x,T]})):_});return[c,f]}):n}function Yge(n){if(n<1)return{get:function(){},set:function(){}};var i=0,o=new Map,c=new Map;function d(f,_){o.set(f,_),i++,i>n&&(i=0,c=o,o=new Map)}return{get:function(_){var v=o.get(_);if(v!==void 0)return v;if((v=c.get(_))!==void 0)return d(_,v),v},set:function(_,v){o.has(_)?o.set(_,v):d(_,v)}}}var zq="!";function $ge(n){var i=n.separator||":",o=i.length===1,c=i[0],d=i.length;return function(_){for(var v=[],x=0,T=0,w,R=0;R<_.length;R++){var I=_[R];if(x===0){if(I===c&&(o||_.slice(R,R+d)===i)){v.push(_.slice(T,R)),T=R+d;continue}if(I==="/"){w=R;continue}}I==="["?x++:I==="]"&&x--}var j=v.length===0?_:_.substring(T),P=j.startsWith(zq),k=P?j.substring(1):j,W=w&&w>T?w-T:void 0;return{modifiers:v,hasImportantModifier:P,baseClassName:k,maybePostfixModifierPosition:W}}}function Xge(n){if(n.length<=1)return n;var i=[],o=[];return n.forEach(function(c){var d=c[0]==="[";d?(i.push.apply(i,o.sort().concat([c])),o=[]):o.push(c)}),i.push.apply(i,o.sort()),i}function Jge(n){return{cache:Yge(n.cacheSize),splitModifiers:$ge(n),...Hge(n)}}var Qge=/\s+/;function Zge(n,i){var o=i.splitModifiers,c=i.getClassGroupId,d=i.getConflictingClassGroupIds,f=new Set;return n.trim().split(Qge).map(function(_){var v=o(_),x=v.modifiers,T=v.hasImportantModifier,w=v.baseClassName,R=v.maybePostfixModifierPosition,I=c(R?w.substring(0,R):w),j=!!R;if(!I){if(!R)return{isTailwindClass:!1,originalClassName:_};if(I=c(w),!I)return{isTailwindClass:!1,originalClassName:_};j=!1}var P=Xge(x).join(":"),k=T?P+zq:P;return{isTailwindClass:!0,modifierId:k,classGroupId:I,originalClassName:_,hasPostfixModifier:j}}).reverse().filter(function(_){if(!_.isTailwindClass)return!0;var v=_.modifierId,x=_.classGroupId,T=_.hasPostfixModifier,w=v+x;return f.has(w)?!1:(f.add(w),d(x,T).forEach(function(R){return f.add(v+R)}),!0)}).reverse().map(function(_){return _.originalClassName}).join(" ")}function e_e(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var c,d,f,_=v;function v(T){var w=i[0],R=i.slice(1),I=R.reduce(function(j,P){return P(j)},w());return c=Jge(I),d=c.cache.get,f=c.cache.set,_=x,x(T)}function x(T){var w=d(T);if(w)return w;var R=Zge(T,c);return f(T,R),R}return function(){return _(Wge.apply(null,arguments))}}function Br(n){var i=function(c){return c[n]||[]};return i.isThemeGetter=!0,i}var Kq=/^\[(?:([a-z-]+):)?(.+)\]$/i,t_e=/^\d+\/\d+$/,n_e=new Set(["px","full","screen"]),r_e=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,i_e=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,s_e=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Ec(n){return Yh(n)||n_e.has(n)||t_e.test(n)||pD(n)}function pD(n){return yp(n,"length",u_e)}function o_e(n){return yp(n,"size",qq)}function a_e(n){return yp(n,"position",qq)}function c_e(n){return yp(n,"url",h_e)}function ix(n){return yp(n,"number",Yh)}function Yh(n){return!Number.isNaN(Number(n))}function l_e(n){return n.endsWith("%")&&Yh(n.slice(0,-1))}function s_(n){return pW(n)||yp(n,"number",pW)}function zn(n){return Kq.test(n)}function o_(){return!0}function Jd(n){return r_e.test(n)}function d_e(n){return yp(n,"",p_e)}function yp(n,i,o){var c=Kq.exec(n);return c?c[1]?c[1]===i:o(c[2]):!1}function u_e(n){return i_e.test(n)}function qq(){return!1}function h_e(n){return n.startsWith("url(")}function pW(n){return Number.isInteger(Number(n))}function p_e(n){return s_e.test(n)}function f_e(){var n=Br("colors"),i=Br("spacing"),o=Br("blur"),c=Br("brightness"),d=Br("borderColor"),f=Br("borderRadius"),_=Br("borderSpacing"),v=Br("borderWidth"),x=Br("contrast"),T=Br("grayscale"),w=Br("hueRotate"),R=Br("invert"),I=Br("gap"),j=Br("gradientColorStops"),P=Br("gradientColorStopPositions"),k=Br("inset"),W=Br("margin"),H=Br("opacity"),L=Br("padding"),V=Br("saturate"),K=Br("scale"),te=Br("sepia"),ie=Br("skew"),A=Br("space"),de=Br("translate"),ue=function(){return["auto","contain","none"]},oe=function(){return["auto","hidden","clip","visible","scroll"]},ye=function(){return["auto",zn,i]},Ee=function(){return[zn,i]},xe=function(){return["",Ec]},Oe=function(){return["auto",Yh,zn]},ct=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},at=function(){return["solid","dashed","dotted","double","none"]},lt=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},He=function(){return["start","end","center","between","around","evenly","stretch"]},et=function(){return["","0",zn]},ut=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},Ae=function(){return[Yh,ix]},Le=function(){return[Yh,zn]};return{cacheSize:500,theme:{colors:[o_],spacing:[Ec],blur:["none","",Jd,zn],brightness:Ae(),borderColor:[n],borderRadius:["none","","full",Jd,zn],borderSpacing:Ee(),borderWidth:xe(),contrast:Ae(),grayscale:et(),hueRotate:Le(),invert:et(),gap:Ee(),gradientColorStops:[n],gradientColorStopPositions:[l_e,pD],inset:ye(),margin:ye(),opacity:Ae(),padding:Ee(),saturate:Ae(),scale:Ae(),sepia:et(),skew:Le(),space:Ee(),translate:Ee()},classGroups:{aspect:[{aspect:["auto","square","video",zn]}],container:["container"],columns:[{columns:[Jd]}],"break-after":[{"break-after":ut()}],"break-before":[{"break-before":ut()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(ct(),[zn])}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:ue()}],"overscroll-x":[{"overscroll-x":ue()}],"overscroll-y":[{"overscroll-y":ue()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[k]}],"inset-x":[{"inset-x":[k]}],"inset-y":[{"inset-y":[k]}],start:[{start:[k]}],end:[{end:[k]}],top:[{top:[k]}],right:[{right:[k]}],bottom:[{bottom:[k]}],left:[{left:[k]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",s_]}],basis:[{basis:ye()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",zn]}],grow:[{grow:et()}],shrink:[{shrink:et()}],order:[{order:["first","last","none",s_]}],"grid-cols":[{"grid-cols":[o_]}],"col-start-end":[{col:["auto",{span:["full",s_]},zn]}],"col-start":[{"col-start":Oe()}],"col-end":[{"col-end":Oe()}],"grid-rows":[{"grid-rows":[o_]}],"row-start-end":[{row:["auto",{span:[s_]},zn]}],"row-start":[{"row-start":Oe()}],"row-end":[{"row-end":Oe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",zn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",zn]}],gap:[{gap:[I]}],"gap-x":[{"gap-x":[I]}],"gap-y":[{"gap-y":[I]}],"justify-content":[{justify:["normal"].concat(He())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(He(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(He(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[L]}],px:[{px:[L]}],py:[{py:[L]}],ps:[{ps:[L]}],pe:[{pe:[L]}],pt:[{pt:[L]}],pr:[{pr:[L]}],pb:[{pb:[L]}],pl:[{pl:[L]}],m:[{m:[W]}],mx:[{mx:[W]}],my:[{my:[W]}],ms:[{ms:[W]}],me:[{me:[W]}],mt:[{mt:[W]}],mr:[{mr:[W]}],mb:[{mb:[W]}],ml:[{ml:[W]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",zn,i]}],"min-w":[{"min-w":["min","max","fit",zn,Ec]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Jd]},Jd,zn]}],h:[{h:[zn,i,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",zn,Ec]}],"max-h":[{"max-h":[zn,i,"min","max","fit"]}],"font-size":[{text:["base",Jd,pD]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ix]}],"font-family":[{font:[o_]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",zn]}],"line-clamp":[{"line-clamp":["none",Yh,ix]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",zn,Ec]}],"list-image":[{"list-image":["none",zn]}],"list-style-type":[{list:["none","disc","decimal",zn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[H]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[H]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(at(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Ec]}],"underline-offset":[{"underline-offset":["auto",zn,Ec]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:Ee()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",zn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",zn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[H]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(ct(),[a_e])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",o_e]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},c_e]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[P]}],"gradient-via-pos":[{via:[P]}],"gradient-to-pos":[{to:[P]}],"gradient-from":[{from:[j]}],"gradient-via":[{via:[j]}],"gradient-to":[{to:[j]}],rounded:[{rounded:[f]}],"rounded-s":[{"rounded-s":[f]}],"rounded-e":[{"rounded-e":[f]}],"rounded-t":[{"rounded-t":[f]}],"rounded-r":[{"rounded-r":[f]}],"rounded-b":[{"rounded-b":[f]}],"rounded-l":[{"rounded-l":[f]}],"rounded-ss":[{"rounded-ss":[f]}],"rounded-se":[{"rounded-se":[f]}],"rounded-ee":[{"rounded-ee":[f]}],"rounded-es":[{"rounded-es":[f]}],"rounded-tl":[{"rounded-tl":[f]}],"rounded-tr":[{"rounded-tr":[f]}],"rounded-br":[{"rounded-br":[f]}],"rounded-bl":[{"rounded-bl":[f]}],"border-w":[{border:[v]}],"border-w-x":[{"border-x":[v]}],"border-w-y":[{"border-y":[v]}],"border-w-s":[{"border-s":[v]}],"border-w-e":[{"border-e":[v]}],"border-w-t":[{"border-t":[v]}],"border-w-r":[{"border-r":[v]}],"border-w-b":[{"border-b":[v]}],"border-w-l":[{"border-l":[v]}],"border-opacity":[{"border-opacity":[H]}],"border-style":[{border:[].concat(at(),["hidden"])}],"divide-x":[{"divide-x":[v]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[v]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[H]}],"divide-style":[{divide:at()}],"border-color":[{border:[d]}],"border-color-x":[{"border-x":[d]}],"border-color-y":[{"border-y":[d]}],"border-color-t":[{"border-t":[d]}],"border-color-r":[{"border-r":[d]}],"border-color-b":[{"border-b":[d]}],"border-color-l":[{"border-l":[d]}],"divide-color":[{divide:[d]}],"outline-style":[{outline:[""].concat(at())}],"outline-offset":[{"outline-offset":[zn,Ec]}],"outline-w":[{outline:[Ec]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:xe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[H]}],"ring-offset-w":[{"ring-offset":[Ec]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Jd,d_e]}],"shadow-color":[{shadow:[o_]}],opacity:[{opacity:[H]}],"mix-blend":[{"mix-blend":lt()}],"bg-blend":[{"bg-blend":lt()}],filter:[{filter:["","none"]}],blur:[{blur:[o]}],brightness:[{brightness:[c]}],contrast:[{contrast:[x]}],"drop-shadow":[{"drop-shadow":["","none",Jd,zn]}],grayscale:[{grayscale:[T]}],"hue-rotate":[{"hue-rotate":[w]}],invert:[{invert:[R]}],saturate:[{saturate:[V]}],sepia:[{sepia:[te]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[o]}],"backdrop-brightness":[{"backdrop-brightness":[c]}],"backdrop-contrast":[{"backdrop-contrast":[x]}],"backdrop-grayscale":[{"backdrop-grayscale":[T]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[w]}],"backdrop-invert":[{"backdrop-invert":[R]}],"backdrop-opacity":[{"backdrop-opacity":[H]}],"backdrop-saturate":[{"backdrop-saturate":[V]}],"backdrop-sepia":[{"backdrop-sepia":[te]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[_]}],"border-spacing-x":[{"border-spacing-x":[_]}],"border-spacing-y":[{"border-spacing-y":[_]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",zn]}],duration:[{duration:Le()}],ease:[{ease:["linear","in","out","in-out",zn]}],delay:[{delay:Le()}],animate:[{animate:["none","spin","ping","pulse","bounce",zn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[K]}],"scale-x":[{"scale-x":[K]}],"scale-y":[{"scale-y":[K]}],rotate:[{rotate:[s_,zn]}],"translate-x":[{"translate-x":[de]}],"translate-y":[{"translate-y":[de]}],"skew-x":[{"skew-x":[ie]}],"skew-y":[{"skew-y":[ie]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",zn]}],accent:[{accent:["auto",n]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",zn]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Ee()}],"scroll-mx":[{"scroll-mx":Ee()}],"scroll-my":[{"scroll-my":Ee()}],"scroll-ms":[{"scroll-ms":Ee()}],"scroll-me":[{"scroll-me":Ee()}],"scroll-mt":[{"scroll-mt":Ee()}],"scroll-mr":[{"scroll-mr":Ee()}],"scroll-mb":[{"scroll-mb":Ee()}],"scroll-ml":[{"scroll-ml":Ee()}],"scroll-p":[{"scroll-p":Ee()}],"scroll-px":[{"scroll-px":Ee()}],"scroll-py":[{"scroll-py":Ee()}],"scroll-ps":[{"scroll-ps":Ee()}],"scroll-pe":[{"scroll-pe":Ee()}],"scroll-pt":[{"scroll-pt":Ee()}],"scroll-pr":[{"scroll-pr":Ee()}],"scroll-pb":[{"scroll-pb":Ee()}],"scroll-pl":[{"scroll-pl":Ee()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",zn]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Ec,ix]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var m_e=e_e(f_e);function Ir(...n){return m_e(Wq(n))}function Vi(n,i,{checkForDefaultPrevented:o=!0}={}){return function(d){if(n==null||n(d),o===!1||!d.defaultPrevented)return i==null?void 0:i(d)}}function fW(n,i){if(typeof n=="function")return n(i);n!=null&&(n.current=i)}function nk(...n){return i=>{let o=!1;const c=n.map(d=>{const f=fW(d,i);return!o&&typeof f=="function"&&(o=!0),f});if(o)return()=>{for(let d=0;d<c.length;d++){const f=c[d];typeof f=="function"?f():fW(n[d],null)}}}}function Ks(...n){return X.useCallback(nk(...n),n)}function g_e(n,i){const o=X.createContext(i),c=f=>{const{children:_,...v}=f,x=X.useMemo(()=>v,Object.values(v));return h.jsx(o.Provider,{value:x,children:_})};c.displayName=n+"Provider";function d(f){const _=X.useContext(o);if(_)return _;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${n}\``)}return[c,d]}function Sp(n,i=[]){let o=[];function c(f,_){const v=X.createContext(_),x=o.length;o=[...o,_];const T=R=>{var H;const{scope:I,children:j,...P}=R,k=((H=I==null?void 0:I[n])==null?void 0:H[x])||v,W=X.useMemo(()=>P,Object.values(P));return h.jsx(k.Provider,{value:W,children:j})};T.displayName=f+"Provider";function w(R,I){var k;const j=((k=I==null?void 0:I[n])==null?void 0:k[x])||v,P=X.useContext(j);if(P)return P;if(_!==void 0)return _;throw new Error(`\`${R}\` must be used within \`${f}\``)}return[T,w]}const d=()=>{const f=o.map(_=>X.createContext(_));return function(v){const x=(v==null?void 0:v[n])||f;return X.useMemo(()=>({[`__scope${n}`]:{...v,[n]:x}}),[v,x])}};return d.scopeName=n,[c,__e(d,...i)]}function __e(...n){const i=n[0];if(n.length===1)return i;const o=()=>{const c=n.map(d=>({useScope:d(),scopeName:d.scopeName}));return function(f){const _=c.reduce((v,{useScope:x,scopeName:T})=>{const R=x(f)[`__scope${T}`];return{...v,...R}},{});return X.useMemo(()=>({[`__scope${i.scopeName}`]:_}),[_])}};return o.scopeName=i.scopeName,o}function sE(n){const i=v_e(n),o=X.forwardRef((c,d)=>{const{children:f,..._}=c,v=X.Children.toArray(f),x=v.find(S_e);if(x){const T=x.props.children,w=v.map(R=>R===x?X.Children.count(T)>1?X.Children.only(null):X.isValidElement(T)?T.props.children:null:R);return h.jsx(i,{..._,ref:d,children:X.isValidElement(T)?X.cloneElement(T,void 0,w):null})}return h.jsx(i,{..._,ref:d,children:f})});return o.displayName=`${n}.Slot`,o}var E_e=sE("Slot");function v_e(n){const i=X.forwardRef((o,c)=>{const{children:d,...f}=o,_=X.isValidElement(d)?T_e(d):void 0,v=Ks(_,c);if(X.isValidElement(d)){const x=x_e(f,d.props);return d.type!==X.Fragment&&(x.ref=v),X.cloneElement(d,x)}return X.Children.count(d)>1?X.Children.only(null):null});return i.displayName=`${n}.SlotClone`,i}var y_e=Symbol("radix.slottable");function S_e(n){return X.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===y_e}function x_e(n,i){const o={...i};for(const c in i){const d=n[c],f=i[c];/^on[A-Z]/.test(c)?d&&f?o[c]=(...v)=>{const x=f(...v);return d(...v),x}:d&&(o[c]=d):c==="style"?o[c]={...d,...f}:c==="className"&&(o[c]=[d,f].filter(Boolean).join(" "))}return{...n,...o}}function T_e(n){var c,d;let i=(c=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:c.get,o=i&&"isReactWarning"in i&&i.isReactWarning;return o?n.ref:(i=(d=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:d.get,o=i&&"isReactWarning"in i&&i.isReactWarning,o?n.props.ref:n.props.ref||n.ref)}function b_e(n){const i=n+"CollectionProvider",[o,c]=Sp(i),[d,f]=o(i,{collectionRef:{current:null},itemMap:new Map}),_=k=>{const{scope:W,children:H}=k,L=wt.useRef(null),V=wt.useRef(new Map).current;return h.jsx(d,{scope:W,itemMap:V,collectionRef:L,children:H})};_.displayName=i;const v=n+"CollectionSlot",x=sE(v),T=wt.forwardRef((k,W)=>{const{scope:H,children:L}=k,V=f(v,H),K=Ks(W,V.collectionRef);return h.jsx(x,{ref:K,children:L})});T.displayName=v;const w=n+"CollectionItemSlot",R="data-radix-collection-item",I=sE(w),j=wt.forwardRef((k,W)=>{const{scope:H,children:L,...V}=k,K=wt.useRef(null),te=Ks(W,K),ie=f(w,H);return wt.useEffect(()=>(ie.itemMap.set(K,{ref:K,...V}),()=>void ie.itemMap.delete(K))),h.jsx(I,{[R]:"",ref:te,children:L})});j.displayName=w;function P(k){const W=f(n+"CollectionConsumer",k);return wt.useCallback(()=>{const L=W.collectionRef.current;if(!L)return[];const V=Array.from(L.querySelectorAll(`[${R}]`));return Array.from(W.itemMap.values()).sort((ie,A)=>V.indexOf(ie.ref.current)-V.indexOf(A.ref.current))},[W.collectionRef,W.itemMap])}return[{Provider:_,Slot:T,ItemSlot:j},P,c]}var w_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wi=w_e.reduce((n,i)=>{const o=sE(`Primitive.${i}`),c=X.forwardRef((d,f)=>{const{asChild:_,...v}=d,x=_?o:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(x,{...v,ref:f})});return c.displayName=`Primitive.${i}`,{...n,[i]:c}},{});function Yq(n,i){n&&hb.flushSync(()=>n.dispatchEvent(i))}function Sl(n){const i=X.useRef(n);return X.useEffect(()=>{i.current=n}),X.useMemo(()=>(...o)=>{var c;return(c=i.current)==null?void 0:c.call(i,...o)},[])}function C_e(n,i=globalThis==null?void 0:globalThis.document){const o=Sl(n);X.useEffect(()=>{const c=d=>{d.key==="Escape"&&o(d)};return i.addEventListener("keydown",c,{capture:!0}),()=>i.removeEventListener("keydown",c,{capture:!0})},[o,i])}var R_e="DismissableLayer",fD="dismissableLayer.update",A_e="dismissableLayer.pointerDownOutside",N_e="dismissableLayer.focusOutside",mW,$q=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),rk=X.forwardRef((n,i)=>{const{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:_,onDismiss:v,...x}=n,T=X.useContext($q),[w,R]=X.useState(null),I=(w==null?void 0:w.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,j]=X.useState({}),P=Ks(i,A=>R(A)),k=Array.from(T.layers),[W]=[...T.layersWithOutsidePointerEventsDisabled].slice(-1),H=k.indexOf(W),L=w?k.indexOf(w):-1,V=T.layersWithOutsidePointerEventsDisabled.size>0,K=L>=H,te=O_e(A=>{const de=A.target,ue=[...T.branches].some(oe=>oe.contains(de));!K||ue||(d==null||d(A),_==null||_(A),A.defaultPrevented||v==null||v())},I),ie=D_e(A=>{const de=A.target;[...T.branches].some(oe=>oe.contains(de))||(f==null||f(A),_==null||_(A),A.defaultPrevented||v==null||v())},I);return C_e(A=>{L===T.layers.size-1&&(c==null||c(A),!A.defaultPrevented&&v&&(A.preventDefault(),v()))},I),X.useEffect(()=>{if(w)return o&&(T.layersWithOutsidePointerEventsDisabled.size===0&&(mW=I.body.style.pointerEvents,I.body.style.pointerEvents="none"),T.layersWithOutsidePointerEventsDisabled.add(w)),T.layers.add(w),gW(),()=>{o&&T.layersWithOutsidePointerEventsDisabled.size===1&&(I.body.style.pointerEvents=mW)}},[w,I,o,T]),X.useEffect(()=>()=>{w&&(T.layers.delete(w),T.layersWithOutsidePointerEventsDisabled.delete(w),gW())},[w,T]),X.useEffect(()=>{const A=()=>j({});return document.addEventListener(fD,A),()=>document.removeEventListener(fD,A)},[]),h.jsx(Wi.div,{...x,ref:P,style:{pointerEvents:V?K?"auto":"none":void 0,...n.style},onFocusCapture:Vi(n.onFocusCapture,ie.onFocusCapture),onBlurCapture:Vi(n.onBlurCapture,ie.onBlurCapture),onPointerDownCapture:Vi(n.onPointerDownCapture,te.onPointerDownCapture)})});rk.displayName=R_e;var I_e="DismissableLayerBranch",Xq=X.forwardRef((n,i)=>{const o=X.useContext($q),c=X.useRef(null),d=Ks(i,c);return X.useEffect(()=>{const f=c.current;if(f)return o.branches.add(f),()=>{o.branches.delete(f)}},[o.branches]),h.jsx(Wi.div,{...n,ref:d})});Xq.displayName=I_e;function O_e(n,i=globalThis==null?void 0:globalThis.document){const o=Sl(n),c=X.useRef(!1),d=X.useRef(()=>{});return X.useEffect(()=>{const f=v=>{if(v.target&&!c.current){let x=function(){Jq(A_e,o,T,{discrete:!0})};const T={originalEvent:v};v.pointerType==="touch"?(i.removeEventListener("click",d.current),d.current=x,i.addEventListener("click",d.current,{once:!0})):x()}else i.removeEventListener("click",d.current);c.current=!1},_=window.setTimeout(()=>{i.addEventListener("pointerdown",f)},0);return()=>{window.clearTimeout(_),i.removeEventListener("pointerdown",f),i.removeEventListener("click",d.current)}},[i,o]),{onPointerDownCapture:()=>c.current=!0}}function D_e(n,i=globalThis==null?void 0:globalThis.document){const o=Sl(n),c=X.useRef(!1);return X.useEffect(()=>{const d=f=>{f.target&&!c.current&&Jq(N_e,o,{originalEvent:f},{discrete:!1})};return i.addEventListener("focusin",d),()=>i.removeEventListener("focusin",d)},[i,o]),{onFocusCapture:()=>c.current=!0,onBlurCapture:()=>c.current=!1}}function gW(){const n=new CustomEvent(fD);document.dispatchEvent(n)}function Jq(n,i,o,{discrete:c}){const d=o.originalEvent.target,f=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:o});i&&d.addEventListener(n,i,{once:!0}),c?Yq(d,f):d.dispatchEvent(f)}var P_e=rk,k_e=Xq,xl=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},L_e="Portal",ik=X.forwardRef((n,i)=>{var v;const{container:o,...c}=n,[d,f]=X.useState(!1);xl(()=>f(!0),[]);const _=o||d&&((v=globalThis==null?void 0:globalThis.document)==null?void 0:v.body);return _?F0e.createPortal(h.jsx(Wi.div,{...c,ref:i}),_):null});ik.displayName=L_e;function M_e(n,i){return X.useReducer((o,c)=>i[o][c]??o,n)}var t0=n=>{const{present:i,children:o}=n,c=j_e(i),d=typeof o=="function"?o({present:c.isPresent}):X.Children.only(o),f=Ks(c.ref,U_e(d));return typeof o=="function"||c.isPresent?X.cloneElement(d,{ref:f}):null};t0.displayName="Presence";function j_e(n){const[i,o]=X.useState(),c=X.useRef(null),d=X.useRef(n),f=X.useRef("none"),_=n?"mounted":"unmounted",[v,x]=M_e(_,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const T=sx(c.current);f.current=v==="mounted"?T:"none"},[v]),xl(()=>{const T=c.current,w=d.current;if(w!==n){const I=f.current,j=sx(T);n?x("MOUNT"):j==="none"||(T==null?void 0:T.display)==="none"?x("UNMOUNT"):x(w&&I!==j?"ANIMATION_OUT":"UNMOUNT"),d.current=n}},[n,x]),xl(()=>{if(i){let T;const w=i.ownerDocument.defaultView??window,R=j=>{const k=sx(c.current).includes(j.animationName);if(j.target===i&&k&&(x("ANIMATION_END"),!d.current)){const W=i.style.animationFillMode;i.style.animationFillMode="forwards",T=w.setTimeout(()=>{i.style.animationFillMode==="forwards"&&(i.style.animationFillMode=W)})}},I=j=>{j.target===i&&(f.current=sx(c.current))};return i.addEventListener("animationstart",I),i.addEventListener("animationcancel",R),i.addEventListener("animationend",R),()=>{w.clearTimeout(T),i.removeEventListener("animationstart",I),i.removeEventListener("animationcancel",R),i.removeEventListener("animationend",R)}}else x("ANIMATION_END")},[i,x]),{isPresent:["mounted","unmountSuspended"].includes(v),ref:X.useCallback(T=>{c.current=T?getComputedStyle(T):null,o(T)},[])}}function sx(n){return(n==null?void 0:n.animationName)||"none"}function U_e(n){var c,d;let i=(c=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:c.get,o=i&&"isReactWarning"in i&&i.isReactWarning;return o?n.ref:(i=(d=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:d.get,o=i&&"isReactWarning"in i&&i.isReactWarning,o?n.props.ref:n.props.ref||n.ref)}var F_e=cP[" useInsertionEffect ".trim().toString()]||xl;function yE({prop:n,defaultProp:i,onChange:o=()=>{},caller:c}){const[d,f,_]=V_e({defaultProp:i,onChange:o}),v=n!==void 0,x=v?n:d;{const w=X.useRef(n!==void 0);X.useEffect(()=>{const R=w.current;R!==v&&console.warn(`${c} is changing from ${R?"controlled":"uncontrolled"} to ${v?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),w.current=v},[v,c])}const T=X.useCallback(w=>{var R;if(v){const I=B_e(w)?w(n):w;I!==n&&((R=_.current)==null||R.call(_,I))}else f(w)},[v,n,f,_]);return[x,T]}function V_e({defaultProp:n,onChange:i}){const[o,c]=X.useState(n),d=X.useRef(o),f=X.useRef(i);return F_e(()=>{f.current=i},[i]),X.useEffect(()=>{var _;d.current!==o&&((_=f.current)==null||_.call(f,o),d.current=o)},[o,d]),[o,c,f]}function B_e(n){return typeof n=="function"}var W_e=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),H_e="VisuallyHidden",sk=X.forwardRef((n,i)=>h.jsx(Wi.span,{...n,ref:i,style:{...W_e,...n.style}}));sk.displayName=H_e;var ok="ToastProvider",[ak,G_e,z_e]=b_e("Toast"),[Qq,JIe]=Sp("Toast",[z_e]),[K_e,gb]=Qq(ok),Zq=n=>{const{__scopeToast:i,label:o="Notification",duration:c=5e3,swipeDirection:d="right",swipeThreshold:f=50,children:_}=n,[v,x]=X.useState(null),[T,w]=X.useState(0),R=X.useRef(!1),I=X.useRef(!1);return o.trim()||console.error(`Invalid prop \`label\` supplied to \`${ok}\`. Expected non-empty \`string\`.`),h.jsx(ak.Provider,{scope:i,children:h.jsx(K_e,{scope:i,label:o,duration:c,swipeDirection:d,swipeThreshold:f,toastCount:T,viewport:v,onViewportChange:x,onToastAdd:X.useCallback(()=>w(j=>j+1),[]),onToastRemove:X.useCallback(()=>w(j=>j-1),[]),isFocusedToastEscapeKeyDownRef:R,isClosePausedRef:I,children:_})})};Zq.displayName=ok;var eY="ToastViewport",q_e=["F8"],mD="toast.viewportPause",gD="toast.viewportResume",tY=X.forwardRef((n,i)=>{const{__scopeToast:o,hotkey:c=q_e,label:d="Notifications ({hotkey})",...f}=n,_=gb(eY,o),v=G_e(o),x=X.useRef(null),T=X.useRef(null),w=X.useRef(null),R=X.useRef(null),I=Ks(i,R,_.onViewportChange),j=c.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=_.toastCount>0;X.useEffect(()=>{const W=H=>{var V;c.length!==0&&c.every(K=>H[K]||H.code===K)&&((V=R.current)==null||V.focus())};return document.addEventListener("keydown",W),()=>document.removeEventListener("keydown",W)},[c]),X.useEffect(()=>{const W=x.current,H=R.current;if(P&&W&&H){const L=()=>{if(!_.isClosePausedRef.current){const ie=new CustomEvent(mD);H.dispatchEvent(ie),_.isClosePausedRef.current=!0}},V=()=>{if(_.isClosePausedRef.current){const ie=new CustomEvent(gD);H.dispatchEvent(ie),_.isClosePausedRef.current=!1}},K=ie=>{!W.contains(ie.relatedTarget)&&V()},te=()=>{W.contains(document.activeElement)||V()};return W.addEventListener("focusin",L),W.addEventListener("focusout",K),W.addEventListener("pointermove",L),W.addEventListener("pointerleave",te),window.addEventListener("blur",L),window.addEventListener("focus",V),()=>{W.removeEventListener("focusin",L),W.removeEventListener("focusout",K),W.removeEventListener("pointermove",L),W.removeEventListener("pointerleave",te),window.removeEventListener("blur",L),window.removeEventListener("focus",V)}}},[P,_.isClosePausedRef]);const k=X.useCallback(({tabbingDirection:W})=>{const L=v().map(V=>{const K=V.ref.current,te=[K,...oEe(K)];return W==="forwards"?te:te.reverse()});return(W==="forwards"?L.reverse():L).flat()},[v]);return X.useEffect(()=>{const W=R.current;if(W){const H=L=>{var te,ie,A;const V=L.altKey||L.ctrlKey||L.metaKey;if(L.key==="Tab"&&!V){const de=document.activeElement,ue=L.shiftKey;if(L.target===W&&ue){(te=T.current)==null||te.focus();return}const Ee=k({tabbingDirection:ue?"backwards":"forwards"}),xe=Ee.findIndex(Oe=>Oe===de);YN(Ee.slice(xe+1))?L.preventDefault():ue?(ie=T.current)==null||ie.focus():(A=w.current)==null||A.focus()}};return W.addEventListener("keydown",H),()=>W.removeEventListener("keydown",H)}},[v,k]),h.jsxs(k_e,{ref:x,role:"region","aria-label":d.replace("{hotkey}",j),tabIndex:-1,style:{pointerEvents:P?void 0:"none"},children:[P&&h.jsx(_D,{ref:T,onFocusFromOutsideViewport:()=>{const W=k({tabbingDirection:"forwards"});YN(W)}}),h.jsx(ak.Slot,{scope:o,children:h.jsx(Wi.ol,{tabIndex:-1,...f,ref:I})}),P&&h.jsx(_D,{ref:w,onFocusFromOutsideViewport:()=>{const W=k({tabbingDirection:"backwards"});YN(W)}})]})});tY.displayName=eY;var nY="ToastFocusProxy",_D=X.forwardRef((n,i)=>{const{__scopeToast:o,onFocusFromOutsideViewport:c,...d}=n,f=gb(nY,o);return h.jsx(sk,{"aria-hidden":!0,tabIndex:0,...d,ref:i,style:{position:"fixed"},onFocus:_=>{var T;const v=_.relatedTarget;!((T=f.viewport)!=null&&T.contains(v))&&c()}})});_D.displayName=nY;var SE="Toast",Y_e="toast.swipeStart",$_e="toast.swipeMove",X_e="toast.swipeCancel",J_e="toast.swipeEnd",rY=X.forwardRef((n,i)=>{const{forceMount:o,open:c,defaultOpen:d,onOpenChange:f,..._}=n,[v,x]=yE({prop:c,defaultProp:d??!0,onChange:f,caller:SE});return h.jsx(t0,{present:o||v,children:h.jsx(eEe,{open:v,..._,ref:i,onClose:()=>x(!1),onPause:Sl(n.onPause),onResume:Sl(n.onResume),onSwipeStart:Vi(n.onSwipeStart,T=>{T.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Vi(n.onSwipeMove,T=>{const{x:w,y:R}=T.detail.delta;T.currentTarget.setAttribute("data-swipe","move"),T.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${w}px`),T.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${R}px`)}),onSwipeCancel:Vi(n.onSwipeCancel,T=>{T.currentTarget.setAttribute("data-swipe","cancel"),T.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),T.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),T.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),T.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Vi(n.onSwipeEnd,T=>{const{x:w,y:R}=T.detail.delta;T.currentTarget.setAttribute("data-swipe","end"),T.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),T.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),T.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${w}px`),T.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${R}px`),x(!1)})})})});rY.displayName=SE;var[Q_e,Z_e]=Qq(SE,{onClose(){}}),eEe=X.forwardRef((n,i)=>{const{__scopeToast:o,type:c="foreground",duration:d,open:f,onClose:_,onEscapeKeyDown:v,onPause:x,onResume:T,onSwipeStart:w,onSwipeMove:R,onSwipeCancel:I,onSwipeEnd:j,...P}=n,k=gb(SE,o),[W,H]=X.useState(null),L=Ks(i,Oe=>H(Oe)),V=X.useRef(null),K=X.useRef(null),te=d||k.duration,ie=X.useRef(0),A=X.useRef(te),de=X.useRef(0),{onToastAdd:ue,onToastRemove:oe}=k,ye=Sl(()=>{var ct;(W==null?void 0:W.contains(document.activeElement))&&((ct=k.viewport)==null||ct.focus()),_()}),Ee=X.useCallback(Oe=>{!Oe||Oe===1/0||(window.clearTimeout(de.current),ie.current=new Date().getTime(),de.current=window.setTimeout(ye,Oe))},[ye]);X.useEffect(()=>{const Oe=k.viewport;if(Oe){const ct=()=>{Ee(A.current),T==null||T()},at=()=>{const lt=new Date().getTime()-ie.current;A.current=A.current-lt,window.clearTimeout(de.current),x==null||x()};return Oe.addEventListener(mD,at),Oe.addEventListener(gD,ct),()=>{Oe.removeEventListener(mD,at),Oe.removeEventListener(gD,ct)}}},[k.viewport,te,x,T,Ee]),X.useEffect(()=>{f&&!k.isClosePausedRef.current&&Ee(te)},[f,te,k.isClosePausedRef,Ee]),X.useEffect(()=>(ue(),()=>oe()),[ue,oe]);const xe=X.useMemo(()=>W?dY(W):null,[W]);return k.viewport?h.jsxs(h.Fragment,{children:[xe&&h.jsx(tEe,{__scopeToast:o,role:"status","aria-live":c==="foreground"?"assertive":"polite","aria-atomic":!0,children:xe}),h.jsx(Q_e,{scope:o,onClose:ye,children:hb.createPortal(h.jsx(ak.ItemSlot,{scope:o,children:h.jsx(P_e,{asChild:!0,onEscapeKeyDown:Vi(v,()=>{k.isFocusedToastEscapeKeyDownRef.current||ye(),k.isFocusedToastEscapeKeyDownRef.current=!1}),children:h.jsx(Wi.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":f?"open":"closed","data-swipe-direction":k.swipeDirection,...P,ref:L,style:{userSelect:"none",touchAction:"none",...n.style},onKeyDown:Vi(n.onKeyDown,Oe=>{Oe.key==="Escape"&&(v==null||v(Oe.nativeEvent),Oe.nativeEvent.defaultPrevented||(k.isFocusedToastEscapeKeyDownRef.current=!0,ye()))}),onPointerDown:Vi(n.onPointerDown,Oe=>{Oe.button===0&&(V.current={x:Oe.clientX,y:Oe.clientY})}),onPointerMove:Vi(n.onPointerMove,Oe=>{if(!V.current)return;const ct=Oe.clientX-V.current.x,at=Oe.clientY-V.current.y,lt=!!K.current,He=["left","right"].includes(k.swipeDirection),et=["left","up"].includes(k.swipeDirection)?Math.min:Math.max,ut=He?et(0,ct):0,Ae=He?0:et(0,at),Le=Oe.pointerType==="touch"?10:2,ze={x:ut,y:Ae},qe={originalEvent:Oe,delta:ze};lt?(K.current=ze,ox($_e,R,qe,{discrete:!1})):_W(ze,k.swipeDirection,Le)?(K.current=ze,ox(Y_e,w,qe,{discrete:!1}),Oe.target.setPointerCapture(Oe.pointerId)):(Math.abs(ct)>Le||Math.abs(at)>Le)&&(V.current=null)}),onPointerUp:Vi(n.onPointerUp,Oe=>{const ct=K.current,at=Oe.target;if(at.hasPointerCapture(Oe.pointerId)&&at.releasePointerCapture(Oe.pointerId),K.current=null,V.current=null,ct){const lt=Oe.currentTarget,He={originalEvent:Oe,delta:ct};_W(ct,k.swipeDirection,k.swipeThreshold)?ox(J_e,j,He,{discrete:!0}):ox(X_e,I,He,{discrete:!0}),lt.addEventListener("click",et=>et.preventDefault(),{once:!0})}})})})}),k.viewport)})]}):null}),tEe=n=>{const{__scopeToast:i,children:o,...c}=n,d=gb(SE,i),[f,_]=X.useState(!1),[v,x]=X.useState(!1);return iEe(()=>_(!0)),X.useEffect(()=>{const T=window.setTimeout(()=>x(!0),1e3);return()=>window.clearTimeout(T)},[]),v?null:h.jsx(ik,{asChild:!0,children:h.jsx(sk,{...c,children:f&&h.jsxs(h.Fragment,{children:[d.label," ",o]})})})},nEe="ToastTitle",iY=X.forwardRef((n,i)=>{const{__scopeToast:o,...c}=n;return h.jsx(Wi.div,{...c,ref:i})});iY.displayName=nEe;var rEe="ToastDescription",sY=X.forwardRef((n,i)=>{const{__scopeToast:o,...c}=n;return h.jsx(Wi.div,{...c,ref:i})});sY.displayName=rEe;var oY="ToastAction",aY=X.forwardRef((n,i)=>{const{altText:o,...c}=n;return o.trim()?h.jsx(lY,{altText:o,asChild:!0,children:h.jsx(ck,{...c,ref:i})}):(console.error(`Invalid prop \`altText\` supplied to \`${oY}\`. Expected non-empty \`string\`.`),null)});aY.displayName=oY;var cY="ToastClose",ck=X.forwardRef((n,i)=>{const{__scopeToast:o,...c}=n,d=Z_e(cY,o);return h.jsx(lY,{asChild:!0,children:h.jsx(Wi.button,{type:"button",...c,ref:i,onClick:Vi(n.onClick,d.onClose)})})});ck.displayName=cY;var lY=X.forwardRef((n,i)=>{const{__scopeToast:o,altText:c,...d}=n;return h.jsx(Wi.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":c||void 0,...d,ref:i})});function dY(n){const i=[];return Array.from(n.childNodes).forEach(c=>{if(c.nodeType===c.TEXT_NODE&&c.textContent&&i.push(c.textContent),sEe(c)){const d=c.ariaHidden||c.hidden||c.style.display==="none",f=c.dataset.radixToastAnnounceExclude==="";if(!d)if(f){const _=c.dataset.radixToastAnnounceAlt;_&&i.push(_)}else i.push(...dY(c))}}),i}function ox(n,i,o,{discrete:c}){const d=o.originalEvent.currentTarget,f=new CustomEvent(n,{bubbles:!0,cancelable:!0,detail:o});i&&d.addEventListener(n,i,{once:!0}),c?Yq(d,f):d.dispatchEvent(f)}var _W=(n,i,o=0)=>{const c=Math.abs(n.x),d=Math.abs(n.y),f=c>d;return i==="left"||i==="right"?f&&c>o:!f&&d>o};function iEe(n=()=>{}){const i=Sl(n);xl(()=>{let o=0,c=0;return o=window.requestAnimationFrame(()=>c=window.requestAnimationFrame(i)),()=>{window.cancelAnimationFrame(o),window.cancelAnimationFrame(c)}},[i])}function sEe(n){return n.nodeType===n.ELEMENT_NODE}function oEe(n){const i=[],o=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const d=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||d?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)i.push(o.currentNode);return i}function YN(n){const i=document.activeElement;return n.some(o=>o===i?!0:(o.focus(),document.activeElement!==i))}var aEe=Zq,uY=tY,hY=rY,pY=iY,fY=sY,mY=aY,gY=ck;const EW=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,vW=Wq,_b=(n,i)=>o=>{var c;if((i==null?void 0:i.variants)==null)return vW(n,o==null?void 0:o.class,o==null?void 0:o.className);const{variants:d,defaultVariants:f}=i,_=Object.keys(d).map(T=>{const w=o==null?void 0:o[T],R=f==null?void 0:f[T];if(w===null)return null;const I=EW(w)||EW(R);return d[T][I]}),v=o&&Object.entries(o).reduce((T,w)=>{let[R,I]=w;return I===void 0||(T[R]=I),T},{}),x=i==null||(c=i.compoundVariants)===null||c===void 0?void 0:c.reduce((T,w)=>{let{class:R,className:I,...j}=w;return Object.entries(j).every(P=>{let[k,W]=P;return Array.isArray(W)?W.includes({...f,...v}[k]):{...f,...v}[k]===W})?[...T,R,I]:T},[]);return vW(n,_,x,o==null?void 0:o.class,o==null?void 0:o.className)};var cEe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lEe=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),At=(n,i)=>{const o=X.forwardRef(({color:c="currentColor",size:d=24,strokeWidth:f=2,absoluteStrokeWidth:_,children:v,...x},T)=>X.createElement("svg",{ref:T,...cEe,width:d,height:d,stroke:c,strokeWidth:_?Number(f)*24/Number(d):f,className:`lucide lucide-${lEe(n)}`,...x},[...i.map(([w,R])=>X.createElement(w,R)),...(Array.isArray(v)?v:[v])||[]]));return o.displayName=`${n}`,o},Fm=At("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),lk=At("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),_Y=At("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),dk=At("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),dEe=At("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),fd=At("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Eb=At("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),EY=At("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),uEe=At("CalendarCheck2",[["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]),hEe=At("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),pEe=At("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),fEe=At("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),ED=At("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),mEe=At("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),$N=At("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),vY=At("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),yY=At("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),gEe=At("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),_Ee=At("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),EEe=At("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),vEe=At("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]),yEe=At("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),SEe=At("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),uk=At("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),SY=At("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),xEe=At("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),hk=At("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),n0=At("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),TEe=At("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),xY=At("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),bEe=At("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),wEe=At("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),CEe=At("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),Vm=At("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Tl=At("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ad=At("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),pk=At("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),REe=At("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),vb=At("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),dp=At("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),AEe=At("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),NEe=At("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),IEe=At("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ST=At("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]),Iu=At("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),xT=At("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),OEe=At("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),DEe=At("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"12",key:"aemgbe"}]]),PEe=At("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),kEe=At("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Ou=At("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),LEe=At("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),fk=At("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),mk=At("ShieldX",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m14.5 9-5 5",key:"1m49dw"}],["path",{d:"m9.5 9 5 5",key:"wyx7zg"}]]),TY=At("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),MEe=At("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),yW=At("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),jEe=At("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),UEe=At("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),oo=At("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),bY=At("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),FEe=At("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),VEe=At("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),TT=At("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),BEe=At("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),ea=At("UserCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),WEe=At("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),$h=At("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),cd=At("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),bT=At("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),HEe=At("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),xp=At("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),GEe=At("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),zEe=At("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),KEe=aEe,wY=wt.forwardRef(({className:n,...i},o)=>h.jsx(uY,{ref:o,className:Ir("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...i}));wY.displayName=uY.displayName;const qEe=_b("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),CY=wt.forwardRef(({className:n,variant:i,...o},c)=>h.jsx(hY,{ref:c,className:Ir(qEe({variant:i}),n),...o}));CY.displayName=hY.displayName;const YEe=wt.forwardRef(({className:n,...i},o)=>h.jsx(mY,{ref:o,className:Ir("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...i}));YEe.displayName=mY.displayName;const RY=wt.forwardRef(({className:n,...i},o)=>h.jsx(gY,{ref:o,className:Ir("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...i,children:h.jsx(xp,{className:"h-4 w-4"})}));RY.displayName=gY.displayName;const AY=wt.forwardRef(({className:n,...i},o)=>h.jsx(pY,{ref:o,className:Ir("text-sm font-semibold",n),...i}));AY.displayName=pY.displayName;const NY=wt.forwardRef(({className:n,...i},o)=>h.jsx(fY,{ref:o,className:Ir("text-sm opacity-90",n),...i}));NY.displayName=fY.displayName;const $Ee=1;let XN=0;function XEe(){return XN=(XN+1)%Number.MAX_VALUE,XN.toString()}const to={state:{toasts:[]},listeners:[],getState:()=>to.state,setState:n=>{typeof n=="function"?to.state=n(to.state):to.state={...to.state,...n},to.listeners.forEach(i=>i(to.state))},subscribe:n=>(to.listeners.push(n),()=>{to.listeners=to.listeners.filter(i=>i!==n)})},vD=({...n})=>{const i=XEe(),o=d=>to.setState(f=>({...f,toasts:f.toasts.map(_=>_.id===i?{..._,...d}:_)})),c=()=>to.setState(d=>({...d,toasts:d.toasts.filter(f=>f.id!==i)}));return to.setState(d=>({...d,toasts:[{...n,id:i,dismiss:c},...d.toasts].slice(0,$Ee)})),{id:i,dismiss:c,update:o}};function gk(){const[n,i]=X.useState(to.getState());return X.useEffect(()=>to.subscribe(c=>{i(c)}),[]),X.useEffect(()=>{const o=[];return n.toasts.forEach(c=>{if(c.duration===1/0)return;const d=setTimeout(()=>{c.dismiss()},c.duration||5e3);o.push(d)}),()=>{o.forEach(c=>clearTimeout(c))}},[n.toasts]),{toast:vD,toasts:n.toasts}}function JEe(){const{toasts:n}=gk();return h.jsxs(KEe,{children:[n.map(({id:i,title:o,description:c,action:d,...f})=>h.jsxs(CY,{...f,children:[h.jsxs("div",{className:"grid gap-1",children:[o&&h.jsx(AY,{children:o}),c&&h.jsx(NY,{children:c})]}),d,h.jsx(RY,{})]},i)),h.jsx(wY,{})]})}const IY=X.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"}),yb=X.createContext({}),_k=X.createContext(null),Sb=typeof document<"u",QEe=Sb?X.useLayoutEffect:X.useEffect,OY=X.createContext({strict:!1}),Ek=n=>n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ZEe="framerAppearId",DY="data-"+Ek(ZEe);function eve(n,i,o,c){const{visualElement:d}=X.useContext(yb),f=X.useContext(OY),_=X.useContext(_k),v=X.useContext(IY).reducedMotion,x=X.useRef();c=c||f.renderer,!x.current&&c&&(x.current=c(n,{visualState:i,parent:d,props:o,presenceContext:_,blockInitialAnimation:_?_.initial===!1:!1,reducedMotionConfig:v}));const T=x.current;X.useInsertionEffect(()=>{T&&T.update(o,_)});const w=X.useRef(!!(o[DY]&&!window.HandoffComplete));return QEe(()=>{T&&(T.render(),w.current&&T.animationState&&T.animationState.animateChanges())}),X.useEffect(()=>{T&&(T.updateFeatures(),!w.current&&T.animationState&&T.animationState.animateChanges(),w.current&&(w.current=!1,window.HandoffComplete=!0))}),T}function vm(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function tve(n,i,o){return X.useCallback(c=>{c&&n.mount&&n.mount(c),i&&(c?i.mount(c):i.unmount()),o&&(typeof o=="function"?o(c):vm(o)&&(o.current=c))},[i])}function oE(n){return typeof n=="string"||Array.isArray(n)}function xb(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}const vk=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],yk=["initial",...vk];function Tb(n){return xb(n.animate)||yk.some(i=>oE(n[i]))}function PY(n){return!!(Tb(n)||n.variants)}function nve(n,i){if(Tb(n)){const{initial:o,animate:c}=n;return{initial:o===!1||oE(o)?o:void 0,animate:oE(c)?c:void 0}}return n.inherit!==!1?i:{}}function rve(n){const{initial:i,animate:o}=nve(n,X.useContext(yb));return X.useMemo(()=>({initial:i,animate:o}),[SW(i),SW(o)])}function SW(n){return Array.isArray(n)?n.join(" "):n}const xW={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},aE={};for(const n in xW)aE[n]={isEnabled:i=>xW[n].some(o=>!!i[o])};function ive(n){for(const i in n)aE[i]={...aE[i],...n[i]}}const kY=X.createContext({}),LY=X.createContext({}),sve=Symbol.for("motionComponentSymbol");function ove({preloadedFeatures:n,createVisualElement:i,useRender:o,useVisualState:c,Component:d}){n&&ive(n);function f(v,x){let T;const w={...X.useContext(IY),...v,layoutId:ave(v)},{isStatic:R}=w,I=rve(v),j=c(v,R);if(!R&&Sb){I.visualElement=eve(d,j,w,i);const P=X.useContext(LY),k=X.useContext(OY).strict;I.visualElement&&(T=I.visualElement.loadFeatures(w,k,n,P))}return X.createElement(yb.Provider,{value:I},T&&I.visualElement?X.createElement(T,{visualElement:I.visualElement,...w}):null,o(d,v,tve(j,I.visualElement,x),j,R,I.visualElement))}const _=X.forwardRef(f);return _[sve]=d,_}function ave({layoutId:n}){const i=X.useContext(kY).id;return i&&n!==void 0?i+"-"+n:n}function cve(n){function i(c,d={}){return ove(n(c,d))}if(typeof Proxy>"u")return i;const o=new Map;return new Proxy(i,{get:(c,d)=>(o.has(d)||o.set(d,i(d)),o.get(d))})}const lve=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Sk(n){return typeof n!="string"||n.includes("-")?!1:!!(lve.indexOf(n)>-1||/[A-Z]/.test(n))}const wT={};function dve(n){Object.assign(wT,n)}const xE=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Tp=new Set(xE);function MY(n,{layout:i,layoutId:o}){return Tp.has(n)||n.startsWith("origin")||(i||o!==void 0)&&(!!wT[n]||n==="opacity")}const Mo=n=>!!(n&&n.getVelocity),uve={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hve=xE.length;function pve(n,{enableHardwareAcceleration:i=!0,allowTransformNone:o=!0},c,d){let f="";for(let _=0;_<hve;_++){const v=xE[_];if(n[v]!==void 0){const x=uve[v]||v;f+=`${x}(${n[v]}) `}}return i&&!n.z&&(f+="translateZ(0)"),f=f.trim(),d?f=d(n,c?"":f):o&&c&&(f="none"),f}const jY=n=>i=>typeof i=="string"&&i.startsWith(n),UY=jY("--"),yD=jY("var(--"),fve=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,mve=(n,i)=>i&&typeof n=="number"?i.transform(n):n,bu=(n,i,o)=>Math.min(Math.max(o,n),i),bp={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},I_={...bp,transform:n=>bu(0,1,n)},ax={...bp,default:1},O_=n=>Math.round(n*1e5)/1e5,bb=/(-)?([\d]*\.?[\d])+/g,FY=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,gve=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function TE(n){return typeof n=="string"}const bE=n=>({test:i=>TE(i)&&i.endsWith(n)&&i.split(" ").length===1,parse:parseFloat,transform:i=>`${i}${n}`}),Zd=bE("deg"),yl=bE("%"),sn=bE("px"),_ve=bE("vh"),Eve=bE("vw"),TW={...yl,parse:n=>yl.parse(n)/100,transform:n=>yl.transform(n*100)},bW={...bp,transform:Math.round},VY={borderWidth:sn,borderTopWidth:sn,borderRightWidth:sn,borderBottomWidth:sn,borderLeftWidth:sn,borderRadius:sn,radius:sn,borderTopLeftRadius:sn,borderTopRightRadius:sn,borderBottomRightRadius:sn,borderBottomLeftRadius:sn,width:sn,maxWidth:sn,height:sn,maxHeight:sn,size:sn,top:sn,right:sn,bottom:sn,left:sn,padding:sn,paddingTop:sn,paddingRight:sn,paddingBottom:sn,paddingLeft:sn,margin:sn,marginTop:sn,marginRight:sn,marginBottom:sn,marginLeft:sn,rotate:Zd,rotateX:Zd,rotateY:Zd,rotateZ:Zd,scale:ax,scaleX:ax,scaleY:ax,scaleZ:ax,skew:Zd,skewX:Zd,skewY:Zd,distance:sn,translateX:sn,translateY:sn,translateZ:sn,x:sn,y:sn,z:sn,perspective:sn,transformPerspective:sn,opacity:I_,originX:TW,originY:TW,originZ:sn,zIndex:bW,fillOpacity:I_,strokeOpacity:I_,numOctaves:bW};function xk(n,i,o,c){const{style:d,vars:f,transform:_,transformOrigin:v}=n;let x=!1,T=!1,w=!0;for(const R in i){const I=i[R];if(UY(R)){f[R]=I;continue}const j=VY[R],P=mve(I,j);if(Tp.has(R)){if(x=!0,_[R]=P,!w)continue;I!==(j.default||0)&&(w=!1)}else R.startsWith("origin")?(T=!0,v[R]=P):d[R]=P}if(i.transform||(x||c?d.transform=pve(n.transform,o,w,c):d.transform&&(d.transform="none")),T){const{originX:R="50%",originY:I="50%",originZ:j=0}=v;d.transformOrigin=`${R} ${I} ${j}`}}const Tk=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function BY(n,i,o){for(const c in i)!Mo(i[c])&&!MY(c,o)&&(n[c]=i[c])}function vve({transformTemplate:n},i,o){return X.useMemo(()=>{const c=Tk();return xk(c,i,{enableHardwareAcceleration:!o},n),Object.assign({},c.vars,c.style)},[i])}function yve(n,i,o){const c=n.style||{},d={};return BY(d,c,n),Object.assign(d,vve(n,i,o)),n.transformValues?n.transformValues(d):d}function Sve(n,i,o){const c={},d=yve(n,i,o);return n.drag&&n.dragListener!==!1&&(c.draggable=!1,d.userSelect=d.WebkitUserSelect=d.WebkitTouchCallout="none",d.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(c.tabIndex=0),c.style=d,c}const xve=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function CT(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||xve.has(n)}let WY=n=>!CT(n);function Tve(n){n&&(WY=i=>i.startsWith("on")?!CT(i):n(i))}try{Tve(require("@emotion/is-prop-valid").default)}catch{}function bve(n,i,o){const c={};for(const d in n)d==="values"&&typeof n.values=="object"||(WY(d)||o===!0&&CT(d)||!i&&!CT(d)||n.draggable&&d.startsWith("onDrag"))&&(c[d]=n[d]);return c}function wW(n,i,o){return typeof n=="string"?n:sn.transform(i+o*n)}function wve(n,i,o){const c=wW(i,n.x,n.width),d=wW(o,n.y,n.height);return`${c} ${d}`}const Cve={offset:"stroke-dashoffset",array:"stroke-dasharray"},Rve={offset:"strokeDashoffset",array:"strokeDasharray"};function Ave(n,i,o=1,c=0,d=!0){n.pathLength=1;const f=d?Cve:Rve;n[f.offset]=sn.transform(-c);const _=sn.transform(i),v=sn.transform(o);n[f.array]=`${_} ${v}`}function bk(n,{attrX:i,attrY:o,attrScale:c,originX:d,originY:f,pathLength:_,pathSpacing:v=1,pathOffset:x=0,...T},w,R,I){if(xk(n,T,w,I),R){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:j,style:P,dimensions:k}=n;j.transform&&(k&&(P.transform=j.transform),delete j.transform),k&&(d!==void 0||f!==void 0||P.transform)&&(P.transformOrigin=wve(k,d!==void 0?d:.5,f!==void 0?f:.5)),i!==void 0&&(j.x=i),o!==void 0&&(j.y=o),c!==void 0&&(j.scale=c),_!==void 0&&Ave(j,_,v,x,!1)}const HY=()=>({...Tk(),attrs:{}}),wk=n=>typeof n=="string"&&n.toLowerCase()==="svg";function Nve(n,i,o,c){const d=X.useMemo(()=>{const f=HY();return bk(f,i,{enableHardwareAcceleration:!1},wk(c),n.transformTemplate),{...f.attrs,style:{...f.style}}},[i]);if(n.style){const f={};BY(f,n.style,n),d.style={...f,...d.style}}return d}function Ive(n=!1){return(o,c,d,{latestValues:f},_)=>{const x=(Sk(o)?Nve:Sve)(c,f,_,o),w={...bve(c,typeof o=="string",n),...x,ref:d},{children:R}=c,I=X.useMemo(()=>Mo(R)?R.get():R,[R]);return X.createElement(o,{...w,children:I})}}function GY(n,{style:i,vars:o},c,d){Object.assign(n.style,i,d&&d.getProjectionStyles(c));for(const f in o)n.style.setProperty(f,o[f])}const zY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function KY(n,i,o,c){GY(n,i,void 0,c);for(const d in i.attrs)n.setAttribute(zY.has(d)?d:Ek(d),i.attrs[d])}function Ck(n,i){const{style:o}=n,c={};for(const d in o)(Mo(o[d])||i.style&&Mo(i.style[d])||MY(d,n))&&(c[d]=o[d]);return c}function qY(n,i){const o=Ck(n,i);for(const c in n)if(Mo(n[c])||Mo(i[c])){const d=xE.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;o[d]=n[c]}return o}function Rk(n,i,o,c={},d={}){return typeof i=="function"&&(i=i(o!==void 0?o:n.custom,c,d)),typeof i=="string"&&(i=n.variants&&n.variants[i]),typeof i=="function"&&(i=i(o!==void 0?o:n.custom,c,d)),i}function Ove(n){const i=X.useRef(null);return i.current===null&&(i.current=n()),i.current}const RT=n=>Array.isArray(n),Dve=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Pve=n=>RT(n)?n[n.length-1]||0:n;function Dx(n){const i=Mo(n)?n.get():n;return Dve(i)?i.toValue():i}function kve({scrapeMotionValuesFromProps:n,createRenderState:i,onMount:o},c,d,f){const _={latestValues:Lve(c,d,f,n),renderState:i()};return o&&(_.mount=v=>o(c,v,_)),_}const YY=n=>(i,o)=>{const c=X.useContext(yb),d=X.useContext(_k),f=()=>kve(n,i,c,d);return o?f():Ove(f)};function Lve(n,i,o,c){const d={},f=c(n,{});for(const I in f)d[I]=Dx(f[I]);let{initial:_,animate:v}=n;const x=Tb(n),T=PY(n);i&&T&&!x&&n.inherit!==!1&&(_===void 0&&(_=i.initial),v===void 0&&(v=i.animate));let w=o?o.initial===!1:!1;w=w||_===!1;const R=w?v:_;return R&&typeof R!="boolean"&&!xb(R)&&(Array.isArray(R)?R:[R]).forEach(j=>{const P=Rk(n,j);if(!P)return;const{transitionEnd:k,transition:W,...H}=P;for(const L in H){let V=H[L];if(Array.isArray(V)){const K=w?V.length-1:0;V=V[K]}V!==null&&(d[L]=V)}for(const L in k)d[L]=k[L]}),d}const wi=n=>n;class CW{constructor(){this.order=[],this.scheduled=new Set}add(i){if(!this.scheduled.has(i))return this.scheduled.add(i),this.order.push(i),!0}remove(i){const o=this.order.indexOf(i);o!==-1&&(this.order.splice(o,1),this.scheduled.delete(i))}clear(){this.order.length=0,this.scheduled.clear()}}function Mve(n){let i=new CW,o=new CW,c=0,d=!1,f=!1;const _=new WeakSet,v={schedule:(x,T=!1,w=!1)=>{const R=w&&d,I=R?i:o;return T&&_.add(x),I.add(x)&&R&&d&&(c=i.order.length),x},cancel:x=>{o.remove(x),_.delete(x)},process:x=>{if(d){f=!0;return}if(d=!0,[i,o]=[o,i],o.clear(),c=i.order.length,c)for(let T=0;T<c;T++){const w=i.order[T];w(x),_.has(w)&&(v.schedule(w),n())}d=!1,f&&(f=!1,v.process(x))}};return v}const cx=["prepare","read","update","preRender","render","postRender"],jve=40;function Uve(n,i){let o=!1,c=!0;const d={delta:0,timestamp:0,isProcessing:!1},f=cx.reduce((R,I)=>(R[I]=Mve(()=>o=!0),R),{}),_=R=>f[R].process(d),v=()=>{const R=performance.now();o=!1,d.delta=c?1e3/60:Math.max(Math.min(R-d.timestamp,jve),1),d.timestamp=R,d.isProcessing=!0,cx.forEach(_),d.isProcessing=!1,o&&i&&(c=!1,n(v))},x=()=>{o=!0,c=!0,d.isProcessing||n(v)};return{schedule:cx.reduce((R,I)=>{const j=f[I];return R[I]=(P,k=!1,W=!1)=>(o||x(),j.schedule(P,k,W)),R},{}),cancel:R=>cx.forEach(I=>f[I].cancel(R)),state:d,steps:f}}const{schedule:Kr,cancel:ld,state:Bs,steps:JN}=Uve(typeof requestAnimationFrame<"u"?requestAnimationFrame:wi,!0),Fve={useVisualState:YY({scrapeMotionValuesFromProps:qY,createRenderState:HY,onMount:(n,i,{renderState:o,latestValues:c})=>{Kr.read(()=>{try{o.dimensions=typeof i.getBBox=="function"?i.getBBox():i.getBoundingClientRect()}catch{o.dimensions={x:0,y:0,width:0,height:0}}}),Kr.render(()=>{bk(o,c,{enableHardwareAcceleration:!1},wk(i.tagName),n.transformTemplate),KY(i,o)})}})},Vve={useVisualState:YY({scrapeMotionValuesFromProps:Ck,createRenderState:Tk})};function Bve(n,{forwardMotionProps:i=!1},o,c){return{...Sk(n)?Fve:Vve,preloadedFeatures:o,useRender:Ive(i),createVisualElement:c,Component:n}}function Ql(n,i,o,c={passive:!0}){return n.addEventListener(i,o,c),()=>n.removeEventListener(i,o)}const $Y=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1;function wb(n,i="page"){return{point:{x:n[i+"X"],y:n[i+"Y"]}}}const Wve=n=>i=>$Y(i)&&n(i,wb(i));function ed(n,i,o,c){return Ql(n,i,Wve(o),c)}const Hve=(n,i)=>o=>i(n(o)),yu=(...n)=>n.reduce(Hve);function XY(n){let i=null;return()=>{const o=()=>{i=null};return i===null?(i=n,o):!1}}const RW=XY("dragHorizontal"),AW=XY("dragVertical");function JY(n){let i=!1;if(n==="y")i=AW();else if(n==="x")i=RW();else{const o=RW(),c=AW();o&&c?i=()=>{o(),c()}:(o&&o(),c&&c())}return i}function QY(){const n=JY(!0);return n?(n(),!1):!0}class Du{constructor(i){this.isMounted=!1,this.node=i}update(){}}function NW(n,i){const o="pointer"+(i?"enter":"leave"),c="onHover"+(i?"Start":"End"),d=(f,_)=>{if(f.pointerType==="touch"||QY())return;const v=n.getProps();n.animationState&&v.whileHover&&n.animationState.setActive("whileHover",i),v[c]&&Kr.update(()=>v[c](f,_))};return ed(n.current,o,d,{passive:!n.getProps()[c]})}class Gve extends Du{mount(){this.unmount=yu(NW(this.node,!0),NW(this.node,!1))}unmount(){}}class zve extends Du{constructor(){super(...arguments),this.isActive=!1}onFocus(){let i=!1;try{i=this.node.current.matches(":focus-visible")}catch{i=!0}!i||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=yu(Ql(this.node.current,"focus",()=>this.onFocus()),Ql(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const ZY=(n,i)=>i?n===i?!0:ZY(n,i.parentElement):!1;function QN(n,i){if(!i)return;const o=new PointerEvent("pointer"+n);i(o,wb(o))}class Kve extends Du{constructor(){super(...arguments),this.removeStartListeners=wi,this.removeEndListeners=wi,this.removeAccessibleListeners=wi,this.startPointerPress=(i,o)=>{if(this.isPressing)return;this.removeEndListeners();const c=this.node.getProps(),f=ed(window,"pointerup",(v,x)=>{if(!this.checkPressEnd())return;const{onTap:T,onTapCancel:w,globalTapTarget:R}=this.node.getProps();Kr.update(()=>{!R&&!ZY(this.node.current,v.target)?w&&w(v,x):T&&T(v,x)})},{passive:!(c.onTap||c.onPointerUp)}),_=ed(window,"pointercancel",(v,x)=>this.cancelPress(v,x),{passive:!(c.onTapCancel||c.onPointerCancel)});this.removeEndListeners=yu(f,_),this.startPress(i,o)},this.startAccessiblePress=()=>{const i=f=>{if(f.key!=="Enter"||this.isPressing)return;const _=v=>{v.key!=="Enter"||!this.checkPressEnd()||QN("up",(x,T)=>{const{onTap:w}=this.node.getProps();w&&Kr.update(()=>w(x,T))})};this.removeEndListeners(),this.removeEndListeners=Ql(this.node.current,"keyup",_),QN("down",(v,x)=>{this.startPress(v,x)})},o=Ql(this.node.current,"keydown",i),c=()=>{this.isPressing&&QN("cancel",(f,_)=>this.cancelPress(f,_))},d=Ql(this.node.current,"blur",c);this.removeAccessibleListeners=yu(o,d)}}startPress(i,o){this.isPressing=!0;const{onTapStart:c,whileTap:d}=this.node.getProps();d&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),c&&Kr.update(()=>c(i,o))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!QY()}cancelPress(i,o){if(!this.checkPressEnd())return;const{onTapCancel:c}=this.node.getProps();c&&Kr.update(()=>c(i,o))}mount(){const i=this.node.getProps(),o=ed(i.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(i.onTapStart||i.onPointerStart)}),c=Ql(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=yu(o,c)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const SD=new WeakMap,ZN=new WeakMap,qve=n=>{const i=SD.get(n.target);i&&i(n)},Yve=n=>{n.forEach(qve)};function $ve({root:n,...i}){const o=n||document;ZN.has(o)||ZN.set(o,{});const c=ZN.get(o),d=JSON.stringify(i);return c[d]||(c[d]=new IntersectionObserver(Yve,{root:n,...i})),c[d]}function Xve(n,i,o){const c=$ve(i);return SD.set(n,o),c.observe(n),()=>{SD.delete(n),c.unobserve(n)}}const Jve={some:0,all:1};class Qve extends Du{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:i={}}=this.node.getProps(),{root:o,margin:c,amount:d="some",once:f}=i,_={root:o?o.current:void 0,rootMargin:c,threshold:typeof d=="number"?d:Jve[d]},v=x=>{const{isIntersecting:T}=x;if(this.isInView===T||(this.isInView=T,f&&!T&&this.hasEnteredView))return;T&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",T);const{onViewportEnter:w,onViewportLeave:R}=this.node.getProps(),I=T?w:R;I&&I(x)};return Xve(this.node.current,_,v)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:i,prevProps:o}=this.node;["amount","margin","root"].some(Zve(i,o))&&this.startObserver()}unmount(){}}function Zve({viewport:n={}},{viewport:i={}}={}){return o=>n[o]!==i[o]}const eye={inView:{Feature:Qve},tap:{Feature:Kve},focus:{Feature:zve},hover:{Feature:Gve}};function e$(n,i){if(!Array.isArray(i))return!1;const o=i.length;if(o!==n.length)return!1;for(let c=0;c<o;c++)if(i[c]!==n[c])return!1;return!0}function tye(n){const i={};return n.values.forEach((o,c)=>i[c]=o.get()),i}function nye(n){const i={};return n.values.forEach((o,c)=>i[c]=o.getVelocity()),i}function Cb(n,i,o){const c=n.getProps();return Rk(c,i,o!==void 0?o:c.custom,tye(n),nye(n))}let rye=wi,Ak=wi;const Su=n=>n*1e3,td=n=>n/1e3,iye={current:!1},t$=n=>Array.isArray(n)&&typeof n[0]=="number";function n$(n){return!!(!n||typeof n=="string"&&r$[n]||t$(n)||Array.isArray(n)&&n.every(n$))}const __=([n,i,o,c])=>`cubic-bezier(${n}, ${i}, ${o}, ${c})`,r$={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:__([0,.65,.55,1]),circOut:__([.55,0,1,.45]),backIn:__([.31,.01,.66,-.59]),backOut:__([.33,1.53,.69,.99])};function i$(n){if(n)return t$(n)?__(n):Array.isArray(n)?n.map(i$):r$[n]}function sye(n,i,o,{delay:c=0,duration:d,repeat:f=0,repeatType:_="loop",ease:v,times:x}={}){const T={[i]:o};x&&(T.offset=x);const w=i$(v);return Array.isArray(w)&&(T.easing=w),n.animate(T,{delay:c,duration:d,easing:Array.isArray(w)?"linear":w,fill:"both",iterations:f+1,direction:_==="reverse"?"alternate":"normal"})}function oye(n,{repeat:i,repeatType:o="loop"}){const c=i&&o!=="loop"&&i%2===1?0:n.length-1;return n[c]}const s$=(n,i,o)=>(((1-3*o+3*i)*n+(3*o-6*i))*n+3*i)*n,aye=1e-7,cye=12;function lye(n,i,o,c,d){let f,_,v=0;do _=i+(o-i)/2,f=s$(_,c,d)-n,f>0?o=_:i=_;while(Math.abs(f)>aye&&++v<cye);return _}function wE(n,i,o,c){if(n===i&&o===c)return wi;const d=f=>lye(f,0,1,n,o);return f=>f===0||f===1?f:s$(d(f),i,c)}const dye=wE(.42,0,1,1),uye=wE(0,0,.58,1),o$=wE(.42,0,.58,1),hye=n=>Array.isArray(n)&&typeof n[0]!="number",a$=n=>i=>i<=.5?n(2*i)/2:(2-n(2*(1-i)))/2,c$=n=>i=>1-n(1-i),Nk=n=>1-Math.sin(Math.acos(n)),l$=c$(Nk),pye=a$(Nk),d$=wE(.33,1.53,.69,.99),Ik=c$(d$),fye=a$(Ik),mye=n=>(n*=2)<1?.5*Ik(n):.5*(2-Math.pow(2,-10*(n-1))),gye={linear:wi,easeIn:dye,easeInOut:o$,easeOut:uye,circIn:Nk,circInOut:pye,circOut:l$,backIn:Ik,backInOut:fye,backOut:d$,anticipate:mye},IW=n=>{if(Array.isArray(n)){Ak(n.length===4);const[i,o,c,d]=n;return wE(i,o,c,d)}else if(typeof n=="string")return gye[n];return n},Ok=(n,i)=>o=>!!(TE(o)&&gve.test(o)&&o.startsWith(n)||i&&Object.prototype.hasOwnProperty.call(o,i)),u$=(n,i,o)=>c=>{if(!TE(c))return c;const[d,f,_,v]=c.match(bb);return{[n]:parseFloat(d),[i]:parseFloat(f),[o]:parseFloat(_),alpha:v!==void 0?parseFloat(v):1}},_ye=n=>bu(0,255,n),eI={...bp,transform:n=>Math.round(_ye(n))},Xh={test:Ok("rgb","red"),parse:u$("red","green","blue"),transform:({red:n,green:i,blue:o,alpha:c=1})=>"rgba("+eI.transform(n)+", "+eI.transform(i)+", "+eI.transform(o)+", "+O_(I_.transform(c))+")"};function Eye(n){let i="",o="",c="",d="";return n.length>5?(i=n.substring(1,3),o=n.substring(3,5),c=n.substring(5,7),d=n.substring(7,9)):(i=n.substring(1,2),o=n.substring(2,3),c=n.substring(3,4),d=n.substring(4,5),i+=i,o+=o,c+=c,d+=d),{red:parseInt(i,16),green:parseInt(o,16),blue:parseInt(c,16),alpha:d?parseInt(d,16)/255:1}}const xD={test:Ok("#"),parse:Eye,transform:Xh.transform},ym={test:Ok("hsl","hue"),parse:u$("hue","saturation","lightness"),transform:({hue:n,saturation:i,lightness:o,alpha:c=1})=>"hsla("+Math.round(n)+", "+yl.transform(O_(i))+", "+yl.transform(O_(o))+", "+O_(I_.transform(c))+")"},no={test:n=>Xh.test(n)||xD.test(n)||ym.test(n),parse:n=>Xh.test(n)?Xh.parse(n):ym.test(n)?ym.parse(n):xD.parse(n),transform:n=>TE(n)?n:n.hasOwnProperty("red")?Xh.transform(n):ym.transform(n)},hi=(n,i,o)=>-o*n+o*i+n;function tI(n,i,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?n+(i-n)*6*o:o<1/2?i:o<2/3?n+(i-n)*(2/3-o)*6:n}function vye({hue:n,saturation:i,lightness:o,alpha:c}){n/=360,i/=100,o/=100;let d=0,f=0,_=0;if(!i)d=f=_=o;else{const v=o<.5?o*(1+i):o+i-o*i,x=2*o-v;d=tI(x,v,n+1/3),f=tI(x,v,n),_=tI(x,v,n-1/3)}return{red:Math.round(d*255),green:Math.round(f*255),blue:Math.round(_*255),alpha:c}}const nI=(n,i,o)=>{const c=n*n;return Math.sqrt(Math.max(0,o*(i*i-c)+c))},yye=[xD,Xh,ym],Sye=n=>yye.find(i=>i.test(n));function OW(n){const i=Sye(n);let o=i.parse(n);return i===ym&&(o=vye(o)),o}const h$=(n,i)=>{const o=OW(n),c=OW(i),d={...o};return f=>(d.red=nI(o.red,c.red,f),d.green=nI(o.green,c.green,f),d.blue=nI(o.blue,c.blue,f),d.alpha=hi(o.alpha,c.alpha,f),Xh.transform(d))};function xye(n){var i,o;return isNaN(n)&&TE(n)&&(((i=n.match(bb))===null||i===void 0?void 0:i.length)||0)+(((o=n.match(FY))===null||o===void 0?void 0:o.length)||0)>0}const p$={regex:fve,countKey:"Vars",token:"${v}",parse:wi},f$={regex:FY,countKey:"Colors",token:"${c}",parse:no.parse},m$={regex:bb,countKey:"Numbers",token:"${n}",parse:bp.parse};function rI(n,{regex:i,countKey:o,token:c,parse:d}){const f=n.tokenised.match(i);f&&(n["num"+o]=f.length,n.tokenised=n.tokenised.replace(i,c),n.values.push(...f.map(d)))}function AT(n){const i=n.toString(),o={value:i,tokenised:i,values:[],numVars:0,numColors:0,numNumbers:0};return o.value.includes("var(--")&&rI(o,p$),rI(o,f$),rI(o,m$),o}function g$(n){return AT(n).values}function _$(n){const{values:i,numColors:o,numVars:c,tokenised:d}=AT(n),f=i.length;return _=>{let v=d;for(let x=0;x<f;x++)x<c?v=v.replace(p$.token,_[x]):x<c+o?v=v.replace(f$.token,no.transform(_[x])):v=v.replace(m$.token,O_(_[x]));return v}}const Tye=n=>typeof n=="number"?0:n;function bye(n){const i=g$(n);return _$(n)(i.map(Tye))}const wu={test:xye,parse:g$,createTransformer:_$,getAnimatableNone:bye},E$=(n,i)=>o=>`${o>0?i:n}`;function v$(n,i){return typeof n=="number"?o=>hi(n,i,o):no.test(n)?h$(n,i):n.startsWith("var(")?E$(n,i):S$(n,i)}const y$=(n,i)=>{const o=[...n],c=o.length,d=n.map((f,_)=>v$(f,i[_]));return f=>{for(let _=0;_<c;_++)o[_]=d[_](f);return o}},wye=(n,i)=>{const o={...n,...i},c={};for(const d in o)n[d]!==void 0&&i[d]!==void 0&&(c[d]=v$(n[d],i[d]));return d=>{for(const f in c)o[f]=c[f](d);return o}},S$=(n,i)=>{const o=wu.createTransformer(i),c=AT(n),d=AT(i);return c.numVars===d.numVars&&c.numColors===d.numColors&&c.numNumbers>=d.numNumbers?yu(y$(c.values,d.values),o):E$(n,i)},cE=(n,i,o)=>{const c=i-n;return c===0?1:(o-n)/c},DW=(n,i)=>o=>hi(n,i,o);function Cye(n){return typeof n=="number"?DW:typeof n=="string"?no.test(n)?h$:S$:Array.isArray(n)?y$:typeof n=="object"?wye:DW}function Rye(n,i,o){const c=[],d=o||Cye(n[0]),f=n.length-1;for(let _=0;_<f;_++){let v=d(n[_],n[_+1]);if(i){const x=Array.isArray(i)?i[_]||wi:i;v=yu(x,v)}c.push(v)}return c}function x$(n,i,{clamp:o=!0,ease:c,mixer:d}={}){const f=n.length;if(Ak(f===i.length),f===1)return()=>i[0];n[0]>n[f-1]&&(n=[...n].reverse(),i=[...i].reverse());const _=Rye(i,c,d),v=_.length,x=T=>{let w=0;if(v>1)for(;w<n.length-2&&!(T<n[w+1]);w++);const R=cE(n[w],n[w+1],T);return _[w](R)};return o?T=>x(bu(n[0],n[f-1],T)):x}function Aye(n,i){const o=n[n.length-1];for(let c=1;c<=i;c++){const d=cE(0,i,c);n.push(hi(o,1,d))}}function Nye(n){const i=[0];return Aye(i,n.length-1),i}function Iye(n,i){return n.map(o=>o*i)}function Oye(n,i){return n.map(()=>i||o$).splice(0,n.length-1)}function NT({duration:n=300,keyframes:i,times:o,ease:c="easeInOut"}){const d=hye(c)?c.map(IW):IW(c),f={done:!1,value:i[0]},_=Iye(o&&o.length===i.length?o:Nye(i),n),v=x$(_,i,{ease:Array.isArray(d)?d:Oye(i,d)});return{calculatedDuration:n,next:x=>(f.value=v(x),f.done=x>=n,f)}}function T$(n,i){return i?n*(1e3/i):0}const Dye=5;function b$(n,i,o){const c=Math.max(i-Dye,0);return T$(o-n(c),i-c)}const iI=.001,Pye=.01,PW=10,kye=.05,Lye=1;function Mye({duration:n=800,bounce:i=.25,velocity:o=0,mass:c=1}){let d,f;rye(n<=Su(PW));let _=1-i;_=bu(kye,Lye,_),n=bu(Pye,PW,td(n)),_<1?(d=T=>{const w=T*_,R=w*n,I=w-o,j=TD(T,_),P=Math.exp(-R);return iI-I/j*P},f=T=>{const R=T*_*n,I=R*o+o,j=Math.pow(_,2)*Math.pow(T,2)*n,P=Math.exp(-R),k=TD(Math.pow(T,2),_);return(-d(T)+iI>0?-1:1)*((I-j)*P)/k}):(d=T=>{const w=Math.exp(-T*n),R=(T-o)*n+1;return-iI+w*R},f=T=>{const w=Math.exp(-T*n),R=(o-T)*(n*n);return w*R});const v=5/n,x=Uye(d,f,v);if(n=Su(n),isNaN(x))return{stiffness:100,damping:10,duration:n};{const T=Math.pow(x,2)*c;return{stiffness:T,damping:_*2*Math.sqrt(c*T),duration:n}}}const jye=12;function Uye(n,i,o){let c=o;for(let d=1;d<jye;d++)c=c-n(c)/i(c);return c}function TD(n,i){return n*Math.sqrt(1-i*i)}const Fye=["duration","bounce"],Vye=["stiffness","damping","mass"];function kW(n,i){return i.some(o=>n[o]!==void 0)}function Bye(n){let i={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...n};if(!kW(n,Vye)&&kW(n,Fye)){const o=Mye(n);i={...i,...o,mass:1},i.isResolvedFromDuration=!0}return i}function w$({keyframes:n,restDelta:i,restSpeed:o,...c}){const d=n[0],f=n[n.length-1],_={done:!1,value:d},{stiffness:v,damping:x,mass:T,duration:w,velocity:R,isResolvedFromDuration:I}=Bye({...c,velocity:-td(c.velocity||0)}),j=R||0,P=x/(2*Math.sqrt(v*T)),k=f-d,W=td(Math.sqrt(v/T)),H=Math.abs(k)<5;o||(o=H?.01:2),i||(i=H?.005:.5);let L;if(P<1){const V=TD(W,P);L=K=>{const te=Math.exp(-P*W*K);return f-te*((j+P*W*k)/V*Math.sin(V*K)+k*Math.cos(V*K))}}else if(P===1)L=V=>f-Math.exp(-W*V)*(k+(j+W*k)*V);else{const V=W*Math.sqrt(P*P-1);L=K=>{const te=Math.exp(-P*W*K),ie=Math.min(V*K,300);return f-te*((j+P*W*k)*Math.sinh(ie)+V*k*Math.cosh(ie))/V}}return{calculatedDuration:I&&w||null,next:V=>{const K=L(V);if(I)_.done=V>=w;else{let te=j;V!==0&&(P<1?te=b$(L,V,K):te=0);const ie=Math.abs(te)<=o,A=Math.abs(f-K)<=i;_.done=ie&&A}return _.value=_.done?f:K,_}}}function LW({keyframes:n,velocity:i=0,power:o=.8,timeConstant:c=325,bounceDamping:d=10,bounceStiffness:f=500,modifyTarget:_,min:v,max:x,restDelta:T=.5,restSpeed:w}){const R=n[0],I={done:!1,value:R},j=de=>v!==void 0&&de<v||x!==void 0&&de>x,P=de=>v===void 0?x:x===void 0||Math.abs(v-de)<Math.abs(x-de)?v:x;let k=o*i;const W=R+k,H=_===void 0?W:_(W);H!==W&&(k=H-R);const L=de=>-k*Math.exp(-de/c),V=de=>H+L(de),K=de=>{const ue=L(de),oe=V(de);I.done=Math.abs(ue)<=T,I.value=I.done?H:oe};let te,ie;const A=de=>{j(I.value)&&(te=de,ie=w$({keyframes:[I.value,P(I.value)],velocity:b$(V,de,I.value),damping:d,stiffness:f,restDelta:T,restSpeed:w}))};return A(0),{calculatedDuration:null,next:de=>{let ue=!1;return!ie&&te===void 0&&(ue=!0,K(de),A(de)),te!==void 0&&de>te?ie.next(de-te):(!ue&&K(de),I)}}}const Wye=n=>{const i=({timestamp:o})=>n(o);return{start:()=>Kr.update(i,!0),stop:()=>ld(i),now:()=>Bs.isProcessing?Bs.timestamp:performance.now()}},MW=2e4;function jW(n){let i=0;const o=50;let c=n.next(i);for(;!c.done&&i<MW;)i+=o,c=n.next(i);return i>=MW?1/0:i}const Hye={decay:LW,inertia:LW,tween:NT,keyframes:NT,spring:w$};function IT({autoplay:n=!0,delay:i=0,driver:o=Wye,keyframes:c,type:d="keyframes",repeat:f=0,repeatDelay:_=0,repeatType:v="loop",onPlay:x,onStop:T,onComplete:w,onUpdate:R,...I}){let j=1,P=!1,k,W;const H=()=>{W=new Promise(Ae=>{k=Ae})};H();let L;const V=Hye[d]||NT;let K;V!==NT&&typeof c[0]!="number"&&(K=x$([0,100],c,{clamp:!1}),c=[0,100]);const te=V({...I,keyframes:c});let ie;v==="mirror"&&(ie=V({...I,keyframes:[...c].reverse(),velocity:-(I.velocity||0)}));let A="idle",de=null,ue=null,oe=null;te.calculatedDuration===null&&f&&(te.calculatedDuration=jW(te));const{calculatedDuration:ye}=te;let Ee=1/0,xe=1/0;ye!==null&&(Ee=ye+_,xe=Ee*(f+1)-_);let Oe=0;const ct=Ae=>{if(ue===null)return;j>0&&(ue=Math.min(ue,Ae)),j<0&&(ue=Math.min(Ae-xe/j,ue)),de!==null?Oe=de:Oe=Math.round(Ae-ue)*j;const Le=Oe-i*(j>=0?1:-1),ze=j>=0?Le<0:Le>xe;Oe=Math.max(Le,0),A==="finished"&&de===null&&(Oe=xe);let qe=Oe,fn=te;if(f){const hr=Math.min(Oe,xe)/Ee;let Bn=Math.floor(hr),Yr=hr%1;!Yr&&hr>=1&&(Yr=1),Yr===1&&Bn--,Bn=Math.min(Bn,f+1),!!(Bn%2)&&(v==="reverse"?(Yr=1-Yr,_&&(Yr-=_/Ee)):v==="mirror"&&(fn=ie)),qe=bu(0,1,Yr)*Ee}const qt=ze?{done:!1,value:c[0]}:fn.next(qe);K&&(qt.value=K(qt.value));let{done:Dn}=qt;!ze&&ye!==null&&(Dn=j>=0?Oe>=xe:Oe<=0);const Kt=de===null&&(A==="finished"||A==="running"&&Dn);return R&&R(qt.value),Kt&&He(),qt},at=()=>{L&&L.stop(),L=void 0},lt=()=>{A="idle",at(),k(),H(),ue=oe=null},He=()=>{A="finished",w&&w(),at(),k()},et=()=>{if(P)return;L||(L=o(ct));const Ae=L.now();x&&x(),de!==null?ue=Ae-de:(!ue||A==="finished")&&(ue=Ae),A==="finished"&&H(),oe=ue,de=null,A="running",L.start()};n&&et();const ut={then(Ae,Le){return W.then(Ae,Le)},get time(){return td(Oe)},set time(Ae){Ae=Su(Ae),Oe=Ae,de!==null||!L||j===0?de=Ae:ue=L.now()-Ae/j},get duration(){const Ae=te.calculatedDuration===null?jW(te):te.calculatedDuration;return td(Ae)},get speed(){return j},set speed(Ae){Ae===j||!L||(j=Ae,ut.time=td(Oe))},get state(){return A},play:et,pause:()=>{A="paused",de=Oe},stop:()=>{P=!0,A!=="idle"&&(A="idle",T&&T(),lt())},cancel:()=>{oe!==null&&ct(oe),lt()},complete:()=>{A="finished"},sample:Ae=>(ue=0,ct(Ae))};return ut}function Gye(n){let i;return()=>(i===void 0&&(i=n()),i)}const zye=Gye(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Kye=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),lx=10,qye=2e4,Yye=(n,i)=>i.type==="spring"||n==="backgroundColor"||!n$(i.ease);function $ye(n,i,{onUpdate:o,onComplete:c,...d}){if(!(zye()&&Kye.has(i)&&!d.repeatDelay&&d.repeatType!=="mirror"&&d.damping!==0&&d.type!=="inertia"))return!1;let _=!1,v,x,T=!1;const w=()=>{x=new Promise(V=>{v=V})};w();let{keyframes:R,duration:I=300,ease:j,times:P}=d;if(Yye(i,d)){const V=IT({...d,repeat:0,delay:0});let K={done:!1,value:R[0]};const te=[];let ie=0;for(;!K.done&&ie<qye;)K=V.sample(ie),te.push(K.value),ie+=lx;P=void 0,R=te,I=ie-lx,j="linear"}const k=sye(n.owner.current,i,R,{...d,duration:I,ease:j,times:P}),W=()=>{T=!1,k.cancel()},H=()=>{T=!0,Kr.update(W),v(),w()};return k.onfinish=()=>{T||(n.set(oye(R,d)),c&&c(),H())},{then(V,K){return x.then(V,K)},attachTimeline(V){return k.timeline=V,k.onfinish=null,wi},get time(){return td(k.currentTime||0)},set time(V){k.currentTime=Su(V)},get speed(){return k.playbackRate},set speed(V){k.playbackRate=V},get duration(){return td(I)},play:()=>{_||(k.play(),ld(W))},pause:()=>k.pause(),stop:()=>{if(_=!0,k.playState==="idle")return;const{currentTime:V}=k;if(V){const K=IT({...d,autoplay:!1});n.setWithVelocity(K.sample(V-lx).value,K.sample(V).value,lx)}H()},complete:()=>{T||k.finish()},cancel:H}}function Xye({keyframes:n,delay:i,onUpdate:o,onComplete:c}){const d=()=>(o&&o(n[n.length-1]),c&&c(),{time:0,speed:1,duration:0,play:wi,pause:wi,stop:wi,then:f=>(f(),Promise.resolve()),cancel:wi,complete:wi});return i?IT({keyframes:[0,1],duration:0,delay:i,onComplete:d}):d()}const Jye={type:"spring",stiffness:500,damping:25,restSpeed:10},Qye=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Zye={type:"keyframes",duration:.8},eSe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},tSe=(n,{keyframes:i})=>i.length>2?Zye:Tp.has(n)?n.startsWith("scale")?Qye(i[1]):Jye:eSe,bD=(n,i)=>n==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(wu.test(i)||i==="0")&&!i.startsWith("url(")),nSe=new Set(["brightness","contrast","saturate","opacity"]);function rSe(n){const[i,o]=n.slice(0,-1).split("(");if(i==="drop-shadow")return n;const[c]=o.match(bb)||[];if(!c)return n;const d=o.replace(c,"");let f=nSe.has(i)?1:0;return c!==o&&(f*=100),i+"("+f+d+")"}const iSe=/([a-z-]*)\(.*?\)/g,wD={...wu,getAnimatableNone:n=>{const i=n.match(iSe);return i?i.map(rSe).join(" "):n}},sSe={...VY,color:no,backgroundColor:no,outlineColor:no,fill:no,stroke:no,borderColor:no,borderTopColor:no,borderRightColor:no,borderBottomColor:no,borderLeftColor:no,filter:wD,WebkitFilter:wD},Dk=n=>sSe[n];function C$(n,i){let o=Dk(n);return o!==wD&&(o=wu),o.getAnimatableNone?o.getAnimatableNone(i):void 0}const R$=n=>/^0[^.\s]+$/.test(n);function oSe(n){if(typeof n=="number")return n===0;if(n!==null)return n==="none"||n==="0"||R$(n)}function aSe(n,i,o,c){const d=bD(i,o);let f;Array.isArray(o)?f=[...o]:f=[null,o];const _=c.from!==void 0?c.from:n.get();let v;const x=[];for(let T=0;T<f.length;T++)f[T]===null&&(f[T]=T===0?_:f[T-1]),oSe(f[T])&&x.push(T),typeof f[T]=="string"&&f[T]!=="none"&&f[T]!=="0"&&(v=f[T]);if(d&&x.length&&v)for(let T=0;T<x.length;T++){const w=x[T];f[w]=C$(i,v)}return f}function cSe({when:n,delay:i,delayChildren:o,staggerChildren:c,staggerDirection:d,repeat:f,repeatType:_,repeatDelay:v,from:x,elapsed:T,...w}){return!!Object.keys(w).length}function Pk(n,i){return n[i]||n.default||n}const lSe={skipAnimations:!1},kk=(n,i,o,c={})=>d=>{const f=Pk(c,n)||{},_=f.delay||c.delay||0;let{elapsed:v=0}=c;v=v-Su(_);const x=aSe(i,n,o,f),T=x[0],w=x[x.length-1],R=bD(n,T),I=bD(n,w);let j={keyframes:x,velocity:i.getVelocity(),ease:"easeOut",...f,delay:-v,onUpdate:P=>{i.set(P),f.onUpdate&&f.onUpdate(P)},onComplete:()=>{d(),f.onComplete&&f.onComplete()}};if(cSe(f)||(j={...j,...tSe(n,j)}),j.duration&&(j.duration=Su(j.duration)),j.repeatDelay&&(j.repeatDelay=Su(j.repeatDelay)),!R||!I||iye.current||f.type===!1||lSe.skipAnimations)return Xye(j);if(!c.isHandoff&&i.owner&&i.owner.current instanceof HTMLElement&&!i.owner.getProps().onUpdate){const P=$ye(i,n,j);if(P)return P}return IT(j)};function OT(n){return!!(Mo(n)&&n.add)}const A$=n=>/^\-?\d*\.?\d+$/.test(n);function Lk(n,i){n.indexOf(i)===-1&&n.push(i)}function Mk(n,i){const o=n.indexOf(i);o>-1&&n.splice(o,1)}class jk{constructor(){this.subscriptions=[]}add(i){return Lk(this.subscriptions,i),()=>Mk(this.subscriptions,i)}notify(i,o,c){const d=this.subscriptions.length;if(d)if(d===1)this.subscriptions[0](i,o,c);else for(let f=0;f<d;f++){const _=this.subscriptions[f];_&&_(i,o,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const dSe=n=>!isNaN(parseFloat(n));class uSe{constructor(i,o={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(c,d=!0)=>{this.prev=this.current,this.current=c;const{delta:f,timestamp:_}=Bs;this.lastUpdated!==_&&(this.timeDelta=f,this.lastUpdated=_,Kr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),d&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Kr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:c})=>{c!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=i,this.canTrackVelocity=dSe(this.current),this.owner=o.owner}onChange(i){return this.on("change",i)}on(i,o){this.events[i]||(this.events[i]=new jk);const c=this.events[i].add(o);return i==="change"?()=>{c(),Kr.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(const i in this.events)this.events[i].clear()}attach(i,o){this.passiveEffect=i,this.stopPassiveEffect=o}set(i,o=!0){!o||!this.passiveEffect?this.updateAndNotify(i,o):this.passiveEffect(i,this.updateAndNotify)}setWithVelocity(i,o,c){this.set(o),this.prev=i,this.timeDelta=c}jump(i){this.updateAndNotify(i),this.prev=i,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?T$(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(i){return this.stop(),new Promise(o=>{this.hasAnimated=!0,this.animation=i(o),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bm(n,i){return new uSe(n,i)}const N$=n=>i=>i.test(n),hSe={test:n=>n==="auto",parse:n=>n},I$=[bp,sn,yl,Zd,Eve,_ve,hSe],a_=n=>I$.find(N$(n)),pSe=[...I$,no,wu],fSe=n=>pSe.find(N$(n));function mSe(n,i,o){n.hasValue(i)?n.getValue(i).set(o):n.addValue(i,Bm(o))}function gSe(n,i){const o=Cb(n,i);let{transitionEnd:c={},transition:d={},...f}=o?n.makeTargetAnimatable(o,!1):{};f={...f,...c};for(const _ in f){const v=Pve(f[_]);mSe(n,_,v)}}function _Se(n,i,o){var c,d;const f=Object.keys(i).filter(v=>!n.hasValue(v)),_=f.length;if(_)for(let v=0;v<_;v++){const x=f[v],T=i[x];let w=null;Array.isArray(T)&&(w=T[0]),w===null&&(w=(d=(c=o[x])!==null&&c!==void 0?c:n.readValue(x))!==null&&d!==void 0?d:i[x]),w!=null&&(typeof w=="string"&&(A$(w)||R$(w))?w=parseFloat(w):!fSe(w)&&wu.test(T)&&(w=C$(x,T)),n.addValue(x,Bm(w,{owner:n})),o[x]===void 0&&(o[x]=w),w!==null&&n.setBaseTarget(x,w))}}function ESe(n,i){return i?(i[n]||i.default||i).from:void 0}function vSe(n,i,o){const c={};for(const d in n){const f=ESe(d,i);if(f!==void 0)c[d]=f;else{const _=o.getValue(d);_&&(c[d]=_.get())}}return c}function ySe({protectedKeys:n,needsAnimating:i},o){const c=n.hasOwnProperty(o)&&i[o]!==!0;return i[o]=!1,c}function SSe(n,i){const o=n.get();if(Array.isArray(i)){for(let c=0;c<i.length;c++)if(i[c]!==o)return!0}else return o!==i}function O$(n,i,{delay:o=0,transitionOverride:c,type:d}={}){let{transition:f=n.getDefaultTransition(),transitionEnd:_,...v}=n.makeTargetAnimatable(i);const x=n.getValue("willChange");c&&(f=c);const T=[],w=d&&n.animationState&&n.animationState.getState()[d];for(const R in v){const I=n.getValue(R),j=v[R];if(!I||j===void 0||w&&ySe(w,R))continue;const P={delay:o,elapsed:0,...Pk(f||{},R)};if(window.HandoffAppearAnimations){const H=n.getProps()[DY];if(H){const L=window.HandoffAppearAnimations(H,R,I,Kr);L!==null&&(P.elapsed=L,P.isHandoff=!0)}}let k=!P.isHandoff&&!SSe(I,j);if(P.type==="spring"&&(I.getVelocity()||P.velocity)&&(k=!1),I.animation&&(k=!1),k)continue;I.start(kk(R,I,j,n.shouldReduceMotion&&Tp.has(R)?{type:!1}:P));const W=I.animation;OT(x)&&(x.add(R),W.then(()=>x.remove(R))),T.push(W)}return _&&Promise.all(T).then(()=>{_&&gSe(n,_)}),T}function CD(n,i,o={}){const c=Cb(n,i,o.custom);let{transition:d=n.getDefaultTransition()||{}}=c||{};o.transitionOverride&&(d=o.transitionOverride);const f=c?()=>Promise.all(O$(n,c,o)):()=>Promise.resolve(),_=n.variantChildren&&n.variantChildren.size?(x=0)=>{const{delayChildren:T=0,staggerChildren:w,staggerDirection:R}=d;return xSe(n,i,T+x,w,R,o)}:()=>Promise.resolve(),{when:v}=d;if(v){const[x,T]=v==="beforeChildren"?[f,_]:[_,f];return x().then(()=>T())}else return Promise.all([f(),_(o.delay)])}function xSe(n,i,o=0,c=0,d=1,f){const _=[],v=(n.variantChildren.size-1)*c,x=d===1?(T=0)=>T*c:(T=0)=>v-T*c;return Array.from(n.variantChildren).sort(TSe).forEach((T,w)=>{T.notify("AnimationStart",i),_.push(CD(T,i,{...f,delay:o+x(w)}).then(()=>T.notify("AnimationComplete",i)))}),Promise.all(_)}function TSe(n,i){return n.sortNodePosition(i)}function bSe(n,i,o={}){n.notify("AnimationStart",i);let c;if(Array.isArray(i)){const d=i.map(f=>CD(n,f,o));c=Promise.all(d)}else if(typeof i=="string")c=CD(n,i,o);else{const d=typeof i=="function"?Cb(n,i,o.custom):i;c=Promise.all(O$(n,d,o))}return c.then(()=>n.notify("AnimationComplete",i))}const wSe=[...vk].reverse(),CSe=vk.length;function RSe(n){return i=>Promise.all(i.map(({animation:o,options:c})=>bSe(n,o,c)))}function ASe(n){let i=RSe(n);const o=ISe();let c=!0;const d=(x,T)=>{const w=Cb(n,T);if(w){const{transition:R,transitionEnd:I,...j}=w;x={...x,...j,...I}}return x};function f(x){i=x(n)}function _(x,T){const w=n.getProps(),R=n.getVariantContext(!0)||{},I=[],j=new Set;let P={},k=1/0;for(let H=0;H<CSe;H++){const L=wSe[H],V=o[L],K=w[L]!==void 0?w[L]:R[L],te=oE(K),ie=L===T?V.isActive:null;ie===!1&&(k=H);let A=K===R[L]&&K!==w[L]&&te;if(A&&c&&n.manuallyAnimateOnMount&&(A=!1),V.protectedKeys={...P},!V.isActive&&ie===null||!K&&!V.prevProp||xb(K)||typeof K=="boolean")continue;let ue=NSe(V.prevProp,K)||L===T&&V.isActive&&!A&&te||H>k&&te,oe=!1;const ye=Array.isArray(K)?K:[K];let Ee=ye.reduce(d,{});ie===!1&&(Ee={});const{prevResolvedValues:xe={}}=V,Oe={...xe,...Ee},ct=at=>{ue=!0,j.has(at)&&(oe=!0,j.delete(at)),V.needsAnimating[at]=!0};for(const at in Oe){const lt=Ee[at],He=xe[at];if(P.hasOwnProperty(at))continue;let et=!1;RT(lt)&&RT(He)?et=!e$(lt,He):et=lt!==He,et?lt!==void 0?ct(at):j.add(at):lt!==void 0&&j.has(at)?ct(at):V.protectedKeys[at]=!0}V.prevProp=K,V.prevResolvedValues=Ee,V.isActive&&(P={...P,...Ee}),c&&n.blockInitialAnimation&&(ue=!1),ue&&(!A||oe)&&I.push(...ye.map(at=>({animation:at,options:{type:L,...x}})))}if(j.size){const H={};j.forEach(L=>{const V=n.getBaseTarget(L);V!==void 0&&(H[L]=V)}),I.push({animation:H})}let W=!!I.length;return c&&(w.initial===!1||w.initial===w.animate)&&!n.manuallyAnimateOnMount&&(W=!1),c=!1,W?i(I):Promise.resolve()}function v(x,T,w){var R;if(o[x].isActive===T)return Promise.resolve();(R=n.variantChildren)===null||R===void 0||R.forEach(j=>{var P;return(P=j.animationState)===null||P===void 0?void 0:P.setActive(x,T)}),o[x].isActive=T;const I=_(w,x);for(const j in o)o[j].protectedKeys={};return I}return{animateChanges:_,setActive:v,setAnimateFunction:f,getState:()=>o}}function NSe(n,i){return typeof i=="string"?i!==n:Array.isArray(i)?!e$(i,n):!1}function Mh(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ISe(){return{animate:Mh(!0),whileInView:Mh(),whileHover:Mh(),whileTap:Mh(),whileDrag:Mh(),whileFocus:Mh(),exit:Mh()}}class OSe extends Du{constructor(i){super(i),i.animationState||(i.animationState=ASe(i))}updateAnimationControlsSubscription(){const{animate:i}=this.node.getProps();this.unmount(),xb(i)&&(this.unmount=i.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:i}=this.node.getProps(),{animate:o}=this.node.prevProps||{};i!==o&&this.updateAnimationControlsSubscription()}unmount(){}}let DSe=0;class PSe extends Du{constructor(){super(...arguments),this.id=DSe++}update(){if(!this.node.presenceContext)return;const{isPresent:i,onExitComplete:o,custom:c}=this.node.presenceContext,{isPresent:d}=this.node.prevPresenceContext||{};if(!this.node.animationState||i===d)return;const f=this.node.animationState.setActive("exit",!i,{custom:c??this.node.getProps().custom});o&&!i&&f.then(()=>o(this.id))}mount(){const{register:i}=this.node.presenceContext||{};i&&(this.unmount=i(this.id))}unmount(){}}const kSe={animation:{Feature:OSe},exit:{Feature:PSe}},UW=(n,i)=>Math.abs(n-i);function LSe(n,i){const o=UW(n.x,i.x),c=UW(n.y,i.y);return Math.sqrt(o**2+c**2)}class D${constructor(i,o,{transformPagePoint:c,contextWindow:d,dragSnapToOrigin:f=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const R=oI(this.lastMoveEventInfo,this.history),I=this.startEvent!==null,j=LSe(R.offset,{x:0,y:0})>=3;if(!I&&!j)return;const{point:P}=R,{timestamp:k}=Bs;this.history.push({...P,timestamp:k});const{onStart:W,onMove:H}=this.handlers;I||(W&&W(this.lastMoveEvent,R),this.startEvent=this.lastMoveEvent),H&&H(this.lastMoveEvent,R)},this.handlePointerMove=(R,I)=>{this.lastMoveEvent=R,this.lastMoveEventInfo=sI(I,this.transformPagePoint),Kr.update(this.updatePoint,!0)},this.handlePointerUp=(R,I)=>{this.end();const{onEnd:j,onSessionEnd:P,resumeAnimation:k}=this.handlers;if(this.dragSnapToOrigin&&k&&k(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const W=oI(R.type==="pointercancel"?this.lastMoveEventInfo:sI(I,this.transformPagePoint),this.history);this.startEvent&&j&&j(R,W),P&&P(R,W)},!$Y(i))return;this.dragSnapToOrigin=f,this.handlers=o,this.transformPagePoint=c,this.contextWindow=d||window;const _=wb(i),v=sI(_,this.transformPagePoint),{point:x}=v,{timestamp:T}=Bs;this.history=[{...x,timestamp:T}];const{onSessionStart:w}=o;w&&w(i,oI(v,this.history)),this.removeListeners=yu(ed(this.contextWindow,"pointermove",this.handlePointerMove),ed(this.contextWindow,"pointerup",this.handlePointerUp),ed(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(i){this.handlers=i}end(){this.removeListeners&&this.removeListeners(),ld(this.updatePoint)}}function sI(n,i){return i?{point:i(n.point)}:n}function FW(n,i){return{x:n.x-i.x,y:n.y-i.y}}function oI({point:n},i){return{point:n,delta:FW(n,P$(i)),offset:FW(n,MSe(i)),velocity:jSe(i,.1)}}function MSe(n){return n[0]}function P$(n){return n[n.length-1]}function jSe(n,i){if(n.length<2)return{x:0,y:0};let o=n.length-1,c=null;const d=P$(n);for(;o>=0&&(c=n[o],!(d.timestamp-c.timestamp>Su(i)));)o--;if(!c)return{x:0,y:0};const f=td(d.timestamp-c.timestamp);if(f===0)return{x:0,y:0};const _={x:(d.x-c.x)/f,y:(d.y-c.y)/f};return _.x===1/0&&(_.x=0),_.y===1/0&&(_.y=0),_}function sa(n){return n.max-n.min}function RD(n,i=0,o=.01){return Math.abs(n-i)<=o}function VW(n,i,o,c=.5){n.origin=c,n.originPoint=hi(i.min,i.max,n.origin),n.scale=sa(o)/sa(i),(RD(n.scale,1,1e-4)||isNaN(n.scale))&&(n.scale=1),n.translate=hi(o.min,o.max,n.origin)-n.originPoint,(RD(n.translate)||isNaN(n.translate))&&(n.translate=0)}function D_(n,i,o,c){VW(n.x,i.x,o.x,c?c.originX:void 0),VW(n.y,i.y,o.y,c?c.originY:void 0)}function BW(n,i,o){n.min=o.min+i.min,n.max=n.min+sa(i)}function USe(n,i,o){BW(n.x,i.x,o.x),BW(n.y,i.y,o.y)}function WW(n,i,o){n.min=i.min-o.min,n.max=n.min+sa(i)}function P_(n,i,o){WW(n.x,i.x,o.x),WW(n.y,i.y,o.y)}function FSe(n,{min:i,max:o},c){return i!==void 0&&n<i?n=c?hi(i,n,c.min):Math.max(n,i):o!==void 0&&n>o&&(n=c?hi(o,n,c.max):Math.min(n,o)),n}function HW(n,i,o){return{min:i!==void 0?n.min+i:void 0,max:o!==void 0?n.max+o-(n.max-n.min):void 0}}function VSe(n,{top:i,left:o,bottom:c,right:d}){return{x:HW(n.x,o,d),y:HW(n.y,i,c)}}function GW(n,i){let o=i.min-n.min,c=i.max-n.max;return i.max-i.min<n.max-n.min&&([o,c]=[c,o]),{min:o,max:c}}function BSe(n,i){return{x:GW(n.x,i.x),y:GW(n.y,i.y)}}function WSe(n,i){let o=.5;const c=sa(n),d=sa(i);return d>c?o=cE(i.min,i.max-c,n.min):c>d&&(o=cE(n.min,n.max-d,i.min)),bu(0,1,o)}function HSe(n,i){const o={};return i.min!==void 0&&(o.min=i.min-n.min),i.max!==void 0&&(o.max=i.max-n.min),o}const AD=.35;function GSe(n=AD){return n===!1?n=0:n===!0&&(n=AD),{x:zW(n,"left","right"),y:zW(n,"top","bottom")}}function zW(n,i,o){return{min:KW(n,i),max:KW(n,o)}}function KW(n,i){return typeof n=="number"?n:n[i]||0}const qW=()=>({translate:0,scale:1,origin:0,originPoint:0}),Sm=()=>({x:qW(),y:qW()}),YW=()=>({min:0,max:0}),Mi=()=>({x:YW(),y:YW()});function Ua(n){return[n("x"),n("y")]}function k$({top:n,left:i,right:o,bottom:c}){return{x:{min:i,max:o},y:{min:n,max:c}}}function zSe({x:n,y:i}){return{top:i.min,right:n.max,bottom:i.max,left:n.min}}function KSe(n,i){if(!i)return n;const o=i({x:n.left,y:n.top}),c=i({x:n.right,y:n.bottom});return{top:o.y,left:o.x,bottom:c.y,right:c.x}}function aI(n){return n===void 0||n===1}function ND({scale:n,scaleX:i,scaleY:o}){return!aI(n)||!aI(i)||!aI(o)}function Bh(n){return ND(n)||L$(n)||n.z||n.rotate||n.rotateX||n.rotateY}function L$(n){return $W(n.x)||$W(n.y)}function $W(n){return n&&n!=="0%"}function DT(n,i,o){const c=n-o,d=i*c;return o+d}function XW(n,i,o,c,d){return d!==void 0&&(n=DT(n,d,c)),DT(n,o,c)+i}function ID(n,i=0,o=1,c,d){n.min=XW(n.min,i,o,c,d),n.max=XW(n.max,i,o,c,d)}function M$(n,{x:i,y:o}){ID(n.x,i.translate,i.scale,i.originPoint),ID(n.y,o.translate,o.scale,o.originPoint)}function qSe(n,i,o,c=!1){const d=o.length;if(!d)return;i.x=i.y=1;let f,_;for(let v=0;v<d;v++){f=o[v],_=f.projectionDelta;const x=f.instance;x&&x.style&&x.style.display==="contents"||(c&&f.options.layoutScroll&&f.scroll&&f!==f.root&&xm(n,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),_&&(i.x*=_.x.scale,i.y*=_.y.scale,M$(n,_)),c&&Bh(f.latestValues)&&xm(n,f.latestValues))}i.x=JW(i.x),i.y=JW(i.y)}function JW(n){return Number.isInteger(n)||n>1.0000000000001||n<.999999999999?n:1}function iu(n,i){n.min=n.min+i,n.max=n.max+i}function QW(n,i,[o,c,d]){const f=i[d]!==void 0?i[d]:.5,_=hi(n.min,n.max,f);ID(n,i[o],i[c],_,i.scale)}const YSe=["x","scaleX","originX"],$Se=["y","scaleY","originY"];function xm(n,i){QW(n.x,i,YSe),QW(n.y,i,$Se)}function j$(n,i){return k$(KSe(n.getBoundingClientRect(),i))}function XSe(n,i,o){const c=j$(n,o),{scroll:d}=i;return d&&(iu(c.x,d.offset.x),iu(c.y,d.offset.y)),c}const U$=({current:n})=>n?n.ownerDocument.defaultView:null,JSe=new WeakMap;class QSe{constructor(i){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Mi(),this.visualElement=i}start(i,{snapToCursor:o=!1}={}){const{presenceContext:c}=this.visualElement;if(c&&c.isPresent===!1)return;const d=w=>{const{dragSnapToOrigin:R}=this.getProps();R?this.pauseAnimation():this.stopAnimation(),o&&this.snapToCursor(wb(w,"page").point)},f=(w,R)=>{const{drag:I,dragPropagation:j,onDragStart:P}=this.getProps();if(I&&!j&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=JY(I),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ua(W=>{let H=this.getAxisMotionValue(W).get()||0;if(yl.test(H)){const{projection:L}=this.visualElement;if(L&&L.layout){const V=L.layout.layoutBox[W];V&&(H=sa(V)*(parseFloat(H)/100))}}this.originPoint[W]=H}),P&&Kr.update(()=>P(w,R),!1,!0);const{animationState:k}=this.visualElement;k&&k.setActive("whileDrag",!0)},_=(w,R)=>{const{dragPropagation:I,dragDirectionLock:j,onDirectionLock:P,onDrag:k}=this.getProps();if(!I&&!this.openGlobalLock)return;const{offset:W}=R;if(j&&this.currentDirection===null){this.currentDirection=ZSe(W),this.currentDirection!==null&&P&&P(this.currentDirection);return}this.updateAxis("x",R.point,W),this.updateAxis("y",R.point,W),this.visualElement.render(),k&&k(w,R)},v=(w,R)=>this.stop(w,R),x=()=>Ua(w=>{var R;return this.getAnimationState(w)==="paused"&&((R=this.getAxisMotionValue(w).animation)===null||R===void 0?void 0:R.play())}),{dragSnapToOrigin:T}=this.getProps();this.panSession=new D$(i,{onSessionStart:d,onStart:f,onMove:_,onSessionEnd:v,resumeAnimation:x},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:T,contextWindow:U$(this.visualElement)})}stop(i,o){const c=this.isDragging;if(this.cancel(),!c)return;const{velocity:d}=o;this.startAnimation(d);const{onDragEnd:f}=this.getProps();f&&Kr.update(()=>f(i,o))}cancel(){this.isDragging=!1;const{projection:i,animationState:o}=this.visualElement;i&&(i.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:c}=this.getProps();!c&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),o&&o.setActive("whileDrag",!1)}updateAxis(i,o,c){const{drag:d}=this.getProps();if(!c||!dx(i,d,this.currentDirection))return;const f=this.getAxisMotionValue(i);let _=this.originPoint[i]+c[i];this.constraints&&this.constraints[i]&&(_=FSe(_,this.constraints[i],this.elastic[i])),f.set(_)}resolveConstraints(){var i;const{dragConstraints:o,dragElastic:c}=this.getProps(),d=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)===null||i===void 0?void 0:i.layout,f=this.constraints;o&&vm(o)?this.constraints||(this.constraints=this.resolveRefConstraints()):o&&d?this.constraints=VSe(d.layoutBox,o):this.constraints=!1,this.elastic=GSe(c),f!==this.constraints&&d&&this.constraints&&!this.hasMutatedConstraints&&Ua(_=>{this.getAxisMotionValue(_)&&(this.constraints[_]=HSe(d.layoutBox[_],this.constraints[_]))})}resolveRefConstraints(){const{dragConstraints:i,onMeasureDragConstraints:o}=this.getProps();if(!i||!vm(i))return!1;const c=i.current,{projection:d}=this.visualElement;if(!d||!d.layout)return!1;const f=XSe(c,d.root,this.visualElement.getTransformPagePoint());let _=BSe(d.layout.layoutBox,f);if(o){const v=o(zSe(_));this.hasMutatedConstraints=!!v,v&&(_=k$(v))}return _}startAnimation(i){const{drag:o,dragMomentum:c,dragElastic:d,dragTransition:f,dragSnapToOrigin:_,onDragTransitionEnd:v}=this.getProps(),x=this.constraints||{},T=Ua(w=>{if(!dx(w,o,this.currentDirection))return;let R=x&&x[w]||{};_&&(R={min:0,max:0});const I=d?200:1e6,j=d?40:1e7,P={type:"inertia",velocity:c?i[w]:0,bounceStiffness:I,bounceDamping:j,timeConstant:750,restDelta:1,restSpeed:10,...f,...R};return this.startAxisValueAnimation(w,P)});return Promise.all(T).then(v)}startAxisValueAnimation(i,o){const c=this.getAxisMotionValue(i);return c.start(kk(i,c,0,o))}stopAnimation(){Ua(i=>this.getAxisMotionValue(i).stop())}pauseAnimation(){Ua(i=>{var o;return(o=this.getAxisMotionValue(i).animation)===null||o===void 0?void 0:o.pause()})}getAnimationState(i){var o;return(o=this.getAxisMotionValue(i).animation)===null||o===void 0?void 0:o.state}getAxisMotionValue(i){const o="_drag"+i.toUpperCase(),c=this.visualElement.getProps(),d=c[o];return d||this.visualElement.getValue(i,(c.initial?c.initial[i]:void 0)||0)}snapToCursor(i){Ua(o=>{const{drag:c}=this.getProps();if(!dx(o,c,this.currentDirection))return;const{projection:d}=this.visualElement,f=this.getAxisMotionValue(o);if(d&&d.layout){const{min:_,max:v}=d.layout.layoutBox[o];f.set(i[o]-hi(_,v,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:i,dragConstraints:o}=this.getProps(),{projection:c}=this.visualElement;if(!vm(o)||!c||!this.constraints)return;this.stopAnimation();const d={x:0,y:0};Ua(_=>{const v=this.getAxisMotionValue(_);if(v){const x=v.get();d[_]=WSe({min:x,max:x},this.constraints[_])}});const{transformTemplate:f}=this.visualElement.getProps();this.visualElement.current.style.transform=f?f({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.resolveConstraints(),Ua(_=>{if(!dx(_,i,null))return;const v=this.getAxisMotionValue(_),{min:x,max:T}=this.constraints[_];v.set(hi(x,T,d[_]))})}addListeners(){if(!this.visualElement.current)return;JSe.set(this.visualElement,this);const i=this.visualElement.current,o=ed(i,"pointerdown",x=>{const{drag:T,dragListener:w=!0}=this.getProps();T&&w&&this.start(x)}),c=()=>{const{dragConstraints:x}=this.getProps();vm(x)&&(this.constraints=this.resolveRefConstraints())},{projection:d}=this.visualElement,f=d.addEventListener("measure",c);d&&!d.layout&&(d.root&&d.root.updateScroll(),d.updateLayout()),c();const _=Ql(window,"resize",()=>this.scalePositionWithinConstraints()),v=d.addEventListener("didUpdate",({delta:x,hasLayoutChanged:T})=>{this.isDragging&&T&&(Ua(w=>{const R=this.getAxisMotionValue(w);R&&(this.originPoint[w]+=x[w].translate,R.set(R.get()+x[w].translate))}),this.visualElement.render())});return()=>{_(),o(),f(),v&&v()}}getProps(){const i=this.visualElement.getProps(),{drag:o=!1,dragDirectionLock:c=!1,dragPropagation:d=!1,dragConstraints:f=!1,dragElastic:_=AD,dragMomentum:v=!0}=i;return{...i,drag:o,dragDirectionLock:c,dragPropagation:d,dragConstraints:f,dragElastic:_,dragMomentum:v}}}function dx(n,i,o){return(i===!0||i===n)&&(o===null||o===n)}function ZSe(n,i=10){let o=null;return Math.abs(n.y)>i?o="y":Math.abs(n.x)>i&&(o="x"),o}class exe extends Du{constructor(i){super(i),this.removeGroupControls=wi,this.removeListeners=wi,this.controls=new QSe(i)}mount(){const{dragControls:i}=this.node.getProps();i&&(this.removeGroupControls=i.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wi}unmount(){this.removeGroupControls(),this.removeListeners()}}const ZW=n=>(i,o)=>{n&&Kr.update(()=>n(i,o))};class txe extends Du{constructor(){super(...arguments),this.removePointerDownListener=wi}onPointerDown(i){this.session=new D$(i,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:U$(this.node)})}createPanHandlers(){const{onPanSessionStart:i,onPanStart:o,onPan:c,onPanEnd:d}=this.node.getProps();return{onSessionStart:ZW(i),onStart:ZW(o),onMove:c,onEnd:(f,_)=>{delete this.session,d&&Kr.update(()=>d(f,_))}}}mount(){this.removePointerDownListener=ed(this.node.current,"pointerdown",i=>this.onPointerDown(i))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function nxe(){const n=X.useContext(_k);if(n===null)return[!0,null];const{isPresent:i,onExitComplete:o,register:c}=n,d=X.useId();return X.useEffect(()=>c(d),[]),!i&&o?[!1,()=>o&&o(d)]:[!0]}const Px={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function eH(n,i){return i.max===i.min?0:n/(i.max-i.min)*100}const c_={correct:(n,i)=>{if(!i.target)return n;if(typeof n=="string")if(sn.test(n))n=parseFloat(n);else return n;const o=eH(n,i.target.x),c=eH(n,i.target.y);return`${o}% ${c}%`}},rxe={correct:(n,{treeScale:i,projectionDelta:o})=>{const c=n,d=wu.parse(n);if(d.length>5)return c;const f=wu.createTransformer(n),_=typeof d[0]!="number"?1:0,v=o.x.scale*i.x,x=o.y.scale*i.y;d[0+_]/=v,d[1+_]/=x;const T=hi(v,x,.5);return typeof d[2+_]=="number"&&(d[2+_]/=T),typeof d[3+_]=="number"&&(d[3+_]/=T),f(d)}};class ixe extends wt.Component{componentDidMount(){const{visualElement:i,layoutGroup:o,switchLayoutGroup:c,layoutId:d}=this.props,{projection:f}=i;dve(sxe),f&&(o.group&&o.group.add(f),c&&c.register&&d&&c.register(f),f.root.didUpdate(),f.addEventListener("animationComplete",()=>{this.safeToRemove()}),f.setOptions({...f.options,onExitComplete:()=>this.safeToRemove()})),Px.hasEverUpdated=!0}getSnapshotBeforeUpdate(i){const{layoutDependency:o,visualElement:c,drag:d,isPresent:f}=this.props,_=c.projection;return _&&(_.isPresent=f,d||i.layoutDependency!==o||o===void 0?_.willUpdate():this.safeToRemove(),i.isPresent!==f&&(f?_.promote():_.relegate()||Kr.postRender(()=>{const v=_.getStack();(!v||!v.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:i}=this.props.visualElement;i&&(i.root.didUpdate(),queueMicrotask(()=>{!i.currentAnimation&&i.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:i,layoutGroup:o,switchLayoutGroup:c}=this.props,{projection:d}=i;d&&(d.scheduleCheckAfterUnmount(),o&&o.group&&o.group.remove(d),c&&c.deregister&&c.deregister(d))}safeToRemove(){const{safeToRemove:i}=this.props;i&&i()}render(){return null}}function F$(n){const[i,o]=nxe(),c=X.useContext(kY);return wt.createElement(ixe,{...n,layoutGroup:c,switchLayoutGroup:X.useContext(LY),isPresent:i,safeToRemove:o})}const sxe={borderRadius:{...c_,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:c_,borderTopRightRadius:c_,borderBottomLeftRadius:c_,borderBottomRightRadius:c_,boxShadow:rxe},V$=["TopLeft","TopRight","BottomLeft","BottomRight"],oxe=V$.length,tH=n=>typeof n=="string"?parseFloat(n):n,nH=n=>typeof n=="number"||sn.test(n);function axe(n,i,o,c,d,f){d?(n.opacity=hi(0,o.opacity!==void 0?o.opacity:1,cxe(c)),n.opacityExit=hi(i.opacity!==void 0?i.opacity:1,0,lxe(c))):f&&(n.opacity=hi(i.opacity!==void 0?i.opacity:1,o.opacity!==void 0?o.opacity:1,c));for(let _=0;_<oxe;_++){const v=`border${V$[_]}Radius`;let x=rH(i,v),T=rH(o,v);if(x===void 0&&T===void 0)continue;x||(x=0),T||(T=0),x===0||T===0||nH(x)===nH(T)?(n[v]=Math.max(hi(tH(x),tH(T),c),0),(yl.test(T)||yl.test(x))&&(n[v]+="%")):n[v]=T}(i.rotate||o.rotate)&&(n.rotate=hi(i.rotate||0,o.rotate||0,c))}function rH(n,i){return n[i]!==void 0?n[i]:n.borderRadius}const cxe=B$(0,.5,l$),lxe=B$(.5,.95,wi);function B$(n,i,o){return c=>c<n?0:c>i?1:o(cE(n,i,c))}function iH(n,i){n.min=i.min,n.max=i.max}function ja(n,i){iH(n.x,i.x),iH(n.y,i.y)}function sH(n,i,o,c,d){return n-=i,n=DT(n,1/o,c),d!==void 0&&(n=DT(n,1/d,c)),n}function dxe(n,i=0,o=1,c=.5,d,f=n,_=n){if(yl.test(i)&&(i=parseFloat(i),i=hi(_.min,_.max,i/100)-_.min),typeof i!="number")return;let v=hi(f.min,f.max,c);n===f&&(v-=i),n.min=sH(n.min,i,o,v,d),n.max=sH(n.max,i,o,v,d)}function oH(n,i,[o,c,d],f,_){dxe(n,i[o],i[c],i[d],i.scale,f,_)}const uxe=["x","scaleX","originX"],hxe=["y","scaleY","originY"];function aH(n,i,o,c){oH(n.x,i,uxe,o?o.x:void 0,c?c.x:void 0),oH(n.y,i,hxe,o?o.y:void 0,c?c.y:void 0)}function cH(n){return n.translate===0&&n.scale===1}function W$(n){return cH(n.x)&&cH(n.y)}function pxe(n,i){return n.x.min===i.x.min&&n.x.max===i.x.max&&n.y.min===i.y.min&&n.y.max===i.y.max}function H$(n,i){return Math.round(n.x.min)===Math.round(i.x.min)&&Math.round(n.x.max)===Math.round(i.x.max)&&Math.round(n.y.min)===Math.round(i.y.min)&&Math.round(n.y.max)===Math.round(i.y.max)}function lH(n){return sa(n.x)/sa(n.y)}class fxe{constructor(){this.members=[]}add(i){Lk(this.members,i),i.scheduleRender()}remove(i){if(Mk(this.members,i),i===this.prevLead&&(this.prevLead=void 0),i===this.lead){const o=this.members[this.members.length-1];o&&this.promote(o)}}relegate(i){const o=this.members.findIndex(d=>i===d);if(o===0)return!1;let c;for(let d=o;d>=0;d--){const f=this.members[d];if(f.isPresent!==!1){c=f;break}}return c?(this.promote(c),!0):!1}promote(i,o){const c=this.lead;if(i!==c&&(this.prevLead=c,this.lead=i,i.show(),c)){c.instance&&c.scheduleRender(),i.scheduleRender(),i.resumeFrom=c,o&&(i.resumeFrom.preserveOpacity=!0),c.snapshot&&(i.snapshot=c.snapshot,i.snapshot.latestValues=c.animationValues||c.latestValues),i.root&&i.root.isUpdating&&(i.isLayoutDirty=!0);const{crossfade:d}=i.options;d===!1&&c.hide()}}exitAnimationComplete(){this.members.forEach(i=>{const{options:o,resumingFrom:c}=i;o.onExitComplete&&o.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(i=>{i.instance&&i.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function dH(n,i,o){let c="";const d=n.x.translate/i.x,f=n.y.translate/i.y;if((d||f)&&(c=`translate3d(${d}px, ${f}px, 0) `),(i.x!==1||i.y!==1)&&(c+=`scale(${1/i.x}, ${1/i.y}) `),o){const{rotate:x,rotateX:T,rotateY:w}=o;x&&(c+=`rotate(${x}deg) `),T&&(c+=`rotateX(${T}deg) `),w&&(c+=`rotateY(${w}deg) `)}const _=n.x.scale*i.x,v=n.y.scale*i.y;return(_!==1||v!==1)&&(c+=`scale(${_}, ${v})`),c||"none"}const mxe=(n,i)=>n.depth-i.depth;class gxe{constructor(){this.children=[],this.isDirty=!1}add(i){Lk(this.children,i),this.isDirty=!0}remove(i){Mk(this.children,i),this.isDirty=!0}forEach(i){this.isDirty&&this.children.sort(mxe),this.isDirty=!1,this.children.forEach(i)}}function _xe(n,i){const o=performance.now(),c=({timestamp:d})=>{const f=d-o;f>=i&&(ld(c),n(f-i))};return Kr.read(c,!0),()=>ld(c)}function Exe(n){window.MotionDebug&&window.MotionDebug.record(n)}function vxe(n){return n instanceof SVGElement&&n.tagName!=="svg"}function yxe(n,i,o){const c=Mo(n)?n:Bm(n);return c.start(kk("",c,i,o)),c.animation}const uH=["","X","Y","Z"],Sxe={visibility:"hidden"},hH=1e3;let xxe=0;const Wh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function G$({attachResizeListener:n,defaultParent:i,measureScroll:o,checkIsScrollRoot:c,resetTransform:d}){return class{constructor(_={},v=i==null?void 0:i()){this.id=xxe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Wh.totalNodes=Wh.resolvedTargetDeltas=Wh.recalculatedProjection=0,this.nodes.forEach(wxe),this.nodes.forEach(Ixe),this.nodes.forEach(Oxe),this.nodes.forEach(Cxe),Exe(Wh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=_,this.root=v?v.root||v:this,this.path=v?[...v.path,v]:[],this.parent=v,this.depth=v?v.depth+1:0;for(let x=0;x<this.path.length;x++)this.path[x].shouldResetTransform=!0;this.root===this&&(this.nodes=new gxe)}addEventListener(_,v){return this.eventHandlers.has(_)||this.eventHandlers.set(_,new jk),this.eventHandlers.get(_).add(v)}notifyListeners(_,...v){const x=this.eventHandlers.get(_);x&&x.notify(...v)}hasListeners(_){return this.eventHandlers.has(_)}mount(_,v=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=vxe(_),this.instance=_;const{layoutId:x,layout:T,visualElement:w}=this.options;if(w&&!w.current&&w.mount(_),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),v&&(T||x)&&(this.isLayoutDirty=!0),n){let R;const I=()=>this.root.updateBlockedByResize=!1;n(_,()=>{this.root.updateBlockedByResize=!0,R&&R(),R=_xe(I,250),Px.hasAnimatedSinceResize&&(Px.hasAnimatedSinceResize=!1,this.nodes.forEach(fH))})}x&&this.root.registerSharedNode(x,this),this.options.animate!==!1&&w&&(x||T)&&this.addEventListener("didUpdate",({delta:R,hasLayoutChanged:I,hasRelativeTargetChanged:j,layout:P})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const k=this.options.transition||w.getDefaultTransition()||Mxe,{onLayoutAnimationStart:W,onLayoutAnimationComplete:H}=w.getProps(),L=!this.targetLayout||!H$(this.targetLayout,P)||j,V=!I&&j;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||V||I&&(L||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(R,V);const K={...Pk(k,"layout"),onPlay:W,onComplete:H};(w.shouldReduceMotion||this.options.layoutRoot)&&(K.delay=0,K.type=!1),this.startAnimation(K)}else I||fH(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=P})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const _=this.getStack();_&&_.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ld(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Dxe),this.animationId++)}getTransformTemplate(){const{visualElement:_}=this.options;return _&&_.getProps().transformTemplate}willUpdate(_=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let w=0;w<this.path.length;w++){const R=this.path[w];R.shouldResetTransform=!0,R.updateScroll("snapshot"),R.options.layoutRoot&&R.willUpdate(!1)}const{layoutId:v,layout:x}=this.options;if(v===void 0&&!x)return;const T=this.getTransformTemplate();this.prevTransformTemplateValue=T?T(this.latestValues,""):void 0,this.updateSnapshot(),_&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(pH);return}this.isUpdating||this.nodes.forEach(Axe),this.isUpdating=!1,this.nodes.forEach(Nxe),this.nodes.forEach(Txe),this.nodes.forEach(bxe),this.clearAllSnapshots();const v=performance.now();Bs.delta=bu(0,1e3/60,v-Bs.timestamp),Bs.timestamp=v,Bs.isProcessing=!0,JN.update.process(Bs),JN.preRender.process(Bs),JN.render.process(Bs),Bs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Rxe),this.sharedNodes.forEach(Pxe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Kr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Kr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let x=0;x<this.path.length;x++)this.path[x].updateScroll();const _=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Mi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:v}=this.options;v&&v.notify("LayoutMeasure",this.layout.layoutBox,_?_.layoutBox:void 0)}updateScroll(_="measure"){let v=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===_&&(v=!1),v&&(this.scroll={animationId:this.root.animationId,phase:_,isRoot:c(this.instance),offset:o(this.instance)})}resetTransform(){if(!d)return;const _=this.isLayoutDirty||this.shouldResetTransform,v=this.projectionDelta&&!W$(this.projectionDelta),x=this.getTransformTemplate(),T=x?x(this.latestValues,""):void 0,w=T!==this.prevTransformTemplateValue;_&&(v||Bh(this.latestValues)||w)&&(d(this.instance,T),this.shouldResetTransform=!1,this.scheduleRender())}measure(_=!0){const v=this.measurePageBox();let x=this.removeElementScroll(v);return _&&(x=this.removeTransform(x)),jxe(x),{animationId:this.root.animationId,measuredBox:v,layoutBox:x,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:_}=this.options;if(!_)return Mi();const v=_.measureViewportBox(),{scroll:x}=this.root;return x&&(iu(v.x,x.offset.x),iu(v.y,x.offset.y)),v}removeElementScroll(_){const v=Mi();ja(v,_);for(let x=0;x<this.path.length;x++){const T=this.path[x],{scroll:w,options:R}=T;if(T!==this.root&&w&&R.layoutScroll){if(w.isRoot){ja(v,_);const{scroll:I}=this.root;I&&(iu(v.x,-I.offset.x),iu(v.y,-I.offset.y))}iu(v.x,w.offset.x),iu(v.y,w.offset.y)}}return v}applyTransform(_,v=!1){const x=Mi();ja(x,_);for(let T=0;T<this.path.length;T++){const w=this.path[T];!v&&w.options.layoutScroll&&w.scroll&&w!==w.root&&xm(x,{x:-w.scroll.offset.x,y:-w.scroll.offset.y}),Bh(w.latestValues)&&xm(x,w.latestValues)}return Bh(this.latestValues)&&xm(x,this.latestValues),x}removeTransform(_){const v=Mi();ja(v,_);for(let x=0;x<this.path.length;x++){const T=this.path[x];if(!T.instance||!Bh(T.latestValues))continue;ND(T.latestValues)&&T.updateSnapshot();const w=Mi(),R=T.measurePageBox();ja(w,R),aH(v,T.latestValues,T.snapshot?T.snapshot.layoutBox:void 0,w)}return Bh(this.latestValues)&&aH(v,this.latestValues),v}setTargetDelta(_){this.targetDelta=_,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(_){this.options={...this.options,..._,crossfade:_.crossfade!==void 0?_.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(_=!1){var v;const x=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=x.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=x.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=x.isSharedProjectionDirty);const T=!!this.resumingFrom||this!==x;if(!(_||T&&this.isSharedProjectionDirty||this.isProjectionDirty||!((v=this.parent)===null||v===void 0)&&v.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:R,layoutId:I}=this.options;if(!(!this.layout||!(R||I))){if(this.resolvedRelativeTargetAt=Bs.timestamp,!this.targetDelta&&!this.relativeTarget){const j=this.getClosestProjectingParent();j&&j.layout&&this.animationProgress!==1?(this.relativeParent=j,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mi(),this.relativeTargetOrigin=Mi(),P_(this.relativeTargetOrigin,this.layout.layoutBox,j.layout.layoutBox),ja(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Mi(),this.targetWithTransforms=Mi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),USe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ja(this.target,this.layout.layoutBox),M$(this.target,this.targetDelta)):ja(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const j=this.getClosestProjectingParent();j&&!!j.resumingFrom==!!this.resumingFrom&&!j.options.layoutScroll&&j.target&&this.animationProgress!==1?(this.relativeParent=j,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Mi(),this.relativeTargetOrigin=Mi(),P_(this.relativeTargetOrigin,this.target,j.target),ja(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Wh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||ND(this.parent.latestValues)||L$(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var _;const v=this.getLead(),x=!!this.resumingFrom||this!==v;let T=!0;if((this.isProjectionDirty||!((_=this.parent)===null||_===void 0)&&_.isProjectionDirty)&&(T=!1),x&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(T=!1),this.resolvedRelativeTargetAt===Bs.timestamp&&(T=!1),T)return;const{layout:w,layoutId:R}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(w||R))return;ja(this.layoutCorrected,this.layout.layoutBox);const I=this.treeScale.x,j=this.treeScale.y;qSe(this.layoutCorrected,this.treeScale,this.path,x),v.layout&&!v.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(v.target=v.layout.layoutBox);const{target:P}=v;if(!P){this.projectionTransform&&(this.projectionDelta=Sm(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Sm(),this.projectionDeltaWithTransform=Sm());const k=this.projectionTransform;D_(this.projectionDelta,this.layoutCorrected,P,this.latestValues),this.projectionTransform=dH(this.projectionDelta,this.treeScale),(this.projectionTransform!==k||this.treeScale.x!==I||this.treeScale.y!==j)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",P)),Wh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(_=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),_){const v=this.getStack();v&&v.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(_,v=!1){const x=this.snapshot,T=x?x.latestValues:{},w={...this.latestValues},R=Sm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!v;const I=Mi(),j=x?x.source:void 0,P=this.layout?this.layout.source:void 0,k=j!==P,W=this.getStack(),H=!W||W.members.length<=1,L=!!(k&&!H&&this.options.crossfade===!0&&!this.path.some(Lxe));this.animationProgress=0;let V;this.mixTargetDelta=K=>{const te=K/1e3;mH(R.x,_.x,te),mH(R.y,_.y,te),this.setTargetDelta(R),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(P_(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),kxe(this.relativeTarget,this.relativeTargetOrigin,I,te),V&&pxe(this.relativeTarget,V)&&(this.isProjectionDirty=!1),V||(V=Mi()),ja(V,this.relativeTarget)),k&&(this.animationValues=w,axe(w,T,this.latestValues,te,L,H)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=te},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(_){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ld(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Kr.update(()=>{Px.hasAnimatedSinceResize=!0,this.currentAnimation=yxe(0,hH,{..._,onUpdate:v=>{this.mixTargetDelta(v),_.onUpdate&&_.onUpdate(v)},onComplete:()=>{_.onComplete&&_.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const _=this.getStack();_&&_.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(hH),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const _=this.getLead();let{targetWithTransforms:v,target:x,layout:T,latestValues:w}=_;if(!(!v||!x||!T)){if(this!==_&&this.layout&&T&&z$(this.options.animationType,this.layout.layoutBox,T.layoutBox)){x=this.target||Mi();const R=sa(this.layout.layoutBox.x);x.x.min=_.target.x.min,x.x.max=x.x.min+R;const I=sa(this.layout.layoutBox.y);x.y.min=_.target.y.min,x.y.max=x.y.min+I}ja(v,x),xm(v,w),D_(this.projectionDeltaWithTransform,this.layoutCorrected,v,w)}}registerSharedNode(_,v){this.sharedNodes.has(_)||this.sharedNodes.set(_,new fxe),this.sharedNodes.get(_).add(v);const T=v.options.initialPromotionConfig;v.promote({transition:T?T.transition:void 0,preserveFollowOpacity:T&&T.shouldPreserveFollowOpacity?T.shouldPreserveFollowOpacity(v):void 0})}isLead(){const _=this.getStack();return _?_.lead===this:!0}getLead(){var _;const{layoutId:v}=this.options;return v?((_=this.getStack())===null||_===void 0?void 0:_.lead)||this:this}getPrevLead(){var _;const{layoutId:v}=this.options;return v?(_=this.getStack())===null||_===void 0?void 0:_.prevLead:void 0}getStack(){const{layoutId:_}=this.options;if(_)return this.root.sharedNodes.get(_)}promote({needsReset:_,transition:v,preserveFollowOpacity:x}={}){const T=this.getStack();T&&T.promote(this,x),_&&(this.projectionDelta=void 0,this.needsReset=!0),v&&this.setOptions({transition:v})}relegate(){const _=this.getStack();return _?_.relegate(this):!1}resetRotation(){const{visualElement:_}=this.options;if(!_)return;let v=!1;const{latestValues:x}=_;if((x.rotate||x.rotateX||x.rotateY||x.rotateZ)&&(v=!0),!v)return;const T={};for(let w=0;w<uH.length;w++){const R="rotate"+uH[w];x[R]&&(T[R]=x[R],_.setStaticValue(R,0))}_.render();for(const w in T)_.setStaticValue(w,T[w]);_.scheduleRender()}getProjectionStyles(_){var v,x;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Sxe;const T={visibility:""},w=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,T.opacity="",T.pointerEvents=Dx(_==null?void 0:_.pointerEvents)||"",T.transform=w?w(this.latestValues,""):"none",T;const R=this.getLead();if(!this.projectionDelta||!this.layout||!R.target){const k={};return this.options.layoutId&&(k.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,k.pointerEvents=Dx(_==null?void 0:_.pointerEvents)||""),this.hasProjected&&!Bh(this.latestValues)&&(k.transform=w?w({},""):"none",this.hasProjected=!1),k}const I=R.animationValues||R.latestValues;this.applyTransformsToTarget(),T.transform=dH(this.projectionDeltaWithTransform,this.treeScale,I),w&&(T.transform=w(I,T.transform));const{x:j,y:P}=this.projectionDelta;T.transformOrigin=`${j.origin*100}% ${P.origin*100}% 0`,R.animationValues?T.opacity=R===this?(x=(v=I.opacity)!==null&&v!==void 0?v:this.latestValues.opacity)!==null&&x!==void 0?x:1:this.preserveOpacity?this.latestValues.opacity:I.opacityExit:T.opacity=R===this?I.opacity!==void 0?I.opacity:"":I.opacityExit!==void 0?I.opacityExit:0;for(const k in wT){if(I[k]===void 0)continue;const{correct:W,applyTo:H}=wT[k],L=T.transform==="none"?I[k]:W(I[k],R);if(H){const V=H.length;for(let K=0;K<V;K++)T[H[K]]=L}else T[k]=L}return this.options.layoutId&&(T.pointerEvents=R===this?Dx(_==null?void 0:_.pointerEvents)||"":"none"),T}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(_=>{var v;return(v=_.currentAnimation)===null||v===void 0?void 0:v.stop()}),this.root.nodes.forEach(pH),this.root.sharedNodes.clear()}}}function Txe(n){n.updateLayout()}function bxe(n){var i;const o=((i=n.resumeFrom)===null||i===void 0?void 0:i.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&o&&n.hasListeners("didUpdate")){const{layoutBox:c,measuredBox:d}=n.layout,{animationType:f}=n.options,_=o.source!==n.layout.source;f==="size"?Ua(R=>{const I=_?o.measuredBox[R]:o.layoutBox[R],j=sa(I);I.min=c[R].min,I.max=I.min+j}):z$(f,o.layoutBox,c)&&Ua(R=>{const I=_?o.measuredBox[R]:o.layoutBox[R],j=sa(c[R]);I.max=I.min+j,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[R].max=n.relativeTarget[R].min+j)});const v=Sm();D_(v,c,o.layoutBox);const x=Sm();_?D_(x,n.applyTransform(d,!0),o.measuredBox):D_(x,c,o.layoutBox);const T=!W$(v);let w=!1;if(!n.resumeFrom){const R=n.getClosestProjectingParent();if(R&&!R.resumeFrom){const{snapshot:I,layout:j}=R;if(I&&j){const P=Mi();P_(P,o.layoutBox,I.layoutBox);const k=Mi();P_(k,c,j.layoutBox),H$(P,k)||(w=!0),R.options.layoutRoot&&(n.relativeTarget=k,n.relativeTargetOrigin=P,n.relativeParent=R)}}}n.notifyListeners("didUpdate",{layout:c,snapshot:o,delta:x,layoutDelta:v,hasLayoutChanged:T,hasRelativeTargetChanged:w})}else if(n.isLead()){const{onExitComplete:c}=n.options;c&&c()}n.options.transition=void 0}function wxe(n){Wh.totalNodes++,n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Cxe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function Rxe(n){n.clearSnapshot()}function pH(n){n.clearMeasurements()}function Axe(n){n.isLayoutDirty=!1}function Nxe(n){const{visualElement:i}=n.options;i&&i.getProps().onBeforeLayoutMeasure&&i.notify("BeforeLayoutMeasure"),n.resetTransform()}function fH(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Ixe(n){n.resolveTargetDelta()}function Oxe(n){n.calcProjection()}function Dxe(n){n.resetRotation()}function Pxe(n){n.removeLeadSnapshot()}function mH(n,i,o){n.translate=hi(i.translate,0,o),n.scale=hi(i.scale,1,o),n.origin=i.origin,n.originPoint=i.originPoint}function gH(n,i,o,c){n.min=hi(i.min,o.min,c),n.max=hi(i.max,o.max,c)}function kxe(n,i,o,c){gH(n.x,i.x,o.x,c),gH(n.y,i.y,o.y,c)}function Lxe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Mxe={duration:.45,ease:[.4,0,.1,1]},_H=n=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(n),EH=_H("applewebkit/")&&!_H("chrome/")?Math.round:wi;function vH(n){n.min=EH(n.min),n.max=EH(n.max)}function jxe(n){vH(n.x),vH(n.y)}function z$(n,i,o){return n==="position"||n==="preserve-aspect"&&!RD(lH(i),lH(o),.2)}const Uxe=G$({attachResizeListener:(n,i)=>Ql(n,"resize",i),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),cI={current:void 0},K$=G$({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!cI.current){const n=new Uxe({});n.mount(window),n.setOptions({layoutScroll:!0}),cI.current=n}return cI.current},resetTransform:(n,i)=>{n.style.transform=i!==void 0?i:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Fxe={pan:{Feature:txe},drag:{Feature:exe,ProjectionNode:K$,MeasureLayout:F$}},Vxe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Bxe(n){const i=Vxe.exec(n);if(!i)return[,];const[,o,c]=i;return[o,c]}function OD(n,i,o=1){const[c,d]=Bxe(n);if(!c)return;const f=window.getComputedStyle(i).getPropertyValue(c);if(f){const _=f.trim();return A$(_)?parseFloat(_):_}else return yD(d)?OD(d,i,o+1):d}function Wxe(n,{...i},o){const c=n.current;if(!(c instanceof Element))return{target:i,transitionEnd:o};o&&(o={...o}),n.values.forEach(d=>{const f=d.get();if(!yD(f))return;const _=OD(f,c);_&&d.set(_)});for(const d in i){const f=i[d];if(!yD(f))continue;const _=OD(f,c);_&&(i[d]=_,o||(o={}),o[d]===void 0&&(o[d]=f))}return{target:i,transitionEnd:o}}const Hxe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),q$=n=>Hxe.has(n),Gxe=n=>Object.keys(n).some(q$),yH=n=>n===bp||n===sn,SH=(n,i)=>parseFloat(n.split(", ")[i]),xH=(n,i)=>(o,{transform:c})=>{if(c==="none"||!c)return 0;const d=c.match(/^matrix3d\((.+)\)$/);if(d)return SH(d[1],i);{const f=c.match(/^matrix\((.+)\)$/);return f?SH(f[1],n):0}},zxe=new Set(["x","y","z"]),Kxe=xE.filter(n=>!zxe.has(n));function qxe(n){const i=[];return Kxe.forEach(o=>{const c=n.getValue(o);c!==void 0&&(i.push([o,c.get()]),c.set(o.startsWith("scale")?1:0))}),i.length&&n.render(),i}const Wm={width:({x:n},{paddingLeft:i="0",paddingRight:o="0"})=>n.max-n.min-parseFloat(i)-parseFloat(o),height:({y:n},{paddingTop:i="0",paddingBottom:o="0"})=>n.max-n.min-parseFloat(i)-parseFloat(o),top:(n,{top:i})=>parseFloat(i),left:(n,{left:i})=>parseFloat(i),bottom:({y:n},{top:i})=>parseFloat(i)+(n.max-n.min),right:({x:n},{left:i})=>parseFloat(i)+(n.max-n.min),x:xH(4,13),y:xH(5,14)};Wm.translateX=Wm.x;Wm.translateY=Wm.y;const Yxe=(n,i,o)=>{const c=i.measureViewportBox(),d=i.current,f=getComputedStyle(d),{display:_}=f,v={};_==="none"&&i.setStaticValue("display",n.display||"block"),o.forEach(T=>{v[T]=Wm[T](c,f)}),i.render();const x=i.measureViewportBox();return o.forEach(T=>{const w=i.getValue(T);w&&w.jump(v[T]),n[T]=Wm[T](x,f)}),n},$xe=(n,i,o={},c={})=>{i={...i},c={...c};const d=Object.keys(i).filter(q$);let f=[],_=!1;const v=[];if(d.forEach(x=>{const T=n.getValue(x);if(!n.hasValue(x))return;let w=o[x],R=a_(w);const I=i[x];let j;if(RT(I)){const P=I.length,k=I[0]===null?1:0;w=I[k],R=a_(w);for(let W=k;W<P&&I[W]!==null;W++)j?Ak(a_(I[W])===j):j=a_(I[W])}else j=a_(I);if(R!==j)if(yH(R)&&yH(j)){const P=T.get();typeof P=="string"&&T.set(parseFloat(P)),typeof I=="string"?i[x]=parseFloat(I):Array.isArray(I)&&j===sn&&(i[x]=I.map(parseFloat))}else R!=null&&R.transform&&(j!=null&&j.transform)&&(w===0||I===0)?w===0?T.set(j.transform(w)):i[x]=R.transform(I):(_||(f=qxe(n),_=!0),v.push(x),c[x]=c[x]!==void 0?c[x]:i[x],T.jump(I))}),v.length){const x=v.indexOf("height")>=0?window.pageYOffset:null,T=Yxe(i,n,v);return f.length&&f.forEach(([w,R])=>{n.getValue(w).set(R)}),n.render(),Sb&&x!==null&&window.scrollTo({top:x}),{target:T,transitionEnd:c}}else return{target:i,transitionEnd:c}};function Xxe(n,i,o,c){return Gxe(i)?$xe(n,i,o,c):{target:i,transitionEnd:c}}const Jxe=(n,i,o,c)=>{const d=Wxe(n,i,c);return i=d.target,c=d.transitionEnd,Xxe(n,i,o,c)},DD={current:null},Y$={current:!1};function Qxe(){if(Y$.current=!0,!!Sb)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),i=()=>DD.current=n.matches;n.addListener(i),i()}else DD.current=!1}function Zxe(n,i,o){const{willChange:c}=i;for(const d in i){const f=i[d],_=o[d];if(Mo(f))n.addValue(d,f),OT(c)&&c.add(d);else if(Mo(_))n.addValue(d,Bm(f,{owner:n})),OT(c)&&c.remove(d);else if(_!==f)if(n.hasValue(d)){const v=n.getValue(d);!v.hasAnimated&&v.set(f)}else{const v=n.getStaticValue(d);n.addValue(d,Bm(v!==void 0?v:f,{owner:n}))}}for(const d in o)i[d]===void 0&&n.removeValue(d);return i}const TH=new WeakMap,$$=Object.keys(aE),eTe=$$.length,bH=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],tTe=yk.length;class nTe{constructor({parent:i,props:o,presenceContext:c,reducedMotionConfig:d,visualState:f},_={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Kr.render(this.render,!1,!0);const{latestValues:v,renderState:x}=f;this.latestValues=v,this.baseTarget={...v},this.initialValues=o.initial?{...v}:{},this.renderState=x,this.parent=i,this.props=o,this.presenceContext=c,this.depth=i?i.depth+1:0,this.reducedMotionConfig=d,this.options=_,this.isControllingVariants=Tb(o),this.isVariantNode=PY(o),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(i&&i.current);const{willChange:T,...w}=this.scrapeMotionValuesFromProps(o,{});for(const R in w){const I=w[R];v[R]!==void 0&&Mo(I)&&(I.set(v[R],!1),OT(T)&&T.add(R))}}scrapeMotionValuesFromProps(i,o){return{}}mount(i){this.current=i,TH.set(i,this),this.projection&&!this.projection.instance&&this.projection.mount(i),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((o,c)=>this.bindToMotionValue(c,o)),Y$.current||Qxe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:DD.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){TH.delete(this.current),this.projection&&this.projection.unmount(),ld(this.notifyUpdate),ld(this.render),this.valueSubscriptions.forEach(i=>i()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const i in this.events)this.events[i].clear();for(const i in this.features)this.features[i].unmount();this.current=null}bindToMotionValue(i,o){const c=Tp.has(i),d=o.on("change",_=>{this.latestValues[i]=_,this.props.onUpdate&&Kr.update(this.notifyUpdate,!1,!0),c&&this.projection&&(this.projection.isTransformDirty=!0)}),f=o.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(i,()=>{d(),f()})}sortNodePosition(i){return!this.current||!this.sortInstanceNodePosition||this.type!==i.type?0:this.sortInstanceNodePosition(this.current,i.current)}loadFeatures({children:i,...o},c,d,f){let _,v;for(let x=0;x<eTe;x++){const T=$$[x],{isEnabled:w,Feature:R,ProjectionNode:I,MeasureLayout:j}=aE[T];I&&(_=I),w(o)&&(!this.features[T]&&R&&(this.features[T]=new R(this)),j&&(v=j))}if((this.type==="html"||this.type==="svg")&&!this.projection&&_){this.projection=new _(this.latestValues,this.parent&&this.parent.projection);const{layoutId:x,layout:T,drag:w,dragConstraints:R,layoutScroll:I,layoutRoot:j}=o;this.projection.setOptions({layoutId:x,layout:T,alwaysMeasureLayout:!!w||R&&vm(R),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof T=="string"?T:"both",initialPromotionConfig:f,layoutScroll:I,layoutRoot:j})}return v}updateFeatures(){for(const i in this.features){const o=this.features[i];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Mi()}getStaticValue(i){return this.latestValues[i]}setStaticValue(i,o){this.latestValues[i]=o}makeTargetAnimatable(i,o=!0){return this.makeTargetAnimatableFromInstance(i,this.props,o)}update(i,o){(i.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=i,this.prevPresenceContext=this.presenceContext,this.presenceContext=o;for(let c=0;c<bH.length;c++){const d=bH[c];this.propEventSubscriptions[d]&&(this.propEventSubscriptions[d](),delete this.propEventSubscriptions[d]);const f=i["on"+d];f&&(this.propEventSubscriptions[d]=this.on(d,f))}this.prevMotionValues=Zxe(this,this.scrapeMotionValuesFromProps(i,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(i){return this.props.variants?this.props.variants[i]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(i=!1){if(i)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const c=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(c.initial=this.props.initial),c}const o={};for(let c=0;c<tTe;c++){const d=yk[c],f=this.props[d];(oE(f)||f===!1)&&(o[d]=f)}return o}addVariantChild(i){const o=this.getClosestVariantNode();if(o)return o.variantChildren&&o.variantChildren.add(i),()=>o.variantChildren.delete(i)}addValue(i,o){o!==this.values.get(i)&&(this.removeValue(i),this.bindToMotionValue(i,o)),this.values.set(i,o),this.latestValues[i]=o.get()}removeValue(i){this.values.delete(i);const o=this.valueSubscriptions.get(i);o&&(o(),this.valueSubscriptions.delete(i)),delete this.latestValues[i],this.removeValueFromRenderState(i,this.renderState)}hasValue(i){return this.values.has(i)}getValue(i,o){if(this.props.values&&this.props.values[i])return this.props.values[i];let c=this.values.get(i);return c===void 0&&o!==void 0&&(c=Bm(o,{owner:this}),this.addValue(i,c)),c}readValue(i){var o;return this.latestValues[i]!==void 0||!this.current?this.latestValues[i]:(o=this.getBaseTargetFromProps(this.props,i))!==null&&o!==void 0?o:this.readValueFromInstance(this.current,i,this.options)}setBaseTarget(i,o){this.baseTarget[i]=o}getBaseTarget(i){var o;const{initial:c}=this.props,d=typeof c=="string"||typeof c=="object"?(o=Rk(this.props,c))===null||o===void 0?void 0:o[i]:void 0;if(c&&d!==void 0)return d;const f=this.getBaseTargetFromProps(this.props,i);return f!==void 0&&!Mo(f)?f:this.initialValues[i]!==void 0&&d===void 0?void 0:this.baseTarget[i]}on(i,o){return this.events[i]||(this.events[i]=new jk),this.events[i].add(o)}notify(i,...o){this.events[i]&&this.events[i].notify(...o)}}class X$ extends nTe{sortInstanceNodePosition(i,o){return i.compareDocumentPosition(o)&2?1:-1}getBaseTargetFromProps(i,o){return i.style?i.style[o]:void 0}removeValueFromRenderState(i,{vars:o,style:c}){delete o[i],delete c[i]}makeTargetAnimatableFromInstance({transition:i,transitionEnd:o,...c},{transformValues:d},f){let _=vSe(c,i||{},this);if(d&&(o&&(o=d(o)),c&&(c=d(c)),_&&(_=d(_))),f){_Se(this,c,_);const v=Jxe(this,c,_,o);o=v.transitionEnd,c=v.target}return{transition:i,transitionEnd:o,...c}}}function rTe(n){return window.getComputedStyle(n)}class iTe extends X${constructor(){super(...arguments),this.type="html"}readValueFromInstance(i,o){if(Tp.has(o)){const c=Dk(o);return c&&c.default||0}else{const c=rTe(i),d=(UY(o)?c.getPropertyValue(o):c[o])||0;return typeof d=="string"?d.trim():d}}measureInstanceViewportBox(i,{transformPagePoint:o}){return j$(i,o)}build(i,o,c,d){xk(i,o,c,d.transformTemplate)}scrapeMotionValuesFromProps(i,o){return Ck(i,o)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:i}=this.props;Mo(i)&&(this.childSubscription=i.on("change",o=>{this.current&&(this.current.textContent=`${o}`)}))}renderInstance(i,o,c,d){GY(i,o,c,d)}}class sTe extends X${constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(i,o){return i[o]}readValueFromInstance(i,o){if(Tp.has(o)){const c=Dk(o);return c&&c.default||0}return o=zY.has(o)?o:Ek(o),i.getAttribute(o)}measureInstanceViewportBox(){return Mi()}scrapeMotionValuesFromProps(i,o){return qY(i,o)}build(i,o,c,d){bk(i,o,c,this.isSVGTag,d.transformTemplate)}renderInstance(i,o,c,d){KY(i,o,c,d)}mount(i){this.isSVGTag=wk(i.tagName),super.mount(i)}}const oTe=(n,i)=>Sk(n)?new sTe(i,{enableHardwareAcceleration:!1}):new iTe(i,{enableHardwareAcceleration:!0}),aTe={layout:{ProjectionNode:K$,MeasureLayout:F$}},cTe={...kSe,...eye,...Fxe,...aTe},Dt=cve((n,i)=>Bve(n,i,cTe,oTe)),lTe=_b("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),vt=wt.forwardRef(({className:n,variant:i,size:o,asChild:c=!1,...d},f)=>{const _=c?E_e:"button";return h.jsx(_,{className:Ir(lTe({variant:i,size:o,className:n})),ref:f,...d})});vt.displayName="Button";const Vt=wt.forwardRef(({className:n,type:i,...o},c)=>h.jsx("input",{type:i,className:Ir("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:c,...o}));Vt.displayName="Input";var dTe="Label",J$=X.forwardRef((n,i)=>h.jsx(Wi.label,{...n,ref:i,onMouseDown:o=>{var d;o.target.closest("button, input, select, textarea")||((d=n.onMouseDown)==null||d.call(n,o),!o.defaultPrevented&&o.detail>1&&o.preventDefault())}}));J$.displayName=dTe;var Ws=J$;const uTe=_b("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ut=wt.forwardRef(({className:n,...i},o)=>h.jsx(Ws,{ref:o,className:Ir(uTe(),n),...i}));Ut.displayName=Ws.displayName;const ur=wt.forwardRef(({className:n,...i},o)=>h.jsx("div",{ref:o,className:Ir("rounded-lg border bg-card text-card-foreground shadow-sm",n),...i}));ur.displayName="Card";const qr=wt.forwardRef(({className:n,...i},o)=>h.jsx("div",{ref:o,className:Ir("flex flex-col space-y-1.5 p-6",n),...i}));qr.displayName="CardHeader";const ni=wt.forwardRef(({className:n,...i},o)=>h.jsx("h3",{ref:o,className:Ir("text-2xl font-semibold leading-none tracking-tight",n),...i}));ni.displayName="CardTitle";const qs=wt.forwardRef(({className:n,...i},o)=>h.jsx("p",{ref:o,className:Ir("text-sm text-muted-foreground",n),...i}));qs.displayName="CardDescription";const vr=wt.forwardRef(({className:n,...i},o)=>h.jsx("div",{ref:o,className:Ir("p-6 pt-0",n),...i}));vr.displayName="CardContent";const r0=wt.forwardRef(({className:n,...i},o)=>h.jsx("div",{ref:o,className:Ir("flex items-center p-6 pt-0",n),...i}));r0.displayName="CardFooter";function Q$(n,i){return function(){return n.apply(i,arguments)}}const{toString:hTe}=Object.prototype,{getPrototypeOf:Uk}=Object,{iterator:Rb,toStringTag:Z$}=Symbol,Ab=(n=>i=>{const o=hTe.call(i);return n[o]||(n[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),Dc=n=>(n=n.toLowerCase(),i=>Ab(i)===n),Nb=n=>i=>typeof i===n,{isArray:i0}=Array,lE=Nb("undefined");function pTe(n){return n!==null&&!lE(n)&&n.constructor!==null&&!lE(n.constructor)&&Lo(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const eX=Dc("ArrayBuffer");function fTe(n){let i;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?i=ArrayBuffer.isView(n):i=n&&n.buffer&&eX(n.buffer),i}const mTe=Nb("string"),Lo=Nb("function"),tX=Nb("number"),Ib=n=>n!==null&&typeof n=="object",gTe=n=>n===!0||n===!1,kx=n=>{if(Ab(n)!=="object")return!1;const i=Uk(n);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Z$ in n)&&!(Rb in n)},_Te=Dc("Date"),ETe=Dc("File"),vTe=Dc("Blob"),yTe=Dc("FileList"),STe=n=>Ib(n)&&Lo(n.pipe),xTe=n=>{let i;return n&&(typeof FormData=="function"&&n instanceof FormData||Lo(n.append)&&((i=Ab(n))==="formdata"||i==="object"&&Lo(n.toString)&&n.toString()==="[object FormData]"))},TTe=Dc("URLSearchParams"),[bTe,wTe,CTe,RTe]=["ReadableStream","Request","Response","Headers"].map(Dc),ATe=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function CE(n,i,{allOwnKeys:o=!1}={}){if(n===null||typeof n>"u")return;let c,d;if(typeof n!="object"&&(n=[n]),i0(n))for(c=0,d=n.length;c<d;c++)i.call(null,n[c],c,n);else{const f=o?Object.getOwnPropertyNames(n):Object.keys(n),_=f.length;let v;for(c=0;c<_;c++)v=f[c],i.call(null,n[v],v,n)}}function nX(n,i){i=i.toLowerCase();const o=Object.keys(n);let c=o.length,d;for(;c-- >0;)if(d=o[c],i===d.toLowerCase())return d;return null}const Jh=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),rX=n=>!lE(n)&&n!==Jh;function PD(){const{caseless:n}=rX(this)&&this||{},i={},o=(c,d)=>{const f=n&&nX(i,d)||d;kx(i[f])&&kx(c)?i[f]=PD(i[f],c):kx(c)?i[f]=PD({},c):i0(c)?i[f]=c.slice():i[f]=c};for(let c=0,d=arguments.length;c<d;c++)arguments[c]&&CE(arguments[c],o);return i}const NTe=(n,i,o,{allOwnKeys:c}={})=>(CE(i,(d,f)=>{o&&Lo(d)?n[f]=Q$(d,o):n[f]=d},{allOwnKeys:c}),n),ITe=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),OTe=(n,i,o,c)=>{n.prototype=Object.create(i.prototype,c),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:i.prototype}),o&&Object.assign(n.prototype,o)},DTe=(n,i,o,c)=>{let d,f,_;const v={};if(i=i||{},n==null)return i;do{for(d=Object.getOwnPropertyNames(n),f=d.length;f-- >0;)_=d[f],(!c||c(_,n,i))&&!v[_]&&(i[_]=n[_],v[_]=!0);n=o!==!1&&Uk(n)}while(n&&(!o||o(n,i))&&n!==Object.prototype);return i},PTe=(n,i,o)=>{n=String(n),(o===void 0||o>n.length)&&(o=n.length),o-=i.length;const c=n.indexOf(i,o);return c!==-1&&c===o},kTe=n=>{if(!n)return null;if(i0(n))return n;let i=n.length;if(!tX(i))return null;const o=new Array(i);for(;i-- >0;)o[i]=n[i];return o},LTe=(n=>i=>n&&i instanceof n)(typeof Uint8Array<"u"&&Uk(Uint8Array)),MTe=(n,i)=>{const c=(n&&n[Rb]).call(n);let d;for(;(d=c.next())&&!d.done;){const f=d.value;i.call(n,f[0],f[1])}},jTe=(n,i)=>{let o;const c=[];for(;(o=n.exec(i))!==null;)c.push(o);return c},UTe=Dc("HTMLFormElement"),FTe=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,c,d){return c.toUpperCase()+d}),wH=(({hasOwnProperty:n})=>(i,o)=>n.call(i,o))(Object.prototype),VTe=Dc("RegExp"),iX=(n,i)=>{const o=Object.getOwnPropertyDescriptors(n),c={};CE(o,(d,f)=>{let _;(_=i(d,f,n))!==!1&&(c[f]=_||d)}),Object.defineProperties(n,c)},BTe=n=>{iX(n,(i,o)=>{if(Lo(n)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const c=n[o];if(Lo(c)){if(i.enumerable=!1,"writable"in i){i.writable=!1;return}i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},WTe=(n,i)=>{const o={},c=d=>{d.forEach(f=>{o[f]=!0})};return i0(n)?c(n):c(String(n).split(i)),o},HTe=()=>{},GTe=(n,i)=>n!=null&&Number.isFinite(n=+n)?n:i;function zTe(n){return!!(n&&Lo(n.append)&&n[Z$]==="FormData"&&n[Rb])}const KTe=n=>{const i=new Array(10),o=(c,d)=>{if(Ib(c)){if(i.indexOf(c)>=0)return;if(!("toJSON"in c)){i[d]=c;const f=i0(c)?[]:{};return CE(c,(_,v)=>{const x=o(_,d+1);!lE(x)&&(f[v]=x)}),i[d]=void 0,f}}return c};return o(n,0)},qTe=Dc("AsyncFunction"),YTe=n=>n&&(Ib(n)||Lo(n))&&Lo(n.then)&&Lo(n.catch),sX=((n,i)=>n?setImmediate:i?((o,c)=>(Jh.addEventListener("message",({source:d,data:f})=>{d===Jh&&f===o&&c.length&&c.shift()()},!1),d=>{c.push(d),Jh.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",Lo(Jh.postMessage)),$Te=typeof queueMicrotask<"u"?queueMicrotask.bind(Jh):typeof process<"u"&&process.nextTick||sX,XTe=n=>n!=null&&Lo(n[Rb]),Ke={isArray:i0,isArrayBuffer:eX,isBuffer:pTe,isFormData:xTe,isArrayBufferView:fTe,isString:mTe,isNumber:tX,isBoolean:gTe,isObject:Ib,isPlainObject:kx,isReadableStream:bTe,isRequest:wTe,isResponse:CTe,isHeaders:RTe,isUndefined:lE,isDate:_Te,isFile:ETe,isBlob:vTe,isRegExp:VTe,isFunction:Lo,isStream:STe,isURLSearchParams:TTe,isTypedArray:LTe,isFileList:yTe,forEach:CE,merge:PD,extend:NTe,trim:ATe,stripBOM:ITe,inherits:OTe,toFlatObject:DTe,kindOf:Ab,kindOfTest:Dc,endsWith:PTe,toArray:kTe,forEachEntry:MTe,matchAll:jTe,isHTMLForm:UTe,hasOwnProperty:wH,hasOwnProp:wH,reduceDescriptors:iX,freezeMethods:BTe,toObjectSet:WTe,toCamelCase:FTe,noop:HTe,toFiniteNumber:GTe,findKey:nX,global:Jh,isContextDefined:rX,isSpecCompliantForm:zTe,toJSONObject:KTe,isAsyncFn:qTe,isThenable:YTe,setImmediate:sX,asap:$Te,isIterable:XTe};function wn(n,i,o,c,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",i&&(this.code=i),o&&(this.config=o),c&&(this.request=c),d&&(this.response=d,this.status=d.status?d.status:null)}Ke.inherits(wn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ke.toJSONObject(this.config),code:this.code,status:this.status}}});const oX=wn.prototype,aX={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{aX[n]={value:n}});Object.defineProperties(wn,aX);Object.defineProperty(oX,"isAxiosError",{value:!0});wn.from=(n,i,o,c,d,f)=>{const _=Object.create(oX);return Ke.toFlatObject(n,_,function(x){return x!==Error.prototype},v=>v!=="isAxiosError"),wn.call(_,n.message,i,o,c,d),_.cause=n,_.name=n.name,f&&Object.assign(_,f),_};const JTe=null;function kD(n){return Ke.isPlainObject(n)||Ke.isArray(n)}function cX(n){return Ke.endsWith(n,"[]")?n.slice(0,-2):n}function CH(n,i,o){return n?n.concat(i).map(function(d,f){return d=cX(d),!o&&f?"["+d+"]":d}).join(o?".":""):i}function QTe(n){return Ke.isArray(n)&&!n.some(kD)}const ZTe=Ke.toFlatObject(Ke,{},null,function(i){return/^is[A-Z]/.test(i)});function Ob(n,i,o){if(!Ke.isObject(n))throw new TypeError("target must be an object");i=i||new FormData,o=Ke.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,W){return!Ke.isUndefined(W[k])});const c=o.metaTokens,d=o.visitor||w,f=o.dots,_=o.indexes,x=(o.Blob||typeof Blob<"u"&&Blob)&&Ke.isSpecCompliantForm(i);if(!Ke.isFunction(d))throw new TypeError("visitor must be a function");function T(P){if(P===null)return"";if(Ke.isDate(P))return P.toISOString();if(!x&&Ke.isBlob(P))throw new wn("Blob is not supported. Use a Buffer instead.");return Ke.isArrayBuffer(P)||Ke.isTypedArray(P)?x&&typeof Blob=="function"?new Blob([P]):Buffer.from(P):P}function w(P,k,W){let H=P;if(P&&!W&&typeof P=="object"){if(Ke.endsWith(k,"{}"))k=c?k:k.slice(0,-2),P=JSON.stringify(P);else if(Ke.isArray(P)&&QTe(P)||(Ke.isFileList(P)||Ke.endsWith(k,"[]"))&&(H=Ke.toArray(P)))return k=cX(k),H.forEach(function(V,K){!(Ke.isUndefined(V)||V===null)&&i.append(_===!0?CH([k],K,f):_===null?k:k+"[]",T(V))}),!1}return kD(P)?!0:(i.append(CH(W,k,f),T(P)),!1)}const R=[],I=Object.assign(ZTe,{defaultVisitor:w,convertValue:T,isVisitable:kD});function j(P,k){if(!Ke.isUndefined(P)){if(R.indexOf(P)!==-1)throw Error("Circular reference detected in "+k.join("."));R.push(P),Ke.forEach(P,function(H,L){(!(Ke.isUndefined(H)||H===null)&&d.call(i,H,Ke.isString(L)?L.trim():L,k,I))===!0&&j(H,k?k.concat(L):[L])}),R.pop()}}if(!Ke.isObject(n))throw new TypeError("data must be an object");return j(n),i}function RH(n){const i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(c){return i[c]})}function Fk(n,i){this._pairs=[],n&&Ob(n,this,i)}const lX=Fk.prototype;lX.append=function(i,o){this._pairs.push([i,o])};lX.toString=function(i){const o=i?function(c){return i.call(this,c,RH)}:RH;return this._pairs.map(function(d){return o(d[0])+"="+o(d[1])},"").join("&")};function ebe(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function dX(n,i,o){if(!i)return n;const c=o&&o.encode||ebe;Ke.isFunction(o)&&(o={serialize:o});const d=o&&o.serialize;let f;if(d?f=d(i,o):f=Ke.isURLSearchParams(i)?i.toString():new Fk(i,o).toString(c),f){const _=n.indexOf("#");_!==-1&&(n=n.slice(0,_)),n+=(n.indexOf("?")===-1?"?":"&")+f}return n}class tbe{constructor(){this.handlers=[]}use(i,o,c){return this.handlers.push({fulfilled:i,rejected:o,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(i){this.handlers[i]&&(this.handlers[i]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(i){Ke.forEach(this.handlers,function(c){c!==null&&i(c)})}}const AH=tbe,uX={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},nbe=typeof URLSearchParams<"u"?URLSearchParams:Fk,rbe=typeof FormData<"u"?FormData:null,ibe=typeof Blob<"u"?Blob:null,sbe={isBrowser:!0,classes:{URLSearchParams:nbe,FormData:rbe,Blob:ibe},protocols:["http","https","file","blob","url","data"]},Vk=typeof window<"u"&&typeof document<"u",LD=typeof navigator=="object"&&navigator||void 0,obe=Vk&&(!LD||["ReactNative","NativeScript","NS"].indexOf(LD.product)<0),abe=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),cbe=Vk&&window.location.href||"http://localhost",lbe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vk,hasStandardBrowserEnv:obe,hasStandardBrowserWebWorkerEnv:abe,navigator:LD,origin:cbe},Symbol.toStringTag,{value:"Module"})),Gs={...lbe,...sbe};function dbe(n,i){return Ob(n,new Gs.classes.URLSearchParams,Object.assign({visitor:function(o,c,d,f){return Gs.isNode&&Ke.isBuffer(o)?(this.append(c,o.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)}},i))}function ube(n){return Ke.matchAll(/\w+|\[(\w*)]/g,n).map(i=>i[0]==="[]"?"":i[1]||i[0])}function hbe(n){const i={},o=Object.keys(n);let c;const d=o.length;let f;for(c=0;c<d;c++)f=o[c],i[f]=n[f];return i}function hX(n){function i(o,c,d,f){let _=o[f++];if(_==="__proto__")return!0;const v=Number.isFinite(+_),x=f>=o.length;return _=!_&&Ke.isArray(d)?d.length:_,x?(Ke.hasOwnProp(d,_)?d[_]=[d[_],c]:d[_]=c,!v):((!d[_]||!Ke.isObject(d[_]))&&(d[_]=[]),i(o,c,d[_],f)&&Ke.isArray(d[_])&&(d[_]=hbe(d[_])),!v)}if(Ke.isFormData(n)&&Ke.isFunction(n.entries)){const o={};return Ke.forEachEntry(n,(c,d)=>{i(ube(c),d,o,0)}),o}return null}function pbe(n,i,o){if(Ke.isString(n))try{return(i||JSON.parse)(n),Ke.trim(n)}catch(c){if(c.name!=="SyntaxError")throw c}return(o||JSON.stringify)(n)}const Bk={transitional:uX,adapter:["xhr","http","fetch"],transformRequest:[function(i,o){const c=o.getContentType()||"",d=c.indexOf("application/json")>-1,f=Ke.isObject(i);if(f&&Ke.isHTMLForm(i)&&(i=new FormData(i)),Ke.isFormData(i))return d?JSON.stringify(hX(i)):i;if(Ke.isArrayBuffer(i)||Ke.isBuffer(i)||Ke.isStream(i)||Ke.isFile(i)||Ke.isBlob(i)||Ke.isReadableStream(i))return i;if(Ke.isArrayBufferView(i))return i.buffer;if(Ke.isURLSearchParams(i))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),i.toString();let v;if(f){if(c.indexOf("application/x-www-form-urlencoded")>-1)return dbe(i,this.formSerializer).toString();if((v=Ke.isFileList(i))||c.indexOf("multipart/form-data")>-1){const x=this.env&&this.env.FormData;return Ob(v?{"files[]":i}:i,x&&new x,this.formSerializer)}}return f||d?(o.setContentType("application/json",!1),pbe(i)):i}],transformResponse:[function(i){const o=this.transitional||Bk.transitional,c=o&&o.forcedJSONParsing,d=this.responseType==="json";if(Ke.isResponse(i)||Ke.isReadableStream(i))return i;if(i&&Ke.isString(i)&&(c&&!this.responseType||d)){const _=!(o&&o.silentJSONParsing)&&d;try{return JSON.parse(i)}catch(v){if(_)throw v.name==="SyntaxError"?wn.from(v,wn.ERR_BAD_RESPONSE,this,null,this.response):v}}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Gs.classes.FormData,Blob:Gs.classes.Blob},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ke.forEach(["delete","get","head","post","put","patch"],n=>{Bk.headers[n]={}});const Wk=Bk,fbe=Ke.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),mbe=n=>{const i={};let o,c,d;return n&&n.split(`
`).forEach(function(_){d=_.indexOf(":"),o=_.substring(0,d).trim().toLowerCase(),c=_.substring(d+1).trim(),!(!o||i[o]&&fbe[o])&&(o==="set-cookie"?i[o]?i[o].push(c):i[o]=[c]:i[o]=i[o]?i[o]+", "+c:c)}),i},NH=Symbol("internals");function l_(n){return n&&String(n).trim().toLowerCase()}function Lx(n){return n===!1||n==null?n:Ke.isArray(n)?n.map(Lx):String(n)}function gbe(n){const i=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=o.exec(n);)i[c[1]]=c[2];return i}const _be=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function lI(n,i,o,c,d){if(Ke.isFunction(c))return c.call(this,i,o);if(d&&(i=o),!!Ke.isString(i)){if(Ke.isString(c))return i.indexOf(c)!==-1;if(Ke.isRegExp(c))return c.test(i)}}function Ebe(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(i,o,c)=>o.toUpperCase()+c)}function vbe(n,i){const o=Ke.toCamelCase(" "+i);["get","set","has"].forEach(c=>{Object.defineProperty(n,c+o,{value:function(d,f,_){return this[c].call(this,i,d,f,_)},configurable:!0})})}class Db{constructor(i){i&&this.set(i)}set(i,o,c){const d=this;function f(v,x,T){const w=l_(x);if(!w)throw new Error("header name must be a non-empty string");const R=Ke.findKey(d,w);(!R||d[R]===void 0||T===!0||T===void 0&&d[R]!==!1)&&(d[R||x]=Lx(v))}const _=(v,x)=>Ke.forEach(v,(T,w)=>f(T,w,x));if(Ke.isPlainObject(i)||i instanceof this.constructor)_(i,o);else if(Ke.isString(i)&&(i=i.trim())&&!_be(i))_(mbe(i),o);else if(Ke.isObject(i)&&Ke.isIterable(i)){let v={},x,T;for(const w of i){if(!Ke.isArray(w))throw TypeError("Object iterator must return a key-value pair");v[T=w[0]]=(x=v[T])?Ke.isArray(x)?[...x,w[1]]:[x,w[1]]:w[1]}_(v,o)}else i!=null&&f(o,i,c);return this}get(i,o){if(i=l_(i),i){const c=Ke.findKey(this,i);if(c){const d=this[c];if(!o)return d;if(o===!0)return gbe(d);if(Ke.isFunction(o))return o.call(this,d,c);if(Ke.isRegExp(o))return o.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,o){if(i=l_(i),i){const c=Ke.findKey(this,i);return!!(c&&this[c]!==void 0&&(!o||lI(this,this[c],c,o)))}return!1}delete(i,o){const c=this;let d=!1;function f(_){if(_=l_(_),_){const v=Ke.findKey(c,_);v&&(!o||lI(c,c[v],v,o))&&(delete c[v],d=!0)}}return Ke.isArray(i)?i.forEach(f):f(i),d}clear(i){const o=Object.keys(this);let c=o.length,d=!1;for(;c--;){const f=o[c];(!i||lI(this,this[f],f,i,!0))&&(delete this[f],d=!0)}return d}normalize(i){const o=this,c={};return Ke.forEach(this,(d,f)=>{const _=Ke.findKey(c,f);if(_){o[_]=Lx(d),delete o[f];return}const v=i?Ebe(f):String(f).trim();v!==f&&delete o[f],o[v]=Lx(d),c[v]=!0}),this}concat(...i){return this.constructor.concat(this,...i)}toJSON(i){const o=Object.create(null);return Ke.forEach(this,(c,d)=>{c!=null&&c!==!1&&(o[d]=i&&Ke.isArray(c)?c.join(", "):c)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([i,o])=>i+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i,...o){const c=new this(i);return o.forEach(d=>c.set(d)),c}static accessor(i){const c=(this[NH]=this[NH]={accessors:{}}).accessors,d=this.prototype;function f(_){const v=l_(_);c[v]||(vbe(d,_),c[v]=!0)}return Ke.isArray(i)?i.forEach(f):f(i),this}}Db.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ke.reduceDescriptors(Db.prototype,({value:n},i)=>{let o=i[0].toUpperCase()+i.slice(1);return{get:()=>n,set(c){this[o]=c}}});Ke.freezeMethods(Db);const Ac=Db;function dI(n,i){const o=this||Wk,c=i||o,d=Ac.from(c.headers);let f=c.data;return Ke.forEach(n,function(v){f=v.call(o,f,d.normalize(),i?i.status:void 0)}),d.normalize(),f}function pX(n){return!!(n&&n.__CANCEL__)}function s0(n,i,o){wn.call(this,n??"canceled",wn.ERR_CANCELED,i,o),this.name="CanceledError"}Ke.inherits(s0,wn,{__CANCEL__:!0});function fX(n,i,o){const c=o.config.validateStatus;!o.status||!c||c(o.status)?n(o):i(new wn("Request failed with status code "+o.status,[wn.ERR_BAD_REQUEST,wn.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function ybe(n){const i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return i&&i[1]||""}function Sbe(n,i){n=n||10;const o=new Array(n),c=new Array(n);let d=0,f=0,_;return i=i!==void 0?i:1e3,function(x){const T=Date.now(),w=c[f];_||(_=T),o[d]=x,c[d]=T;let R=f,I=0;for(;R!==d;)I+=o[R++],R=R%n;if(d=(d+1)%n,d===f&&(f=(f+1)%n),T-_<i)return;const j=w&&T-w;return j?Math.round(I*1e3/j):void 0}}function xbe(n,i){let o=0,c=1e3/i,d,f;const _=(T,w=Date.now())=>{o=w,d=null,f&&(clearTimeout(f),f=null),n.apply(null,T)};return[(...T)=>{const w=Date.now(),R=w-o;R>=c?_(T,w):(d=T,f||(f=setTimeout(()=>{f=null,_(d)},c-R)))},()=>d&&_(d)]}const PT=(n,i,o=3)=>{let c=0;const d=Sbe(50,250);return xbe(f=>{const _=f.loaded,v=f.lengthComputable?f.total:void 0,x=_-c,T=d(x),w=_<=v;c=_;const R={loaded:_,total:v,progress:v?_/v:void 0,bytes:x,rate:T||void 0,estimated:T&&v&&w?(v-_)/T:void 0,event:f,lengthComputable:v!=null,[i?"download":"upload"]:!0};n(R)},o)},IH=(n,i)=>{const o=n!=null;return[c=>i[0]({lengthComputable:o,total:n,loaded:c}),i[1]]},OH=n=>(...i)=>Ke.asap(()=>n(...i)),Tbe=Gs.hasStandardBrowserEnv?((n,i)=>o=>(o=new URL(o,Gs.origin),n.protocol===o.protocol&&n.host===o.host&&(i||n.port===o.port)))(new URL(Gs.origin),Gs.navigator&&/(msie|trident)/i.test(Gs.navigator.userAgent)):()=>!0,bbe=Gs.hasStandardBrowserEnv?{write(n,i,o,c,d,f){const _=[n+"="+encodeURIComponent(i)];Ke.isNumber(o)&&_.push("expires="+new Date(o).toGMTString()),Ke.isString(c)&&_.push("path="+c),Ke.isString(d)&&_.push("domain="+d),f===!0&&_.push("secure"),document.cookie=_.join("; ")},read(n){const i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function wbe(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Cbe(n,i){return i?n.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):n}function mX(n,i,o){let c=!wbe(i);return n&&(c||o==!1)?Cbe(n,i):i}const DH=n=>n instanceof Ac?{...n}:n;function up(n,i){i=i||{};const o={};function c(T,w,R,I){return Ke.isPlainObject(T)&&Ke.isPlainObject(w)?Ke.merge.call({caseless:I},T,w):Ke.isPlainObject(w)?Ke.merge({},w):Ke.isArray(w)?w.slice():w}function d(T,w,R,I){if(Ke.isUndefined(w)){if(!Ke.isUndefined(T))return c(void 0,T,R,I)}else return c(T,w,R,I)}function f(T,w){if(!Ke.isUndefined(w))return c(void 0,w)}function _(T,w){if(Ke.isUndefined(w)){if(!Ke.isUndefined(T))return c(void 0,T)}else return c(void 0,w)}function v(T,w,R){if(R in i)return c(T,w);if(R in n)return c(void 0,T)}const x={url:f,method:f,data:f,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,withXSRFToken:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:v,headers:(T,w,R)=>d(DH(T),DH(w),R,!0)};return Ke.forEach(Object.keys(Object.assign({},n,i)),function(w){const R=x[w]||d,I=R(n[w],i[w],w);Ke.isUndefined(I)&&R!==v||(o[w]=I)}),o}const gX=n=>{const i=up({},n);let{data:o,withXSRFToken:c,xsrfHeaderName:d,xsrfCookieName:f,headers:_,auth:v}=i;i.headers=_=Ac.from(_),i.url=dX(mX(i.baseURL,i.url,i.allowAbsoluteUrls),n.params,n.paramsSerializer),v&&_.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):"")));let x;if(Ke.isFormData(o)){if(Gs.hasStandardBrowserEnv||Gs.hasStandardBrowserWebWorkerEnv)_.setContentType(void 0);else if((x=_.getContentType())!==!1){const[T,...w]=x?x.split(";").map(R=>R.trim()).filter(Boolean):[];_.setContentType([T||"multipart/form-data",...w].join("; "))}}if(Gs.hasStandardBrowserEnv&&(c&&Ke.isFunction(c)&&(c=c(i)),c||c!==!1&&Tbe(i.url))){const T=d&&f&&bbe.read(f);T&&_.set(d,T)}return i},Rbe=typeof XMLHttpRequest<"u",Abe=Rbe&&function(n){return new Promise(function(o,c){const d=gX(n);let f=d.data;const _=Ac.from(d.headers).normalize();let{responseType:v,onUploadProgress:x,onDownloadProgress:T}=d,w,R,I,j,P;function k(){j&&j(),P&&P(),d.cancelToken&&d.cancelToken.unsubscribe(w),d.signal&&d.signal.removeEventListener("abort",w)}let W=new XMLHttpRequest;W.open(d.method.toUpperCase(),d.url,!0),W.timeout=d.timeout;function H(){if(!W)return;const V=Ac.from("getAllResponseHeaders"in W&&W.getAllResponseHeaders()),te={data:!v||v==="text"||v==="json"?W.responseText:W.response,status:W.status,statusText:W.statusText,headers:V,config:n,request:W};fX(function(A){o(A),k()},function(A){c(A),k()},te),W=null}"onloadend"in W?W.onloadend=H:W.onreadystatechange=function(){!W||W.readyState!==4||W.status===0&&!(W.responseURL&&W.responseURL.indexOf("file:")===0)||setTimeout(H)},W.onabort=function(){W&&(c(new wn("Request aborted",wn.ECONNABORTED,n,W)),W=null)},W.onerror=function(){c(new wn("Network Error",wn.ERR_NETWORK,n,W)),W=null},W.ontimeout=function(){let K=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded";const te=d.transitional||uX;d.timeoutErrorMessage&&(K=d.timeoutErrorMessage),c(new wn(K,te.clarifyTimeoutError?wn.ETIMEDOUT:wn.ECONNABORTED,n,W)),W=null},f===void 0&&_.setContentType(null),"setRequestHeader"in W&&Ke.forEach(_.toJSON(),function(K,te){W.setRequestHeader(te,K)}),Ke.isUndefined(d.withCredentials)||(W.withCredentials=!!d.withCredentials),v&&v!=="json"&&(W.responseType=d.responseType),T&&([I,P]=PT(T,!0),W.addEventListener("progress",I)),x&&W.upload&&([R,j]=PT(x),W.upload.addEventListener("progress",R),W.upload.addEventListener("loadend",j)),(d.cancelToken||d.signal)&&(w=V=>{W&&(c(!V||V.type?new s0(null,n,W):V),W.abort(),W=null)},d.cancelToken&&d.cancelToken.subscribe(w),d.signal&&(d.signal.aborted?w():d.signal.addEventListener("abort",w)));const L=ybe(d.url);if(L&&Gs.protocols.indexOf(L)===-1){c(new wn("Unsupported protocol "+L+":",wn.ERR_BAD_REQUEST,n));return}W.send(f||null)})},Nbe=(n,i)=>{const{length:o}=n=n?n.filter(Boolean):[];if(i||o){let c=new AbortController,d;const f=function(T){if(!d){d=!0,v();const w=T instanceof Error?T:this.reason;c.abort(w instanceof wn?w:new s0(w instanceof Error?w.message:w))}};let _=i&&setTimeout(()=>{_=null,f(new wn(`timeout ${i} of ms exceeded`,wn.ETIMEDOUT))},i);const v=()=>{n&&(_&&clearTimeout(_),_=null,n.forEach(T=>{T.unsubscribe?T.unsubscribe(f):T.removeEventListener("abort",f)}),n=null)};n.forEach(T=>T.addEventListener("abort",f));const{signal:x}=c;return x.unsubscribe=()=>Ke.asap(v),x}},Ibe=Nbe,Obe=function*(n,i){let o=n.byteLength;if(!i||o<i){yield n;return}let c=0,d;for(;c<o;)d=c+i,yield n.slice(c,d),c=d},Dbe=async function*(n,i){for await(const o of Pbe(n))yield*Obe(o,i)},Pbe=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const i=n.getReader();try{for(;;){const{done:o,value:c}=await i.read();if(o)break;yield c}}finally{await i.cancel()}},PH=(n,i,o,c)=>{const d=Dbe(n,i);let f=0,_,v=x=>{_||(_=!0,c&&c(x))};return new ReadableStream({async pull(x){try{const{done:T,value:w}=await d.next();if(T){v(),x.close();return}let R=w.byteLength;if(o){let I=f+=R;o(I)}x.enqueue(new Uint8Array(w))}catch(T){throw v(T),T}},cancel(x){return v(x),d.return()}},{highWaterMark:2})},Pb=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",_X=Pb&&typeof ReadableStream=="function",kbe=Pb&&(typeof TextEncoder=="function"?(n=>i=>n.encode(i))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),EX=(n,...i)=>{try{return!!n(...i)}catch{return!1}},Lbe=_X&&EX(()=>{let n=!1;const i=new Request(Gs.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!i}),kH=64*1024,MD=_X&&EX(()=>Ke.isReadableStream(new Response("").body)),kT={stream:MD&&(n=>n.body)};Pb&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(i=>{!kT[i]&&(kT[i]=Ke.isFunction(n[i])?o=>o[i]():(o,c)=>{throw new wn(`Response type '${i}' is not supported`,wn.ERR_NOT_SUPPORT,c)})})})(new Response);const Mbe=async n=>{if(n==null)return 0;if(Ke.isBlob(n))return n.size;if(Ke.isSpecCompliantForm(n))return(await new Request(Gs.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(Ke.isArrayBufferView(n)||Ke.isArrayBuffer(n))return n.byteLength;if(Ke.isURLSearchParams(n)&&(n=n+""),Ke.isString(n))return(await kbe(n)).byteLength},jbe=async(n,i)=>{const o=Ke.toFiniteNumber(n.getContentLength());return o??Mbe(i)},Ube=Pb&&(async n=>{let{url:i,method:o,data:c,signal:d,cancelToken:f,timeout:_,onDownloadProgress:v,onUploadProgress:x,responseType:T,headers:w,withCredentials:R="same-origin",fetchOptions:I}=gX(n);T=T?(T+"").toLowerCase():"text";let j=Ibe([d,f&&f.toAbortSignal()],_),P;const k=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let W;try{if(x&&Lbe&&o!=="get"&&o!=="head"&&(W=await jbe(w,c))!==0){let te=new Request(i,{method:"POST",body:c,duplex:"half"}),ie;if(Ke.isFormData(c)&&(ie=te.headers.get("content-type"))&&w.setContentType(ie),te.body){const[A,de]=IH(W,PT(OH(x)));c=PH(te.body,kH,A,de)}}Ke.isString(R)||(R=R?"include":"omit");const H="credentials"in Request.prototype;P=new Request(i,{...I,signal:j,method:o.toUpperCase(),headers:w.normalize().toJSON(),body:c,duplex:"half",credentials:H?R:void 0});let L=await fetch(P);const V=MD&&(T==="stream"||T==="response");if(MD&&(v||V&&k)){const te={};["status","statusText","headers"].forEach(ue=>{te[ue]=L[ue]});const ie=Ke.toFiniteNumber(L.headers.get("content-length")),[A,de]=v&&IH(ie,PT(OH(v),!0))||[];L=new Response(PH(L.body,kH,A,()=>{de&&de(),k&&k()}),te)}T=T||"text";let K=await kT[Ke.findKey(kT,T)||"text"](L,n);return!V&&k&&k(),await new Promise((te,ie)=>{fX(te,ie,{data:K,headers:Ac.from(L.headers),status:L.status,statusText:L.statusText,config:n,request:P})})}catch(H){throw k&&k(),H&&H.name==="TypeError"&&/Load failed|fetch/i.test(H.message)?Object.assign(new wn("Network Error",wn.ERR_NETWORK,n,P),{cause:H.cause||H}):wn.from(H,H&&H.code,n,P)}}),jD={http:JTe,xhr:Abe,fetch:Ube};Ke.forEach(jD,(n,i)=>{if(n){try{Object.defineProperty(n,"name",{value:i})}catch{}Object.defineProperty(n,"adapterName",{value:i})}});const LH=n=>`- ${n}`,Fbe=n=>Ke.isFunction(n)||n===null||n===!1,vX={getAdapter:n=>{n=Ke.isArray(n)?n:[n];const{length:i}=n;let o,c;const d={};for(let f=0;f<i;f++){o=n[f];let _;if(c=o,!Fbe(o)&&(c=jD[(_=String(o)).toLowerCase()],c===void 0))throw new wn(`Unknown adapter '${_}'`);if(c)break;d[_||"#"+f]=c}if(!c){const f=Object.entries(d).map(([v,x])=>`adapter ${v} `+(x===!1?"is not supported by the environment":"is not available in the build"));let _=i?f.length>1?`since :
`+f.map(LH).join(`
`):" "+LH(f[0]):"as no adapter specified";throw new wn("There is no suitable adapter to dispatch the request "+_,"ERR_NOT_SUPPORT")}return c},adapters:jD};function uI(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new s0(null,n)}function MH(n){return uI(n),n.headers=Ac.from(n.headers),n.data=dI.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),vX.getAdapter(n.adapter||Wk.adapter)(n).then(function(c){return uI(n),c.data=dI.call(n,n.transformResponse,c),c.headers=Ac.from(c.headers),c},function(c){return pX(c)||(uI(n),c&&c.response&&(c.response.data=dI.call(n,n.transformResponse,c.response),c.response.headers=Ac.from(c.response.headers))),Promise.reject(c)})}const yX="1.9.0",kb={};["object","boolean","number","function","string","symbol"].forEach((n,i)=>{kb[n]=function(c){return typeof c===n||"a"+(i<1?"n ":" ")+n}});const jH={};kb.transitional=function(i,o,c){function d(f,_){return"[Axios v"+yX+"] Transitional option '"+f+"'"+_+(c?". "+c:"")}return(f,_,v)=>{if(i===!1)throw new wn(d(_," has been removed"+(o?" in "+o:"")),wn.ERR_DEPRECATED);return o&&!jH[_]&&(jH[_]=!0,console.warn(d(_," has been deprecated since v"+o+" and will be removed in the near future"))),i?i(f,_,v):!0}};kb.spelling=function(i){return(o,c)=>(console.warn(`${c} is likely a misspelling of ${i}`),!0)};function Vbe(n,i,o){if(typeof n!="object")throw new wn("options must be an object",wn.ERR_BAD_OPTION_VALUE);const c=Object.keys(n);let d=c.length;for(;d-- >0;){const f=c[d],_=i[f];if(_){const v=n[f],x=v===void 0||_(v,f,n);if(x!==!0)throw new wn("option "+f+" must be "+x,wn.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new wn("Unknown option "+f,wn.ERR_BAD_OPTION)}}const Mx={assertOptions:Vbe,validators:kb},ul=Mx.validators;class LT{constructor(i){this.defaults=i||{},this.interceptors={request:new AH,response:new AH}}async request(i,o){try{return await this._request(i,o)}catch(c){if(c instanceof Error){let d={};Error.captureStackTrace?Error.captureStackTrace(d):d=new Error;const f=d.stack?d.stack.replace(/^.+\n/,""):"";try{c.stack?f&&!String(c.stack).endsWith(f.replace(/^.+\n.+\n/,""))&&(c.stack+=`
`+f):c.stack=f}catch{}}throw c}}_request(i,o){typeof i=="string"?(o=o||{},o.url=i):o=i||{},o=up(this.defaults,o);const{transitional:c,paramsSerializer:d,headers:f}=o;c!==void 0&&Mx.assertOptions(c,{silentJSONParsing:ul.transitional(ul.boolean),forcedJSONParsing:ul.transitional(ul.boolean),clarifyTimeoutError:ul.transitional(ul.boolean)},!1),d!=null&&(Ke.isFunction(d)?o.paramsSerializer={serialize:d}:Mx.assertOptions(d,{encode:ul.function,serialize:ul.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Mx.assertOptions(o,{baseUrl:ul.spelling("baseURL"),withXsrfToken:ul.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let _=f&&Ke.merge(f.common,f[o.method]);f&&Ke.forEach(["delete","get","head","post","put","patch","common"],P=>{delete f[P]}),o.headers=Ac.concat(_,f);const v=[];let x=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(o)===!1||(x=x&&k.synchronous,v.unshift(k.fulfilled,k.rejected))});const T=[];this.interceptors.response.forEach(function(k){T.push(k.fulfilled,k.rejected)});let w,R=0,I;if(!x){const P=[MH.bind(this),void 0];for(P.unshift.apply(P,v),P.push.apply(P,T),I=P.length,w=Promise.resolve(o);R<I;)w=w.then(P[R++],P[R++]);return w}I=v.length;let j=o;for(R=0;R<I;){const P=v[R++],k=v[R++];try{j=P(j)}catch(W){k.call(this,W);break}}try{w=MH.call(this,j)}catch(P){return Promise.reject(P)}for(R=0,I=T.length;R<I;)w=w.then(T[R++],T[R++]);return w}getUri(i){i=up(this.defaults,i);const o=mX(i.baseURL,i.url,i.allowAbsoluteUrls);return dX(o,i.params,i.paramsSerializer)}}Ke.forEach(["delete","get","head","options"],function(i){LT.prototype[i]=function(o,c){return this.request(up(c||{},{method:i,url:o,data:(c||{}).data}))}});Ke.forEach(["post","put","patch"],function(i){function o(c){return function(f,_,v){return this.request(up(v||{},{method:i,headers:c?{"Content-Type":"multipart/form-data"}:{},url:f,data:_}))}}LT.prototype[i]=o(),LT.prototype[i+"Form"]=o(!0)});const jx=LT;class Hk{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(f){o=f});const c=this;this.promise.then(d=>{if(!c._listeners)return;let f=c._listeners.length;for(;f-- >0;)c._listeners[f](d);c._listeners=null}),this.promise.then=d=>{let f;const _=new Promise(v=>{c.subscribe(v),f=v}).then(d);return _.cancel=function(){c.unsubscribe(f)},_},i(function(f,_,v){c.reason||(c.reason=new s0(f,_,v),o(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;const o=this._listeners.indexOf(i);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const i=new AbortController,o=c=>{i.abort(c)};return this.subscribe(o),i.signal.unsubscribe=()=>this.unsubscribe(o),i.signal}static source(){let i;return{token:new Hk(function(d){i=d}),cancel:i}}}const Bbe=Hk;function Wbe(n){return function(o){return n.apply(null,o)}}function Hbe(n){return Ke.isObject(n)&&n.isAxiosError===!0}const UD={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(UD).forEach(([n,i])=>{UD[i]=n});const Gbe=UD;function SX(n){const i=new jx(n),o=Q$(jx.prototype.request,i);return Ke.extend(o,jx.prototype,i,{allOwnKeys:!0}),Ke.extend(o,i,null,{allOwnKeys:!0}),o.create=function(d){return SX(up(n,d))},o}const Bi=SX(Wk);Bi.Axios=jx;Bi.CanceledError=s0;Bi.CancelToken=Bbe;Bi.isCancel=pX;Bi.VERSION=yX;Bi.toFormData=Ob;Bi.AxiosError=wn;Bi.Cancel=Bi.CanceledError;Bi.all=function(i){return Promise.all(i)};Bi.spread=Wbe;Bi.isAxiosError=Hbe;Bi.mergeConfig=up;Bi.AxiosHeaders=Ac;Bi.formToJSON=n=>hX(Ke.isHTMLForm(n)?new FormData(n):n);Bi.getAdapter=vX.getAdapter;Bi.HttpStatusCode=Gbe;Bi.default=Bi;const Jn=Bi,zbe=()=>{const[n,i]=X.useState(""),[o,c]=X.useState(""),[d,f]=X.useState(!1),[_,v]=X.useState(!1),{toast:x}=gk(),T=Qi();X.useEffect(()=>(document.body.style.cursor=_?"wait":"default",()=>{document.body.style.cursor="default"}),[_]);const w=async R=>{var I,j,P;if(R.preventDefault(),!n||!o){x({title:"Missing Fields",description:"Please enter both email and password.",variant:"destructive"});return}v(!0);try{const W=(await Jn.post("https://astro-talk-backend.onrender.com/web/login/",{email:n,password:o})).data;W!=null&&W.token?(localStorage.setItem("userToken",W.token),localStorage.setItem("user",JSON.stringify(W.user||{})),localStorage.setItem("userId",((I=W.user)==null?void 0:I._id)||""),x({title:"Login Successful!",description:"Welcome back to Astro Truth!"}),console.log("Login successful. Navigating..."),T("/user-dashboard")):x({title:"Invalid Credentials",description:(W==null?void 0:W.message)||"Please check your email and password.",variant:"destructive"})}catch(k){console.error("Login failed:",k.response||k),x({title:"Login Failed",description:((P=(j=k.response)==null?void 0:j.data)==null?void 0:P.message)||"Server error occurred. Please try again later.",variant:"destructive"})}finally{v(!1)}};return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-astro-indigo via-astro-purple to-astro-pink p-4 pt-24 star-bg",children:h.jsx(Dt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:h.jsxs(ur,{className:"w-full max-w-md shadow-2xl relative",children:[h.jsx("button",{onClick:()=>T("/"),className:"absolute top-4 right-4 text-gray-400 hover:text-red-500","aria-label":"Close",children:h.jsx(xp,{className:"w-5 h-5"})}),h.jsxs(qr,{className:"text-center",children:[h.jsx(ni,{className:"text-3xl font-bold cosmic-text",children:"Welcome Back!"}),h.jsx(qs,{children:"Log in to continue your cosmic journey."})]}),h.jsx(vr,{children:h.jsxs("form",{onSubmit:w,className:"space-y-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"email",children:"Email Address"}),h.jsxs("div",{className:"relative",children:[h.jsx(ad,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{id:"email",type:"email",placeholder:"you@example.com",value:n,onChange:R=>i(R.target.value),required:!0,className:"pl-10"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"password",children:"Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(Vm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{id:"password",type:d?"text":"password",placeholder:"Enter Password",value:o,onChange:R=>c(R.target.value),required:!0,className:"pl-10 pr-10"}),h.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:d?h.jsx(vY,{className:"h-5 w-5"}):h.jsx(yY,{className:"h-5 w-5"})})]})]}),h.jsx(vt,{type:"submit",className:"w-full cosmic-gradient text-white",disabled:_,children:_?"Logging in...":"Log In"})]})}),h.jsxs(r0,{className:"flex flex-col items-center space-y-2",children:[h.jsx(Xn,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:"Forgot your password?"}),h.jsxs("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",h.jsx(Xn,{to:"/user-register",className:"font-medium text-primary hover:underline",children:"Sign up"})]})]})]})})})};var RE=n=>n.type==="checkbox",Qh=n=>n instanceof Date,io=n=>n==null;const xX=n=>typeof n=="object";var Pi=n=>!io(n)&&!Array.isArray(n)&&xX(n)&&!Qh(n),Kbe=n=>Pi(n)&&n.target?RE(n.target)?n.target.checked:n.target.value:n,qbe=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,Ybe=(n,i)=>n.has(qbe(i)),$be=n=>{const i=n.constructor&&n.constructor.prototype;return Pi(i)&&i.hasOwnProperty("isPrototypeOf")},Gk=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Vs(n){let i;const o=Array.isArray(n),c=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)i=new Date(n);else if(n instanceof Set)i=new Set(n);else if(!(Gk&&(n instanceof Blob||c))&&(o||Pi(n)))if(i=o?[]:{},!o&&!$be(n))i=n;else for(const d in n)n.hasOwnProperty(d)&&(i[d]=Vs(n[d]));else return n;return i}var Lb=n=>Array.isArray(n)?n.filter(Boolean):[],ji=n=>n===void 0,Bt=(n,i,o)=>{if(!i||!Pi(n))return o;const c=Lb(i.split(/[,[\].]+?/)).reduce((d,f)=>io(d)?d:d[f],n);return ji(c)||c===n?ji(n[i])?o:n[i]:c},pl=n=>typeof n=="boolean",zk=n=>/^\w*$/.test(n),TX=n=>Lb(n.replace(/["|']|\]/g,"").split(/\.|\[/)),Gr=(n,i,o)=>{let c=-1;const d=zk(i)?[i]:TX(i),f=d.length,_=f-1;for(;++c<f;){const v=d[c];let x=o;if(c!==_){const T=n[v];x=Pi(T)||Array.isArray(T)?T:isNaN(+d[c+1])?{}:[]}if(v==="__proto__"||v==="constructor"||v==="prototype")return;n[v]=x,n=n[v]}};const UH={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Tc={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Kl={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};wt.createContext(null);var Xbe=(n,i,o,c=!0)=>{const d={defaultValues:i._defaultValues};for(const f in n)Object.defineProperty(d,f,{get:()=>{const _=f;return i._proxyFormState[_]!==Tc.all&&(i._proxyFormState[_]=!c||Tc.all),o&&(o[_]=!0),n[_]}});return d};const Jbe=typeof window<"u"?X.useLayoutEffect:X.useEffect;var _l=n=>typeof n=="string",Qbe=(n,i,o,c,d)=>_l(n)?(c&&i.watch.add(n),Bt(o,n,d)):Array.isArray(n)?n.map(f=>(c&&i.watch.add(f),Bt(o,f))):(c&&(i.watchAll=!0),o),Zbe=(n,i,o,c,d)=>i?{...o[n],types:{...o[n]&&o[n].types?o[n].types:{},[c]:d||!0}}:{},k_=n=>Array.isArray(n)?n:[n],FH=()=>{let n=[];return{get observers(){return n},next:d=>{for(const f of n)f.next&&f.next(d)},subscribe:d=>(n.push(d),{unsubscribe:()=>{n=n.filter(f=>f!==d)}}),unsubscribe:()=>{n=[]}}},FD=n=>io(n)||!xX(n);function au(n,i){if(FD(n)||FD(i))return n===i;if(Qh(n)&&Qh(i))return n.getTime()===i.getTime();const o=Object.keys(n),c=Object.keys(i);if(o.length!==c.length)return!1;for(const d of o){const f=n[d];if(!c.includes(d))return!1;if(d!=="ref"){const _=i[d];if(Qh(f)&&Qh(_)||Pi(f)&&Pi(_)||Array.isArray(f)&&Array.isArray(_)?!au(f,_):f!==_)return!1}}return!0}var Ro=n=>Pi(n)&&!Object.keys(n).length,Kk=n=>n.type==="file",bc=n=>typeof n=="function",MT=n=>{if(!Gk)return!1;const i=n?n.ownerDocument:0;return n instanceof(i&&i.defaultView?i.defaultView.HTMLElement:HTMLElement)},bX=n=>n.type==="select-multiple",qk=n=>n.type==="radio",ewe=n=>qk(n)||RE(n),hI=n=>MT(n)&&n.isConnected;function twe(n,i){const o=i.slice(0,-1).length;let c=0;for(;c<o;)n=ji(n)?c++:n[i[c++]];return n}function nwe(n){for(const i in n)if(n.hasOwnProperty(i)&&!ji(n[i]))return!1;return!0}function $i(n,i){const o=Array.isArray(i)?i:zk(i)?[i]:TX(i),c=o.length===1?n:twe(n,o),d=o.length-1,f=o[d];return c&&delete c[f],d!==0&&(Pi(c)&&Ro(c)||Array.isArray(c)&&nwe(c))&&$i(n,o.slice(0,-1)),n}var wX=n=>{for(const i in n)if(bc(n[i]))return!0;return!1};function jT(n,i={}){const o=Array.isArray(n);if(Pi(n)||o)for(const c in n)Array.isArray(n[c])||Pi(n[c])&&!wX(n[c])?(i[c]=Array.isArray(n[c])?[]:{},jT(n[c],i[c])):io(n[c])||(i[c]=!0);return i}function CX(n,i,o){const c=Array.isArray(n);if(Pi(n)||c)for(const d in n)Array.isArray(n[d])||Pi(n[d])&&!wX(n[d])?ji(i)||FD(o[d])?o[d]=Array.isArray(n[d])?jT(n[d],[]):{...jT(n[d])}:CX(n[d],io(i)?{}:i[d],o[d]):o[d]=!au(n[d],i[d]);return o}var d_=(n,i)=>CX(n,i,jT(i));const VH={value:!1,isValid:!1},BH={value:!0,isValid:!0};var RX=n=>{if(Array.isArray(n)){if(n.length>1){const i=n.filter(o=>o&&o.checked&&!o.disabled).map(o=>o.value);return{value:i,isValid:!!i.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!ji(n[0].attributes.value)?ji(n[0].value)||n[0].value===""?BH:{value:n[0].value,isValid:!0}:BH:VH}return VH},AX=(n,{valueAsNumber:i,valueAsDate:o,setValueAs:c})=>ji(n)?n:i?n===""?NaN:n&&+n:o&&_l(n)?new Date(n):c?c(n):n;const WH={isValid:!1,value:null};var NX=n=>Array.isArray(n)?n.reduce((i,o)=>o&&o.checked&&!o.disabled?{isValid:!0,value:o.value}:i,WH):WH;function HH(n){const i=n.ref;return Kk(i)?i.files:qk(i)?NX(n.refs).value:bX(i)?[...i.selectedOptions].map(({value:o})=>o):RE(i)?RX(n.refs).value:AX(ji(i.value)?n.ref.value:i.value,n)}var rwe=(n,i,o,c)=>{const d={};for(const f of n){const _=Bt(i,f);_&&Gr(d,f,_._f)}return{criteriaMode:o,names:[...n],fields:d,shouldUseNativeValidation:c}},UT=n=>n instanceof RegExp,u_=n=>ji(n)?n:UT(n)?n.source:Pi(n)?UT(n.value)?n.value.source:n.value:n,GH=n=>({isOnSubmit:!n||n===Tc.onSubmit,isOnBlur:n===Tc.onBlur,isOnChange:n===Tc.onChange,isOnAll:n===Tc.all,isOnTouch:n===Tc.onTouched});const zH="AsyncFunction";var iwe=n=>!!n&&!!n.validate&&!!(bc(n.validate)&&n.validate.constructor.name===zH||Pi(n.validate)&&Object.values(n.validate).find(i=>i.constructor.name===zH)),swe=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),KH=(n,i,o)=>!o&&(i.watchAll||i.watch.has(n)||[...i.watch].some(c=>n.startsWith(c)&&/^\.\w+/.test(n.slice(c.length))));const L_=(n,i,o,c)=>{for(const d of o||Object.keys(n)){const f=Bt(n,d);if(f){const{_f:_,...v}=f;if(_){if(_.refs&&_.refs[0]&&i(_.refs[0],d)&&!c)return!0;if(_.ref&&i(_.ref,_.name)&&!c)return!0;if(L_(v,i))break}else if(Pi(v)&&L_(v,i))break}}};function qH(n,i,o){const c=Bt(n,o);if(c||zk(o))return{error:c,name:o};const d=o.split(".");for(;d.length;){const f=d.join("."),_=Bt(i,f),v=Bt(n,f);if(_&&!Array.isArray(_)&&o!==f)return{name:o};if(v&&v.type)return{name:f,error:v};if(v&&v.root&&v.root.type)return{name:`${f}.root`,error:v.root};d.pop()}return{name:o}}var owe=(n,i,o,c)=>{o(n);const{name:d,...f}=n;return Ro(f)||Object.keys(f).length>=Object.keys(i).length||Object.keys(f).find(_=>i[_]===(!c||Tc.all))},awe=(n,i,o)=>!n||!i||n===i||k_(n).some(c=>c&&(o?c===i:c.startsWith(i)||i.startsWith(c))),cwe=(n,i,o,c,d)=>d.isOnAll?!1:!o&&d.isOnTouch?!(i||n):(o?c.isOnBlur:d.isOnBlur)?!n:(o?c.isOnChange:d.isOnChange)?n:!0,lwe=(n,i)=>!Lb(Bt(n,i)).length&&$i(n,i),dwe=(n,i,o)=>{const c=k_(Bt(n,o));return Gr(c,"root",i[o]),Gr(n,o,c),n},Ux=n=>_l(n);function YH(n,i,o="validate"){if(Ux(n)||Array.isArray(n)&&n.every(Ux)||pl(n)&&!n)return{type:o,message:Ux(n)?n:"",ref:i}}var Qf=n=>Pi(n)&&!UT(n)?n:{value:n,message:""},$H=async(n,i,o,c,d,f)=>{const{ref:_,refs:v,required:x,maxLength:T,minLength:w,min:R,max:I,pattern:j,validate:P,name:k,valueAsNumber:W,mount:H}=n._f,L=Bt(o,k);if(!H||i.has(k))return{};const V=v?v[0]:_,K=Ee=>{d&&V.reportValidity&&(V.setCustomValidity(pl(Ee)?"":Ee||""),V.reportValidity())},te={},ie=qk(_),A=RE(_),de=ie||A,ue=(W||Kk(_))&&ji(_.value)&&ji(L)||MT(_)&&_.value===""||L===""||Array.isArray(L)&&!L.length,oe=Zbe.bind(null,k,c,te),ye=(Ee,xe,Oe,ct=Kl.maxLength,at=Kl.minLength)=>{const lt=Ee?xe:Oe;te[k]={type:Ee?ct:at,message:lt,ref:_,...oe(Ee?ct:at,lt)}};if(f?!Array.isArray(L)||!L.length:x&&(!de&&(ue||io(L))||pl(L)&&!L||A&&!RX(v).isValid||ie&&!NX(v).isValid)){const{value:Ee,message:xe}=Ux(x)?{value:!!x,message:x}:Qf(x);if(Ee&&(te[k]={type:Kl.required,message:xe,ref:V,...oe(Kl.required,xe)},!c))return K(xe),te}if(!ue&&(!io(R)||!io(I))){let Ee,xe;const Oe=Qf(I),ct=Qf(R);if(!io(L)&&!isNaN(L)){const at=_.valueAsNumber||L&&+L;io(Oe.value)||(Ee=at>Oe.value),io(ct.value)||(xe=at<ct.value)}else{const at=_.valueAsDate||new Date(L),lt=ut=>new Date(new Date().toDateString()+" "+ut),He=_.type=="time",et=_.type=="week";_l(Oe.value)&&L&&(Ee=He?lt(L)>lt(Oe.value):et?L>Oe.value:at>new Date(Oe.value)),_l(ct.value)&&L&&(xe=He?lt(L)<lt(ct.value):et?L<ct.value:at<new Date(ct.value))}if((Ee||xe)&&(ye(!!Ee,Oe.message,ct.message,Kl.max,Kl.min),!c))return K(te[k].message),te}if((T||w)&&!ue&&(_l(L)||f&&Array.isArray(L))){const Ee=Qf(T),xe=Qf(w),Oe=!io(Ee.value)&&L.length>+Ee.value,ct=!io(xe.value)&&L.length<+xe.value;if((Oe||ct)&&(ye(Oe,Ee.message,xe.message),!c))return K(te[k].message),te}if(j&&!ue&&_l(L)){const{value:Ee,message:xe}=Qf(j);if(UT(Ee)&&!L.match(Ee)&&(te[k]={type:Kl.pattern,message:xe,ref:_,...oe(Kl.pattern,xe)},!c))return K(xe),te}if(P){if(bc(P)){const Ee=await P(L,o),xe=YH(Ee,V);if(xe&&(te[k]={...xe,...oe(Kl.validate,xe.message)},!c))return K(xe.message),te}else if(Pi(P)){let Ee={};for(const xe in P){if(!Ro(Ee)&&!c)break;const Oe=YH(await P[xe](L,o),V,xe);Oe&&(Ee={...Oe,...oe(xe,Oe.message)},K(Oe.message),c&&(te[k]=Ee))}if(!Ro(Ee)&&(te[k]={ref:V,...Ee},!c))return te}}return K(!0),te};const uwe={mode:Tc.onSubmit,reValidateMode:Tc.onChange,shouldFocusError:!0};function hwe(n={}){let i={...uwe,...n},o={submitCount:0,isDirty:!1,isReady:!1,isLoading:bc(i.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:i.errors||{},disabled:i.disabled||!1};const c={};let d=Pi(i.defaultValues)||Pi(i.values)?Vs(i.defaultValues||i.values)||{}:{},f=i.shouldUnregister?{}:Vs(d),_={action:!1,mount:!1,watch:!1},v={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},x,T=0;const w={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let R={...w};const I={array:FH(),state:FH()},j=i.criteriaMode===Tc.all,P=ve=>De=>{clearTimeout(T),T=setTimeout(ve,De)},k=async ve=>{if(!i.disabled&&(w.isValid||R.isValid||ve)){const De=i.resolver?Ro((await A()).errors):await ue(c,!0);De!==o.isValid&&I.state.next({isValid:De})}},W=(ve,De)=>{!i.disabled&&(w.isValidating||w.validatingFields||R.isValidating||R.validatingFields)&&((ve||Array.from(v.mount)).forEach(Ve=>{Ve&&(De?Gr(o.validatingFields,Ve,De):$i(o.validatingFields,Ve))}),I.state.next({validatingFields:o.validatingFields,isValidating:!Ro(o.validatingFields)}))},H=(ve,De=[],Ve,gt,ot=!0,Ue=!0)=>{if(gt&&Ve&&!i.disabled){if(_.action=!0,Ue&&Array.isArray(Bt(c,ve))){const St=Ve(Bt(c,ve),gt.argA,gt.argB);ot&&Gr(c,ve,St)}if(Ue&&Array.isArray(Bt(o.errors,ve))){const St=Ve(Bt(o.errors,ve),gt.argA,gt.argB);ot&&Gr(o.errors,ve,St),lwe(o.errors,ve)}if((w.touchedFields||R.touchedFields)&&Ue&&Array.isArray(Bt(o.touchedFields,ve))){const St=Ve(Bt(o.touchedFields,ve),gt.argA,gt.argB);ot&&Gr(o.touchedFields,ve,St)}(w.dirtyFields||R.dirtyFields)&&(o.dirtyFields=d_(d,f)),I.state.next({name:ve,isDirty:ye(ve,De),dirtyFields:o.dirtyFields,errors:o.errors,isValid:o.isValid})}else Gr(f,ve,De)},L=(ve,De)=>{Gr(o.errors,ve,De),I.state.next({errors:o.errors})},V=ve=>{o.errors=ve,I.state.next({errors:o.errors,isValid:!1})},K=(ve,De,Ve,gt)=>{const ot=Bt(c,ve);if(ot){const Ue=Bt(f,ve,ji(Ve)?Bt(d,ve):Ve);ji(Ue)||gt&&gt.defaultChecked||De?Gr(f,ve,De?Ue:HH(ot._f)):Oe(ve,Ue),_.mount&&k()}},te=(ve,De,Ve,gt,ot)=>{let Ue=!1,St=!1;const dn={name:ve};if(!i.disabled){if(!Ve||gt){(w.isDirty||R.isDirty)&&(St=o.isDirty,o.isDirty=dn.isDirty=ye(),Ue=St!==dn.isDirty);const nr=au(Bt(d,ve),De);St=!!Bt(o.dirtyFields,ve),nr?$i(o.dirtyFields,ve):Gr(o.dirtyFields,ve,!0),dn.dirtyFields=o.dirtyFields,Ue=Ue||(w.dirtyFields||R.dirtyFields)&&St!==!nr}if(Ve){const nr=Bt(o.touchedFields,ve);nr||(Gr(o.touchedFields,ve,Ve),dn.touchedFields=o.touchedFields,Ue=Ue||(w.touchedFields||R.touchedFields)&&nr!==Ve)}Ue&&ot&&I.state.next(dn)}return Ue?dn:{}},ie=(ve,De,Ve,gt)=>{const ot=Bt(o.errors,ve),Ue=(w.isValid||R.isValid)&&pl(De)&&o.isValid!==De;if(i.delayError&&Ve?(x=P(()=>L(ve,Ve)),x(i.delayError)):(clearTimeout(T),x=null,Ve?Gr(o.errors,ve,Ve):$i(o.errors,ve)),(Ve?!au(ot,Ve):ot)||!Ro(gt)||Ue){const St={...gt,...Ue&&pl(De)?{isValid:De}:{},errors:o.errors,name:ve};o={...o,...St},I.state.next(St)}},A=async ve=>{W(ve,!0);const De=await i.resolver(f,i.context,rwe(ve||v.mount,c,i.criteriaMode,i.shouldUseNativeValidation));return W(ve),De},de=async ve=>{const{errors:De}=await A(ve);if(ve)for(const Ve of ve){const gt=Bt(De,Ve);gt?Gr(o.errors,Ve,gt):$i(o.errors,Ve)}else o.errors=De;return De},ue=async(ve,De,Ve={valid:!0})=>{for(const gt in ve){const ot=ve[gt];if(ot){const{_f:Ue,...St}=ot;if(Ue){const dn=v.array.has(Ue.name),nr=ot._f&&iwe(ot._f);nr&&w.validatingFields&&W([gt],!0);const Ci=await $H(ot,v.disabled,f,j,i.shouldUseNativeValidation&&!De,dn);if(nr&&w.validatingFields&&W([gt]),Ci[Ue.name]&&(Ve.valid=!1,De))break;!De&&(Bt(Ci,Ue.name)?dn?dwe(o.errors,Ci,Ue.name):Gr(o.errors,Ue.name,Ci[Ue.name]):$i(o.errors,Ue.name))}!Ro(St)&&await ue(St,De,Ve)}}return Ve.valid},oe=()=>{for(const ve of v.unMount){const De=Bt(c,ve);De&&(De._f.refs?De._f.refs.every(Ve=>!hI(Ve)):!hI(De._f.ref))&&Dn(ve)}v.unMount=new Set},ye=(ve,De)=>!i.disabled&&(ve&&De&&Gr(f,ve,De),!au(ut(),d)),Ee=(ve,De,Ve)=>Qbe(ve,v,{..._.mount?f:ji(De)?d:_l(ve)?{[ve]:De}:De},Ve,De),xe=ve=>Lb(Bt(_.mount?f:d,ve,i.shouldUnregister?Bt(d,ve,[]):[])),Oe=(ve,De,Ve={})=>{const gt=Bt(c,ve);let ot=De;if(gt){const Ue=gt._f;Ue&&(!Ue.disabled&&Gr(f,ve,AX(De,Ue)),ot=MT(Ue.ref)&&io(De)?"":De,bX(Ue.ref)?[...Ue.ref.options].forEach(St=>St.selected=ot.includes(St.value)):Ue.refs?RE(Ue.ref)?Ue.refs.forEach(St=>{(!St.defaultChecked||!St.disabled)&&(Array.isArray(ot)?St.checked=!!ot.find(dn=>dn===St.value):St.checked=ot===St.value||!!ot)}):Ue.refs.forEach(St=>St.checked=St.value===ot):Kk(Ue.ref)?Ue.ref.value="":(Ue.ref.value=ot,Ue.ref.type||I.state.next({name:ve,values:Vs(f)})))}(Ve.shouldDirty||Ve.shouldTouch)&&te(ve,ot,Ve.shouldTouch,Ve.shouldDirty,!0),Ve.shouldValidate&&et(ve)},ct=(ve,De,Ve)=>{for(const gt in De){if(!De.hasOwnProperty(gt))return;const ot=De[gt],Ue=ve+"."+gt,St=Bt(c,Ue);(v.array.has(ve)||Pi(ot)||St&&!St._f)&&!Qh(ot)?ct(Ue,ot,Ve):Oe(Ue,ot,Ve)}},at=(ve,De,Ve={})=>{const gt=Bt(c,ve),ot=v.array.has(ve),Ue=Vs(De);Gr(f,ve,Ue),ot?(I.array.next({name:ve,values:Vs(f)}),(w.isDirty||w.dirtyFields||R.isDirty||R.dirtyFields)&&Ve.shouldDirty&&I.state.next({name:ve,dirtyFields:d_(d,f),isDirty:ye(ve,Ue)})):gt&&!gt._f&&!io(Ue)?ct(ve,Ue,Ve):Oe(ve,Ue,Ve),KH(ve,v)&&I.state.next({...o}),I.state.next({name:_.mount?ve:void 0,values:Vs(f)})},lt=async ve=>{_.mount=!0;const De=ve.target;let Ve=De.name,gt=!0;const ot=Bt(c,Ve),Ue=nr=>{gt=Number.isNaN(nr)||Qh(nr)&&isNaN(nr.getTime())||au(nr,Bt(f,Ve,nr))},St=GH(i.mode),dn=GH(i.reValidateMode);if(ot){let nr,Ci;const Uo=De.type?HH(ot._f):Kbe(ve),Ri=ve.type===UH.BLUR||ve.type===UH.FOCUS_OUT,Rs=!swe(ot._f)&&!i.resolver&&!Bt(o.errors,Ve)&&!ot._f.deps||cwe(Ri,Bt(o.touchedFields,Ve),o.isSubmitted,dn,St),Zi=KH(Ve,v,Ri);Gr(f,Ve,Uo),Ri?(ot._f.onBlur&&ot._f.onBlur(ve),x&&x(0)):ot._f.onChange&&ot._f.onChange(ve);const _i=te(Ve,Uo,Ri),lo=!Ro(_i)||Zi;if(!Ri&&I.state.next({name:Ve,type:ve.type,values:Vs(f)}),Rs)return(w.isValid||R.isValid)&&(i.mode==="onBlur"?Ri&&k():Ri||k()),lo&&I.state.next({name:Ve,...Zi?{}:_i});if(!Ri&&Zi&&I.state.next({...o}),i.resolver){const{errors:md}=await A([Ve]);if(Ue(Uo),gt){const Lc=qH(o.errors,c,Ve),Ys=qH(md,c,Lc.name||Ve);nr=Ys.error,Ve=Ys.name,Ci=Ro(md)}}else W([Ve],!0),nr=(await $H(ot,v.disabled,f,j,i.shouldUseNativeValidation))[Ve],W([Ve]),Ue(Uo),gt&&(nr?Ci=!1:(w.isValid||R.isValid)&&(Ci=await ue(c,!0)));gt&&(ot._f.deps&&et(ot._f.deps),ie(Ve,Ci,nr,_i))}},He=(ve,De)=>{if(Bt(o.errors,De)&&ve.focus)return ve.focus(),1},et=async(ve,De={})=>{let Ve,gt;const ot=k_(ve);if(i.resolver){const Ue=await de(ji(ve)?ve:ot);Ve=Ro(Ue),gt=ve?!ot.some(St=>Bt(Ue,St)):Ve}else ve?(gt=(await Promise.all(ot.map(async Ue=>{const St=Bt(c,Ue);return await ue(St&&St._f?{[Ue]:St}:St)}))).every(Boolean),!(!gt&&!o.isValid)&&k()):gt=Ve=await ue(c);return I.state.next({...!_l(ve)||(w.isValid||R.isValid)&&Ve!==o.isValid?{}:{name:ve},...i.resolver||!ve?{isValid:Ve}:{},errors:o.errors}),De.shouldFocus&&!gt&&L_(c,He,ve?ot:v.mount),gt},ut=ve=>{const De={..._.mount?f:d};return ji(ve)?De:_l(ve)?Bt(De,ve):ve.map(Ve=>Bt(De,Ve))},Ae=(ve,De)=>({invalid:!!Bt((De||o).errors,ve),isDirty:!!Bt((De||o).dirtyFields,ve),error:Bt((De||o).errors,ve),isValidating:!!Bt(o.validatingFields,ve),isTouched:!!Bt((De||o).touchedFields,ve)}),Le=ve=>{ve&&k_(ve).forEach(De=>$i(o.errors,De)),I.state.next({errors:ve?o.errors:{}})},ze=(ve,De,Ve)=>{const gt=(Bt(c,ve,{_f:{}})._f||{}).ref,ot=Bt(o.errors,ve)||{},{ref:Ue,message:St,type:dn,...nr}=ot;Gr(o.errors,ve,{...nr,...De,ref:gt}),I.state.next({name:ve,errors:o.errors,isValid:!1}),Ve&&Ve.shouldFocus&&gt&&gt.focus&&gt.focus()},qe=(ve,De)=>bc(ve)?I.state.subscribe({next:Ve=>ve(Ee(void 0,De),Ve)}):Ee(ve,De,!0),fn=ve=>I.state.subscribe({next:De=>{awe(ve.name,De.name,ve.exact)&&owe(De,ve.formState||w,mn,ve.reRenderRoot)&&ve.callback({values:{...f},...o,...De})}}).unsubscribe,qt=ve=>(_.mount=!0,R={...R,...ve.formState},fn({...ve,formState:R})),Dn=(ve,De={})=>{for(const Ve of ve?k_(ve):v.mount)v.mount.delete(Ve),v.array.delete(Ve),De.keepValue||($i(c,Ve),$i(f,Ve)),!De.keepError&&$i(o.errors,Ve),!De.keepDirty&&$i(o.dirtyFields,Ve),!De.keepTouched&&$i(o.touchedFields,Ve),!De.keepIsValidating&&$i(o.validatingFields,Ve),!i.shouldUnregister&&!De.keepDefaultValue&&$i(d,Ve);I.state.next({values:Vs(f)}),I.state.next({...o,...De.keepDirty?{isDirty:ye()}:{}}),!De.keepIsValid&&k()},Kt=({disabled:ve,name:De})=>{(pl(ve)&&_.mount||ve||v.disabled.has(De))&&(ve?v.disabled.add(De):v.disabled.delete(De))},hr=(ve,De={})=>{let Ve=Bt(c,ve);const gt=pl(De.disabled)||pl(i.disabled);return Gr(c,ve,{...Ve||{},_f:{...Ve&&Ve._f?Ve._f:{ref:{name:ve}},name:ve,mount:!0,...De}}),v.mount.add(ve),Ve?Kt({disabled:pl(De.disabled)?De.disabled:i.disabled,name:ve}):K(ve,!0,De.value),{...gt?{disabled:De.disabled||i.disabled}:{},...i.progressive?{required:!!De.required,min:u_(De.min),max:u_(De.max),minLength:u_(De.minLength),maxLength:u_(De.maxLength),pattern:u_(De.pattern)}:{},name:ve,onChange:lt,onBlur:lt,ref:ot=>{if(ot){hr(ve,De),Ve=Bt(c,ve);const Ue=ji(ot.value)&&ot.querySelectorAll&&ot.querySelectorAll("input,select,textarea")[0]||ot,St=ewe(Ue),dn=Ve._f.refs||[];if(St?dn.find(nr=>nr===Ue):Ue===Ve._f.ref)return;Gr(c,ve,{_f:{...Ve._f,...St?{refs:[...dn.filter(hI),Ue,...Array.isArray(Bt(d,ve))?[{}]:[]],ref:{type:Ue.type,name:ve}}:{ref:Ue}}}),K(ve,!1,void 0,Ue)}else Ve=Bt(c,ve,{}),Ve._f&&(Ve._f.mount=!1),(i.shouldUnregister||De.shouldUnregister)&&!(Ybe(v.array,ve)&&_.action)&&v.unMount.add(ve)}}},Bn=()=>i.shouldFocusError&&L_(c,He,v.mount),Yr=ve=>{pl(ve)&&(I.state.next({disabled:ve}),L_(c,(De,Ve)=>{const gt=Bt(c,Ve);gt&&(De.disabled=gt._f.disabled||ve,Array.isArray(gt._f.refs)&&gt._f.refs.forEach(ot=>{ot.disabled=gt._f.disabled||ve}))},0,!1))},yr=(ve,De)=>async Ve=>{let gt;Ve&&(Ve.preventDefault&&Ve.preventDefault(),Ve.persist&&Ve.persist());let ot=Vs(f);if(I.state.next({isSubmitting:!0}),i.resolver){const{errors:Ue,values:St}=await A();o.errors=Ue,ot=St}else await ue(c);if(v.disabled.size)for(const Ue of v.disabled)Gr(ot,Ue,void 0);if($i(o.errors,"root"),Ro(o.errors)){I.state.next({errors:{}});try{await ve(ot,Ve)}catch(Ue){gt=Ue}}else De&&await De({...o.errors},Ve),Bn(),setTimeout(Bn);if(I.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ro(o.errors)&&!gt,submitCount:o.submitCount+1,errors:o.errors}),gt)throw gt},cr=(ve,De={})=>{Bt(c,ve)&&(ji(De.defaultValue)?at(ve,Vs(Bt(d,ve))):(at(ve,De.defaultValue),Gr(d,ve,Vs(De.defaultValue))),De.keepTouched||$i(o.touchedFields,ve),De.keepDirty||($i(o.dirtyFields,ve),o.isDirty=De.defaultValue?ye(ve,Vs(Bt(d,ve))):ye()),De.keepError||($i(o.errors,ve),w.isValid&&k()),I.state.next({...o}))},ri=(ve,De={})=>{const Ve=ve?Vs(ve):d,gt=Vs(Ve),ot=Ro(ve),Ue=ot?d:gt;if(De.keepDefaultValues||(d=Ve),!De.keepValues){if(De.keepDirtyValues){const St=new Set([...v.mount,...Object.keys(d_(d,f))]);for(const dn of Array.from(St))Bt(o.dirtyFields,dn)?Gr(Ue,dn,Bt(f,dn)):at(dn,Bt(Ue,dn))}else{if(Gk&&ji(ve))for(const St of v.mount){const dn=Bt(c,St);if(dn&&dn._f){const nr=Array.isArray(dn._f.refs)?dn._f.refs[0]:dn._f.ref;if(MT(nr)){const Ci=nr.closest("form");if(Ci){Ci.reset();break}}}}for(const St of v.mount)at(St,Bt(Ue,St))}f=Vs(Ue),I.array.next({values:{...Ue}}),I.state.next({values:{...Ue}})}v={mount:De.keepDirtyValues?v.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},_.mount=!w.isValid||!!De.keepIsValid||!!De.keepDirtyValues,_.watch=!!i.shouldUnregister,I.state.next({submitCount:De.keepSubmitCount?o.submitCount:0,isDirty:ot?!1:De.keepDirty?o.isDirty:!!(De.keepDefaultValues&&!au(ve,d)),isSubmitted:De.keepIsSubmitted?o.isSubmitted:!1,dirtyFields:ot?{}:De.keepDirtyValues?De.keepDefaultValues&&f?d_(d,f):o.dirtyFields:De.keepDefaultValues&&ve?d_(d,ve):De.keepDirty?o.dirtyFields:{},touchedFields:De.keepTouched?o.touchedFields:{},errors:De.keepErrors?o.errors:{},isSubmitSuccessful:De.keepIsSubmitSuccessful?o.isSubmitSuccessful:!1,isSubmitting:!1})},jo=(ve,De)=>ri(bc(ve)?ve(f):ve,De),gi=(ve,De={})=>{const Ve=Bt(c,ve),gt=Ve&&Ve._f;if(gt){const ot=gt.refs?gt.refs[0]:gt.ref;ot.focus&&(ot.focus(),De.shouldSelect&&bc(ot.select)&&ot.select())}},mn=ve=>{o={...o,...ve}},$r={control:{register:hr,unregister:Dn,getFieldState:Ae,handleSubmit:yr,setError:ze,_subscribe:fn,_runSchema:A,_focusError:Bn,_getWatch:Ee,_getDirty:ye,_setValid:k,_setFieldArray:H,_setDisabledField:Kt,_setErrors:V,_getFieldArray:xe,_reset:ri,_resetDefaultValues:()=>bc(i.defaultValues)&&i.defaultValues().then(ve=>{jo(ve,i.resetOptions),I.state.next({isLoading:!1})}),_removeUnmounted:oe,_disableForm:Yr,_subjects:I,_proxyFormState:w,get _fields(){return c},get _formValues(){return f},get _state(){return _},set _state(ve){_=ve},get _defaultValues(){return d},get _names(){return v},set _names(ve){v=ve},get _formState(){return o},get _options(){return i},set _options(ve){i={...i,...ve}}},subscribe:qt,trigger:et,register:hr,handleSubmit:yr,watch:qe,setValue:at,getValues:ut,reset:jo,resetField:cr,clearErrors:Le,unregister:Dn,setError:ze,setFocus:gi,getFieldState:Ae};return{...$r,formControl:$r}}function Mb(n={}){const i=wt.useRef(void 0),o=wt.useRef(void 0),[c,d]=wt.useState({isDirty:!1,isValidating:!1,isLoading:bc(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:bc(n.defaultValues)?void 0:n.defaultValues});i.current||(i.current={...n.formControl?n.formControl:hwe(n),formState:c},n.formControl&&n.defaultValues&&!bc(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions));const f=i.current.control;return f._options=n,Jbe(()=>{const _=f._subscribe({formState:f._proxyFormState,callback:()=>d({...f._formState}),reRenderRoot:!0});return d(v=>({...v,isReady:!0})),f._formState.isReady=!0,_},[f]),wt.useEffect(()=>f._disableForm(n.disabled),[f,n.disabled]),wt.useEffect(()=>{n.mode&&(f._options.mode=n.mode),n.reValidateMode&&(f._options.reValidateMode=n.reValidateMode)},[f,n.mode,n.reValidateMode]),wt.useEffect(()=>{n.errors&&(f._setErrors(n.errors),f._focusError())},[f,n.errors]),wt.useEffect(()=>{n.shouldUnregister&&f._subjects.state.next({values:f._getWatch()})},[f,n.shouldUnregister]),wt.useEffect(()=>{if(f._proxyFormState.isDirty){const _=f._getDirty();_!==c.isDirty&&f._subjects.state.next({isDirty:_})}},[f,c.isDirty]),wt.useEffect(()=>{n.values&&!au(n.values,o.current)?(f._reset(n.values,f._options.resetOptions),o.current=n.values,d(_=>({..._}))):f._resetDefaultValues()},[f,n.values]),wt.useEffect(()=>{f._state.mount||(f._setValid(),f._state.mount=!0),f._state.watch&&(f._state.watch=!1,f._subjects.state.next({...f._formState})),f._removeUnmounted()}),i.current.formState=Xbe(c,f),i.current}const pwe=()=>{const{register:n,handleSubmit:i,formState:{errors:o}}=Mb(),c=Qi(),[d,f]=X.useState(!1),_=async v=>{var x;f(!0);try{const T=await Jn.post("https://astro-talk-backend.onrender.com/web/register",v);console.log("Registration successful:",T.data),alert("Registration successful! Please log in."),c("/user-login")}catch(T){console.error("Registration failed:",((x=T.response)==null?void 0:x.data)||T.message),alert("Registration failed. Try again.")}finally{f(!1)}};return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-astro-indigo via-astro-purple to-astro-pink p-4 pt-24 star-bg",children:h.jsx(Dt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:h.jsxs(ur,{className:"w-full max-w-md shadow-2xl relative",children:[h.jsx("button",{onClick:()=>c("/"),className:"absolute top-4 right-4 text-gray-400 hover:text-red-500","aria-label":"Close",children:h.jsx(xp,{className:"w-5 h-5"})}),h.jsxs(qr,{className:"text-center",children:[h.jsx(ni,{className:"text-3xl font-bold cosmic-text",children:"Create Your Account"}),h.jsx(qs,{children:"Join Astro Truth and start your cosmic journey today!"})]}),h.jsx(vr,{children:h.jsxs("form",{onSubmit:i(_),className:"space-y-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"name",children:"Full Name"}),h.jsxs("div",{className:"relative",children:[h.jsx($h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{type:"text",placeholder:"Name",...n("name",{required:"Name is required"}),className:"pl-10"})]}),o.name&&h.jsx("p",{className:"text-red-500 text-sm",children:o.name.message})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"email",children:"Email"}),h.jsxs("div",{className:"relative",children:[h.jsx(ad,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{type:"email",placeholder:"Email",...n("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),className:"pl-10"})]}),o.email&&h.jsx("p",{className:"text-red-500 text-sm",children:o.email.message})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"mobile",children:"Mobile"}),h.jsxs("div",{className:"relative",children:[h.jsx(Iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{type:"tel",placeholder:"Mobile number",...n("mobile",{required:"Mobile number is required",pattern:{value:/^[0-9]{10}$/,message:"Enter a valid 10-digit number"}}),className:"pl-10"})]}),o.mobile&&h.jsx("p",{className:"text-red-500 text-sm",children:o.mobile.message})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"address",children:"Address"}),h.jsx(Vt,{type:"text",placeholder:"Address",...n("address",{required:"Address is required"})}),o.address&&h.jsx("p",{className:"text-red-500 text-sm",children:o.address.message})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"dob",children:"Date of Birth"}),h.jsx(Vt,{type:"date",...n("dob",{required:"DOB is required"})}),o.dob&&h.jsx("p",{className:"text-red-500 text-sm",children:o.dob.message})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"password",children:"Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(Vm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{type:"password",placeholder:"",...n("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),className:"pl-10"})]}),o.password&&h.jsx("p",{className:"text-red-500 text-sm",children:o.password.message})]}),h.jsx(vt,{type:"submit",className:"w-full cosmic-gradient text-white",disabled:d,children:d?"Creating Account...":"Create Account"})]})}),h.jsx(r0,{className:"flex flex-col items-center",children:h.jsxs("p",{className:"text-sm text-muted-foreground",children:["Already have an account?"," ",h.jsx(Xn,{to:"/user-login",className:"font-medium text-primary hover:underline",children:"Log in"})]})})]})})})},fwe=()=>h.jsxs("section",{className:"md:bg-white bg-orange-100 pt-20 md:pt-28 pb-10 md:pb-16  relative overflow-hidden min-h-screen flex flex-col justify-center",children:[h.jsx("div",{className:"absolute inset-0 z-0"}),h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:h.jsxs("div",{className:"text-center main-title-color",children:[h.jsx(Dt.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-4xl md:text-5xl lg:text-7xl font-extrabold mb-6  main-title-color drop-shadow-lg",children:"Your Trusted Guide to the Star"}),h.jsx(Dt.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"text-lg md:text-xl lg:text-2xl mb-10 color-black max-w-3xl mx-auto drop-shadow-sm",children:"Connect with Indias Best Astrologers for instant guidance on love, career, and life's challenges. Personalized readings, 24/7 availability."}),h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[h.jsxs(vt,{size:"lg",className:" common-btn-color font-semibold text-lg py-3 px-8 pulse",children:[h.jsx(ST,{className:"mr-2 h-6 w-6"})," Talk with Astrologers"]}),h.jsxs(vt,{size:"lg",variant:"outline",className:" common-btn-color font-semibold text-lg py-3 px-8",children:[h.jsx(cd,{className:"mr-2 h-6 w-6"})," View All Astrologers"]})]}),h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},className:"flex flex-wrap justify-center items-center gap-x-8 gap-y-4 text-white/90",children:[h.jsxs("div",{className:"flex items-center color-black",children:[h.jsx(oo,{className:"h-5 w-5  mr-1.5",fill:"white"}),h.jsx("span",{children:"4.9/5 User Rating"})]}),h.jsxs("div",{className:"flex items-center color-black",children:[h.jsx(cd,{className:"h-5 w-5  mr-1.5"}),h.jsx("span",{children:"500+ Verified Astrologers"})]}),h.jsxs("div",{className:"flex items-center color-black",children:[h.jsx(ST,{className:"h-5 w-5  mr-1.5"}),h.jsx("span",{children:"24/7 Support"})]})]})]})}),h.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t from-background to-transparent opacity-80"})]}),mwe=[{icon:h.jsx(oo,{className:"h-6 w-6 text-yellow-500"}),title:"Expert Astrologers",description:"Consult with India's most experienced and trusted astrologers."},{icon:h.jsx(TY,{className:"h-6 w-6 text-green-500"}),title:"100% Privacy",description:"Your personal information and consultations remain completely confidential."},{icon:h.jsx(mEe,{className:"h-6 w-6 text-blue-500"}),title:"24/7 Availability",description:"Access astrological guidance anytime, day or night."},{icon:h.jsx(Iu,{className:"h-6 w-6 text-purple-500"}),title:"Instant Connect",description:"No waiting time. Connect with an astrologer within seconds."},{icon:h.jsx(cd,{className:"h-6 w-6 text-pink-500"}),title:"Verified Experts",description:"All astrologers are thoroughly vetted for authenticity and expertise."},{icon:h.jsx(_Y,{className:"h-6 w-6 text-amber-500"}),title:"Satisfaction Guarantee",description:"Not satisfied with your consultation? Get your money back."}],gwe=()=>h.jsx("section",{className:"py-16 bg-gradient-to-b from-background to-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Why Choose ",h.jsx("span",{className:"cosmic-text",children:"Astrotruth"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Experience the difference with our premium astrology consultation services"})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:mwe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow border border-gray-100",children:[h.jsx("div",{className:"bg-gray-50 rounded-full w-12 h-12 flex items-center justify-center mb-4",children:n.icon}),h.jsx("h3",{className:"text-xl font-semibold mb-2",children:n.title}),h.jsx("p",{className:"text-gray-600",children:n.description})]},i))})]})}),_we=_b("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",cosmic:"border-transparent bg-gradient-to-r from-astro-indigo via-astro-purple to-astro-pink text-white"}},defaultVariants:{variant:"default"}});function np({className:n,variant:i,...o}){return h.jsx("div",{className:Ir(_we({variant:i}),n),...o})}const Ewe=()=>{const[n,i]=X.useState([]),o=async()=>{var c;try{const d=await Jn.get("https://astro-talk-backend.onrender.com/web/astro/astrolist");i(((c=d.data)==null?void 0:c.data)||[])}catch(d){console.error("Error fetching astrologers:",d)}};return X.useEffect(()=>{o()},[]),h.jsx("section",{id:"astrologers",className:"py-16 bg-gray-50 common-margin-top",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our Expert ",h.jsx("span",{className:"cosmic-text",children:"Astrologers"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Connect with India's most trusted astrologers for personalized guidance"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map((c,d)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:d*.1},viewport:{once:!0},children:h.jsxs(ur,{className:"astrologer-card overflow-hidden h-full",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{alt:`Astrologer ${c.astroName}`,className:"w-full h-48 object-cover",src:"https://images.unsplash.com/photo-1457422373114-0d5cb3d0965b"}),h.jsx("div",{className:"absolute top-3 right-3"})]}),h.jsxs(vr,{className:"p-5",children:[h.jsxs("div",{className:"flex justify-between items-start mb-3",children:[h.jsx("div",{children:h.jsx("h3",{className:"font-bold text-lg",children:c.astroName})}),h.jsx("div",{className:"flex items-center bg-yellow-50 px-2 py-1 rounded",children:h.jsx(oo,{className:"h-4 w-4 text-yellow-500 mr-1",fill:"currentColor"})})]}),h.jsxs("div",{className:"mb-3",children:[h.jsxs("p",{className:"text-sm text-gray-600",children:[h.jsx("span",{className:"font-medium",children:"Experience:"})," ",c.experience," + Years"]}),h.jsxs("p",{className:"text-sm text-gray-600",children:[h.jsx("span",{className:"font-medium",children:"Languages:"})," ",c.langauge]})]}),h.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:h.jsx("span",{className:"text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded-full",children:c.expertise})}),h.jsx("div",{className:"flex justify-between items-center",children:h.jsxs("div",{className:"flex space-x-2",children:[h.jsx(vt,{size:"sm",variant:"outline",className:"rounded-full",children:h.jsx(vb,{className:"h-4 w-4"})}),h.jsxs(vt,{size:"sm",className:"cosmic-gradient rounded-full",children:[h.jsx(ST,{className:"h-4 w-4 mr-1"})," Call"]})]})})]})]})},d))}),h.jsx("div",{className:"text-center mt-10",children:h.jsx(vt,{size:"lg",className:"cosmic-gradient",children:"View All Astrologers"})})]})})},vwe=[{title:"Horoscope Reading",description:"Get detailed insights about your future based on your birth chart.",icon:""},{title:"Relationship Compatibility",description:"Find out if you and your partner are truly compatible for a long-term relationship.",icon:""},{title:"Career Guidance",description:"Discover the best career path aligned with your planetary positions.",icon:""},{title:"Marriage Prediction",description:"Learn about your marriage prospects, timing, and compatibility.",icon:""},{title:"Financial Forecast",description:"Get insights about your financial future and investment opportunities.",icon:""},{title:"Vastu Consultation",description:"Optimize your living and working spaces for positive energy flow.",icon:""}],IX=()=>h.jsx("section",{id:"services",className:"py-16 bg-white star-bg common-margin-top",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our ",h.jsx("span",{className:"cosmic-text",children:"Services"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Comprehensive astrological solutions for every aspect of your life"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:vwe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"service-card bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all border border-gray-100",children:[h.jsx("div",{className:"text-4xl mb-4",children:n.icon}),h.jsx("h3",{className:"text-xl font-semibold mb-3",children:n.title}),h.jsx("p",{className:"text-gray-600 mb-4",children:n.description}),h.jsxs(vt,{variant:"ghost",className:"text-primary hover:text-primary/80 p-0 flex items-center",children:["Learn More ",h.jsx(lk,{className:"ml-2 h-4 w-4"})]})]},i))})]})});var OX={exports:{}},DX={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hm=X;function ywe(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Swe=typeof Object.is=="function"?Object.is:ywe,xwe=Hm.useState,Twe=Hm.useEffect,bwe=Hm.useLayoutEffect,wwe=Hm.useDebugValue;function Cwe(n,i){var o=i(),c=xwe({inst:{value:o,getSnapshot:i}}),d=c[0].inst,f=c[1];return bwe(function(){d.value=o,d.getSnapshot=i,pI(d)&&f({inst:d})},[n,o,i]),Twe(function(){return pI(d)&&f({inst:d}),n(function(){pI(d)&&f({inst:d})})},[n]),wwe(o),o}function pI(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!Swe(n,o)}catch{return!0}}function Rwe(n,i){return i()}var Awe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Rwe:Cwe;DX.useSyncExternalStore=Hm.useSyncExternalStore!==void 0?Hm.useSyncExternalStore:Awe;OX.exports=DX;var Nwe=OX.exports;function Iwe(){return Nwe.useSyncExternalStore(Owe,()=>!0,()=>!1)}function Owe(){return()=>{}}var Yk="Avatar",[Dwe,ZIe]=Sp(Yk),[Pwe,PX]=Dwe(Yk),kX=X.forwardRef((n,i)=>{const{__scopeAvatar:o,...c}=n,[d,f]=X.useState("idle");return h.jsx(Pwe,{scope:o,imageLoadingStatus:d,onImageLoadingStatusChange:f,children:h.jsx(Wi.span,{...c,ref:i})})});kX.displayName=Yk;var LX="AvatarImage",MX=X.forwardRef((n,i)=>{const{__scopeAvatar:o,src:c,onLoadingStatusChange:d=()=>{},...f}=n,_=PX(LX,o),v=kwe(c,f),x=Sl(T=>{d(T),_.onImageLoadingStatusChange(T)});return xl(()=>{v!=="idle"&&x(v)},[v,x]),v==="loaded"?h.jsx(Wi.img,{...f,ref:i,src:c}):null});MX.displayName=LX;var jX="AvatarFallback",UX=X.forwardRef((n,i)=>{const{__scopeAvatar:o,delayMs:c,...d}=n,f=PX(jX,o),[_,v]=X.useState(c===void 0);return X.useEffect(()=>{if(c!==void 0){const x=window.setTimeout(()=>v(!0),c);return()=>window.clearTimeout(x)}},[c]),_&&f.imageLoadingStatus!=="loaded"?h.jsx(Wi.span,{...d,ref:i}):null});UX.displayName=jX;function XH(n,i){return n?i?(n.src!==i&&(n.src=i),n.complete&&n.naturalWidth>0?"loaded":"loading"):"error":"idle"}function kwe(n,{referrerPolicy:i,crossOrigin:o}){const c=Iwe(),d=X.useRef(null),f=(()=>c?(d.current||(d.current=new window.Image),d.current):null)(),[_,v]=X.useState(()=>XH(f,n));return xl(()=>{v(XH(f,n))},[f,n]),xl(()=>{const x=R=>()=>{v(R)};if(!f)return;const T=x("loaded"),w=x("error");return f.addEventListener("load",T),f.addEventListener("error",w),i&&(f.referrerPolicy=i),typeof o=="string"&&(f.crossOrigin=o),()=>{f.removeEventListener("load",T),f.removeEventListener("error",w)}},[f,o,i]),_}var FX=kX,VX=MX,BX=UX;const jb=wt.forwardRef(({className:n,...i},o)=>h.jsx(FX,{ref:o,className:Ir("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...i}));jb.displayName=FX.displayName;const Lwe=wt.forwardRef(({className:n,...i},o)=>h.jsx(VX,{ref:o,className:Ir("aspect-square h-full w-full",n),...i}));Lwe.displayName=VX.displayName;const Ub=wt.forwardRef(({className:n,...i},o)=>h.jsx(BX,{ref:o,className:Ir("flex h-full w-full items-center justify-center rounded-full bg-muted",n),...i}));Ub.displayName=BX.displayName;const Mwe=[{name:"Priya S.",location:"Mumbai",rating:5,title:"Incredibly Accurate!",text:"The career guidance I received was spot on and helped me make a crucial decision. Highly recommend!",avatarFallback:"PS"},{name:"Rajesh K.",location:"Delhi",rating:5,title:"Life-Changing Insights",text:"My relationship reading provided so much clarity. I understand my partner better now. Thank you, AstroTruth!",avatarFallback:"RK"},{name:"Anita V.",location:"Bangalore",rating:4,title:"Very Helpful",text:"The astrologer was patient and listened to all my concerns. The remedies suggested were simple and effective.",avatarFallback:"AV"},{name:"Vikram C.",location:"Chennai",rating:5,title:"Best Astrology Platform",text:"I've tried a few platforms, but AstroTruth has the most genuine and knowledgeable astrologers. 24/7 support is a plus!",avatarFallback:"VC"}],jwe=()=>h.jsx("section",{id:"testimonials",className:"py-16 bg-yellow-50 star-bg",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["CUSTOMERS ",h.jsx("span",{className:"text-yellow-600",children:"REVIEWS"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Hear what our valued clients have to say about their experiences with AstroTruth."})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Mwe.map((n,i)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},children:h.jsx(ur,{className:"testimonial-card rounded-xl p-6 shadow-lg border-yellow-300 hover:shadow-yellow-400/30 transition-shadow",children:h.jsxs(vr,{className:"flex flex-col",children:[h.jsxs("div",{className:"flex items-center mb-4",children:[h.jsx(jb,{className:"h-14 w-14 border-2 border-yellow-500",children:h.jsx(Ub,{className:"bg-yellow-500 text-white text-xl",children:n.avatarFallback})}),h.jsxs("div",{className:"ml-4",children:[h.jsx("h4",{className:"font-semibold text-lg text-gray-800",children:n.name}),h.jsx("p",{className:"text-sm text-gray-500",children:n.location})]})]}),h.jsxs("div",{className:"flex mb-3",children:[[...Array(n.rating)].map((o,c)=>h.jsx(oo,{className:"h-5 w-5 text-yellow-500",fill:"currentColor"},c)),[...Array(5-n.rating)].map((o,c)=>h.jsx(oo,{className:"h-5 w-5 text-gray-300"},c+n.rating))]}),h.jsx("h5",{className:"font-semibold text-md text-gray-700 mb-2",children:n.title}),h.jsx("p",{className:"text-gray-600 leading-relaxed",children:n.text}),h.jsxs("div",{className:"flex items-center mt-4 space-x-4 text-sm text-gray-500",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(FEe,{className:"h-4 w-4 mr-1 text-green-500"})," Helpful"]}),h.jsxs("div",{className:"flex items-center",children:[h.jsx(dp,{className:"h-4 w-4 mr-1 text-blue-500"})," Reply"]})]})]})})},i))})]})});function VD(n){const i=Uwe(n),o=X.forwardRef((c,d)=>{const{children:f,..._}=c,v=X.Children.toArray(f),x=v.find(Vwe);if(x){const T=x.props.children,w=v.map(R=>R===x?X.Children.count(T)>1?X.Children.only(null):X.isValidElement(T)?T.props.children:null:R);return h.jsx(i,{..._,ref:d,children:X.isValidElement(T)?X.cloneElement(T,void 0,w):null})}return h.jsx(i,{..._,ref:d,children:f})});return o.displayName=`${n}.Slot`,o}function Uwe(n){const i=X.forwardRef((o,c)=>{const{children:d,...f}=o;if(X.isValidElement(d)){const _=Wwe(d),v=Bwe(f,d.props);return d.type!==X.Fragment&&(v.ref=c?nk(c,_):_),X.cloneElement(d,v)}return X.Children.count(d)>1?X.Children.only(null):null});return i.displayName=`${n}.SlotClone`,i}var Fwe=Symbol("radix.slottable");function Vwe(n){return X.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===Fwe}function Bwe(n,i){const o={...i};for(const c in i){const d=n[c],f=i[c];/^on[A-Z]/.test(c)?d&&f?o[c]=(...v)=>{const x=f(...v);return d(...v),x}:d&&(o[c]=d):c==="style"?o[c]={...d,...f}:c==="className"&&(o[c]=[d,f].filter(Boolean).join(" "))}return{...n,...o}}function Wwe(n){var c,d;let i=(c=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:c.get,o=i&&"isReactWarning"in i&&i.isReactWarning;return o?n.ref:(i=(d=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:d.get,o=i&&"isReactWarning"in i&&i.isReactWarning,o?n.props.ref:n.props.ref||n.ref)}function Hwe(n){const i=n+"CollectionProvider",[o,c]=Sp(i),[d,f]=o(i,{collectionRef:{current:null},itemMap:new Map}),_=k=>{const{scope:W,children:H}=k,L=wt.useRef(null),V=wt.useRef(new Map).current;return h.jsx(d,{scope:W,itemMap:V,collectionRef:L,children:H})};_.displayName=i;const v=n+"CollectionSlot",x=VD(v),T=wt.forwardRef((k,W)=>{const{scope:H,children:L}=k,V=f(v,H),K=Ks(W,V.collectionRef);return h.jsx(x,{ref:K,children:L})});T.displayName=v;const w=n+"CollectionItemSlot",R="data-radix-collection-item",I=VD(w),j=wt.forwardRef((k,W)=>{const{scope:H,children:L,...V}=k,K=wt.useRef(null),te=Ks(W,K),ie=f(w,H);return wt.useEffect(()=>(ie.itemMap.set(K,{ref:K,...V}),()=>void ie.itemMap.delete(K))),h.jsx(I,{[R]:"",ref:te,children:L})});j.displayName=w;function P(k){const W=f(n+"CollectionConsumer",k);return wt.useCallback(()=>{const L=W.collectionRef.current;if(!L)return[];const V=Array.from(L.querySelectorAll(`[${R}]`));return Array.from(W.itemMap.values()).sort((ie,A)=>V.indexOf(ie.ref.current)-V.indexOf(A.ref.current))},[W.collectionRef,W.itemMap])}return[{Provider:_,Slot:T,ItemSlot:j},P,c]}var Gwe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],WX=Gwe.reduce((n,i)=>{const o=VD(`Primitive.${i}`),c=X.forwardRef((d,f)=>{const{asChild:_,...v}=d,x=_?o:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(x,{...v,ref:f})});return c.displayName=`Primitive.${i}`,{...n,[i]:c}},{});function zwe(n){const i=Kwe(n),o=X.forwardRef((c,d)=>{const{children:f,..._}=c,v=X.Children.toArray(f),x=v.find(Ywe);if(x){const T=x.props.children,w=v.map(R=>R===x?X.Children.count(T)>1?X.Children.only(null):X.isValidElement(T)?T.props.children:null:R);return h.jsx(i,{..._,ref:d,children:X.isValidElement(T)?X.cloneElement(T,void 0,w):null})}return h.jsx(i,{..._,ref:d,children:f})});return o.displayName=`${n}.Slot`,o}function Kwe(n){const i=X.forwardRef((o,c)=>{const{children:d,...f}=o;if(X.isValidElement(d)){const _=Xwe(d),v=$we(f,d.props);return d.type!==X.Fragment&&(v.ref=c?nk(c,_):_),X.cloneElement(d,v)}return X.Children.count(d)>1?X.Children.only(null):null});return i.displayName=`${n}.SlotClone`,i}var qwe=Symbol("radix.slottable");function Ywe(n){return X.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===qwe}function $we(n,i){const o={...i};for(const c in i){const d=n[c],f=i[c];/^on[A-Z]/.test(c)?d&&f?o[c]=(...v)=>{const x=f(...v);return d(...v),x}:d&&(o[c]=d):c==="style"?o[c]={...d,...f}:c==="className"&&(o[c]=[d,f].filter(Boolean).join(" "))}return{...n,...o}}function Xwe(n){var c,d;let i=(c=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:c.get,o=i&&"isReactWarning"in i&&i.isReactWarning;return o?n.ref:(i=(d=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:d.get,o=i&&"isReactWarning"in i&&i.isReactWarning,o?n.props.ref:n.props.ref||n.ref)}var Jwe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$k=Jwe.reduce((n,i)=>{const o=zwe(`Primitive.${i}`),c=X.forwardRef((d,f)=>{const{asChild:_,...v}=d,x=_?o:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(x,{...v,ref:f})});return c.displayName=`Primitive.${i}`,{...n,[i]:c}},{}),Qwe=cP[" useId ".trim().toString()]||(()=>{}),Zwe=0;function M_(n){const[i,o]=X.useState(Qwe());return xl(()=>{n||o(c=>c??String(Zwe++))},[n]),n||(i?`radix-${i}`:"")}var Fb="Collapsible",[eCe,HX]=Sp(Fb),[tCe,Xk]=eCe(Fb),GX=X.forwardRef((n,i)=>{const{__scopeCollapsible:o,open:c,defaultOpen:d,disabled:f,onOpenChange:_,...v}=n,[x,T]=yE({prop:c,defaultProp:d??!1,onChange:_,caller:Fb});return h.jsx(tCe,{scope:o,disabled:f,contentId:M_(),open:x,onOpenToggle:X.useCallback(()=>T(w=>!w),[T]),children:h.jsx($k.div,{"data-state":Qk(x),"data-disabled":f?"":void 0,...v,ref:i})})});GX.displayName=Fb;var zX="CollapsibleTrigger",KX=X.forwardRef((n,i)=>{const{__scopeCollapsible:o,...c}=n,d=Xk(zX,o);return h.jsx($k.button,{type:"button","aria-controls":d.contentId,"aria-expanded":d.open||!1,"data-state":Qk(d.open),"data-disabled":d.disabled?"":void 0,disabled:d.disabled,...c,ref:i,onClick:Vi(n.onClick,d.onOpenToggle)})});KX.displayName=zX;var Jk="CollapsibleContent",qX=X.forwardRef((n,i)=>{const{forceMount:o,...c}=n,d=Xk(Jk,n.__scopeCollapsible);return h.jsx(t0,{present:o||d.open,children:({present:f})=>h.jsx(nCe,{...c,ref:i,present:f})})});qX.displayName=Jk;var nCe=X.forwardRef((n,i)=>{const{__scopeCollapsible:o,present:c,children:d,...f}=n,_=Xk(Jk,o),[v,x]=X.useState(c),T=X.useRef(null),w=Ks(i,T),R=X.useRef(0),I=R.current,j=X.useRef(0),P=j.current,k=_.open||v,W=X.useRef(k),H=X.useRef(void 0);return X.useEffect(()=>{const L=requestAnimationFrame(()=>W.current=!1);return()=>cancelAnimationFrame(L)},[]),xl(()=>{const L=T.current;if(L){H.current=H.current||{transitionDuration:L.style.transitionDuration,animationName:L.style.animationName},L.style.transitionDuration="0s",L.style.animationName="none";const V=L.getBoundingClientRect();R.current=V.height,j.current=V.width,W.current||(L.style.transitionDuration=H.current.transitionDuration,L.style.animationName=H.current.animationName),x(c)}},[_.open,c]),h.jsx($k.div,{"data-state":Qk(_.open),"data-disabled":_.disabled?"":void 0,id:_.contentId,hidden:!k,...f,ref:w,style:{"--radix-collapsible-content-height":I?`${I}px`:void 0,"--radix-collapsible-content-width":P?`${P}px`:void 0,...n.style},children:k&&d})});function Qk(n){return n?"open":"closed"}var rCe=GX,iCe=KX,sCe=qX,oCe=X.createContext(void 0);function aCe(n){const i=X.useContext(oCe);return n||i||"ltr"}var Pc="Accordion",cCe=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Zk,lCe,dCe]=Hwe(Pc),[Vb,eOe]=Sp(Pc,[dCe,HX]),e2=HX(),YX=wt.forwardRef((n,i)=>{const{type:o,...c}=n,d=c,f=c;return h.jsx(Zk.Provider,{scope:n.__scopeAccordion,children:o==="multiple"?h.jsx(fCe,{...f,ref:i}):h.jsx(pCe,{...d,ref:i})})});YX.displayName=Pc;var[$X,uCe]=Vb(Pc),[XX,hCe]=Vb(Pc,{collapsible:!1}),pCe=wt.forwardRef((n,i)=>{const{value:o,defaultValue:c,onValueChange:d=()=>{},collapsible:f=!1,..._}=n,[v,x]=yE({prop:o,defaultProp:c??"",onChange:d,caller:Pc});return h.jsx($X,{scope:n.__scopeAccordion,value:wt.useMemo(()=>v?[v]:[],[v]),onItemOpen:x,onItemClose:wt.useCallback(()=>f&&x(""),[f,x]),children:h.jsx(XX,{scope:n.__scopeAccordion,collapsible:f,children:h.jsx(JX,{..._,ref:i})})})}),fCe=wt.forwardRef((n,i)=>{const{value:o,defaultValue:c,onValueChange:d=()=>{},...f}=n,[_,v]=yE({prop:o,defaultProp:c??[],onChange:d,caller:Pc}),x=wt.useCallback(w=>v((R=[])=>[...R,w]),[v]),T=wt.useCallback(w=>v((R=[])=>R.filter(I=>I!==w)),[v]);return h.jsx($X,{scope:n.__scopeAccordion,value:_,onItemOpen:x,onItemClose:T,children:h.jsx(XX,{scope:n.__scopeAccordion,collapsible:!0,children:h.jsx(JX,{...f,ref:i})})})}),[mCe,Bb]=Vb(Pc),JX=wt.forwardRef((n,i)=>{const{__scopeAccordion:o,disabled:c,dir:d,orientation:f="vertical",..._}=n,v=wt.useRef(null),x=Ks(v,i),T=lCe(o),R=aCe(d)==="ltr",I=Vi(n.onKeyDown,j=>{var de;if(!cCe.includes(j.key))return;const P=j.target,k=T().filter(ue=>{var oe;return!((oe=ue.ref.current)!=null&&oe.disabled)}),W=k.findIndex(ue=>ue.ref.current===P),H=k.length;if(W===-1)return;j.preventDefault();let L=W;const V=0,K=H-1,te=()=>{L=W+1,L>K&&(L=V)},ie=()=>{L=W-1,L<V&&(L=K)};switch(j.key){case"Home":L=V;break;case"End":L=K;break;case"ArrowRight":f==="horizontal"&&(R?te():ie());break;case"ArrowDown":f==="vertical"&&te();break;case"ArrowLeft":f==="horizontal"&&(R?ie():te());break;case"ArrowUp":f==="vertical"&&ie();break}const A=L%H;(de=k[A].ref.current)==null||de.focus()});return h.jsx(mCe,{scope:o,disabled:c,direction:d,orientation:f,children:h.jsx(Zk.Slot,{scope:o,children:h.jsx(WX.div,{..._,"data-orientation":f,ref:x,onKeyDown:c?void 0:I})})})}),FT="AccordionItem",[gCe,t2]=Vb(FT),QX=wt.forwardRef((n,i)=>{const{__scopeAccordion:o,value:c,...d}=n,f=Bb(FT,o),_=uCe(FT,o),v=e2(o),x=M_(),T=c&&_.value.includes(c)||!1,w=f.disabled||n.disabled;return h.jsx(gCe,{scope:o,open:T,disabled:w,triggerId:x,children:h.jsx(rCe,{"data-orientation":f.orientation,"data-state":iJ(T),...v,...d,ref:i,disabled:w,open:T,onOpenChange:R=>{R?_.onItemOpen(c):_.onItemClose(c)}})})});QX.displayName=FT;var ZX="AccordionHeader",eJ=wt.forwardRef((n,i)=>{const{__scopeAccordion:o,...c}=n,d=Bb(Pc,o),f=t2(ZX,o);return h.jsx(WX.h3,{"data-orientation":d.orientation,"data-state":iJ(f.open),"data-disabled":f.disabled?"":void 0,...c,ref:i})});eJ.displayName=ZX;var BD="AccordionTrigger",tJ=wt.forwardRef((n,i)=>{const{__scopeAccordion:o,...c}=n,d=Bb(Pc,o),f=t2(BD,o),_=hCe(BD,o),v=e2(o);return h.jsx(Zk.ItemSlot,{scope:o,children:h.jsx(iCe,{"aria-disabled":f.open&&!_.collapsible||void 0,"data-orientation":d.orientation,id:f.triggerId,...v,...c,ref:i})})});tJ.displayName=BD;var nJ="AccordionContent",rJ=wt.forwardRef((n,i)=>{const{__scopeAccordion:o,...c}=n,d=Bb(Pc,o),f=t2(nJ,o),_=e2(o);return h.jsx(sCe,{role:"region","aria-labelledby":f.triggerId,"data-orientation":d.orientation,..._,...c,ref:i,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});rJ.displayName=nJ;function iJ(n){return n?"open":"closed"}var _Ce=YX,ECe=QX,vCe=eJ,sJ=tJ,oJ=rJ;const yCe=_Ce,aJ=wt.forwardRef(({className:n,...i},o)=>h.jsx(ECe,{ref:o,className:Ir("border-b",n),...i}));aJ.displayName="AccordionItem";const cJ=wt.forwardRef(({className:n,children:i,...o},c)=>h.jsx(vCe,{className:"flex",children:h.jsxs(sJ,{ref:c,className:Ir("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",n),...o,children:[i,h.jsx(ED,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));cJ.displayName=sJ.displayName;const lJ=wt.forwardRef(({className:n,children:i,...o},c)=>h.jsx(oJ,{ref:c,className:Ir("overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",n),...o,children:h.jsx("div",{className:"pb-4 pt-0",children:i})}));lJ.displayName=oJ.displayName;const SCe=[{question:"How does online astrology consultation work?",answer:"Our online astrology consultation connects you with expert astrologers via call or chat. You can discuss your concerns, share your birth details, and receive personalized guidance based on your astrological chart."},{question:"What information do I need to provide for an accurate reading?",answer:"For the most accurate reading, you should provide your date of birth, time of birth, and place of birth. This information helps the astrologer create your precise birth chart for analysis."},{question:"How long does a typical consultation last?",answer:"A typical consultation lasts between 15 to 30 minutes, depending on the complexity of your questions and the package you choose. You can always extend the session if needed."},{question:"Are the consultations confidential?",answer:"Absolutely. We maintain strict confidentiality for all consultations. Your personal information and the details discussed during the session remain private and secure."},{question:"Can astrology really predict my future?",answer:"Astrology provides insights into potential future trends based on planetary positions and their influence on your birth chart. While it can indicate possibilities and tendencies, remember that you always have free will to make choices."},{question:"What if I'm not satisfied with my consultation?",answer:"We have a satisfaction guarantee policy. If you're not satisfied with your consultation, please contact our customer support within 24 hours, and we'll arrange another session with a different astrologer or provide a refund."}],xCe=()=>h.jsx("section",{className:"py-16 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Most Trusted ",h.jsx("span",{className:"text-yellow-600",children:"Astrology Platform"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Find answers to common questions about our astrology services. Your peace of mind is our priority."})]}),h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},viewport:{once:!0},className:"max-w-3xl mx-auto",children:h.jsx(yCe,{type:"single",collapsible:!0,className:"w-full",children:SCe.map((n,i)=>h.jsxs(aJ,{value:`item-${i}`,className:"border-b border-yellow-200",children:[h.jsx(cJ,{className:"text-left font-medium text-lg hover:text-yellow-600 text-gray-800",children:n.question}),h.jsx(lJ,{className:"text-gray-600 pt-2 pb-4",children:n.answer})]},i))})})]})}),TCe=[{title:"Understanding Your Moon Sign and Its Impact on Emotions",excerpt:"Discover how your moon sign influences your emotional responses and inner self.",category:"Astrology Basics",date:"May 25, 2025"},{title:"Mercury Retrograde: Myths and Reality",excerpt:"Learn what Mercury retrograde really means and how to navigate this astrological period.",category:"Planetary Movements",date:"May 18, 2025"},{title:"Compatibility Beyond Sun Signs: The Full Astrological Picture",excerpt:"Why sun sign compatibility is just the beginning of understanding relationship dynamics.",category:"Relationships",date:"May 10, 2025"}],dJ=()=>h.jsx("section",{id:"blog",className:"py-16 bg-gray-50 common-margin-top",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Latest from our ",h.jsx("span",{className:"cosmic-text",children:"Blog"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Insights, guides, and astrological wisdom to enhance your spiritual journey"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:TCe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"bg-white rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:[h.jsxs("div",{className:"relative h-48",children:[h.jsx("img",{alt:n.title,className:"w-full h-full object-cover",src:"https://images.unsplash.com/photo-1685478237361-a5b50d0eb76b"}),h.jsx("div",{className:"absolute top-3 left-3",children:h.jsx(np,{variant:"cosmic",children:n.category})})]}),h.jsxs("div",{className:"p-6",children:[h.jsx("p",{className:"text-sm text-gray-500 mb-2",children:n.date}),h.jsx("h3",{className:"font-bold text-xl mb-2",children:n.title}),h.jsx("p",{className:"text-gray-600 mb-4",children:n.excerpt}),h.jsxs(vt,{variant:"ghost",className:"text-primary hover:text-primary/80 p-0 flex items-center",children:["Read More ",h.jsx(lk,{className:"ml-2 h-4 w-4"})]})]})]},i))}),h.jsx("div",{className:"text-center mt-10",children:h.jsx(vt,{size:"lg",className:"cosmic-gradient",children:"View All Articles"})})]})}),bCe=()=>h.jsx("section",{className:"py-16 cosmic-gradient text-white",children:h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"text-center max-w-3xl mx-auto",children:[h.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Ready to Discover Your Cosmic Path?"}),h.jsx("p",{className:"text-xl mb-8 text-white/90",children:"Connect with our expert astrologers now and get answers to life's most pressing questions."}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[h.jsxs(vt,{size:"lg",className:"bg-white text-primary hover:bg-white/90",children:[h.jsx(ST,{className:"mr-2 h-5 w-5"})," Talk to Astrologer"]}),h.jsxs(vt,{size:"lg",variant:"outline",className:"border-white text-primary hover:bg-white/10",children:[h.jsx(vb,{className:"mr-2 h-5 w-5"})," Chat Consultation"]})]}),h.jsx("p",{className:"mt-6 text-white/80",children:"First-time users get 5 minutes free consultation!"})]})})}),wCe=[{name:"Aries",icon:"",date:"Mar 21 - Apr 19"},{name:"Taurus",icon:"",date:"Apr 20 - May 20"},{name:"Gemini",icon:"",date:"May 21 - Jun 20"},{name:"Cancer",icon:"",date:"Jun 21 - Jul 22"},{name:"Leo",icon:"",date:"Jul 23 - Aug 22"},{name:"Virgo",icon:"",date:"Aug 23 - Sep 22"},{name:"Libra",icon:"",date:"Sep 23 - Oct 22"},{name:"Scorpio",icon:"",date:"Oct 23 - Nov 21"},{name:"Sagittarius",icon:"",date:"Nov 22 - Dec 21"},{name:"Capricorn",icon:"",date:"Dec 22 - Jan 19"},{name:"Aquarius",icon:"",date:"Jan 20 - Feb 18"},{name:"Pisces",icon:"",date:"Feb 19 - Mar 20"}],CCe=()=>h.jsx("section",{className:"py-16 bg-gradient-to-b from-yellow-50 via-yellow-100 to-background",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Choose Your ",h.jsx("span",{className:"text-yellow-600",children:"Zodiac Sign"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Select your zodiac sign to get personalized insights and daily horoscopes."})]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6",children:wCe.map((n,i)=>h.jsx(Dt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,delay:i*.05},className:"zodiac-card",children:h.jsx(ur,{className:"text-center p-4 bg-white shadow-lg hover:shadow-yellow-500/30 border-yellow-400 border-2",children:h.jsxs(vr,{className:"flex flex-col items-center justify-center",children:[h.jsx("div",{className:"text-6xl mb-3",children:n.icon}),h.jsx("h3",{className:"text-xl font-semibold text-yellow-700",children:n.name}),h.jsx("p",{className:"text-xs text-gray-500",children:n.date}),h.jsxs(vt,{variant:"ghost",size:"sm",className:"mt-3 text-yellow-600 hover:bg-yellow-100",children:["View Details ",h.jsx(lk,{className:"ml-1 h-4 w-4"})]})]})})},n.name))})]})}),RCe=[{name:"The Cosmic Times",alt:"The Cosmic Times logo - a stylized star within a circle"},{name:"Astro Today",alt:"Astro Today logo - elegant script font with a crescent moon"},{name:"Stellar Insights Magazine",alt:"Stellar Insights Magazine logo - a telescope pointing towards a galaxy"},{name:"Celestial Chronicle",alt:"Celestial Chronicle logo - an open book with constellations"},{name:"Galaxy Gazette",alt:"Galaxy Gazette logo - a swirling galaxy icon"},{name:"Zodiac Weekly",alt:"Zodiac Weekly logo - all 12 zodiac symbols arranged in a circle"}],ACe=()=>h.jsx("section",{className:"py-16 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Astro Truth ",h.jsx("span",{className:"text-yellow-600",children:"In News"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Recognized by leading publications for our trusted astrological services."})]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-8 items-center",children:RCe.map((n,i)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},className:"flex justify-center",children:h.jsx("img",{className:"h-12 md:h-40 news-logo",alt:n.alt,src:"https://images.unsplash.com/photo-1485531865381-286666aa80a9"})},i))})]})}),NCe=[{icon:h.jsx(fk,{className:"h-10 w-10 text-yellow-500"}),title:"Verified Astrologers",description:"Connect with genuine, highly experienced, and rigorously vetted astrologers."},{icon:h.jsx(cd,{className:"h-10 w-10 text-yellow-500"}),title:"Top Astrologers",description:"Access a wide network of India's best astrologers, available at your fingertips."},{icon:h.jsx(SEe,{className:"h-10 w-10 text-yellow-500"}),title:"24x7 Customer Support",description:"Our dedicated support team is always ready to assist you with any queries."},{icon:h.jsx(jEe,{className:"h-10 w-10 text-yellow-500"}),title:"Happy to Help",description:"Your satisfaction is our priority. We strive to provide a positive and insightful experience."}],ICe=()=>h.jsx("section",{className:"py-16 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our ",h.jsx("span",{className:"text-yellow-600",children:"Promise"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"We are committed to providing you with the best astrological guidance and support."})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:NCe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"text-center p-6 bg-yellow-50 rounded-xl shadow-md hover:shadow-lg transition-shadow border border-yellow-200",children:[h.jsx("div",{className:"flex justify-center mb-4",children:n.icon}),h.jsx("h3",{className:"text-xl font-semibold mb-2 text-yellow-700",children:n.title}),h.jsx("p",{className:"text-gray-600",children:n.description})]},i))})]})}),OCe=[{icon:h.jsx(_Y,{className:"h-8 w-8 text-yellow-600"}),title:"Expert Guidance",description:"Receive insights from seasoned astrologers with years of experience."},{icon:h.jsx(Eb,{className:"h-8 w-8 text-yellow-600"}),title:"Personalized Readings",description:"Get detailed predictions and advice tailored to your unique birth chart."},{icon:h.jsx(uk,{className:"h-8 w-8 text-yellow-600"}),title:"Relationship Clarity",description:"Understand your love life, compatibility, and future with your partner."},{icon:h.jsx(TT,{className:"h-8 w-8 text-yellow-600"}),title:"Career & Finance Solutions",description:"Navigate your professional path and financial decisions with confidence."},{icon:h.jsx(vb,{className:"h-8 w-8 text-yellow-600"}),title:"Instant & Confidential",description:"Connect instantly and discuss your concerns in a private, secure environment."}],DCe=()=>h.jsx("section",{className:"py-16 bg-yellow-50",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Why Talk To Our ",h.jsx("span",{className:"text-yellow-600",children:"Astrologers?"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Discover the benefits of connecting with our trusted astrology experts."})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:OCe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow border border-gray-100",children:[h.jsxs("div",{className:"flex items-center mb-4",children:[h.jsx("div",{className:"p-3 bg-yellow-100 rounded-full mr-4",children:n.icon}),h.jsx("h3",{className:"text-xl font-semibold text-yellow-700",children:n.title})]}),h.jsx("p",{className:"text-gray-600",children:n.description})]},i))})]})}),PCe=()=>h.jsx("section",{className:"py-16 bg-gradient-to-r from-yellow-100 via-yellow-100 to-yellow-100 ",children:h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 text-center",children:h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[h.jsx("h2",{className:"text-3xl main-title-color md:text-4xl font-bold mb-6",children:"Connect With Astrologers Instantly"}),h.jsx("p",{className:"text-lg md:text-xl mb-10 max-w-2xl mx-auto color-black",children:"Choose your preferred way to connect and get immediate astrological guidance."}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:[h.jsxs(Dt.div,{whileHover:{scale:1.05},className:"bg-white/20 backdrop-blur-md p-8 rounded-xl shadow-xl hover:bg-white/30 transition-all",children:[h.jsx(Iu,{className:"h-12 w-12 mx-auto mb-4 color-black "}),h.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Call Astrologer"}),h.jsx("p",{className:"color-black /80 mb-6",children:"Speak directly with an astrologer for a personalized voice consultation."}),h.jsx(vt,{size:"lg",className:"bg-white text-yellow-600 hover:bg-gray-100 w-full font-semibold",children:"Start Call"})]}),h.jsxs(Dt.div,{whileHover:{scale:1.05},className:"bg-white/20 backdrop-blur-md p-8 rounded-xl shadow-xl hover:bg-white/30 transition-all",children:[h.jsx(dp,{className:"h-12 w-12 mx-auto mb-4 color-black "}),h.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Chat with Astrologer"}),h.jsx("p",{className:"color-black /80 mb-6",children:"Get your questions answered through a live chat session with an expert."}),h.jsx(vt,{size:"lg",className:"bg-white text-yellow-600 hover:bg-gray-100 w-full font-semibold",children:"Start Chat"})]}),h.jsxs(Dt.div,{whileHover:{scale:1.05},className:"bg-white/20 backdrop-blur-md p-8 rounded-xl shadow-xl hover:bg-white/30 transition-all",children:[h.jsx(bT,{className:"h-12 w-12 mx-auto mb-4 color-black"}),h.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Video Call (Coming Soon)"}),h.jsx("p",{className:"color-black mb-6",children:"Connect face-to-face with astrologers for an immersive experience."}),h.jsx(vt,{size:"lg",className:"bg-white/50 text-yellow-700 w-full font-semibold cursor-not-allowed",disabled:!0,children:"Notify Me"})]})]})]})})}),kCe=()=>h.jsx("section",{className:"py-16 bg-white",children:h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[h.jsx(Dt.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.6},children:h.jsx("img",{alt:"Stylized image representing astrology concepts like planets, zodiac signs, and constellations.",className:"rounded-xl shadow-2xl w-full h-auto object-cover",src:"https://images.unsplash.com/photo-1685478237361-a5b50d0eb76b"})}),h.jsxs(Dt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},children:[h.jsx("span",{className:"inline-block px-3 py-1 text-sm font-semibold text-yellow-700 bg-yellow-100 rounded-full mb-3",children:"Unlock Cosmic Wisdom"}),h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-6 text-gray-800",children:["Understanding ",h.jsx("span",{className:"text-yellow-600",children:"Astrology"})]}),h.jsx("p",{className:"text-lg text-gray-600 mb-4 leading-relaxed",children:"Astrology is an ancient art and science that studies the movements and relative positions of celestial objects as a means for divining information about human affairs and terrestrial events. It offers profound insights into your personality, relationships, career, and life path."}),h.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Our expert astrologers use these cosmic patterns to provide guidance, helping you make informed decisions and navigate life's challenges with greater clarity and confidence."}),h.jsxs(vt,{size:"lg",className:"bg-yellow-500 hover:bg-yellow-600 text-white font-semibold",children:["Learn More About Astrology ",h.jsx(Eb,{className:"ml-2 h-5 w-5"})]})]})]})})}),LCe=[{icon:h.jsx(vEe,{className:"h-10 w-10 text-yellow-500"}),title:"Gemstone Therapy",description:"Harness the power of specific gemstones to balance energies and attract positivity.",color:"bg-pink-100",textColor:"text-pink-600"},{icon:h.jsx(wEe,{className:"h-10 w-10 text-yellow-500"}),title:"Herbal Remedies",description:"Utilize traditional herbs and natural solutions to improve well-being and harmony.",color:"bg-green-100",textColor:"text-green-600"},{icon:h.jsx(bY,{className:"h-10 w-10 text-yellow-500"}),title:"Planetary Poojas",description:"Perform specific rituals and poojas to appease planetary influences and gain blessings.",color:"bg-orange-100",textColor:"text-orange-600"},{icon:h.jsx(AEe,{className:"h-10 w-10 text-yellow-500"}),title:"Mantra Chanting",description:"Recite powerful mantras to create positive vibrations and overcome obstacles.",color:"bg-blue-100",textColor:"text-blue-600"}],MCe=()=>h.jsx("section",{className:"py-16 bg-yellow-50",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Astrological Remedies for a ",h.jsx("span",{className:"text-yellow-600",children:"Better Life"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Discover effective astrological solutions to enhance your life, overcome challenges, and attract prosperity."})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:LCe.map((n,i)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},children:h.jsxs(ur,{className:`shadow-lg hover:shadow-xl transition-shadow border-t-4 ${n.textColor.replace("text-","border-")}`,children:[h.jsxs(qr,{children:[h.jsx("div",{className:`p-3 rounded-full inline-block mb-4 ${n.color}`,children:wt.cloneElement(n.icon,{className:`h-10 w-10 ${n.textColor}`})}),h.jsx(ni,{className:`text-xl font-semibold ${n.textColor}`,children:n.title})]}),h.jsx(vr,{children:h.jsx("p",{className:"text-gray-600",children:n.description})})]})},i))})]})}),jCe=[{name:"Aarav Sharma",profession:"Film Actor",reviewText:"AstroTruth's guidance has been invaluable for my career choices. Their astrologers are truly insightful!",avatarFallback:"AS",videoThumbnailAlt:"Video thumbnail of Aarav Sharma giving a testimonial"},{name:"Priya Singh",profession:"Playback Singer",reviewText:"Whenever I face a dilemma, I turn to AstroTruth. Their predictions are accurate and advice practical.",avatarFallback:"PS",videoThumbnailAlt:"Video thumbnail of Priya Singh sharing her experience"},{name:"Rohan Kapoor",profession:"TV Personality",reviewText:"The Vastu consultation for my new home was excellent. I feel a positive shift in energy already!",avatarFallback:"RK",videoThumbnailAlt:"Video thumbnail of Rohan Kapoor discussing Vastu consultation"}],UCe=()=>h.jsx("section",{className:"py-16 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our ",h.jsx("span",{className:"text-yellow-600",children:"Celebrity Customers"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Hear from renowned personalities who trust AstroTruth for astrological guidance."})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:jCe.map((n,i)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},children:h.jsxs(ur,{className:"overflow-hidden shadow-lg hover:shadow-xl transition-shadow border border-yellow-200",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{className:"w-full h-56 object-cover",alt:n.videoThumbnailAlt,src:"https://images.unsplash.com/photo-1495488170890-ee9e49ff335d"}),h.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:h.jsx(xT,{className:"h-16 w-16 text-white/80 hover:text-white cursor-pointer transition-colors"})})]}),h.jsxs(vr,{className:"p-6",children:[h.jsxs("div",{className:"flex items-center mb-3",children:[h.jsx(jb,{className:"h-12 w-12 mr-3 border-2 border-yellow-500",children:h.jsx(Ub,{className:"bg-yellow-500 text-white",children:n.avatarFallback})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-yellow-700",children:n.name}),h.jsx("p",{className:"text-sm text-gray-500",children:n.profession})]})]}),h.jsxs("p",{className:"text-gray-600 text-sm italic",children:['"',n.reviewText,'"']}),h.jsxs("div",{className:"flex items-center mt-4 text-xs text-green-600",children:[h.jsx(BEe,{className:"h-4 w-4 mr-1"})," Verified Customer"]})]})]})},i))})]})}),FCe=[{icon:h.jsx(fEe,{className:"h-8 w-8 text-yellow-500"}),title:"Accurate Predictions",description:"Leverage ancient wisdom and modern techniques for precise astrological insights."},{icon:h.jsx(TT,{className:"h-8 w-8 text-yellow-500"}),title:"Future Clarity",description:"Gain a clearer understanding of your future path in career, love, and life."},{icon:h.jsx(cd,{className:"h-8 w-8 text-yellow-500"}),title:"Expert Astrologers",description:"Consult with a panel of highly experienced and verified astrologers."},{icon:h.jsx(TY,{className:"h-8 w-8 text-yellow-500"}),title:"Confidential & Secure",description:"Your consultations and personal data are always kept private and secure."}],VCe=()=>h.jsx("section",{className:"py-16 bg-gradient-to-b from-yellow-100 via-yellow-50 to-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Astrological Services for Accurate Answers & ",h.jsx("span",{className:"text-yellow-600",children:"Better Future"})]}),h.jsx("p",{className:"text-lg text-gray-700 max-w-3xl mx-auto",children:"Our comprehensive astrological services are designed to provide you with the clarity and guidance needed to make informed decisions and shape a brighter tomorrow."})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:FCe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"bg-white p-6 rounded-xl shadow-lg hover:shadow-yellow-400/30 transition-shadow border border-yellow-200 flex flex-col items-center text-center",children:[h.jsx("div",{className:"p-4 bg-yellow-100 rounded-full mb-4",children:n.icon}),h.jsx("h3",{className:"text-xl font-semibold mb-2 text-yellow-700",children:n.title}),h.jsx("p",{className:"text-gray-600 text-sm",children:n.description})]},i))})]})}),JH=[{id:1,title:"Understanding Your Sun Sign",astrologer:"Dr. Ananya Sharma",duration:"12:35",views:"10.2K",thumbnail:"video_thumb_1",category:"Zodiac Basics"},{id:2,title:"Impact of Saturn Transit",astrologer:"Pt. Rajesh Tripathi",duration:"15:50",views:"8.5K",thumbnail:"video_thumb_2",category:"Planetary Transits"},{id:3,title:"Introduction to Tarot Reading",astrologer:"Ms. Priya Kaur",duration:"10:12",views:"12.1K",thumbnail:"video_thumb_3",category:"Tarot"},{id:4,title:"Vastu Tips for Home Prosperity",astrologer:"Shri. Vikram Singh",duration:"18:20",views:"7.9K",thumbnail:"video_thumb_4",category:"Vastu Shastra"},{id:5,title:"Numerology and Your Life Path",astrologer:"Mystic Meera",duration:"14:00",views:"9.3K",thumbnail:"video_thumb_5",category:"Numerology"},{id:6,title:"Gemstones for Career Success",astrologer:"Guru Gyanesh",duration:"11:45",views:"6.5K",thumbnail:"video_thumb_6",category:"Gemology"}],BCe=({video:n,delay:i})=>h.jsx(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:i},children:h.jsxs(ur,{className:"shadow-lg hover:shadow-xl transition-shadow duration-300 rounded-xl overflow-hidden border border-yellow-200 bg-white",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{alt:`Thumbnail for ${n.title}`,class:"w-full h-48 object-cover",src:"https://images.unsplash.com/photo-1516280440614-37939bb91594"}),h.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center",children:h.jsx(xT,{className:"w-16 h-16 text-white opacity-80 hover:opacity-100 cursor-pointer"})}),h.jsx("span",{className:"absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded",children:n.duration})]}),h.jsx(qr,{className:"pb-2 pt-4",children:h.jsx(ni,{className:"text-md font-semibold text-yellow-700 leading-tight h-12 overflow-hidden",children:n.title})}),h.jsxs(vr,{className:"pb-3 text-xs",children:[h.jsxs("p",{className:"text-gray-600 mb-1",children:["By: ",n.astrologer]}),h.jsxs("p",{className:"text-gray-500",children:[n.views," views  Category: ",n.category]})]}),h.jsx(r0,{className:"p-3 pt-0",children:h.jsx(vt,{variant:"link",className:"text-yellow-600 p-0 hover:text-yellow-700 text-sm",children:"Watch Now "})})]})}),WCe=()=>h.jsx("div",{className:"min-h-screen p-4 md:p-8 bg-yellow-50",children:h.jsxs(Dt.div,{className:"container mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[h.jsx(ur,{className:"shadow-2xl rounded-xl overflow-hidden mb-8 border-2 border-yellow-400",children:h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-yellow-400 via-amber-400 to-orange-300",children:[h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg mb-4",children:h.jsx(xT,{className:"h-16 w-16 text-yellow-600"})}),h.jsx(ni,{className:"text-4xl font-bold text-gray-800",children:"Astro Videos"}),h.jsx(qs,{className:"text-lg text-gray-700 mt-2",children:"Explore insightful videos from our expert astrologers."})]})}),h.jsx(ur,{className:"mb-8 p-4 bg-white rounded-lg shadow",children:h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[h.jsxs("div",{className:"relative flex-grow w-full sm:w-auto",children:[h.jsx(Vt,{type:"search",placeholder:"Search videos...",className:"pl-10 focus:ring-yellow-500 focus:border-yellow-500"}),h.jsx(PEe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"})]}),h.jsxs(vt,{variant:"outline",className:"border-yellow-500 text-yellow-600 hover:bg-yellow-100",children:[h.jsx(EEe,{className:"mr-2 h-4 w-4"})," Filter by Category"]})]})}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:JH.map((n,i)=>h.jsx(BCe,{video:n,delay:i*.05},n.id))}),JH.length===0&&h.jsxs("div",{className:"text-center py-10 col-span-full",children:[h.jsx(xT,{className:"w-24 h-24 mx-auto mb-4 text-gray-300"}),h.jsx("p",{className:"text-xl text-gray-500",children:"No videos available at the moment. Please check back soon!"})]})]})});var uJ={exports:{}};(function(n,i){(function(o,c){n.exports=c()})(En,function(){function o(e,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(s){if(s!=="default"&&!(s in e)){var a=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:function(){return r[s]}})}})}),Object.freeze(e)}var c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof En<"u"?En:typeof self<"u"?self:{};function d(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f=function(e){try{return!!e()}catch{return!0}},_=!f(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),v=_,x=Function.prototype,T=x.call,w=v&&x.bind.bind(T,T),R=v?w:function(e){return function(){return T.apply(e,arguments)}},I=R({}.isPrototypeOf),j=function(e){return e&&e.Math===Math&&e},P=j(typeof globalThis=="object"&&globalThis)||j(typeof window=="object"&&window)||j(typeof self=="object"&&self)||j(typeof c=="object"&&c)||j(typeof c=="object"&&c)||function(){return this}()||Function("return this")(),k=_,W=Function.prototype,H=W.apply,L=W.call,V=typeof Reflect=="object"&&Reflect.apply||(k?L.bind(H):function(){return L.apply(H,arguments)}),K=R,te=K({}.toString),ie=K("".slice),A=function(e){return ie(te(e),8,-1)},de=A,ue=R,oe=function(e){if(de(e)==="Function")return ue(e)},ye=typeof document=="object"&&document.all,Ee=ye===void 0&&ye!==void 0?function(e){return typeof e=="function"||e===ye}:function(e){return typeof e=="function"},xe={},Oe=!f(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ct=_,at=Function.prototype.call,lt=ct?at.bind(at):function(){return at.apply(at,arguments)},He={},et={}.propertyIsEnumerable,ut=Object.getOwnPropertyDescriptor,Ae=ut&&!et.call({1:2},1);He.f=Ae?function(e){var t=ut(this,e);return!!t&&t.enumerable}:et;var Le,ze,qe=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},fn=f,qt=A,Dn=Object,Kt=R("".split),hr=fn(function(){return!Dn("z").propertyIsEnumerable(0)})?function(e){return qt(e)==="String"?Kt(e,""):Dn(e)}:Dn,Bn=function(e){return e==null},Yr=Bn,yr=TypeError,cr=function(e){if(Yr(e))throw new yr("Can't call method on "+e);return e},ri=hr,jo=cr,gi=function(e){return ri(jo(e))},mn=Ee,Pn=function(e){return typeof e=="object"?e!==null:mn(e)},$r={},ve=$r,De=P,Ve=Ee,gt=function(e){return Ve(e)?e:void 0},ot=function(e,t){return arguments.length<2?gt(ve[e])||gt(De[e]):ve[e]&&ve[e][t]||De[e]&&De[e][t]},Ue=P.navigator,St=Ue&&Ue.userAgent,dn=St?String(St):"",nr=P,Ci=dn,Uo=nr.process,Ri=nr.Deno,Rs=Uo&&Uo.versions||Ri&&Ri.version,Zi=Rs&&Rs.v8;Zi&&(ze=(Le=Zi.split("."))[0]>0&&Le[0]<4?1:+(Le[0]+Le[1])),!ze&&Ci&&(!(Le=Ci.match(/Edge\/(\d+)/))||Le[1]>=74)&&(Le=Ci.match(/Chrome\/(\d+)/))&&(ze=+Le[1]);var _i=ze,lo=_i,md=f,Lc=P.String,Ys=!!Object.getOwnPropertySymbols&&!md(function(){var e=Symbol("symbol detection");return!Lc(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&lo&&lo<41}),Lu=Ys&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ap=ot,Mc=Ee,jc=I,Np=Object,Uc=Lu?function(e){return typeof e=="symbol"}:function(e){var t=Ap("Symbol");return Mc(t)&&jc(t.prototype,Np(e))},As=String,Xr=function(e){try{return As(e)}catch{return"Object"}},Mu=Ee,a0=Xr,ju=TypeError,Hi=function(e){if(Mu(e))return e;throw new ju(a0(e)+" is not a function")},Ka=Hi,Ei=Bn,ms=function(e,t){var r=e[t];return Ei(r)?void 0:Ka(r)},qa=lt,Uu=Ee,c0=Pn,nw=TypeError,l0={exports:{}},OE=P,rw=Object.defineProperty,DE=P,iw=function(e,t){try{rw(OE,e,{value:t,configurable:!0,writable:!0})}catch{OE[e]=t}return t},bl="__core-js_shared__",d0=l0.exports=DE[bl]||iw(bl,{});(d0.versions||(d0.versions=[])).push({version:"3.42.0",mode:"pure",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Fu=l0.exports,Ip=Fu,Ya=function(e,t){return Ip[e]||(Ip[e]=t||{})},PE=cr,sw=Object,Ns=function(e){return sw(PE(e))},kE=Ns,LE=R({}.hasOwnProperty),ii=Object.hasOwn||function(e,t){return LE(kE(e),t)},ME=R,ow=0,u0=Math.random(),aw=ME(1 .toString),h0=function(e){return"Symbol("+(e===void 0?"":e)+")_"+aw(++ow+u0,36)},jE=Ya,p0=ii,f0=h0,UE=Ys,Is=Lu,Fo=P.Symbol,gd=jE("wks"),cw=Is?Fo.for||Fo:Fo&&Fo.withoutSetter||f0,Sr=function(e){return p0(gd,e)||(gd[e]=UE&&p0(Fo,e)?Fo[e]:cw("Symbol."+e)),gd[e]},m0=lt,g0=Pn,Vu=Uc,FE=ms,lw=function(e,t){var r,s;if(t==="string"&&Uu(r=e.toString)&&!c0(s=qa(r,e))||Uu(r=e.valueOf)&&!c0(s=qa(r,e))||t!=="string"&&Uu(r=e.toString)&&!c0(s=qa(r,e)))return s;throw new nw("Can't convert object to primitive value")},dw=TypeError,Vo=Sr("toPrimitive"),VE=function(e,t){if(!g0(e)||Vu(e))return e;var r,s=FE(e,Vo);if(s){if(t===void 0&&(t="default"),r=m0(s,e,t),!g0(r)||Vu(r))return r;throw new dw("Can't convert object to primitive value")}return t===void 0&&(t="number"),lw(e,t)},Bu=Uc,_0=function(e){var t=VE(e,"string");return Bu(t)?t:t+""},BE=Pn,$a=P.document,wl=BE($a)&&BE($a.createElement),Wu=function(e){return wl?$a.createElement(e):{}},uw=Wu,_d=!Oe&&!f(function(){return Object.defineProperty(uw("div"),"a",{get:function(){return 7}}).a!==7}),WE=Oe,E0=lt,HE=He,GE=qe,hw=gi,zE=_0,pw=ii,fw=_d,Op=Object.getOwnPropertyDescriptor;xe.f=WE?Op:function(e,t){if(e=hw(e),t=zE(t),fw)try{return Op(e,t)}catch{}if(pw(e,t))return GE(!E0(HE.f,e,t),e[t])};var mw=f,gw=Ee,_w=/#|\.prototype\./,Hu=function(e,t){var r=vw[Ew(e)];return r===KE||r!==yw&&(gw(t)?mw(t):!!t)},Ew=Hu.normalize=function(e){return String(e).replace(_w,".").toLowerCase()},vw=Hu.data={},yw=Hu.NATIVE="N",KE=Hu.POLYFILL="P",Dp=Hu,qE=Hi,v0=_,YE=oe(oe.bind),Xa=function(e,t){return qE(e),t===void 0?e:v0?YE(e,t):function(){return e.apply(t,arguments)}},Os={},$E=Oe&&f(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Sw=Pn,xw=String,Gu=TypeError,es=function(e){if(Sw(e))return e;throw new Gu(xw(e)+" is not an object")},y0=Oe,Tw=_d,bw=$E,Pp=es,S=_0,N=TypeError,U=Object.defineProperty,G=Object.getOwnPropertyDescriptor,J="enumerable",Q="configurable",ne="writable";Os.f=y0?bw?function(e,t,r){if(Pp(e),t=S(t),Pp(r),typeof e=="function"&&t==="prototype"&&"value"in r&&ne in r&&!r[ne]){var s=G(e,t);s&&s[ne]&&(e[t]=r.value,r={configurable:Q in r?r[Q]:s[Q],enumerable:J in r?r[J]:s[J],writable:!1})}return U(e,t,r)}:U:function(e,t,r){if(Pp(e),t=S(t),Pp(r),Tw)try{return U(e,t,r)}catch{}if("get"in r||"set"in r)throw new N("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var ge=Os,fe=qe,be=Oe?function(e,t,r){return ge.f(e,t,fe(1,r))}:function(e,t,r){return e[t]=r,e},We=P,Qe=V,Me=oe,dt=Ee,on=xe.f,Gn=Dp,un=$r,Gi=Xa,Lr=be,Bo=ii,da=function(e){var t=function(r,s,a){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,s)}return new e(r,s,a)}return Qe(e,this,arguments)};return t.prototype=e.prototype,t},yt=function(e,t){var r,s,a,l,u,p,m,g,E,y=e.target,b=e.global,C=e.stat,B=e.proto,M=b?We:C?We[y]:We[y]&&We[y].prototype,F=b?un:un[y]||Lr(un,y,{})[y],q=F.prototype;for(l in t)s=!(r=Gn(b?l:y+(C?".":"#")+l,e.forced))&&M&&Bo(M,l),p=F[l],s&&(m=e.dontCallGetSet?(E=on(M,l))&&E.value:M[l]),u=s&&m?m:t[l],(r||B||typeof p!=typeof u)&&(g=e.bind&&s?Gi(u,We):e.wrap&&s?da(u):B&&dt(u)?Me(u):u,(e.sham||u&&u.sham||p&&p.sham)&&Lr(g,"sham",!0),Lr(F,l,g),B&&(Bo(un,a=y+"Prototype")||Lr(un,a,{}),Lr(un[a],l,u),e.real&&q&&(r||!q[l])&&Lr(q,l,u)))},Cl=Math.ceil,Kn=Math.floor,Jr=Math.trunc||function(e){var t=+e;return(t>0?Kn:Cl)(t)},zu=Jr,Ku=function(e){var t=+e;return t!=t||t===0?0:zu(t)},ua=Ku,qu=Math.max,ha=Math.min,pa=function(e,t){var r=ua(e);return r<0?qu(r+t,0):ha(r,t)},Fc=Ku,uo=Math.min,kp=function(e){var t=Fc(e);return t>0?uo(t,9007199254740991):0},Ja=kp,ts=function(e){return Ja(e.length)},ww=gi,Cw=pa,Rw=ts,lr=function(e){return function(t,r,s){var a=ww(t),l=Rw(a);if(l===0)return!e&&-1;var u,p=Cw(s,l);if(e&&r!=r){for(;l>p;)if((u=a[p++])!=u)return!0}else for(;l>p;p++)if((e||p in a)&&a[p]===r)return e||p||0;return!e&&-1}},Ed={includes:lr(!0),indexOf:lr(!1)},Wo=Ed.includes;yt({target:"Array",proto:!0,forced:f(function(){return!Array(1).includes()})},{includes:function(e){return Wo(this,e,arguments.length>1?arguments[1]:void 0)}});var vd=P,Aw=$r,ho=function(e,t){var r=Aw[e+"Prototype"],s=r&&r[t];if(s)return s;var a=vd[e],l=a&&a.prototype;return l&&l[t]},XE=ho("Array","includes"),Rl=Pn,S0=A,Vc=Sr("match"),x0=function(e){var t;return Rl(e)&&((t=e[Vc])!==void 0?!!t:S0(e)==="RegExp")},Yu=x0,Lp=TypeError,$u={};$u[Sr("toStringTag")]="z";var Xu=String($u)==="[object z]",Nw=Xu,Mp=Ee,yd=A,T0=Sr("toStringTag"),Iw=Object,b0=yd(function(){return arguments}())==="Arguments",Qa=Nw?yd:function(e){var t,r,s;return e===void 0?"Undefined":e===null?"Null":typeof(r=function(a,l){try{return a[l]}catch{}}(t=Iw(e),T0))=="string"?r:b0?yd(t):(s=yd(t))==="Object"&&Mp(t.callee)?"Arguments":s},he=Qa,Te=String,Ne=function(e){if(he(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return Te(e)},Fe=Sr("match"),Je=yt,Et=function(e){if(Yu(e))throw new Lp("The method doesn't accept regular expressions");return e},Nt=cr,Ft=Ne,It=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[Fe]=!1,"/./"[e](t)}catch{}}return!1},kn=R("".indexOf);Je({target:"String",proto:!0,forced:!It("includes")},{includes:function(e){return!!~kn(Ft(Nt(this)),Ft(Et(e)),arguments.length>1?arguments[1]:void 0)}});var rn=ho("String","includes"),an=I,Ln=XE,Yt=rn,mr=Array.prototype,ns=String.prototype,rs=function(e){var t=e.includes;return e===mr||an(mr,e)&&t===mr.includes?Ln:typeof e=="string"||e===ns||an(ns,e)&&t===ns.includes?Yt:t},je=d(rs),fa=Hi,Sd=Ns,gs=hr,VQ=ts,y2=TypeError,S2="Reduce of empty array with no initial value",x2=function(e){return function(t,r,s,a){var l=Sd(t),u=gs(l),p=VQ(l);if(fa(r),p===0&&s<2)throw new y2(S2);var m=e?p-1:0,g=e?-1:1;if(s<2)for(;;){if(m in u){a=u[m],m+=g;break}if(m+=g,e?m<0:p<=m)throw new y2(S2)}for(;e?m>=0:p>m;m+=g)m in u&&(a=r(a,u[m],m,l));return a}},BQ={left:x2(!1),right:x2(!0)},WQ=f,JE=function(e,t){var r=[][e];return!!r&&WQ(function(){r.call(null,t||function(){return 1},1)})},w0=P,HQ=dn,GQ=A,QE=function(e){return HQ.slice(0,e.length)===e},Ow=QE("Bun/")?"BUN":QE("Cloudflare-Workers")?"CLOUDFLARE":QE("Deno/")?"DENO":QE("Node.js/")?"NODE":w0.Bun&&typeof Bun.version=="string"?"BUN":w0.Deno&&typeof Deno.version=="object"?"DENO":GQ(w0.process)==="process"?"NODE":w0.window&&w0.document?"BROWSER":"REST",ZE=Ow==="NODE",zQ=BQ.left;yt({target:"Array",proto:!0,forced:!ZE&&_i>79&&_i<83||!JE("reduce")},{reduce:function(e){var t=arguments.length;return zQ(this,e,t,t>1?arguments[1]:void 0)}});var KQ=ho("Array","reduce"),qQ=I,YQ=KQ,Dw=Array.prototype,$Q=function(e){var t=e.reduce;return e===Dw||qQ(Dw,e)&&t===Dw.reduce?YQ:t},T2=$Q,ma=d(T2),XQ=A,C0=Array.isArray||function(e){return XQ(e)==="Array"},JQ=yt,QQ=C0,ZQ=R([].reverse),b2=[1,2];JQ({target:"Array",proto:!0,forced:String(b2)===String(b2.reverse())},{reverse:function(){return QQ(this)&&(this.length=this.length),ZQ(this)}});var eZ=ho("Array","reverse"),tZ=I,nZ=eZ,Pw=Array.prototype,rZ=function(e){var t=e.reverse;return e===Pw||tZ(Pw,e)&&t===Pw.reverse?nZ:t},w2=rZ,C2=d(w2),iZ=h0,R2=Ya("keys"),ev=function(e){return R2[e]||(R2[e]=iZ(e))},sZ=!f(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),oZ=ii,aZ=Ee,cZ=Ns,lZ=sZ,A2=ev("IE_PROTO"),kw=Object,dZ=kw.prototype,Lw=lZ?kw.getPrototypeOf:function(e){var t=cZ(e);if(oZ(t,A2))return t[A2];var r=t.constructor;return aZ(r)&&t instanceof r?r.prototype:t instanceof kw?dZ:null},uZ=R,hZ=Hi,pZ=Pn,fZ=function(e){return pZ(e)||e===null},mZ=String,gZ=TypeError,_Z=function(e,t,r){try{return uZ(hZ(Object.getOwnPropertyDescriptor(e,t)[r]))}catch{}},EZ=Pn,vZ=cr,yZ=function(e){if(fZ(e))return e;throw new gZ("Can't set "+mZ(e)+" as a prototype")},SZ=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=_Z(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch{}return function(s,a){return vZ(s),yZ(a),EZ(s)&&(t?e(s,a):s.__proto__=a),s}}():void 0),tv={},nv={},Mw=ii,xZ=gi,TZ=Ed.indexOf,bZ=nv,N2=R([].push),I2=function(e,t){var r,s=xZ(e),a=0,l=[];for(r in s)!Mw(bZ,r)&&Mw(s,r)&&N2(l,r);for(;t.length>a;)Mw(s,r=t[a++])&&(~TZ(l,r)||N2(l,r));return l},jw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],wZ=I2,CZ=jw.concat("length","prototype");tv.f=Object.getOwnPropertyNames||function(e){return wZ(e,CZ)};var R0={};R0.f=Object.getOwnPropertySymbols;var RZ=ot,AZ=tv,NZ=R0,IZ=es,OZ=R([].concat),DZ=RZ("Reflect","ownKeys")||function(e){var t=AZ.f(IZ(e)),r=NZ.f;return r?OZ(t,r(e)):t},O2=ii,PZ=DZ,kZ=xe,LZ=Os,Uw={},MZ=I2,jZ=jw,rv=Object.keys||function(e){return MZ(e,jZ)},UZ=Oe,FZ=$E,VZ=Os,BZ=es,WZ=gi,HZ=rv;Uw.f=UZ&&!FZ?Object.defineProperties:function(e,t){BZ(e);for(var r,s=WZ(t),a=HZ(t),l=a.length,u=0;l>u;)VZ.f(e,r=a[u++],s[r]);return e};var iv,D2=ot("document","documentElement"),GZ=es,zZ=Uw,P2=jw,KZ=nv,qZ=D2,YZ=Wu,Fw="prototype",Vw="script",k2=ev("IE_PROTO"),Bw=function(){},L2=function(e){return"<"+Vw+">"+e+"</"+Vw+">"},M2=function(e){e.write(L2("")),e.close();var t=e.parentWindow.Object;return e=null,t},sv=function(){try{iv=new ActiveXObject("htmlfile")}catch{}var e,t,r;sv=typeof document<"u"?document.domain&&iv?M2(iv):(t=YZ("iframe"),r="java"+Vw+":",t.style.display="none",qZ.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(L2("document.F=Object")),e.close(),e.F):M2(iv);for(var s=P2.length;s--;)delete sv[Fw][P2[s]];return sv()};KZ[k2]=!0;var A0=Object.create||function(e,t){var r;return e!==null?(Bw[Fw]=GZ(e),r=new Bw,Bw[Fw]=null,r[k2]=e):r=sv(),t===void 0?r:zZ.f(r,t)},$Z=Pn,XZ=be,j2=Error,JZ=R("".replace),QZ=String(new j2("zxcasd").stack),U2=/\n\s*at [^:]*:[^\n]*/,ZZ=U2.test(QZ),eee=qe,tee=!f(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",eee(1,7)),e.stack!==7)}),nee=be,ree=function(e,t){if(ZZ&&typeof e=="string"&&!j2.prepareStackTrace)for(;t--;)e=JZ(e,U2,"");return e},iee=tee,F2=Error.captureStackTrace,jp={},see=jp,oee=Sr("iterator"),aee=Array.prototype,V2=function(e){return e!==void 0&&(see.Array===e||aee[oee]===e)},cee=Qa,B2=ms,lee=Bn,dee=jp,uee=Sr("iterator"),ov=function(e){if(!lee(e))return B2(e,uee)||B2(e,"@@iterator")||dee[cee(e)]},hee=lt,pee=Hi,fee=es,mee=Xr,gee=ov,_ee=TypeError,Ww=function(e,t){var r=arguments.length<2?gee(e):t;if(pee(r))return fee(hee(r,e));throw new _ee(mee(e)+" is not iterable")},Eee=lt,W2=es,vee=ms,H2=function(e,t,r){var s,a;W2(e);try{if(!(s=vee(e,"return"))){if(t==="throw")throw r;return r}s=Eee(s,e)}catch(l){a=!0,s=l}if(t==="throw")throw r;if(a)throw s;return W2(s),r},yee=Xa,See=lt,xee=es,Tee=Xr,bee=V2,wee=ts,G2=I,Cee=Ww,Ree=ov,z2=H2,Aee=TypeError,av=function(e,t){this.stopped=e,this.result=t},K2=av.prototype,N0=function(e,t,r){var s,a,l,u,p,m,g,E=r&&r.that,y=!(!r||!r.AS_ENTRIES),b=!(!r||!r.IS_RECORD),C=!(!r||!r.IS_ITERATOR),B=!(!r||!r.INTERRUPTED),M=yee(t,E),F=function(Y){return s&&z2(s,"normal",Y),new av(!0,Y)},q=function(Y){return y?(xee(Y),B?M(Y[0],Y[1],F):M(Y[0],Y[1])):B?M(Y,F):M(Y)};if(b)s=e.iterator;else if(C)s=e;else{if(!(a=Ree(e)))throw new Aee(Tee(e)+" is not iterable");if(bee(a)){for(l=0,u=wee(e);u>l;l++)if((p=q(e[l]))&&G2(K2,p))return p;return new av(!1)}s=Cee(e,a)}for(m=b?e.next:s.next;!(g=See(m,s)).done;){try{p=q(g.value)}catch(Y){z2(s,"throw",Y)}if(typeof p=="object"&&p&&G2(K2,p))return p}return new av(!1)},Nee=Ne,Iee=yt,Oee=I,Dee=Lw,cv=SZ,Pee=function(e,t,r){for(var s=PZ(t),a=LZ.f,l=kZ.f,u=0;u<s.length;u++){var p=s[u];O2(e,p)||r&&O2(r,p)||a(e,p,l(t,p))}},q2=A0,Hw=be,Gw=qe,kee=function(e,t){$Z(t)&&"cause"in t&&XZ(e,"cause",t.cause)},Lee=function(e,t,r,s){iee&&(F2?F2(e,t):nee(e,"stack",ree(r,s)))},Mee=N0,jee=function(e,t){return e===void 0?arguments.length<2?"":t:Nee(e)},Uee=Sr("toStringTag"),lv=Error,Fee=[].push,Up=function(e,t){var r,s=Oee(zw,this);cv?r=cv(new lv,s?Dee(this):zw):(r=s?this:q2(zw),Hw(r,Uee,"Error")),t!==void 0&&Hw(r,"message",jee(t)),Lee(r,Up,r.stack,1),arguments.length>2&&kee(r,arguments[2]);var a=[];return Mee(e,Fee,{that:a}),Hw(r,"errors",a),r};cv?cv(Up,lv):Pee(Up,lv,{name:!0});var zw=Up.prototype=q2(lv.prototype,{constructor:Gw(1,Up),message:Gw(1,""),name:Gw(1,"AggregateError")});Iee({global:!0,constructor:!0,arity:2},{AggregateError:Up});var dv,I0,uv,Vee=Ee,Y2=P.WeakMap,Bee=Vee(Y2)&&/native code/.test(String(Y2)),$2=P,Wee=Pn,Hee=be,Kw=ii,qw=Fu,Gee=ev,zee=nv,X2="Object already initialized",Yw=$2.TypeError,Kee=$2.WeakMap;if(Bee||qw.state){var Bc=qw.state||(qw.state=new Kee);Bc.get=Bc.get,Bc.has=Bc.has,Bc.set=Bc.set,dv=function(e,t){if(Bc.has(e))throw new Yw(X2);return t.facade=e,Bc.set(e,t),t},I0=function(e){return Bc.get(e)||{}},uv=function(e){return Bc.has(e)}}else{var Fp=Gee("state");zee[Fp]=!0,dv=function(e,t){if(Kw(e,Fp))throw new Yw(X2);return t.facade=e,Hee(e,Fp,t),t},I0=function(e){return Kw(e,Fp)?e[Fp]:{}},uv=function(e){return Kw(e,Fp)}}var Ju,J2,Q2,Qu={set:dv,get:I0,has:uv,enforce:function(e){return uv(e)?I0(e):dv(e,{})},getterFor:function(e){return function(t){var r;if(!Wee(t)||(r=I0(t)).type!==e)throw new Yw("Incompatible receiver, "+e+" required");return r}}},$w=Oe,qee=ii,Z2=Function.prototype,Yee=$w&&Object.getOwnPropertyDescriptor,Xw=qee(Z2,"name"),eL={EXISTS:Xw,PROPER:Xw&&(function(){}).name==="something",CONFIGURABLE:Xw&&(!$w||$w&&Yee(Z2,"name").configurable)},$ee=be,xd=function(e,t,r,s){return s&&s.enumerable?e[t]=r:$ee(e,t,r),e},Xee=f,Jee=Ee,Qee=Pn,Zee=A0,tL=Lw,ete=xd,Jw=Sr("iterator"),nL=!1;[].keys&&("next"in(Q2=[].keys())?(J2=tL(tL(Q2)))!==Object.prototype&&(Ju=J2):nL=!0);var tte=!Qee(Ju)||Xee(function(){var e={};return Ju[Jw].call(e)!==e});Jee((Ju=tte?{}:Zee(Ju))[Jw])||ete(Ju,Jw,function(){return this});var rL={IteratorPrototype:Ju,BUGGY_SAFARI_ITERATORS:nL},nte=Qa,rte=Xu?{}.toString:function(){return"[object "+nte(this)+"]"},ite=Xu,ste=Os.f,ote=be,ate=ii,cte=rte,iL=Sr("toStringTag"),Al=function(e,t,r,s){var a=r?e:e&&e.prototype;a&&(ate(a,iL)||ste(a,iL,{configurable:!0,value:t}),s&&!ite&&ote(a,"toString",cte))},lte=rL.IteratorPrototype,dte=A0,ute=qe,hte=Al,pte=jp,fte=function(){return this},Qw=function(e,t,r,s){var a=t+" Iterator";return e.prototype=dte(lte,{next:ute(+!s,r)}),hte(e,a,!1,!0),pte[a]=fte,e},mte=yt,gte=lt,_te=eL,Ete=Qw,vte=Lw,yte=Al,sL=xd,oL=jp,Ste=rL,xte=_te.PROPER,hv=Ste.BUGGY_SAFARI_ITERATORS,Zw=Sr("iterator"),aL="keys",pv="values",cL="entries",Tte=function(){return this},lL=function(e,t,r,s,a,l,u){Ete(r,t,s);var p,m,g,E=function(q){if(q===a&&M)return M;if(!hv&&q&&q in C)return C[q];switch(q){case aL:case pv:case cL:return function(){return new r(this,q)}}return function(){return new r(this)}},y=t+" Iterator",b=!1,C=e.prototype,B=C[Zw]||C["@@iterator"]||a&&C[a],M=!hv&&B||E(a),F=t==="Array"&&C.entries||B;if(F&&(p=vte(F.call(new e)))!==Object.prototype&&p.next&&(yte(p,y,!0,!0),oL[y]=Tte),xte&&a===pv&&B&&B.name!==pv&&(b=!0,M=function(){return gte(B,this)}),a)if(m={values:E(pv),keys:l?M:E(aL),entries:E(cL)},u)for(g in m)(hv||b||!(g in C))&&sL(C,g,m[g]);else mte({target:t,proto:!0,forced:hv||b},m);return u&&C[Zw]!==M&&sL(C,Zw,M,{name:a}),oL[t]=M,m},fv=function(e,t){return{value:e,done:t}},bte=gi,dL=jp,uL=Qu;Os.f;var wte=lL,mv=fv,hL="Array Iterator",Cte=uL.set,Rte=uL.getterFor(hL);wte(Array,"Array",function(e,t){Cte(this,{type:hL,target:bte(e),index:0,kind:t})},function(){var e=Rte(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,mv(void 0,!0);switch(e.kind){case"keys":return mv(r,!1);case"values":return mv(t[r],!1)}return mv([r,t[r]],!1)},"values"),dL.Arguments=dL.Array;var Ate=Os,gv=function(e,t,r){return Ate.f(e,t,r)},Nte=ot,Ite=gv,Ote=Oe,pL=Sr("species"),Dte=I,Pte=TypeError,eC=function(e,t){if(Dte(t,e))return e;throw new Pte("Incorrect invocation")},kte=Ee,tC=Fu,Lte=R(Function.toString);kte(tC.inspectSource)||(tC.inspectSource=function(e){return Lte(e)});var fL=tC.inspectSource,Mte=R,jte=f,mL=Ee,Ute=Qa,Fte=fL,gL=function(){},_L=ot("Reflect","construct"),nC=/^\s*(?:class|function)\b/,Vte=Mte(nC.exec),Bte=!nC.test(gL),O0=function(e){if(!mL(e))return!1;try{return _L(gL,[],e),!0}catch{return!1}},EL=function(e){if(!mL(e))return!1;switch(Ute(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Bte||!!Vte(nC,Fte(e))}catch{return!0}};EL.sham=!0;var D0,Vp,vL,rC,_v=!_L||jte(function(){var e;return O0(O0.call)||!O0(Object)||!O0(function(){e=!0})||e})?EL:O0,Wte=_v,Hte=Xr,Gte=TypeError,yL=es,zte=function(e){if(Wte(e))return e;throw new Gte(Hte(e)+" is not a constructor")},Kte=Bn,qte=Sr("species"),iC=function(e,t){var r,s=yL(e).constructor;return s===void 0||Kte(r=yL(s)[qte])?t:zte(r)},Td=R([].slice),Yte=TypeError,Zu=function(e,t){if(e<t)throw new Yte("Not enough arguments");return e},SL=/(?:ipad|iphone|ipod).*applewebkit/i.test(dn),Ho=P,$te=V,Xte=Xa,xL=Ee,Jte=ii,TL=f,bL=D2,Qte=Td,wL=Wu,Zte=Zu,ene=SL,tne=ZE,sC=Ho.setImmediate,oC=Ho.clearImmediate,nne=Ho.process,aC=Ho.Dispatch,rne=Ho.Function,CL=Ho.MessageChannel,ine=Ho.String,cC=0,P0={},RL="onreadystatechange";TL(function(){D0=Ho.location});var lC=function(e){if(Jte(P0,e)){var t=P0[e];delete P0[e],t()}},dC=function(e){return function(){lC(e)}},AL=function(e){lC(e.data)},NL=function(e){Ho.postMessage(ine(e),D0.protocol+"//"+D0.host)};sC&&oC||(sC=function(e){Zte(arguments.length,1);var t=xL(e)?e:rne(e),r=Qte(arguments,1);return P0[++cC]=function(){$te(t,void 0,r)},Vp(cC),cC},oC=function(e){delete P0[e]},tne?Vp=function(e){nne.nextTick(dC(e))}:aC&&aC.now?Vp=function(e){aC.now(dC(e))}:CL&&!ene?(rC=(vL=new CL).port2,vL.port1.onmessage=AL,Vp=Xte(rC.postMessage,rC)):Ho.addEventListener&&xL(Ho.postMessage)&&!Ho.importScripts&&D0&&D0.protocol!=="file:"&&!TL(NL)?(Vp=NL,Ho.addEventListener("message",AL,!1)):Vp=RL in wL("script")?function(e){bL.appendChild(wL("script"))[RL]=function(){bL.removeChild(this),lC(e)}}:function(e){setTimeout(dC(e),0)});var Ev={set:sC,clear:oC},IL=P,sne=Oe,one=Object.getOwnPropertyDescriptor,OL=function(e){if(!sne)return IL[e];var t=one(IL,e);return t&&t.value},DL=function(){this.head=null,this.tail=null};DL.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return(this.head=e.next)===null&&(this.tail=null),e.item}};var Bp,uC,hC,pC,PL,kL=DL,ane=/ipad|iphone|ipod/i.test(dn)&&typeof Pebble<"u",cne=/web0s(?!.*chrome)/i.test(dn),Wp=P,lne=OL,LL=Xa,fC=Ev.set,dne=kL,une=SL,hne=ane,pne=cne,mC=ZE,ML=Wp.MutationObserver||Wp.WebKitMutationObserver,jL=Wp.document,UL=Wp.process,vv=Wp.Promise,gC=lne("queueMicrotask");if(!gC){var yv=new dne,Sv=function(){var e,t;for(mC&&(e=UL.domain)&&e.exit();t=yv.get();)try{t()}catch(r){throw yv.head&&Bp(),r}e&&e.enter()};une||mC||pne||!ML||!jL?!hne&&vv&&vv.resolve?((pC=vv.resolve(void 0)).constructor=vv,PL=LL(pC.then,pC),Bp=function(){PL(Sv)}):mC?Bp=function(){UL.nextTick(Sv)}:(fC=LL(fC,Wp),Bp=function(){fC(Sv)}):(uC=!0,hC=jL.createTextNode(""),new ML(Sv).observe(hC,{characterData:!0}),Bp=function(){hC.data=uC=!uC}),gC=function(e){yv.head||Bp(),yv.add(e)}}var FL=gC,Hp=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},eh=P.Promise,fne=P,k0=eh,mne=Ee,gne=Dp,_ne=fL,Ene=Sr,VL=Ow,_C=_i,BL=k0&&k0.prototype,vne=Ene("species"),WL=!1,HL=mne(fne.PromiseRejectionEvent),yne=gne("Promise",function(){var e=_ne(k0),t=e!==String(k0);if(!t&&_C===66||!BL.catch||!BL.finally)return!0;if(!_C||_C<51||!/native code/.test(e)){var r=new k0(function(a){a(1)}),s=function(a){a(function(){},function(){})};if((r.constructor={})[vne]=s,!(WL=r.then(function(){})instanceof s))return!0}return!(t||VL!=="BROWSER"&&VL!=="DENO"||HL)}),L0={CONSTRUCTOR:yne,REJECTION_EVENT:HL,SUBCLASSING:WL},Wc={},GL=Hi,Sne=TypeError,xne=function(e){var t,r;this.promise=new e(function(s,a){if(t!==void 0||r!==void 0)throw new Sne("Bad Promise constructor");t=s,r=a}),this.resolve=GL(t),this.reject=GL(r)};Wc.f=function(e){return new xne(e)};var EC,zL,Tne=yt,xv=ZE,bd=P,M0=lt,bne=xd,wne=Al,Cne=function(e){var t=Nte(e);Ote&&t&&!t[pL]&&Ite(t,pL,{configurable:!0,get:function(){return this}})},Rne=Hi,vC=Ee,Ane=Pn,Nne=eC,Ine=iC,KL=Ev.set,yC=FL,One=function(e,t){try{arguments.length===1?console.error(e):console.error(e,t)}catch{}},Dne=Hp,Pne=kL,qL=Qu,SC=eh,YL=L0,$L=Wc,Tv="Promise",XL=YL.CONSTRUCTOR,kne=YL.REJECTION_EVENT,xC=qL.getterFor(Tv),Lne=qL.set,Mne=SC&&SC.prototype,j0=SC,TC=Mne,JL=bd.TypeError,bC=bd.document,wC=bd.process,CC=$L.f,jne=CC,Une=!!(bC&&bC.createEvent&&bd.dispatchEvent),QL="unhandledrejection",ZL=function(e){var t;return!(!Ane(e)||!vC(t=e.then))&&t},eM=function(e,t){var r,s,a,l=t.value,u=t.state===1,p=u?e.ok:e.fail,m=e.resolve,g=e.reject,E=e.domain;try{p?(u||(t.rejection===2&&Vne(t),t.rejection=1),p===!0?r=l:(E&&E.enter(),r=p(l),E&&(E.exit(),a=!0)),r===e.promise?g(new JL("Promise-chain cycle")):(s=ZL(r))?M0(s,r,m,g):m(r)):g(l)}catch(y){E&&!a&&E.exit(),g(y)}},tM=function(e,t){e.notified||(e.notified=!0,yC(function(){for(var r,s=e.reactions;r=s.get();)eM(r,e);e.notified=!1,t&&!e.rejection&&Fne(e)}))},nM=function(e,t,r){var s,a;Une?((s=bC.createEvent("Event")).promise=t,s.reason=r,s.initEvent(e,!1,!0),bd.dispatchEvent(s)):s={promise:t,reason:r},!kne&&(a=bd["on"+e])?a(s):e===QL&&One("Unhandled promise rejection",r)},Fne=function(e){M0(KL,bd,function(){var t,r=e.facade,s=e.value;if(rM(e)&&(t=Dne(function(){xv?wC.emit("unhandledRejection",s,r):nM(QL,r,s)}),e.rejection=xv||rM(e)?2:1,t.error))throw t.value})},rM=function(e){return e.rejection!==1&&!e.parent},Vne=function(e){M0(KL,bd,function(){var t=e.facade;xv?wC.emit("rejectionHandled",t):nM("rejectionhandled",t,e.value)})},Gp=function(e,t,r){return function(s){e(t,s,r)}},zp=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,tM(e,!0))},RC=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new JL("Promise can't be resolved itself");var s=ZL(t);s?yC(function(){var a={done:!1};try{M0(s,t,Gp(RC,a,e),Gp(zp,a,e))}catch(l){zp(a,l,e)}}):(e.value=t,e.state=1,tM(e,!1))}catch(a){zp({done:!1},a,e)}}};XL&&(TC=(j0=function(e){Nne(this,TC),Rne(e),M0(EC,this);var t=xC(this);try{e(Gp(RC,t),Gp(zp,t))}catch(r){zp(t,r)}}).prototype,(EC=function(e){Lne(this,{type:Tv,done:!1,notified:!1,parent:!1,reactions:new Pne,rejection:!1,state:0,value:null})}).prototype=bne(TC,"then",function(e,t){var r=xC(this),s=CC(Ine(this,j0));return r.parent=!0,s.ok=!vC(e)||e,s.fail=vC(t)&&t,s.domain=xv?wC.domain:void 0,r.state===0?r.reactions.add(s):yC(function(){eM(s,r)}),s.promise}),zL=function(){var e=new EC,t=xC(e);this.promise=e,this.resolve=Gp(RC,t),this.reject=Gp(zp,t)},$L.f=CC=function(e){return e===j0||e===void 0?new zL(e):jne(e)}),Tne({global:!0,constructor:!0,wrap:!0,forced:XL},{Promise:j0}),wne(j0,Tv,!1,!0),Cne(Tv);var iM=Sr("iterator"),sM=!1;try{var Bne=0,oM={next:function(){return{done:!!Bne++}},return:function(){sM=!0}};oM[iM]=function(){return this},Array.from(oM,function(){throw 2})}catch{}var Wne=eh,Hne=function(e,t){try{if(!t&&!sM)return!1}catch{return!1}var r=!1;try{var s={};s[iM]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch{}return r},bv=L0.CONSTRUCTOR||!Hne(function(e){Wne.all(e).then(void 0,function(){})}),Gne=lt,zne=Hi,Kne=Wc,qne=Hp,Yne=N0;yt({target:"Promise",stat:!0,forced:bv},{all:function(e){var t=this,r=Kne.f(t),s=r.resolve,a=r.reject,l=qne(function(){var u=zne(t.resolve),p=[],m=0,g=1;Yne(e,function(E){var y=m++,b=!1;g++,Gne(u,t,E).then(function(C){b||(b=!0,p[y]=C,--g||s(p))},a)}),--g||s(p)});return l.error&&a(l.value),r.promise}});var $ne=yt,Xne=L0.CONSTRUCTOR;eh&&eh.prototype,$ne({target:"Promise",proto:!0,forced:Xne,real:!0},{catch:function(e){return this.then(void 0,e)}});var Jne=lt,Qne=Hi,Zne=Wc,ere=Hp,tre=N0;yt({target:"Promise",stat:!0,forced:bv},{race:function(e){var t=this,r=Zne.f(t),s=r.reject,a=ere(function(){var l=Qne(t.resolve);tre(e,function(u){Jne(l,t,u).then(r.resolve,s)})});return a.error&&s(a.value),r.promise}});var nre=Wc;yt({target:"Promise",stat:!0,forced:L0.CONSTRUCTOR},{reject:function(e){var t=nre.f(this);return(0,t.reject)(e),t.promise}});var rre=es,ire=Pn,sre=Wc,aM=function(e,t){if(rre(e),ire(t)&&t.constructor===e)return t;var r=sre.f(e);return(0,r.resolve)(t),r.promise},ore=yt,are=eh,cre=L0.CONSTRUCTOR,lre=aM,dre=ot("Promise"),ure=!cre;ore({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return lre(ure&&this===dre?are:this,e)}});var hre=lt,pre=Hi,fre=Wc,mre=Hp,gre=N0;yt({target:"Promise",stat:!0,forced:bv},{allSettled:function(e){var t=this,r=fre.f(t),s=r.resolve,a=r.reject,l=mre(function(){var u=pre(t.resolve),p=[],m=0,g=1;gre(e,function(E){var y=m++,b=!1;g++,hre(u,t,E).then(function(C){b||(b=!0,p[y]={status:"fulfilled",value:C},--g||s(p))},function(C){b||(b=!0,p[y]={status:"rejected",reason:C},--g||s(p))})}),--g||s(p)});return l.error&&a(l.value),r.promise}});var _re=lt,Ere=Hi,vre=ot,yre=Wc,Sre=Hp,xre=N0,cM="No one promise resolved";yt({target:"Promise",stat:!0,forced:bv},{any:function(e){var t=this,r=vre("AggregateError"),s=yre.f(t),a=s.resolve,l=s.reject,u=Sre(function(){var p=Ere(t.resolve),m=[],g=0,E=1,y=!1;xre(e,function(b){var C=g++,B=!1;E++,_re(p,t,b).then(function(M){B||y||(y=!0,a(M))},function(M){B||y||(B=!0,m[C]=M,--E||l(new r(m,cM)))})}),--E||l(new r(m,cM))});return u.error&&l(u.value),s.promise}});var Tre=yt,bre=V,wre=Td,Cre=Wc,Rre=Hi,lM=Hp,AC=P.Promise,dM=!1;Tre({target:"Promise",stat:!0,forced:!AC||!AC.try||lM(function(){AC.try(function(e){dM=e===8},8)}).error||!dM},{try:function(e){var t=arguments.length>1?wre(arguments,1):[],r=Cre.f(this),s=lM(function(){return bre(Rre(e),void 0,t)});return(s.error?r.reject:r.resolve)(s.value),r.promise}});var Are=Wc;yt({target:"Promise",stat:!0},{withResolvers:function(){var e=Are.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Nre=yt,NC=eh,Ire=f,Ore=ot,Dre=Ee,Pre=iC,uM=aM,kre=NC&&NC.prototype;Nre({target:"Promise",proto:!0,real:!0,forced:!!NC&&Ire(function(){kre.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=Pre(this,Ore("Promise")),r=Dre(e);return this.then(r?function(s){return uM(t,e()).then(function(){return s})}:e,r?function(s){return uM(t,e()).then(function(){throw s})}:e)}});var IC=R,Lre=Ku,Mre=Ne,jre=cr,Ure=IC("".charAt),hM=IC("".charCodeAt),Fre=IC("".slice),pM=function(e){return function(t,r){var s,a,l=Mre(jre(t)),u=Lre(r),p=l.length;return u<0||u>=p?e?"":void 0:(s=hM(l,u))<55296||s>56319||u+1===p||(a=hM(l,u+1))<56320||a>57343?e?Ure(l,u):s:e?Fre(l,u,u+2):a-56320+(s-55296<<10)+65536}},OC={codeAt:pM(!1),charAt:pM(!0)},Vre=OC.charAt,Bre=Ne,fM=Qu,Wre=lL,mM=fv,gM="String Iterator",Hre=fM.set,Gre=fM.getterFor(gM);Wre(String,"String",function(e){Hre(this,{type:gM,string:Bre(e),index:0})},function(){var e,t=Gre(this),r=t.string,s=t.index;return s>=r.length?mM(void 0,!0):(e=Vre(r,s),t.index+=e.length,mM(e,!1))});var zre=$r.Promise,Kre={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},qre=P,Yre=Al,_M=jp;for(var DC in Kre)Yre(qre[DC],DC),_M[DC]=_M.Array;var EM=zre,Ye=d(EM),$re=ho("Array","values"),Xre=Qa,Jre=ii,Qre=I,Zre=$re,PC=Array.prototype,eie={DOMTokenList:!0,NodeList:!0},tie=function(e){var t=e.values;return e===PC||Qre(PC,e)&&t===PC.values||Jre(eie,Xre(e))?Zre:t},$s=d(tie),vM=Xr,nie=TypeError,yM=Td,rie=Math.floor,kC=function(e,t){var r=e.length;if(r<8)for(var s,a,l=1;l<r;){for(a=l,s=e[l];a&&t(e[a-1],s)>0;)e[a]=e[--a];a!==l++&&(e[a]=s)}else for(var u=rie(r/2),p=kC(yM(e,0,u),t),m=kC(yM(e,u),t),g=p.length,E=m.length,y=0,b=0;y<g||b<E;)e[y+b]=y<g&&b<E?t(p[y],m[b])<=0?p[y++]:m[b++]:y<g?p[y++]:m[b++];return e},SM=kC,xM=dn.match(/firefox\/(\d+)/i),iie=!!xM&&+xM[1],sie=/MSIE|Trident/.test(dn),TM=dn.match(/AppleWebKit\/(\d+)\./),oie=!!TM&&+TM[1],aie=yt,bM=R,cie=Hi,lie=Ns,wM=ts,die=function(e,t){if(!delete e[t])throw new nie("Cannot delete property "+vM(t)+" of "+vM(e))},CM=Ne,LC=f,uie=SM,hie=JE,RM=iie,pie=sie,AM=_i,NM=oie,wd=[],IM=bM(wd.sort),fie=bM(wd.push),mie=LC(function(){wd.sort(void 0)}),gie=LC(function(){wd.sort(null)}),_ie=hie("sort"),OM=!LC(function(){if(AM)return AM<70;if(!(RM&&RM>3)){if(pie)return!0;if(NM)return NM<603;var e,t,r,s,a="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(s=0;s<47;s++)wd.push({k:t+s,v:r})}for(wd.sort(function(l,u){return u.v-l.v}),s=0;s<wd.length;s++)t=wd[s].k.charAt(0),a.charAt(a.length-1)!==t&&(a+=t);return a!=="DGBEFHACIJK"}});aie({target:"Array",proto:!0,forced:mie||!gie||!_ie||!OM},{sort:function(e){e!==void 0&&cie(e);var t=lie(this);if(OM)return e===void 0?IM(t):IM(t,e);var r,s,a=[],l=wM(t);for(s=0;s<l;s++)s in t&&fie(a,t[s]);for(uie(a,function(u){return function(p,m){return m===void 0?-1:p===void 0?1:u!==void 0?+u(p,m)||0:CM(p)>CM(m)?1:-1}}(e)),r=wM(a),s=0;s<r;)t[s]=a[s++];for(;s<l;)die(t,s++);return t}});var Eie=ho("Array","sort"),vie=I,yie=Eie,MC=Array.prototype,Sie=function(e){var t=e.sort;return e===MC||vie(MC,e)&&t===MC.sort?yie:t},th=d(Sie),xie=yt,Tie=R,bie=pa,wie=RangeError,DM=String.fromCharCode,PM=String.fromCodePoint,Cie=Tie([].join);xie({target:"String",stat:!0,arity:1,forced:!!PM&&PM.length!==1},{fromCodePoint:function(e){for(var t,r=[],s=arguments.length,a=0;s>a;){if(t=+arguments[a++],bie(t,1114111)!==t)throw new wie(t+" is not a valid code point");r[a]=t<65536?DM(t):DM(55296+((t-=65536)>>10),t%1024+56320)}return Cie(r,"")}});var Rie=f,Aie=Sr("iterator"),wv=!Rie(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),s="";return e.pathname="c%20d",t.forEach(function(a,l){t.delete("b"),s+=l+a}),r.delete("a",2),r.delete("b",void 0),!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b")||!t.size&&!0||!t.sort||e.href!=="https://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[Aie]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://").host!=="xn--e1aybc"||new URL("https://a#").hash!=="#%D0%B1"||s!=="a1c3"||new URL("https://x",void 0).host!=="x"}),Nie=xd,jC=yt,kM=P,UC=OL,Iie=ot,Cv=lt,Za=R,U0=Oe,LM=wv,MM=xd,Oie=gv,Die=function(e,t,r){for(var s in t)r&&r.unsafe&&e[s]?e[s]=t[s]:Nie(e,s,t[s],r);return e},Pie=Al,kie=Qw,FC=Qu,jM=eC,VC=Ee,Lie=ii,Mie=Xa,jie=Qa,Uie=es,UM=Pn,Xs=Ne,Fie=A0,FM=qe,VM=Ww,Vie=ov,Rv=fv,Kp=Zu,Bie=SM,Wie=Sr("iterator"),qp="URLSearchParams",BM=qp+"Iterator",WM=FC.set,ga=FC.getterFor(qp),Hie=FC.getterFor(BM),HM=UC("fetch"),Av=UC("Request"),F0=UC("Headers"),BC=Av&&Av.prototype,GM=F0&&F0.prototype,Gie=kM.TypeError,zie=kM.encodeURIComponent,Kie=String.fromCharCode,qie=Iie("String","fromCodePoint"),Yie=parseInt,Nv=Za("".charAt),zM=Za([].join),Cd=Za([].push),KM=Za("".replace),$ie=Za([].shift),qM=Za([].splice),YM=Za("".split),$M=Za("".slice),Xie=Za(/./.exec),Jie=/\+/g,Qie=/^[0-9a-f]+$/i,XM=function(e,t){var r=$M(e,t,t+2);return Xie(Qie,r)?Yie(r,16):NaN},Zie=function(e){for(var t=0,r=128;r>0&&e&r;r>>=1)t++;return t},ese=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},JM=function(e){for(var t=(e=KM(e,Jie," ")).length,r="",s=0;s<t;){var a=Nv(e,s);if(a==="%"){if(Nv(e,s+1)==="%"||s+3>t){r+="%",s++;continue}var l=XM(e,s+1);if(l!=l){r+=a,s++;continue}s+=2;var u=Zie(l);if(u===0)a=Kie(l);else{if(u===1||u>4){r+="",s++;continue}for(var p=[l],m=1;m<u&&!(++s+3>t||Nv(e,s)!=="%");){var g=XM(e,s+1);if(g!=g){s+=3;break}if(g>191||g<128)break;Cd(p,g),s+=2,m++}if(p.length!==u){r+="";continue}var E=ese(p);E===null?r+="":a=qie(E)}}r+=a,s++}return r},tse=/[!'()~]|%20/g,nse={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},rse=function(e){return nse[e]},QM=function(e){return KM(zie(e),tse,rse)},WC=kie(function(e,t){WM(this,{type:BM,target:ga(e).entries,index:0,kind:t})},qp,function(){var e=Hie(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,Rv(void 0,!0);var s=t[r];switch(e.kind){case"keys":return Rv(s.key,!1);case"values":return Rv(s.value,!1)}return Rv([s.key,s.value],!1)},!0),ZM=function(e){this.entries=[],this.url=null,e!==void 0&&(UM(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?Nv(e,0)==="?"?$M(e,1):e:Xs(e)))};ZM.prototype={type:qp,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,s,a,l,u,p,m=this.entries,g=Vie(e);if(g)for(r=(t=VM(e,g)).next;!(s=Cv(r,t)).done;){if(l=(a=VM(Uie(s.value))).next,(u=Cv(l,a)).done||(p=Cv(l,a)).done||!Cv(l,a).done)throw new Gie("Expected sequence with length 2");Cd(m,{key:Xs(u.value),value:Xs(p.value)})}else for(var E in e)Lie(e,E)&&Cd(m,{key:E,value:Xs(e[E])})},parseQuery:function(e){if(e)for(var t,r,s=this.entries,a=YM(e,"&"),l=0;l<a.length;)(t=a[l++]).length&&(r=YM(t,"="),Cd(s,{key:JM($ie(r)),value:JM(zM(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],s=0;s<t.length;)e=t[s++],Cd(r,QM(e.key)+"="+QM(e.value));return zM(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Iv=function(){jM(this,Yp);var e=WM(this,new ZM(arguments.length>0?arguments[0]:void 0));U0||(this.size=e.entries.length)},Yp=Iv.prototype;if(Die(Yp,{append:function(e,t){var r=ga(this);Kp(arguments.length,2),Cd(r.entries,{key:Xs(e),value:Xs(t)}),U0||this.length++,r.updateURL()},delete:function(e){for(var t=ga(this),r=Kp(arguments.length,1),s=t.entries,a=Xs(e),l=r<2?void 0:arguments[1],u=l===void 0?l:Xs(l),p=0;p<s.length;){var m=s[p];if(m.key!==a||u!==void 0&&m.value!==u)p++;else if(qM(s,p,1),u!==void 0)break}U0||(this.size=s.length),t.updateURL()},get:function(e){var t=ga(this).entries;Kp(arguments.length,1);for(var r=Xs(e),s=0;s<t.length;s++)if(t[s].key===r)return t[s].value;return null},getAll:function(e){var t=ga(this).entries;Kp(arguments.length,1);for(var r=Xs(e),s=[],a=0;a<t.length;a++)t[a].key===r&&Cd(s,t[a].value);return s},has:function(e){for(var t=ga(this).entries,r=Kp(arguments.length,1),s=Xs(e),a=r<2?void 0:arguments[1],l=a===void 0?a:Xs(a),u=0;u<t.length;){var p=t[u++];if(p.key===s&&(l===void 0||p.value===l))return!0}return!1},set:function(e,t){var r=ga(this);Kp(arguments.length,1);for(var s,a=r.entries,l=!1,u=Xs(e),p=Xs(t),m=0;m<a.length;m++)(s=a[m]).key===u&&(l?qM(a,m--,1):(l=!0,s.value=p));l||Cd(a,{key:u,value:p}),U0||(this.size=a.length),r.updateURL()},sort:function(){var e=ga(this);Bie(e.entries,function(t,r){return t.key>r.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=ga(this).entries,s=Mie(e,arguments.length>1?arguments[1]:void 0),a=0;a<r.length;)s((t=r[a++]).value,t.key,this)},keys:function(){return new WC(this,"keys")},values:function(){return new WC(this,"values")},entries:function(){return new WC(this,"entries")}},{enumerable:!0}),MM(Yp,Wie,Yp.entries,{name:"entries"}),MM(Yp,"toString",function(){return ga(this).serialize()},{enumerable:!0}),U0&&Oie(Yp,"size",{get:function(){return ga(this).entries.length},configurable:!0,enumerable:!0}),Pie(Iv,qp),jC({global:!0,constructor:!0,forced:!LM},{URLSearchParams:Iv}),!LM&&VC(F0)){var ise=Za(GM.has),sse=Za(GM.set),ej=function(e){if(UM(e)){var t,r=e.body;if(jie(r)===qp)return t=e.headers?new F0(e.headers):new F0,ise(t,"content-type")||sse(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Fie(e,{body:FM(0,Xs(r)),headers:FM(0,t)})}return e};if(VC(HM)&&jC({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return HM(e,arguments.length>1?ej(arguments[1]):{})}}),VC(Av)){var HC=function(e){return jM(this,BC),new Av(e,arguments.length>1?ej(arguments[1]):{})};BC.constructor=HC,HC.prototype=BC,jC({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:HC})}}var _a,ose={URLSearchParams:Iv,getState:ga},ase=$r.URLSearchParams,tj=Oe,cse=R,lse=lt,dse=f,GC=rv,use=R0,hse=He,pse=Ns,fse=hr,$p=Object.assign,nj=Object.defineProperty,mse=cse([].concat),gse=!$p||dse(function(){if(tj&&$p({b:1},$p(nj({},"a",{enumerable:!0,get:function(){nj(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol("assign detection"),s="abcdefghijklmnopqrst";return e[r]=7,s.split("").forEach(function(a){t[a]=a}),$p({},e)[r]!==7||GC($p({},t)).join("")!==s})?function(e,t){for(var r=pse(e),s=arguments.length,a=1,l=use.f,u=hse.f;s>a;)for(var p,m=fse(arguments[a++]),g=l?mse(GC(m),l(m)):GC(m),E=g.length,y=0;E>y;)p=g[y++],tj&&!lse(u,m,p)||(r[p]=m[p]);return r}:$p,_se=es,Ese=H2,vse=Oe,yse=Os,Sse=qe,zC=function(e,t,r){vse?yse.f(e,t,Sse(0,r)):e[t]=r},xse=Xa,Tse=lt,bse=Ns,wse=function(e,t,r,s){try{return s?t(_se(r)[0],r[1]):t(r)}catch(a){Ese(e,"throw",a)}},Cse=V2,Rse=_v,Ase=ts,rj=zC,Nse=Ww,Ise=ov,ij=Array,nh=R,KC=2147483647,Ose=/[^\0-\u007E]/,sj=/[.\u3002\uFF0E\uFF61]/g,oj="Overflow: input needs wider integers to process",aj=RangeError,Dse=nh(sj.exec),Xp=Math.floor,qC=String.fromCharCode,cj=nh("".charCodeAt),lj=nh([].join),Rd=nh([].push),Pse=nh("".replace),kse=nh("".split),Lse=nh("".toLowerCase),dj=function(e){return e+22+75*(e<26)},Mse=function(e,t,r){var s=0;for(e=r?Xp(e/700):e>>1,e+=Xp(e/t);e>455;)e=Xp(e/35),s+=36;return Xp(s+36*e/(e+38))},jse=function(e){var t=[];e=function(q){for(var Y=[],re=0,ce=q.length;re<ce;){var le=cj(q,re++);if(le>=55296&&le<=56319&&re<ce){var ae=cj(q,re++);(64512&ae)==56320?Rd(Y,((1023&le)<<10)+(1023&ae)+65536):(Rd(Y,le),re--)}else Rd(Y,le)}return Y}(e);var r,s,a=e.length,l=128,u=0,p=72;for(r=0;r<e.length;r++)(s=e[r])<128&&Rd(t,qC(s));var m=t.length,g=m;for(m&&Rd(t,"-");g<a;){var E=KC;for(r=0;r<e.length;r++)(s=e[r])>=l&&s<E&&(E=s);var y=g+1;if(E-l>Xp((KC-u)/y))throw new aj(oj);for(u+=(E-l)*y,l=E,r=0;r<e.length;r++){if((s=e[r])<l&&++u>KC)throw new aj(oj);if(s===l){for(var b=u,C=36;;){var B=C<=p?1:C>=p+26?26:C-p;if(b<B)break;var M=b-B,F=36-B;Rd(t,qC(dj(B+M%F))),b=Xp(M/F),C+=36}Rd(t,qC(dj(b))),p=Mse(u,y,g===m),u=0,g++}}u++,l++}return lj(t,"")},Use=yt,YC=Oe,Fse=wv,$C=P,uj=Xa,Ea=R,Ov=xd,va=gv,Vse=eC,XC=ii,JC=gse,Jp=function(e){var t=bse(e),r=Rse(this),s=arguments.length,a=s>1?arguments[1]:void 0,l=a!==void 0;l&&(a=xse(a,s>2?arguments[2]:void 0));var u,p,m,g,E,y,b=Ise(t),C=0;if(!b||this===ij&&Cse(b))for(u=Ase(t),p=r?new this(u):ij(u);u>C;C++)y=l?a(t[C],C):t[C],rj(p,C,y);else for(p=r?new this:[],E=(g=Nse(t,b)).next;!(m=Tse(E,g)).done;C++)y=l?wse(g,a,[m.value,C],!0):m.value,rj(p,C,y);return p.length=C,p},ec=Td,Bse=OC.codeAt,Wse=function(e){var t,r,s=[],a=kse(Pse(Lse(e),sj,"."),".");for(t=0;t<a.length;t++)r=a[t],Rd(s,Dse(Ose,r)?"xn--"+jse(r):r);return lj(s,".")},Nl=Ne,Hse=Al,Gse=Zu,hj=ose,pj=Qu,zse=pj.set,Dv=pj.getterFor("URL"),Kse=hj.URLSearchParams,qse=hj.getState,V0=$C.URL,QC=$C.TypeError,Pv=$C.parseInt,Yse=Math.floor,fj=Math.pow,ya=Ea("".charAt),tc=Ea(/./.exec),B0=Ea([].join),$se=Ea(1 .toString),Xse=Ea([].pop),Qp=Ea([].push),ZC=Ea("".replace),Jse=Ea([].shift),Qse=Ea("".split),W0=Ea("".slice),kv=Ea("".toLowerCase),Zse=Ea([].unshift),eR="Invalid scheme",rh="Invalid host",mj="Invalid port",gj=/[a-z]/i,eoe=/[\d+-.a-z]/i,tR=/\d/,toe=/^0x/i,noe=/^[0-7]+$/,roe=/^\d+$/,_j=/^[\da-f]+$/i,ioe=/[\0\t\n\r #%/:<>?@[\\\]^|]/,soe=/[\0\t\n\r #/:<>?@[\\\]^|]/,ooe=/^[\u0000-\u0020]+/,aoe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,coe=/[\t\n\r]/g,H0=function(e){var t,r,s,a;if(typeof e=="number"){for(t=[],r=0;r<4;r++)Zse(t,e%256),e=Yse(e/256);return B0(t,".")}if(typeof e=="object"){for(t="",s=function(l){for(var u=null,p=1,m=null,g=0,E=0;E<8;E++)l[E]!==0?(g>p&&(u=m,p=g),m=null,g=0):(m===null&&(m=E),++g);return g>p?m:u}(e),r=0;r<8;r++)a&&e[r]===0||(a&&(a=!1),s===r?(t+=r?":":"::",a=!0):(t+=$se(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},Lv={},Ej=JC({},Lv,{" ":1,'"':1,"<":1,">":1,"`":1}),vj=JC({},Ej,{"#":1,"?":1,"{":1,"}":1}),nR=JC({},vj,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ad=function(e,t){var r=Bse(e,0);return r>32&&r<127&&!XC(t,e)?e:encodeURIComponent(e)},Mv={ftp:21,file:null,http:80,https:443,ws:80,wss:443},G0=function(e,t){var r;return e.length===2&&tc(gj,ya(e,0))&&((r=ya(e,1))===":"||!t&&r==="|")},yj=function(e){var t;return e.length>1&&G0(W0(e,0,2))&&(e.length===2||(t=ya(e,2))==="/"||t==="\\"||t==="?"||t==="#")},loe=function(e){return e==="."||kv(e)==="%2e"},rR={},Sj={},iR={},xj={},Tj={},sR={},bj={},wj={},jv={},Uv={},oR={},aR={},cR={},lR={},Cj={},dR={},Zp={},Hc={},Rj={},ih={},Il={},uR=function(e,t,r){var s,a,l,u=Nl(e);if(t){if(a=this.parse(u))throw new QC(a);this.searchParams=null}else{if(r!==void 0&&(s=new uR(r,!0)),a=this.parse(u,null,s))throw new QC(a);(l=qse(new Kse)).bindURL(this),this.searchParams=l}};uR.prototype={type:"URL",parse:function(e,t,r){var s,a,l,u,p,m=this,g=t||rR,E=0,y="",b=!1,C=!1,B=!1;for(e=Nl(e),t||(m.scheme="",m.username="",m.password="",m.host=null,m.port=null,m.path=[],m.query=null,m.fragment=null,m.cannotBeABaseURL=!1,e=ZC(e,ooe,""),e=ZC(e,aoe,"$1")),e=ZC(e,coe,""),s=Jp(e);E<=s.length;){switch(a=s[E],g){case rR:if(!a||!tc(gj,a)){if(t)return eR;g=iR;continue}y+=kv(a),g=Sj;break;case Sj:if(a&&(tc(eoe,a)||a==="+"||a==="-"||a==="."))y+=kv(a);else{if(a!==":"){if(t)return eR;y="",g=iR,E=0;continue}if(t&&(m.isSpecial()!==XC(Mv,y)||y==="file"&&(m.includesCredentials()||m.port!==null)||m.scheme==="file"&&!m.host))return;if(m.scheme=y,t)return void(m.isSpecial()&&Mv[m.scheme]===m.port&&(m.port=null));y="",m.scheme==="file"?g=lR:m.isSpecial()&&r&&r.scheme===m.scheme?g=xj:m.isSpecial()?g=wj:s[E+1]==="/"?(g=Tj,E++):(m.cannotBeABaseURL=!0,Qp(m.path,""),g=Rj)}break;case iR:if(!r||r.cannotBeABaseURL&&a!=="#")return eR;if(r.cannotBeABaseURL&&a==="#"){m.scheme=r.scheme,m.path=ec(r.path),m.query=r.query,m.fragment="",m.cannotBeABaseURL=!0,g=Il;break}g=r.scheme==="file"?lR:sR;continue;case xj:if(a!=="/"||s[E+1]!=="/"){g=sR;continue}g=jv,E++;break;case Tj:if(a==="/"){g=Uv;break}g=Hc;continue;case sR:if(m.scheme=r.scheme,a===_a)m.username=r.username,m.password=r.password,m.host=r.host,m.port=r.port,m.path=ec(r.path),m.query=r.query;else if(a==="/"||a==="\\"&&m.isSpecial())g=bj;else if(a==="?")m.username=r.username,m.password=r.password,m.host=r.host,m.port=r.port,m.path=ec(r.path),m.query="",g=ih;else{if(a!=="#"){m.username=r.username,m.password=r.password,m.host=r.host,m.port=r.port,m.path=ec(r.path),m.path.length--,g=Hc;continue}m.username=r.username,m.password=r.password,m.host=r.host,m.port=r.port,m.path=ec(r.path),m.query=r.query,m.fragment="",g=Il}break;case bj:if(!m.isSpecial()||a!=="/"&&a!=="\\"){if(a!=="/"){m.username=r.username,m.password=r.password,m.host=r.host,m.port=r.port,g=Hc;continue}g=Uv}else g=jv;break;case wj:if(g=jv,a!=="/"||ya(y,E+1)!=="/")continue;E++;break;case jv:if(a!=="/"&&a!=="\\"){g=Uv;continue}break;case Uv:if(a==="@"){b&&(y="%40"+y),b=!0,l=Jp(y);for(var M=0;M<l.length;M++){var F=l[M];if(F!==":"||B){var q=Ad(F,nR);B?m.password+=q:m.username+=q}else B=!0}y=""}else if(a===_a||a==="/"||a==="?"||a==="#"||a==="\\"&&m.isSpecial()){if(b&&y==="")return"Invalid authority";E-=Jp(y).length+1,y="",g=oR}else y+=a;break;case oR:case aR:if(t&&m.scheme==="file"){g=dR;continue}if(a!==":"||C){if(a===_a||a==="/"||a==="?"||a==="#"||a==="\\"&&m.isSpecial()){if(m.isSpecial()&&y==="")return rh;if(t&&y===""&&(m.includesCredentials()||m.port!==null))return;if(u=m.parseHost(y))return u;if(y="",g=Zp,t)return;continue}a==="["?C=!0:a==="]"&&(C=!1),y+=a}else{if(y==="")return rh;if(u=m.parseHost(y))return u;if(y="",g=cR,t===aR)return}break;case cR:if(!tc(tR,a)){if(a===_a||a==="/"||a==="?"||a==="#"||a==="\\"&&m.isSpecial()||t){if(y!==""){var Y=Pv(y,10);if(Y>65535)return mj;m.port=m.isSpecial()&&Y===Mv[m.scheme]?null:Y,y=""}if(t)return;g=Zp;continue}return mj}y+=a;break;case lR:if(m.scheme="file",a==="/"||a==="\\")g=Cj;else{if(!r||r.scheme!=="file"){g=Hc;continue}switch(a){case _a:m.host=r.host,m.path=ec(r.path),m.query=r.query;break;case"?":m.host=r.host,m.path=ec(r.path),m.query="",g=ih;break;case"#":m.host=r.host,m.path=ec(r.path),m.query=r.query,m.fragment="",g=Il;break;default:yj(B0(ec(s,E),""))||(m.host=r.host,m.path=ec(r.path),m.shortenPath()),g=Hc;continue}}break;case Cj:if(a==="/"||a==="\\"){g=dR;break}r&&r.scheme==="file"&&!yj(B0(ec(s,E),""))&&(G0(r.path[0],!0)?Qp(m.path,r.path[0]):m.host=r.host),g=Hc;continue;case dR:if(a===_a||a==="/"||a==="\\"||a==="?"||a==="#"){if(!t&&G0(y))g=Hc;else if(y===""){if(m.host="",t)return;g=Zp}else{if(u=m.parseHost(y))return u;if(m.host==="localhost"&&(m.host=""),t)return;y="",g=Zp}continue}y+=a;break;case Zp:if(m.isSpecial()){if(g=Hc,a!=="/"&&a!=="\\")continue}else if(t||a!=="?")if(t||a!=="#"){if(a!==_a&&(g=Hc,a!=="/"))continue}else m.fragment="",g=Il;else m.query="",g=ih;break;case Hc:if(a===_a||a==="/"||a==="\\"&&m.isSpecial()||!t&&(a==="?"||a==="#")){if((p=kv(p=y))===".."||p==="%2e."||p===".%2e"||p==="%2e%2e"?(m.shortenPath(),a==="/"||a==="\\"&&m.isSpecial()||Qp(m.path,"")):loe(y)?a==="/"||a==="\\"&&m.isSpecial()||Qp(m.path,""):(m.scheme==="file"&&!m.path.length&&G0(y)&&(m.host&&(m.host=""),y=ya(y,0)+":"),Qp(m.path,y)),y="",m.scheme==="file"&&(a===_a||a==="?"||a==="#"))for(;m.path.length>1&&m.path[0]==="";)Jse(m.path);a==="?"?(m.query="",g=ih):a==="#"&&(m.fragment="",g=Il)}else y+=Ad(a,vj);break;case Rj:a==="?"?(m.query="",g=ih):a==="#"?(m.fragment="",g=Il):a!==_a&&(m.path[0]+=Ad(a,Lv));break;case ih:t||a!=="#"?a!==_a&&(a==="'"&&m.isSpecial()?m.query+="%27":m.query+=a==="#"?"%23":Ad(a,Lv)):(m.fragment="",g=Il);break;case Il:a!==_a&&(m.fragment+=Ad(a,Ej))}E++}},parseHost:function(e){var t,r,s;if(ya(e,0)==="["){if(ya(e,e.length-1)!=="]"||(t=function(a){var l,u,p,m,g,E,y,b=[0,0,0,0,0,0,0,0],C=0,B=null,M=0,F=function(){return ya(a,M)};if(F()===":"){if(ya(a,1)!==":")return;M+=2,B=++C}for(;F();){if(C===8)return;if(F()!==":"){for(l=u=0;u<4&&tc(_j,F());)l=16*l+Pv(F(),16),M++,u++;if(F()==="."){if(u===0||(M-=u,C>6))return;for(p=0;F();){if(m=null,p>0){if(!(F()==="."&&p<4))return;M++}if(!tc(tR,F()))return;for(;tc(tR,F());){if(g=Pv(F(),10),m===null)m=g;else{if(m===0)return;m=10*m+g}if(m>255)return;M++}b[C]=256*b[C]+m,++p!=2&&p!==4||C++}if(p!==4)return;break}if(F()===":"){if(M++,!F())return}else if(F())return;b[C++]=l}else{if(B!==null)return;M++,B=++C}}if(B!==null)for(E=C-B,C=7;C!==0&&E>0;)y=b[C],b[C--]=b[B+E-1],b[B+--E]=y;else if(C!==8)return;return b}(W0(e,1,-1)),!t))return rh;this.host=t}else if(this.isSpecial()){if(e=Wse(e),tc(ioe,e)||(t=function(a){var l,u,p,m,g,E,y,b=Qse(a,".");if(b.length&&b[b.length-1]===""&&b.length--,(l=b.length)>4)return a;for(u=[],p=0;p<l;p++){if((m=b[p])==="")return a;if(g=10,m.length>1&&ya(m,0)==="0"&&(g=tc(toe,m)?16:8,m=W0(m,g===8?1:2)),m==="")E=0;else{if(!tc(g===10?roe:g===8?noe:_j,m))return a;E=Pv(m,g)}Qp(u,E)}for(p=0;p<l;p++)if(E=u[p],p===l-1){if(E>=fj(256,5-l))return null}else if(E>255)return null;for(y=Xse(u),p=0;p<u.length;p++)y+=u[p]*fj(256,3-p);return y}(e),t===null))return rh;this.host=t}else{if(tc(soe,e))return rh;for(t="",r=Jp(e),s=0;s<r.length;s++)t+=Ad(r[s],Lv);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return XC(Mv,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||this.scheme==="file"&&t===1&&G0(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,s=e.password,a=e.host,l=e.port,u=e.path,p=e.query,m=e.fragment,g=t+":";return a!==null?(g+="//",e.includesCredentials()&&(g+=r+(s?":"+s:"")+"@"),g+=H0(a),l!==null&&(g+=":"+l)):t==="file"&&(g+="//"),g+=e.cannotBeABaseURL?u[0]:u.length?"/"+B0(u,"/"):"",p!==null&&(g+="?"+p),m!==null&&(g+="#"+m),g},setHref:function(e){var t=this.parse(e);if(t)throw new QC(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e==="blob")try{return new ef(e.path[0]).origin}catch{return"null"}return e!=="file"&&this.isSpecial()?e+"://"+H0(this.host)+(t!==null?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Nl(e)+":",rR)},getUsername:function(){return this.username},setUsername:function(e){var t=Jp(Nl(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Ad(t[r],nR)}},getPassword:function(){return this.password},setPassword:function(e){var t=Jp(Nl(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Ad(t[r],nR)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?H0(e):H0(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,oR)},getHostname:function(){var e=this.host;return e===null?"":H0(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,aR)},getPort:function(){var e=this.port;return e===null?"":Nl(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=Nl(e))===""?this.port=null:this.parse(e,cR))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+B0(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Zp))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=Nl(e))===""?this.query=null:(ya(e,0)==="?"&&(e=W0(e,1)),this.query="",this.parse(e,ih)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=Nl(e))!==""?(ya(e,0)==="#"&&(e=W0(e,1)),this.fragment="",this.parse(e,Il)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ef=function(e){var t=Vse(this,Js),r=Gse(arguments.length,1)>1?arguments[1]:void 0,s=zse(t,new uR(e,!1,r));YC||(t.href=s.serialize(),t.origin=s.getOrigin(),t.protocol=s.getProtocol(),t.username=s.getUsername(),t.password=s.getPassword(),t.host=s.getHost(),t.hostname=s.getHostname(),t.port=s.getPort(),t.pathname=s.getPathname(),t.search=s.getSearch(),t.searchParams=s.getSearchParams(),t.hash=s.getHash())},Js=ef.prototype,Sa=function(e,t){return{get:function(){return Dv(this)[e]()},set:t&&function(r){return Dv(this)[t](r)},configurable:!0,enumerable:!0}};if(YC&&(va(Js,"href",Sa("serialize","setHref")),va(Js,"origin",Sa("getOrigin")),va(Js,"protocol",Sa("getProtocol","setProtocol")),va(Js,"username",Sa("getUsername","setUsername")),va(Js,"password",Sa("getPassword","setPassword")),va(Js,"host",Sa("getHost","setHost")),va(Js,"hostname",Sa("getHostname","setHostname")),va(Js,"port",Sa("getPort","setPort")),va(Js,"pathname",Sa("getPathname","setPathname")),va(Js,"search",Sa("getSearch","setSearch")),va(Js,"searchParams",Sa("getSearchParams")),va(Js,"hash",Sa("getHash","setHash"))),Ov(Js,"toJSON",function(){return Dv(this).serialize()},{enumerable:!0}),Ov(Js,"toString",function(){return Dv(this).serialize()},{enumerable:!0}),V0){var Aj=V0.createObjectURL,Nj=V0.revokeObjectURL;Aj&&Ov(ef,"createObjectURL",uj(Aj,V0)),Nj&&Ov(ef,"revokeObjectURL",uj(Nj,V0))}Hse(ef,"URL"),Use({global:!0,constructor:!0,forced:!Fse,sham:!YC},{URL:ef});var doe=yt,Ij=f,uoe=Zu,Oj=Ne,hoe=wv,hR=ot("URL"),poe=hoe&&Ij(function(){hR.canParse()}),foe=Ij(function(){return hR.canParse.length!==1});doe({target:"URL",stat:!0,forced:!poe||foe},{canParse:function(e){var t=uoe(arguments.length,1),r=Oj(e),s=t<2||arguments[1]===void 0?void 0:Oj(arguments[1]);try{return!!new hR(r,s)}catch{return!1}}});var moe=yt,goe=Zu,Dj=Ne,_oe=wv,Eoe=ot("URL");moe({target:"URL",stat:!0,forced:!_oe},{parse:function(e){var t=goe(arguments.length,1),r=Dj(e),s=t<2||arguments[1]===void 0?void 0:Dj(arguments[1]);try{return new Eoe(r,s)}catch{return null}}});var Fv=d($r.URL);let Pj=!0,kj=!0;function Vv(e,t,r){const s=e.match(t);return s&&s.length>=r&&parseInt(s[r],10)}function sh(e,t,r){if(!e.RTCPeerConnection)return;const s=e.RTCPeerConnection.prototype,a=s.addEventListener;s.addEventListener=function(u,p){if(u!==t)return a.apply(this,arguments);const m=g=>{const E=r(g);E&&(p.handleEvent?p.handleEvent(E):p(E))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(p,m),a.apply(this,[u,m])};const l=s.removeEventListener;s.removeEventListener=function(u,p){if(u!==t||!this._eventMap||!this._eventMap[t])return l.apply(this,arguments);if(!this._eventMap[t].has(p))return l.apply(this,arguments);const m=this._eventMap[t].get(p);return this._eventMap[t].delete(p),this._eventMap[t].size===0&&delete this._eventMap[t],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[u,m])},Object.defineProperty(s,"on"+t,{get(){return this["_on"+t]},set(u){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),u&&this.addEventListener(t,this["_on"+t]=u)},enumerable:!0,configurable:!0})}function voe(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(Pj=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function yoe(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(kj=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Lj(){if(typeof window=="object"){if(Pj)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function pR(e,t){kj&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Mj(e){return Object.prototype.toString.call(e)==="[object Object]"}function jj(e){var t;return Mj(e)?ma(t=Object.keys(e)).call(t,function(r,s){const a=Mj(e[s]),l=a?jj(e[s]):e[s],u=a&&!Object.keys(l).length;return l===void 0||u?r:Object.assign(r,{[s]:l})},{}):e}function fR(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach(s=>{s.endsWith("Id")?fR(e,e.get(t[s]),r):s.endsWith("Ids")&&t[s].forEach(a=>{fR(e,e.get(a),r)})}))}function Uj(e,t,r){const s=r?"outbound-rtp":"inbound-rtp",a=new Map;if(t===null)return a;const l=[];return e.forEach(u=>{u.type==="track"&&u.trackIdentifier===t.id&&l.push(u)}),l.forEach(u=>{e.forEach(p=>{p.type===s&&p.trackId===u.id&&fR(e,p,a)})}),a}const Fj=Lj;function Vj(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const s=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const p={};return Object.keys(u).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const g=typeof u[m]=="object"?u[m]:{ideal:u[m]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const E=function(y,b){return y?y+b.charAt(0).toUpperCase()+b.slice(1):b==="deviceId"?"sourceId":b};if(g.ideal!==void 0){p.optional=p.optional||[];let y={};typeof g.ideal=="number"?(y[E("min",m)]=g.ideal,p.optional.push(y),y={},y[E("max",m)]=g.ideal,p.optional.push(y)):(y[E("",m)]=g.ideal,p.optional.push(y))}g.exact!==void 0&&typeof g.exact!="number"?(p.mandatory=p.mandatory||{},p.mandatory[E("",m)]=g.exact):["min","max"].forEach(y=>{g[y]!==void 0&&(p.mandatory=p.mandatory||{},p.mandatory[E(y,m)]=g[y])})}),u.advanced&&(p.optional=(p.optional||[]).concat(u.advanced)),p},a=function(u,p){if(t.version>=61)return p(u);if((u=JSON.parse(JSON.stringify(u)))&&typeof u.audio=="object"){const m=function(g,E,y){E in g&&!(y in g)&&(g[y]=g[E],delete g[E])};m((u=JSON.parse(JSON.stringify(u))).audio,"autoGainControl","googAutoGainControl"),m(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=s(u.audio)}if(u&&typeof u.video=="object"){let m=u.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const g=t.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||g)){let E;if(delete u.video.facingMode,m.exact==="environment"||m.ideal==="environment"?E=["back","rear"]:m.exact!=="user"&&m.ideal!=="user"||(E=["front"]),E)return r.mediaDevices.enumerateDevices().then(y=>{let b=(y=y.filter(C=>C.kind==="videoinput")).find(C=>E.some(B=>{var M;return je(M=C.label.toLowerCase()).call(M,B)}));return!b&&y.length&&je(E).call(E,"back")&&(b=y[y.length-1]),b&&(u.video.deviceId=m.exact?{exact:b.deviceId}:{ideal:b.deviceId}),u.video=s(u.video),Fj("chrome: "+JSON.stringify(u)),p(u)})}u.video=s(u.video)}return Fj("chrome: "+JSON.stringify(u)),p(u)},l=function(u){return t.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(u,p,m){a(u,g=>{r.webkitGetUserMedia(g,p,E=>{m&&m(l(E))})})}).bind(r),r.mediaDevices.getUserMedia){const u=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(p){return a(p,m=>u(m).then(g=>{if(m.audio&&!g.getAudioTracks().length||m.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(E=>{E.stop()}),new DOMException("","NotFoundError");return g},g=>Ye.reject(l(g))))}}}function Bj(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Wj(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",s=>{let a;a=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(u=>u.track&&u.track.id===s.track.id):{track:s.track};const l=new Event("track");l.track=s.track,l.receiver=a,l.transceiver={receiver:a},l.streams=[r.stream],this.dispatchEvent(l)}),r.stream.getTracks().forEach(s=>{let a;a=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(u=>u.track&&u.track.id===s.id):{track:s};const l=new Event("track");l.track=s,l.receiver=a,l.transceiver={receiver:a},l.streams=[r.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else sh(e,"track",t=>(t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t))}function Hj(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(a,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=a.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:a}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(u,p){let m=a.apply(this,arguments);return m||(m=t(this,u),this._senders.push(m)),m};const l=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(u){l.apply(this,arguments);const p=this._senders.indexOf(u);p!==-1&&this._senders.splice(p,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(l=>{this._senders.push(t(this,l))})};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],s.apply(this,[a]),a.getTracks().forEach(l=>{const u=this._senders.find(p=>p.track===l);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Gj(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,s,a]=arguments;if(arguments.length>0&&typeof r=="function")return t.apply(this,arguments);if(t.length===0&&(arguments.length===0||typeof r!="function"))return t.apply(this,[]);const l=function(p){const m={};return p.result().forEach(g=>{const E={id:g.id,timestamp:g.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[g.type]||g.type};g.names().forEach(y=>{E[y]=g.stat(y)}),m[E.id]=E}),m},u=function(p){return new Map(Object.keys(p).map(m=>[m,p[m]]))};if(arguments.length>=2){const p=function(m){s(u(l(m)))};return t.apply(this,[p,r])}return new Ye((p,m)=>{t.apply(this,[function(g){p(u(l(g)))},m])}).then(s,a)}}function zj(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const a=r.apply(this,[]);return a.forEach(l=>l._pc=this),a});const s=e.RTCPeerConnection.prototype.addTrack;s&&(e.RTCPeerConnection.prototype.addTrack=function(){const a=s.apply(this,arguments);return a._pc=this,a}),e.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>Uj(l,a.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const s=r.apply(this,[]);return s.forEach(a=>a._pc=this),s}),sh(e,"track",s=>(s.receiver._pc=s.srcElement,s)),e.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>Uj(a,s.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let s,a,l;return this.getSenders().forEach(u=>{u.track===r&&(s?l=!0:s=u)}),this.getReceivers().forEach(u=>(u.track===r&&(a?l=!0:a=u),u.track===r)),l||s&&a?Ye.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():a?a.getStats():Ye.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Kj(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(l,u){if(!u)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const p=t.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(p)===-1&&this._shimmedLocalStreams[u.id].push(p):this._shimmedLocalStreams[u.id]=[u,p],p};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(m=>{if(this.getSenders().find(E=>E.track===m))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();r.apply(this,arguments);const p=this.getSenders().filter(m=>u.indexOf(m)===-1);this._shimmedLocalStreams[l.id]=[l].concat(p)};const s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],s.apply(this,arguments)};const a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const p=this._shimmedLocalStreams[u].indexOf(l);p!==-1&&this._shimmedLocalStreams[u].splice(p,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),a.apply(this,arguments)}}function qj(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Kj(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const m=r.apply(this);return this._reverseStreams=this._reverseStreams||{},m.map(g=>this._reverseStreams[g.id])};const s=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(m){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},m.getTracks().forEach(g=>{if(this.getSenders().find(y=>y.track===g))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[m.id]){const g=new e.MediaStream(m.getTracks());this._streams[m.id]=g,this._reverseStreams[g.id]=m,m=g}s.apply(this,[m])};const a=e.RTCPeerConnection.prototype.removeStream;function l(m,g){let E=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(y=>{const b=m._reverseStreams[y],C=m._streams[b.id];E=E.replace(new RegExp(C.id,"g"),b.id)}),new RTCSessionDescription({type:g.type,sdp:E})}e.RTCPeerConnection.prototype.removeStream=function(m){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[m.id]||m]),delete this._reverseStreams[this._streams[m.id]?this._streams[m.id].id:m.id],delete this._streams[m.id]},e.RTCPeerConnection.prototype.addTrack=function(m,g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const E=[].slice.call(arguments,1);if(E.length!==1||!E[0].getTracks().find(C=>C===m))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(C=>C.track===m))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const b=this._streams[g.id];if(b)b.addTrack(m),Ye.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const C=new e.MediaStream([m]);this._streams[g.id]=C,this._reverseStreams[C.id]=g,this.addStream(C)}return this.getSenders().find(C=>C.track===m)},["createOffer","createAnswer"].forEach(function(m){const g=e.RTCPeerConnection.prototype[m],E={[m](){const y=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[b=>{const C=l(this,b);y[0].apply(null,[C])},b=>{y[1]&&y[1].apply(null,b)},arguments[2]]):g.apply(this,arguments).then(b=>l(this,b))}};e.RTCPeerConnection.prototype[m]=E[m]});const u=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(m,g){let E=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(y=>{const b=m._reverseStreams[y],C=m._streams[b.id];E=E.replace(new RegExp(b.id,"g"),C.id)}),new RTCSessionDescription({type:g.type,sdp:E})}(this,arguments[0]),u.apply(this,arguments)):u.apply(this,arguments)};const p=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const m=p.get.apply(this);return m.type===""?m:l(this,m)}}),e.RTCPeerConnection.prototype.removeTrack=function(m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!m._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(m._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let g;this._streams=this._streams||{},Object.keys(this._streams).forEach(E=>{this._streams[E].getTracks().find(y=>m.track===y)&&(g=this._streams[E])}),g&&(g.getTracks().length===1?this.removeStream(this._reverseStreams[g.id]):g.removeTrack(m.track),this.dispatchEvent(new Event("negotiationneeded")))}}function mR(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=e.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=a[r]})}function Yj(e,t){sh(e,"negotiationneeded",r=>{const s=r.target;if(!(t.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")||s.signalingState==="stable")return r})}var $j=Object.freeze({__proto__:null,fixNegotiationNeeded:Yj,shimAddTrackRemoveTrack:qj,shimAddTrackRemoveTrackWithNative:Kj,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof t=="function"?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(s=>{const a=r.video&&r.video.width,l=r.video&&r.video.height,u=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:u||3}},a&&(r.video.mandatory.maxWidth=a),l&&(r.video.mandatory.maxHeight=l),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:Hj,shimGetStats:Gj,shimGetUserMedia:Vj,shimMediaStream:Bj,shimOnTrack:Wj,shimPeerConnection:mR,shimSenderReceiverGetStats:zj});function Xj(e,t){const r=e&&e.navigator,s=e&&e.MediaStreamTrack;if(r.getUserMedia=function(a,l,u){pR("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(a).then(l,u)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const a=function(u,p,m){p in u&&!(m in u)&&(u[m]=u[p],delete u[p])},l=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),a(u.audio,"autoGainControl","mozAutoGainControl"),a(u.audio,"noiseSuppression","mozNoiseSuppression")),l(u)},s&&s.prototype.getSettings){const u=s.prototype.getSettings;s.prototype.getSettings=function(){const p=u.apply(this,arguments);return a(p,"mozAutoGainControl","autoGainControl"),a(p,"mozNoiseSuppression","noiseSuppression"),p}}if(s&&s.prototype.applyConstraints){const u=s.prototype.applyConstraints;s.prototype.applyConstraints=function(p){return this.kind==="audio"&&typeof p=="object"&&(p=JSON.parse(JSON.stringify(p)),a(p,"autoGainControl","mozAutoGainControl"),a(p,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[p])}}}}function Jj(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function gR(e,t){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const l=e.RTCPeerConnection.prototype[a],u={[a](){return arguments[0]=new(a==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};e.RTCPeerConnection.prototype[a]=u[a]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[a,l,u]=arguments;return s.apply(this,[a||null]).then(p=>{if(t.version<53&&!l)try{p.forEach(m=>{m.type=r[m.type]||m.type})}catch(m){if(m.name!=="TypeError")throw m;p.forEach((g,E)=>{p.set(E,Object.assign({},g,{type:r[g.type]||g.type}))})}return p}).then(l,u)}}function Qj(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(a=>a._pc=this),s});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Ye.resolve(new Map)}}function Zj(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=t.apply(this,[]);return r.forEach(s=>s._pc=this),r}),sh(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function eU(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(t){pR("removeStream","removeTrack"),this.getSenders().forEach(r=>{var s;r.track&&je(s=t.getTracks()).call(s,r.track)&&this.removeTrack(r)})})}function tU(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function nU(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const s=r.length>0;s&&r.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=t.apply(this,arguments);if(s){const{sender:l}=a,u=l.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=r,l.sendEncodings=r,this.setParametersPromises.push(l.setParameters(u).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return a})}function rU(e){if(typeof e!="object"||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const r=t.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function iU(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ye.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function sU(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Ye.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var oU=Object.freeze({__proto__:null,shimAddTransceiver:nU,shimCreateAnswer:sU,shimCreateOffer:iU,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Ye.reject(s)}return r.video===!0?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})},shimGetParameters:rU,shimGetUserMedia:Xj,shimOnTrack:Jj,shimPeerConnection:gR,shimRTCDataChannel:tU,shimReceiverGetStats:Zj,shimRemoveStream:eU,shimSenderGetStats:Qj});function aU(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){var s;this._localStreams||(this._localStreams=[]),je(s=this._localStreams).call(s,r)||this._localStreams.push(r),r.getAudioTracks().forEach(a=>t.call(this,a,r)),r.getVideoTracks().forEach(a=>t.call(this,a,r))},e.RTCPeerConnection.prototype.addTrack=function(r){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return a&&a.forEach(u=>{var p;this._localStreams?je(p=this._localStreams).call(p,u)||this._localStreams.push(u):this._localStreams=[u]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const s=t.getTracks();this.getSenders().forEach(a=>{je(s).call(s,a.track)&&this.removeTrack(a)})})}}function cU(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(a=>{var l;if(this._remoteStreams||(this._remoteStreams=[]),je(l=this._remoteStreams).call(l,a))return;this._remoteStreams.push(a);const u=new Event("addstream");u.stream=a,this.dispatchEvent(u)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(a=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(a)>=0)return;r._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,r.dispatchEvent(l)})}),t.apply(r,arguments)}}}function lU(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,s=t.createAnswer,a=t.setLocalDescription,l=t.setRemoteDescription,u=t.addIceCandidate;t.createOffer=function(m,g){const E=arguments.length>=2?arguments[2]:arguments[0],y=r.apply(this,[E]);return g?(y.then(m,g),Ye.resolve()):y},t.createAnswer=function(m,g){const E=arguments.length>=2?arguments[2]:arguments[0],y=s.apply(this,[E]);return g?(y.then(m,g),Ye.resolve()):y};let p=function(m,g,E){const y=a.apply(this,[m]);return E?(y.then(g,E),Ye.resolve()):y};t.setLocalDescription=p,p=function(m,g,E){const y=l.apply(this,[m]);return E?(y.then(g,E),Ye.resolve()):y},t.setRemoteDescription=p,p=function(m,g,E){const y=u.apply(this,[m]);return E?(y.then(g,E),Ye.resolve()):y},t.addIceCandidate=p}function dU(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const r=t.mediaDevices,s=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=a=>s(uU(a))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(r,s,a){t.mediaDevices.getUserMedia(r).then(s,a)}).bind(t))}function uU(e){return e&&e.video!==void 0?Object.assign({},e,{video:jj(e.video)}):e}function hU(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(r,s){if(r&&r.iceServers){const a=[];for(let l=0;l<r.iceServers.length;l++){let u=r.iceServers[l];!u.hasOwnProperty("urls")&&u.hasOwnProperty("url")?(pR("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,a.push(u)):a.push(r.iceServers[l])}r.iceServers=a}return new t(r,s)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function pU(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fU(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const s=this.getTransceivers().find(l=>l.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveAudio!==!0||s||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const a=this.getTransceivers().find(l=>l.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):r.offerToReceiveVideo!==!0||a||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function mU(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var gU=Object.freeze({__proto__:null,shimAudioContext:mU,shimCallbacksAPI:lU,shimConstraints:uU,shimCreateOfferLegacy:fU,shimGetUserMedia:dU,shimLocalStreamsAPI:aU,shimRTCIceServerUrls:hU,shimRemoteStreamsAPI:cU,shimTrackEventTransceiver:pU}),_U=`	
\v\f\r \u2028\u2029\uFEFF`,Soe=cr,xoe=Ne,_R=_U,EU=R("".replace),Toe=RegExp("^["+_R+"]+"),boe=RegExp("(^|[^"+_R+"])["+_R+"]+$"),ER=function(e){return function(t){var r=xoe(Soe(t));return 1&e&&(r=EU(r,Toe,"")),2&e&&(r=EU(r,boe,"$1")),r}},woe={start:ER(1),end:ER(2),trim:ER(3)},Coe=eL.PROPER,Roe=f,vU=_U,Aoe=woe.trim;yt({target:"String",proto:!0,forced:function(e){return Roe(function(){return!!vU[e]()||""[e]()!==""||Coe&&vU[e].name!==e})}("trim")},{trim:function(){return Aoe(this)}});var Noe=ho("String","trim"),Ioe=I,Ooe=Noe,vR=String.prototype,Doe=function(e){var t=e.trim;return typeof e=="string"||e===vR||Ioe(vR,e)&&t===vR.trim?Ooe:t},zi=d(Doe),yU={exports:{}};(function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(r){return r.trim().split(`
`).map(s=>s.trim())},t.splitSections=function(r){return r.split(`
m=`).map((s,a)=>(a>0?"m="+s:s).trim()+`\r
`)},t.getDescription=function(r){const s=t.splitSections(r);return s&&s[0]},t.getMediaSections=function(r){const s=t.splitSections(r);return s.shift(),s},t.matchPrefix=function(r,s){return t.splitLines(r).filter(a=>a.indexOf(s)===0)},t.parseCandidate=function(r){let s;s=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");const a={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":a.relatedAddress=s[l+1];break;case"rport":a.relatedPort=parseInt(s[l+1],10);break;case"tcptype":a.tcpType=s[l+1];break;case"ufrag":a.ufrag=s[l+1],a.usernameFragment=s[l+1];break;default:a[s[l]]===void 0&&(a[s[l]]=s[l+1])}return a},t.writeCandidate=function(r){const s=[];s.push(r.foundation);const a=r.component;a==="rtp"?s.push(1):a==="rtcp"?s.push(2):s.push(a),s.push(r.protocol.toUpperCase()),s.push(r.priority),s.push(r.address||r.ip),s.push(r.port);const l=r.type;return s.push("typ"),s.push(l),l!=="host"&&r.relatedAddress&&r.relatedPort&&(s.push("raddr"),s.push(r.relatedAddress),s.push("rport"),s.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(s.push("ufrag"),s.push(r.usernameFragment||r.ufrag)),"candidate:"+s.join(" ")},t.parseIceOptions=function(r){return r.substring(14).split(" ")},t.parseRtpMap=function(r){let s=r.substring(9).split(" ");const a={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),a.name=s[0],a.clockRate=parseInt(s[1],10),a.channels=s.length===3?parseInt(s[2],10):1,a.numChannels=a.channels,a},t.writeRtpMap=function(r){let s=r.payloadType;r.preferredPayloadType!==void 0&&(s=r.preferredPayloadType);const a=r.channels||r.numChannels||1;return"a=rtpmap:"+s+" "+r.name+"/"+r.clockRate+(a!==1?"/"+a:"")+`\r
`},t.parseExtmap=function(r){const s=r.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},t.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},t.parseFmtp=function(r){const s={};let a;const l=r.substring(r.indexOf(" ")+1).split(";");for(let u=0;u<l.length;u++)a=l[u].trim().split("="),s[a[0].trim()]=a[1];return s},t.writeFmtp=function(r){let s="",a=r.payloadType;if(r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const l=[];Object.keys(r.parameters).forEach(u=>{r.parameters[u]!==void 0?l.push(u+"="+r.parameters[u]):l.push(u)}),s+="a=fmtp:"+a+" "+l.join(";")+`\r
`}return s},t.parseRtcpFb=function(r){const s=r.substring(r.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},t.writeRtcpFb=function(r){let s="",a=r.payloadType;return r.preferredPayloadType!==void 0&&(a=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+a+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},t.parseSsrcMedia=function(r){const s=r.indexOf(" "),a={ssrc:parseInt(r.substring(7,s),10)},l=r.indexOf(":",s);return l>-1?(a.attribute=r.substring(s+1,l),a.value=r.substring(l+1)):a.attribute=r.substring(s+1),a},t.parseSsrcGroup=function(r){const s=r.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(a=>parseInt(a,10))}},t.getMid=function(r){const s=t.matchPrefix(r,"a=mid:")[0];if(s)return s.substring(6)},t.parseFingerprint=function(r){const s=r.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},t.getDtlsParameters=function(r,s){return{role:"auto",fingerprints:t.matchPrefix(r+s,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(r,s){let a="a=setup:"+s+`\r
`;return r.fingerprints.forEach(l=>{a+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),a},t.parseCryptoLine=function(r){const s=r.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},t.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?t.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},t.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const s=r.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},t.getCryptoParameters=function(r,s){return t.matchPrefix(r+s,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(r,s){const a=t.matchPrefix(r+s,"a=ice-ufrag:")[0],l=t.matchPrefix(r+s,"a=ice-pwd:")[0];return a&&l?{usernameFragment:a.substring(12),password:l.substring(10)}:null},t.writeIceParameters=function(r){let s="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(s+=`a=ice-lite\r
`),s},t.parseRtpParameters=function(r){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=t.splitLines(r)[0].split(" ");s.profile=a[2];for(let u=3;u<a.length;u++){const p=a[u],m=t.matchPrefix(r,"a=rtpmap:"+p+" ")[0];if(m){const g=t.parseRtpMap(m),E=t.matchPrefix(r,"a=fmtp:"+p+" ");switch(g.parameters=E.length?t.parseFmtp(E[0]):{},g.rtcpFeedback=t.matchPrefix(r,"a=rtcp-fb:"+p+" ").map(t.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase())}}}t.matchPrefix(r,"a=extmap:").forEach(u=>{s.headerExtensions.push(t.parseExtmap(u))});const l=t.matchPrefix(r,"a=rtcp-fb:* ").map(t.parseRtcpFb);return s.codecs.forEach(u=>{l.forEach(p=>{u.rtcpFeedback.find(m=>m.type===p.type&&m.parameter===p.parameter)||u.rtcpFeedback.push(p)})}),s},t.writeRtpDescription=function(r,s){let a="";a+="m="+r+" ",a+=s.codecs.length>0?"9":"0",a+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=s.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(u=>{a+=t.writeRtpMap(u),a+=t.writeFmtp(u),a+=t.writeRtcpFb(u)});let l=0;return s.codecs.forEach(u=>{u.maxptime>l&&(l=u.maxptime)}),l>0&&(a+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(u=>{a+=t.writeExtmap(u)}),a},t.parseRtpEncodingParameters=function(r){const s=[],a=t.parseRtpParameters(r),l=a.fecMechanisms.indexOf("RED")!==-1,u=a.fecMechanisms.indexOf("ULPFEC")!==-1,p=t.matchPrefix(r,"a=ssrc:").map(b=>t.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),m=p.length>0&&p[0].ssrc;let g;const E=t.matchPrefix(r,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(C=>parseInt(C,10)));E.length>0&&E[0].length>1&&E[0][0]===m&&(g=E[0][1]),a.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let C={ssrc:m,codecPayloadType:parseInt(b.parameters.apt,10)};m&&g&&(C.rtx={ssrc:g}),s.push(C),l&&(C=JSON.parse(JSON.stringify(C)),C.fec={ssrc:m,mechanism:u?"red+ulpfec":"red"},s.push(C))}}),s.length===0&&m&&s.push({ssrc:m});let y=t.matchPrefix(r,"b=");return y.length&&(y=y[0].indexOf("b=TIAS:")===0?parseInt(y[0].substring(7),10):y[0].indexOf("b=AS:")===0?1e3*parseInt(y[0].substring(5),10)*.95-16e3:void 0,s.forEach(b=>{b.maxBitrate=y})),s},t.parseRtcpParameters=function(r){const s={},a=t.matchPrefix(r,"a=ssrc:").map(p=>t.parseSsrcMedia(p)).filter(p=>p.attribute==="cname")[0];a&&(s.cname=a.value,s.ssrc=a.ssrc);const l=t.matchPrefix(r,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const u=t.matchPrefix(r,"a=rtcp-mux");return s.mux=u.length>0,s},t.writeRtcpParameters=function(r){let s="";return r.reducedSize&&(s+=`a=rtcp-rsize\r
`),r.mux&&(s+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(s+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),s},t.parseMsid=function(r){let s;const a=t.matchPrefix(r,"a=msid:");if(a.length===1)return s=a[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=t.matchPrefix(r,"a=ssrc:").map(u=>t.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");return l.length>0?(s=l[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},t.parseSctpDescription=function(r){const s=t.parseMLine(r),a=t.matchPrefix(r,"a=max-message-size:");let l;a.length>0&&(l=parseInt(a[0].substring(19),10)),isNaN(l)&&(l=65536);const u=t.matchPrefix(r,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const p=t.matchPrefix(r,"a=sctpmap:");if(p.length>0){const m=p[0].substring(10).split(" ");return{port:parseInt(m[0],10),protocol:m[1],maxMessageSize:l}}},t.writeSctpDescription=function(r,s){let a=[];return a=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&a.push("a=max-message-size:"+s.maxMessageSize+`\r
`),a.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(r,s,a){let l;const u=s!==void 0?s:2;return l=r||t.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+l+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},t.getDirection=function(r,s){const a=t.splitLines(r);for(let l=0;l<a.length;l++)switch(a[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[l].substring(2)}return s?t.getDirection(s):"sendrecv"},t.getKind=function(r){return t.splitLines(r)[0].split(" ")[0].substring(2)},t.isRejected=function(r){return r.split(" ",2)[1]==="0"},t.parseMLine=function(r){const s=t.splitLines(r)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},t.parseOLine=function(r){const s=t.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},t.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const s=t.splitLines(r);for(let a=0;a<s.length;a++)if(s[a].length<2||s[a].charAt(1)!=="=")return!1;return!0},e.exports=t})(yU);var SU=yU.exports,tf=d(SU),Poe=o({__proto__:null,default:tf},[SU]);function Bv(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substr(2)),r.candidate&&r.candidate.length){const s=new t(r),a=tf.parseCandidate(r.candidate),l=Object.assign(s,a);return l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}},l}return new t(r)},e.RTCIceCandidate.prototype=t.prototype,sh(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function yR(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||sh(e,"icecandidate",t=>{if(t.candidate){const r=tf.parseCandidate(t.candidate.candidate);r.type==="relay"&&(t.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return t})}function Wv(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const r=function(p){if(!p||!p.sdp)return!1;const m=tf.splitSections(p.sdp);return m.shift(),m.some(g=>{const E=tf.parseMLine(g);return E&&E.kind==="application"&&E.protocol.indexOf("SCTP")!==-1})},s=function(p){const m=p.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(m===null||m.length<2)return-1;const g=parseInt(m[1],10);return g!=g?-1:g},a=function(p){let m=65536;return t.browser==="firefox"&&(m=t.version<57?p===-1?16384:2147483637:t.version<60?t.version===57?65535:65536:2147483637),m},l=function(p,m){let g=65536;t.browser==="firefox"&&t.version===57&&(g=65535);const E=tf.matchPrefix(p.sdp,"a=max-message-size:");return E.length>0?g=parseInt(E[0].substr(19),10):t.browser==="firefox"&&m!==-1&&(g=2147483637),g},u=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,t.browser==="chrome"&&t.version>=76){const{sdpSemantics:p}=this.getConfiguration();p==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const p=s(arguments[0]),m=a(p),g=l(arguments[0],p);let E;E=m===0&&g===0?Number.POSITIVE_INFINITY:m===0||g===0?Math.max(m,g):Math.min(m,g);const y={};Object.defineProperty(y,"maxMessageSize",{get:()=>E}),this._sctp=y}return u.apply(this,arguments)}}function Hv(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(s,a){const l=s.send;s.send=function(){const u=arguments[0],p=u.length||u.size||u.byteLength;if(s.readyState==="open"&&a.sctp&&p>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const s=r.apply(this,arguments);return t(s,this),s},sh(e,"datachannel",s=>(t(s.channel,s.target),s))}function SR(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const s=t[r];t[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const l=a.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const u=new Event("connectionstatechange",a);l.dispatchEvent(u)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function xR(e,t){if(!e.RTCPeerConnection||t.browser==="chrome"&&t.version>=71||t.browser==="safari"&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=s.sdp.split(`
`).filter(l=>zi(l).call(l)!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&s instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:s.type,sdp:a}):s.sdp=a}return r.apply(this,arguments)}}function Gv(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(t.browser==="chrome"&&t.version<78||t.browser==="firefox"&&t.version<68||t.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Ye.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Ye.resolve())})}function zv(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return r.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer"}return s.sdp||s.type!=="offer"&&s.type!=="answer"?r.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>r.apply(this,[a]))})}var koe=Object.freeze({__proto__:null,removeExtmapAllowMixed:xR,shimAddIceCandidateNullOrEmpty:Gv,shimConnectionState:SR,shimMaxMessageSize:Wv,shimParameterlessSetLocalDescription:zv,shimRTCIceCandidate:Bv,shimRTCIceCandidateRelayProtocol:yR,shimSendThrowTypeError:Hv});(function(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const r=Lj,s=function(l){const u={browser:null,version:null};if(l===void 0||!l.navigator)return u.browser="Not a browser.",u;const{navigator:p}=l;if(p.mozGetUserMedia)u.browser="firefox",u.version=Vv(p.userAgent,/Firefox\/(\d+)\./,1);else if(p.webkitGetUserMedia||l.isSecureContext===!1&&l.webkitRTCPeerConnection)u.browser="chrome",u.version=Vv(p.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!l.RTCPeerConnection||!p.userAgent.match(/AppleWebKit\/(\d+)\./))return u.browser="Not a supported browser.",u;u.browser="safari",u.version=Vv(p.userAgent,/AppleWebKit\/(\d+)\./,1),u.supportsUnifiedPlan=l.RTCRtpTransceiver&&"currentDirection"in l.RTCRtpTransceiver.prototype}return u}(e),a={browserDetails:s,commonShim:koe,extractVersion:Vv,disableLog:voe,disableWarnings:yoe,sdp:Poe};switch(s.browser){case"chrome":if(!$j||!mR||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),a;if(s.version===null)return r("Chrome shim can not determine version, not shimming."),a;r("adapter.js shimming chrome."),a.browserShim=$j,Gv(e,s),zv(e),Vj(e,s),Bj(e),mR(e,s),Wj(e),qj(e,s),Hj(e),Gj(e),zj(e),Yj(e,s),Bv(e),yR(e),SR(e),Wv(e,s),Hv(e),xR(e,s);break;case"firefox":if(!oU||!gR||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),a;r("adapter.js shimming firefox."),a.browserShim=oU,Gv(e,s),zv(e),Xj(e,s),gR(e,s),Jj(e),eU(e),Qj(e),Zj(e),tU(e),nU(e),rU(e),iU(e),sU(e),Bv(e),SR(e),Wv(e,s),Hv(e);break;case"safari":if(!gU||!t.shimSafari)return r("Safari shim is not included in this adapter release."),a;r("adapter.js shimming safari."),a.browserShim=gU,Gv(e,s),zv(e),hU(e),fU(e),lU(e),aU(e),cU(e),pU(e),dU(e),mU(e),Bv(e),yR(e),Wv(e,s),Hv(e),xR(e,s);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var TR=P;yt({global:!0,forced:TR.globalThis!==TR},{globalThis:TR});var xU=d(P),bR={exports:{}};(function(e,t){(function(r,s){var a="function",l="undefined",u="object",p="string",m="major",g="model",E="name",y="type",b="vendor",C="version",B="architecture",M="console",F="mobile",q="tablet",Y="smarttv",re="wearable",ce="embedded",le="Amazon",ae="Apple",_e="ASUS",we="BlackBerry",Be="Browser",Xe="Chrome",jt="Firefox",kt="Google",Tt="Huawei",jn="LG",bn="Microsoft",xs="Motorola",Ce="Opera",ke="Samsung",nt="Sharp",Re="Sony",D="Xiaomi",ee="Zebra",se="Facebook",Pe="Chromium OS",Ot="Mac OS",Nn=" Browser",Pr=function(Nr){for(var kr={},Vn=0;Vn<Nr.length;Vn++)kr[Nr[Vn].toUpperCase()]=Nr[Vn];return kr},Qo=function(Nr,kr){return typeof Nr===p&&Ma(kr).indexOf(Ma(Nr))!==-1},Ma=function(Nr){return Nr.toLowerCase()},Xg=function(Nr,kr){if(typeof Nr===p)return Nr=Nr.replace(/^\s\s*/,""),typeof kr===l?Nr:Nr.substring(0,500)},Ph=function(Nr,kr){for(var Vn,js,mc,_r,zl,Qt,gc=0;gc<kr.length&&!zl;){var kh=kr[gc],ll=kr[gc+1];for(Vn=js=0;Vn<kh.length&&!zl&&kh[Vn];)if(zl=kh[Vn++].exec(Nr))for(mc=0;mc<ll.length;mc++)Qt=zl[++js],typeof(_r=ll[mc])===u&&_r.length>0?_r.length===2?typeof _r[1]==a?this[_r[0]]=_r[1].call(this,Qt):this[_r[0]]=_r[1]:_r.length===3?typeof _r[1]!==a||_r[1].exec&&_r[1].test?this[_r[0]]=Qt?Qt.replace(_r[1],_r[2]):s:this[_r[0]]=Qt?_r[1].call(this,Qt,_r[2]):s:_r.length===4&&(this[_r[0]]=Qt?_r[3].call(this,Qt.replace(_r[1],_r[2])):s):this[_r]=Qt||s;gc+=2}},Xf=function(Nr,kr){for(var Vn in kr)if(typeof kr[Vn]===u&&kr[Vn].length>0){for(var js=0;js<kr[Vn].length;js++)if(Qo(kr[Vn][js],Nr))return Vn==="?"?s:Vn}else if(Qo(kr[Vn],Nr))return Vn==="?"?s:Vn;return kr.hasOwnProperty("*")?kr["*"]:Nr},US={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},FS={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[C,[E,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[C,[E,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[E,C],[/opios[\/ ]+([\w\.]+)/i],[C,[E,Ce+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[C,[E,Ce+" GX"]],[/\bopr\/([\w\.]+)/i],[C,[E,Ce]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[C,[E,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[C,[E,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[E,C],[/quark(?:pc)?\/([-\w\.]+)/i],[C,[E,"Quark"]],[/\bddg\/([\w\.]+)/i],[C,[E,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[C,[E,"UC"+Be]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[C,[E,"WeChat"]],[/konqueror\/([\w\.]+)/i],[C,[E,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[C,[E,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[C,[E,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[C,[E,"Smart Lenovo "+Be]],[/(avast|avg)\/([\w\.]+)/i],[[E,/(.+)/,"$1 Secure "+Be],C],[/\bfocus\/([\w\.]+)/i],[C,[E,jt+" Focus"]],[/\bopt\/([\w\.]+)/i],[C,[E,Ce+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[C,[E,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[C,[E,"Dolphin"]],[/coast\/([\w\.]+)/i],[C,[E,Ce+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[C,[E,"MIUI"+Nn]],[/fxios\/([\w\.-]+)/i],[C,[E,jt]],[/\bqihoobrowser\/?([\w\.]*)/i],[C,[E,"360"]],[/\b(qq)\/([\w\.]+)/i],[[E,/(.+)/,"$1Browser"],C],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[E,/(.+)/,"$1"+Nn],C],[/samsungbrowser\/([\w\.]+)/i],[C,[E,ke+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[C,[E,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[E,"Sogou Mobile"],C],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[E,C],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[E],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[C,E],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[E,se],C],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[E,C],[/\bgsa\/([\w\.]+) .*safari\//i],[C,[E,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[C,[E,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[C,[E,Xe+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[E,Xe+" WebView"],C],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[C,[E,"Android "+Be]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[E,C],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[C,[E,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[C,E],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[E,[C,Xf,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[E,C],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[E,"Netscape"],C],[/(wolvic|librewolf)\/([\w\.]+)/i],[E,C],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[C,[E,jt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[E,[C,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[E,[C,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[B,"amd64"]],[/(ia32(?=;))/i],[[B,Ma]],[/((?:i[346]|x)86)[;\)]/i],[[B,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[B,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[B,"armhf"]],[/windows (ce|mobile); ppc;/i],[[B,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[B,/ower/,"",Ma]],[/(sun4\w)[;\)]/i],[[B,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[B,Ma]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[g,[b,ke],[y,q]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[g,[b,ke],[y,F]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[g,[b,ae],[y,F]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[g,[b,ae],[y,q]],[/(macintosh);/i],[g,[b,ae]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[g,[b,nt],[y,F]],[/(?:honor)([-\w ]+)[;\)]/i],[g,[b,"Honor"],[y,F]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[g,[b,Tt],[y,q]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[g,[b,Tt],[y,F]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[g,/_/g," "],[b,D],[y,F]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[g,/_/g," "],[b,D],[y,q]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[g,[b,"OPPO"],[y,F]],[/\b(opd2\d{3}a?) bui/i],[g,[b,"OPPO"],[y,q]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[g,[b,"Vivo"],[y,F]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[g,[b,"Realme"],[y,F]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[g,[b,xs],[y,F]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[g,[b,xs],[y,q]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[g,[b,jn],[y,q]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[g,[b,jn],[y,F]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[g,[b,"Lenovo"],[y,q]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[g,/_/g," "],[b,"Nokia"],[y,F]],[/(pixel c)\b/i],[g,[b,kt],[y,q]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[g,[b,kt],[y,F]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[g,[b,Re],[y,F]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[g,"Xperia Tablet"],[b,Re],[y,q]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[g,[b,"OnePlus"],[y,F]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[g,[b,le],[y,q]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[g,/(.+)/g,"Fire Phone $1"],[b,le],[y,F]],[/(playbook);[-\w\),; ]+(rim)/i],[g,b,[y,q]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[g,[b,we],[y,F]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[g,[b,_e],[y,q]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[g,[b,_e],[y,F]],[/(nexus 9)/i],[g,[b,"HTC"],[y,q]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[b,[g,/_/g," "],[y,F]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[g,[b,"TCL"],[y,q]],[/(itel) ((\w+))/i],[[b,Ma],g,[y,Xf,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[g,[b,"Acer"],[y,q]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[g,[b,"Meizu"],[y,F]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[g,[b,"Ulefone"],[y,F]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[g,[b,"Energizer"],[y,F]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[g,[b,"Cat"],[y,F]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[g,[b,"Smartfren"],[y,F]],[/droid.+; (a(?:015|06[35]|142p?))/i],[g,[b,"Nothing"],[y,F]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[b,g,[y,F]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[b,g,[y,q]],[/(surface duo)/i],[g,[b,bn],[y,q]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[g,[b,"Fairphone"],[y,F]],[/(u304aa)/i],[g,[b,"AT&T"],[y,F]],[/\bsie-(\w*)/i],[g,[b,"Siemens"],[y,F]],[/\b(rct\w+) b/i],[g,[b,"RCA"],[y,q]],[/\b(venue[\d ]{2,7}) b/i],[g,[b,"Dell"],[y,q]],[/\b(q(?:mv|ta)\w+) b/i],[g,[b,"Verizon"],[y,q]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[g,[b,"Barnes & Noble"],[y,q]],[/\b(tm\d{3}\w+) b/i],[g,[b,"NuVision"],[y,q]],[/\b(k88) b/i],[g,[b,"ZTE"],[y,q]],[/\b(nx\d{3}j) b/i],[g,[b,"ZTE"],[y,F]],[/\b(gen\d{3}) b.+49h/i],[g,[b,"Swiss"],[y,F]],[/\b(zur\d{3}) b/i],[g,[b,"Swiss"],[y,q]],[/\b((zeki)?tb.*\b) b/i],[g,[b,"Zeki"],[y,q]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[b,"Dragon Touch"],g,[y,q]],[/\b(ns-?\w{0,9}) b/i],[g,[b,"Insignia"],[y,q]],[/\b((nxa|next)-?\w{0,9}) b/i],[g,[b,"NextBook"],[y,q]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[b,"Voice"],g,[y,F]],[/\b(lvtel\-)?(v1[12]) b/i],[[b,"LvTel"],g,[y,F]],[/\b(ph-1) /i],[g,[b,"Essential"],[y,F]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[g,[b,"Envizen"],[y,q]],[/\b(trio[-\w\. ]+) b/i],[g,[b,"MachSpeed"],[y,q]],[/\btu_(1491) b/i],[g,[b,"Rotor"],[y,q]],[/(shield[\w ]+) b/i],[g,[b,"Nvidia"],[y,q]],[/(sprint) (\w+)/i],[b,g,[y,F]],[/(kin\.[onetw]{3})/i],[[g,/\./g," "],[b,bn],[y,F]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[g,[b,ee],[y,q]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[g,[b,ee],[y,F]],[/smart-tv.+(samsung)/i],[b,[y,Y]],[/hbbtv.+maple;(\d+)/i],[[g,/^/,"SmartTV"],[b,ke],[y,Y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[b,jn],[y,Y]],[/(apple) ?tv/i],[b,[g,ae+" TV"],[y,Y]],[/crkey/i],[[g,Xe+"cast"],[b,kt],[y,Y]],[/droid.+aft(\w+)( bui|\))/i],[g,[b,le],[y,Y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[g,[b,nt],[y,Y]],[/(bravia[\w ]+)( bui|\))/i],[g,[b,Re],[y,Y]],[/(mitv-\w{5}) bui/i],[g,[b,D],[y,Y]],[/Hbbtv.*(technisat) (.*);/i],[b,g,[y,Y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[b,Xg],[g,Xg],[y,Y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[y,Y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[b,g,[y,M]],[/droid.+; (shield) bui/i],[g,[b,"Nvidia"],[y,M]],[/(playstation [345portablevi]+)/i],[g,[b,Re],[y,M]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[g,[b,bn],[y,M]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[g,[b,ke],[y,re]],[/((pebble))app/i],[b,g,[y,re]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[g,[b,ae],[y,re]],[/droid.+; (glass) \d/i],[g,[b,kt],[y,re]],[/droid.+; (wt63?0{2,3})\)/i],[g,[b,ee],[y,re]],[/droid.+; (glass) \d/i],[g,[b,kt],[y,re]],[/(pico) (4|neo3(?: link|pro)?)/i],[b,g,[y,re]],[/; (quest( \d| pro)?)/i],[g,[b,se],[y,re]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[b,[y,ce]],[/(aeobc)\b/i],[g,[b,le],[y,ce]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[g,[y,F]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[g,[y,q]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[y,q]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[y,F]],[/(android[-\w\. ]{0,9});.+buil/i],[g,[b,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[C,[E,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[E,C],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[C,[E,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[E,C],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[C,E]],os:[[/microsoft (windows) (vista|xp)/i],[E,C],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[E,[C,Xf,US]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[C,Xf,US],[E,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[C,/_/g,"."],[E,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[E,Ot],[C,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[C,E],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[E,C],[/\(bb(10);/i],[C,[E,we]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[C,[E,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[C,[E,jt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[C,[E,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[C,[E,"watchOS"]],[/crkey\/([\d\.]+)/i],[C,[E,Xe+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[E,Pe],C],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[E,C],[/(sunos) ?([\w\.\d]*)/i],[[E,"Solaris"],C],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[E,C]]},Zo=function(Nr,kr){if(typeof Nr===u&&(kr=Nr,Nr=s),!(this instanceof Zo))return new Zo(Nr,kr).getResult();var Vn=typeof r!==l&&r.navigator?r.navigator:s,js=Nr||(Vn&&Vn.userAgent?Vn.userAgent:""),mc=Vn&&Vn.userAgentData?Vn.userAgentData:s,_r=kr?function(Qt,gc){var kh={};for(var ll in Qt)gc[ll]&&gc[ll].length%2==0?kh[ll]=gc[ll].concat(Qt[ll]):kh[ll]=Qt[ll];return kh}(FS,kr):FS,zl=Vn&&Vn.userAgent==js;return this.getBrowser=function(){var Qt={};return Qt[E]=s,Qt[C]=s,Ph.call(Qt,js,_r.browser),Qt[m]=function(gc){return typeof gc===p?gc.replace(/[^\d\.]/g,"").split(".")[0]:s}(Qt[C]),zl&&Vn&&Vn.brave&&typeof Vn.brave.isBrave==a&&(Qt[E]="Brave"),Qt},this.getCPU=function(){var Qt={};return Qt[B]=s,Ph.call(Qt,js,_r.cpu),Qt},this.getDevice=function(){var Qt={};return Qt[b]=s,Qt[g]=s,Qt[y]=s,Ph.call(Qt,js,_r.device),zl&&!Qt[y]&&mc&&mc.mobile&&(Qt[y]=F),zl&&Qt[g]=="Macintosh"&&Vn&&typeof Vn.standalone!==l&&Vn.maxTouchPoints&&Vn.maxTouchPoints>2&&(Qt[g]="iPad",Qt[y]=q),Qt},this.getEngine=function(){var Qt={};return Qt[E]=s,Qt[C]=s,Ph.call(Qt,js,_r.engine),Qt},this.getOS=function(){var Qt={};return Qt[E]=s,Qt[C]=s,Ph.call(Qt,js,_r.os),zl&&!Qt[E]&&mc&&mc.platform&&mc.platform!="Unknown"&&(Qt[E]=mc.platform.replace(/chrome os/i,Pe).replace(/macos/i,Ot)),Qt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return js},this.setUA=function(Qt){return js=typeof Qt===p&&Qt.length>500?Xg(Qt,500):Qt,this},this.setUA(js),this};Zo.VERSION="0.7.40",Zo.BROWSER=Pr([E,C,m]),Zo.CPU=Pr([B]),Zo.DEVICE=Pr([g,b,y,M,F,Y,q,re,ce]),Zo.ENGINE=Zo.OS=Pr([E,C]),e.exports&&(t=e.exports=Zo),t.UAParser=Zo;var Gl=typeof r!==l&&(r.jQuery||r.Zepto);if(Gl&&!Gl.ua){var VS=new Zo;Gl.ua=VS.getResult(),Gl.ua.get=function(){return VS.getUA()},Gl.ua.set=function(Nr){VS.setUA(Nr);var kr=VS.getResult();for(var Vn in kr)Gl.ua[Vn]=kr[Vn]}}})(typeof window=="object"?window:c)})(bR,bR.exports);var Loe=d(bR.exports),TU=Ev.clear;yt({global:!0,bind:!0,enumerable:!0,forced:P.clearImmediate!==TU},{clearImmediate:TU});var bU=P,Moe=V,joe=Ee,Uoe=Ow,Foe=dn,Voe=Td,Boe=Zu,Woe=bU.Function,Hoe=/MSIE .\./.test(Foe)||Uoe==="BUN"&&function(){var e=bU.Bun.version.split(".");return e.length<3||e[0]==="0"&&(e[1]<3||e[1]==="3"&&e[2]==="0")}(),Goe=yt,wU=P,CU=Ev.set,zoe=function(e,t){var r=t?2:1;return Hoe?function(s,a){var l=Boe(arguments.length,1)>r,u=joe(s)?s:Woe(s),p=l?Voe(arguments,r):[],m=l?function(){Moe(u,this,p)}:u;return t?e(m,a):e(m)}:e},RU=wU.setImmediate?zoe(CU,!1):CU;Goe({global:!0,bind:!0,enumerable:!0,forced:wU.setImmediate!==RU},{setImmediate:RU});var AU=d($r.setImmediate),Koe=P,qoe=FL,Yoe=Hi,$oe=Zu,Xoe=Oe;yt({global:!0,enumerable:!0,dontCallGetSet:!0,forced:f(function(){return Xoe&&Object.getOwnPropertyDescriptor(Koe,"queueMicrotask").value.length!==1})},{queueMicrotask:function(e){$oe(arguments.length,1),qoe(Yoe(e))}});var NU=d($r.queueMicrotask);function IU(e,t){return function(){return e.apply(t,arguments)}}const{toString:Joe}=Object.prototype,{getPrototypeOf:wR}=Object,{iterator:Kv,toStringTag:OU}=Symbol,qv=(CR=Object.create(null),e=>{const t=Joe.call(e);return CR[t]||(CR[t]=t.slice(8,-1).toLowerCase())});var CR;const nc=e=>(e=e.toLowerCase(),t=>qv(t)===e),Yv=e=>t=>typeof t===e,{isArray:nf}=Array,z0=Yv("undefined"),DU=nc("ArrayBuffer"),Qoe=Yv("string"),po=Yv("function"),PU=Yv("number"),$v=e=>e!==null&&typeof e=="object",Xv=e=>{if(qv(e)!=="object")return!1;const t=wR(e);return!(t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||OU in e||Kv in e)},Zoe=nc("Date"),eae=nc("File"),tae=nc("Blob"),nae=nc("FileList"),rae=nc("URLSearchParams"),[iae,sae,oae,aae]=["ReadableStream","Request","Response","Headers"].map(nc);function K0(e,t){let r,s,{allOwnKeys:a=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e!=null)if(typeof e!="object"&&(e=[e]),nf(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{const l=a?Object.getOwnPropertyNames(e):Object.keys(e),u=l.length;let p;for(r=0;r<u;r++)p=l[r],t.call(null,e[p],p,e)}}function kU(e,t){t=t.toLowerCase();const r=Object.keys(e);let s,a=r.length;for(;a-- >0;)if(s=r[a],t===s.toLowerCase())return s;return null}const oh=xU!==void 0?xU:typeof self<"u"?self:typeof window<"u"?window:En,LU=e=>!z0(e)&&e!==oh,cae=(RR=typeof Uint8Array<"u"&&wR(Uint8Array),e=>RR&&e instanceof RR);var RR;const lae=nc("HTMLFormElement"),MU=(e=>{let{hasOwnProperty:t}=e;return(r,s)=>t.call(r,s)})(Object.prototype),dae=nc("RegExp"),jU=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};K0(r,(a,l)=>{let u;(u=t(a,l,e))!==!1&&(s[l]=u||a)}),Object.defineProperties(e,s)},uae=nc("AsyncFunction"),UU=(FU=typeof AU=="function",VU=po(oh.postMessage),FU?AU:VU?(AR="axios@".concat(Math.random()),Jv=[],oh.addEventListener("message",e=>{let{source:t,data:r}=e;t===oh&&r===AR&&Jv.length&&Jv.shift()()},!1),e=>{Jv.push(e),oh.postMessage(AR,"*")}):e=>setTimeout(e));var FU,VU,AR,Jv;const hae=NU!==void 0?NU.bind(oh):typeof process<"u"&&process.nextTick||UU;var Ge={isArray:nf,isArrayBuffer:DU,isBuffer:function(e){return e!==null&&!z0(e)&&e.constructor!==null&&!z0(e.constructor)&&po(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||po(e.append)&&((t=qv(e))==="formdata"||t==="object"&&po(e.toString)&&e.toString()==="[object FormData]"))},isArrayBufferView:function(e){let t;return t=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&DU(e.buffer),t},isString:Qoe,isNumber:PU,isBoolean:e=>e===!0||e===!1,isObject:$v,isPlainObject:Xv,isReadableStream:iae,isRequest:sae,isResponse:oae,isHeaders:aae,isUndefined:z0,isDate:Zoe,isFile:eae,isBlob:tae,isRegExp:dae,isFunction:po,isStream:e=>$v(e)&&po(e.pipe),isURLSearchParams:rae,isTypedArray:cae,isFileList:nae,forEach:K0,merge:function e(){const{caseless:t}=LU(this)&&this||{},r={},s=(a,l)=>{const u=t&&kU(r,l)||l;Xv(r[u])&&Xv(a)?r[u]=e(r[u],a):Xv(a)?r[u]=e({},a):nf(a)?r[u]=a.slice():r[u]=a};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&K0(arguments[a],s);return r},extend:function(e,t,r){let{allOwnKeys:s}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return K0(t,(a,l)=>{r&&po(a)?e[l]=IU(a,r):e[l]=a},{allOwnKeys:s}),e},trim:e=>zi(e)?zi(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits:(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,s)=>{let a,l,u;const p={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),l=a.length;l-- >0;)u=a[l],s&&!s(u,e,t)||p[u]||(t[u]=e[u],p[u]=!0);e=r!==!1&&wR(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:qv,kindOfTest:nc,endsWith:(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},toArray:e=>{if(!e)return null;if(nf(e))return e;let t=e.length;if(!PU(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[Kv]).call(e);let s;for(;(s=r.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},matchAll:(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},isHTMLForm:lae,hasOwnProperty:MU,hasOwnProp:MU,reduceDescriptors:jU,freezeMethods:e=>{jU(e,(t,r)=>{if(po(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];po(s)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},s=a=>{a.forEach(l=>{r[l]=!0})};return nf(e)?s(e):s(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,findKey:kU,global:oh,isContextDefined:LU,isSpecCompliantForm:function(e){return!!(e&&po(e.append)&&e[OU]==="FormData"&&e[Kv])},toJSONObject:e=>{const t=new Array(10),r=(s,a)=>{if($v(s)){if(t.indexOf(s)>=0)return;if(!("toJSON"in s)){t[a]=s;const l=nf(s)?[]:{};return K0(s,(u,p)=>{const m=r(u,a+1);!z0(m)&&(l[p]=m)}),t[a]=void 0,l}}return s};return r(e,0)},isAsyncFn:uae,isThenable:e=>e&&($v(e)||po(e))&&po(e.then)&&po(e.catch),setImmediate:UU,asap:hae,isIterable:e=>e!=null&&po(e[Kv])};function Sn(e,t,r,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}Ge.inherits(Sn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ge.toJSONObject(this.config),code:this.code,status:this.status}}});const BU=Sn.prototype,WU={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WU[e]={value:e}}),Object.defineProperties(Sn,WU),Object.defineProperty(BU,"isAxiosError",{value:!0}),Sn.from=(e,t,r,s,a,l)=>{const u=Object.create(BU);return Ge.toFlatObject(e,u,function(p){return p!==Error.prototype},p=>p!=="isAxiosError"),Sn.call(u,e.message,t,r,s,a),u.cause=e,u.name=e.name,l&&Object.assign(u,l),u};function NR(e){return Ge.isPlainObject(e)||Ge.isArray(e)}function HU(e){return Ge.endsWith(e,"[]")?e.slice(0,-2):e}function GU(e,t,r){return e?e.concat(t).map(function(s,a){return s=HU(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}const pae=Ge.toFlatObject(Ge,{},null,function(e){return/^is[A-Z]/.test(e)});function Qv(e,t,r){if(!Ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const s=(r=Ge.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,C){return!Ge.isUndefined(C[b])})).metaTokens,a=r.visitor||g,l=r.dots,u=r.indexes,p=(r.Blob||typeof Blob<"u"&&Blob)&&Ge.isSpecCompliantForm(t);if(!Ge.isFunction(a))throw new TypeError("visitor must be a function");function m(b){if(b===null)return"";if(Ge.isDate(b))return b.toISOString();if(!p&&Ge.isBlob(b))throw new Sn("Blob is not supported. Use a Buffer instead.");return Ge.isArrayBuffer(b)||Ge.isTypedArray(b)?p&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function g(b,C,B){let M=b;if(b&&!B&&typeof b=="object"){if(Ge.endsWith(C,"{}"))C=s?C:C.slice(0,-2),b=JSON.stringify(b);else if(Ge.isArray(b)&&function(F){return Ge.isArray(F)&&!F.some(NR)}(b)||(Ge.isFileList(b)||Ge.endsWith(C,"[]"))&&(M=Ge.toArray(b)))return C=HU(C),M.forEach(function(F,q){!Ge.isUndefined(F)&&F!==null&&t.append(u===!0?GU([C],q,l):u===null?C:C+"[]",m(F))}),!1}return!!NR(b)||(t.append(GU(B,C,l),m(b)),!1)}const E=[],y=Object.assign(pae,{defaultVisitor:g,convertValue:m,isVisitable:NR});if(!Ge.isObject(e))throw new TypeError("data must be an object");return function b(C,B){if(!Ge.isUndefined(C)){if(E.indexOf(C)!==-1)throw Error("Circular reference detected in "+B.join("."));E.push(C),Ge.forEach(C,function(M,F){(!(Ge.isUndefined(M)||M===null)&&a.call(t,M,Ge.isString(F)?zi(F).call(F):F,B,y))===!0&&b(M,B?B.concat(F):[F])}),E.pop()}}(e),t}function zU(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function IR(e,t){this._pairs=[],e&&Qv(e,this,t)}const KU=IR.prototype;function fae(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function qU(e,t,r){if(!t)return e;const s=r&&r.encode||fae;Ge.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let l;if(l=a?a(t,r):Ge.isURLSearchParams(t)?t.toString():new IR(t,r).toString(s),l){const u=e.indexOf("#");u!==-1&&(e=e.slice(0,u)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}KU.append=function(e,t){this._pairs.push([e,t])},KU.toString=function(e){const t=e?function(r){return e.call(this,r,zU)}:zU;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};var YU=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ge.forEach(this.handlers,function(t){t!==null&&e(t)})}},$U={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},XU={exports:{}},mae=yt,gae=Oe,JU=Os.f;mae({target:"Object",stat:!0,forced:Object.defineProperty!==JU,sham:!gae},{defineProperty:JU});var QU=$r.Object,_ae=XU.exports=function(e,t,r){return QU.defineProperty(e,t,r)};QU.defineProperty.sham&&(_ae.sham=!0);var ZU=d(XU.exports),Eae=TypeError,e4=C0,vae=_v,yae=Pn,Sae=Sr("species"),t4=Array,xae=function(e){var t;return e4(e)&&(t=e.constructor,(vae(t)&&(t===t4||e4(t.prototype))||yae(t)&&(t=t[Sae])===null)&&(t=void 0)),t===void 0?t4:t},n4=function(e,t){return new(xae(e))(t===0?0:t)},Tae=f,bae=_i,wae=Sr("species"),r4=function(e){return bae>=51||!Tae(function(){var t=[];return(t.constructor={})[wae]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Cae=yt,Rae=f,Aae=C0,Nae=Pn,Iae=Ns,Oae=ts,i4=function(e){if(e>9007199254740991)throw Eae("Maximum allowed index exceeded");return e},s4=zC,Dae=n4,Pae=r4,kae=_i,o4=Sr("isConcatSpreadable"),Lae=kae>=51||!Rae(function(){var e=[];return e[o4]=!1,e.concat()[0]!==e}),Mae=function(e){if(!Nae(e))return!1;var t=e[o4];return t!==void 0?!!t:Aae(e)};Cae({target:"Array",proto:!0,arity:1,forced:!Lae||!Pae("concat")},{concat:function(e){var t,r,s,a,l,u=Iae(this),p=Dae(u,0),m=0;for(t=-1,s=arguments.length;t<s;t++)if(Mae(l=t===-1?u:arguments[t]))for(a=Oae(l),i4(m+a),r=0;r<a;r++,m++)r in l&&s4(p,m,l[r]);else i4(m+1),s4(p,m++,l);return p.length=m,p}});var a4={},jae=A,Uae=gi,c4=tv.f,Fae=Td,l4=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];a4.f=function(e){return l4&&jae(e)==="Window"?function(t){try{return c4(t)}catch{return Fae(l4)}}(e):c4(Uae(e))};var rf={},Vae=Sr;rf.f=Vae;var d4=$r,Bae=ii,Wae=rf,Hae=Os.f,si=function(e){var t=d4.Symbol||(d4.Symbol={});Bae(t,e)||Hae(t,e,{value:Wae.f(e)})},Gae=lt,zae=ot,Kae=Sr,qae=xd,u4=function(){var e=zae("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,s=Kae("toPrimitive");t&&!t[s]&&qae(t,s,function(a){return Gae(r,this)},{arity:1})},Yae=Xa,$ae=hr,Xae=Ns,Jae=ts,Qae=n4,h4=R([].push),Nd=function(e){var t=e===1,r=e===2,s=e===3,a=e===4,l=e===6,u=e===7,p=e===5||l;return function(m,g,E,y){for(var b,C,B=Xae(m),M=$ae(B),F=Jae(M),q=Yae(g,E),Y=0,re=y||Qae,ce=t?re(m,F):r||u?re(m,0):void 0;F>Y;Y++)if((p||Y in M)&&(C=q(b=M[Y],Y,B),e))if(t)ce[Y]=C;else if(C)switch(e){case 3:return!0;case 5:return b;case 6:return Y;case 2:h4(ce,b)}else switch(e){case 4:return!1;case 7:h4(ce,b)}return l?-1:s||a?a:ce}},p4={forEach:Nd(0),map:Nd(1),filter:Nd(2),some:Nd(3),every:Nd(4),find:Nd(5),findIndex:Nd(6),filterReject:Nd(7)},Zv=yt,q0=P,OR=lt,Zae=R,sf=Oe,of=Ys,ece=f,is=ii,tce=I,DR=es,ey=gi,PR=_0,nce=Ne,kR=qe,af=A0,f4=rv,rce=tv,m4=a4,ice=R0,g4=xe,_4=Os,sce=Uw,E4=He,v4=xd,oce=gv,LR=Ya,y4=nv,S4=h0,ace=Sr,cce=rf,lce=si,dce=u4,uce=Al,x4=Qu,ty=p4.forEach,fo=ev("hidden"),ny="Symbol",Y0="prototype",hce=x4.set,T4=x4.getterFor(ny),rc=Object[Y0],ah=q0.Symbol,ry=ah&&ah[Y0],pce=q0.RangeError,fce=q0.TypeError,MR=q0.QObject,b4=g4.f,ch=_4.f,w4=m4.f,mce=E4.f,C4=Zae([].push),Ol=LR("symbols"),$0=LR("op-symbols"),gce=LR("wks"),jR=!MR||!MR[Y0]||!MR[Y0].findChild,R4=function(e,t,r){var s=b4(rc,t);s&&delete rc[t],ch(e,t,r),s&&e!==rc&&ch(rc,t,s)},UR=sf&&ece(function(){return af(ch({},"a",{get:function(){return ch(this,"a",{value:7}).a}})).a!==7})?R4:ch,FR=function(e,t){var r=Ol[e]=af(ry);return hce(r,{type:ny,tag:e,description:t}),sf||(r.description=t),r},iy=function(e,t,r){e===rc&&iy($0,t,r),DR(e);var s=PR(t);return DR(r),is(Ol,s)?(r.enumerable?(is(e,fo)&&e[fo][s]&&(e[fo][s]=!1),r=af(r,{enumerable:kR(0,!1)})):(is(e,fo)||ch(e,fo,kR(1,af(null))),e[fo][s]=!0),UR(e,s,r)):ch(e,s,r)},VR=function(e,t){DR(e);var r=ey(t),s=f4(r).concat(O4(r));return ty(s,function(a){sf&&!OR(A4,r,a)||iy(e,a,r[a])}),e},A4=function(e){var t=PR(e),r=OR(mce,this,t);return!(this===rc&&is(Ol,t)&&!is($0,t))&&(!(r||!is(this,t)||!is(Ol,t)||is(this,fo)&&this[fo][t])||r)},N4=function(e,t){var r=ey(e),s=PR(t);if(r!==rc||!is(Ol,s)||is($0,s)){var a=b4(r,s);return!a||!is(Ol,s)||is(r,fo)&&r[fo][s]||(a.enumerable=!0),a}},I4=function(e){var t=w4(ey(e)),r=[];return ty(t,function(s){is(Ol,s)||is(y4,s)||C4(r,s)}),r},O4=function(e){var t=e===rc,r=w4(t?$0:ey(e)),s=[];return ty(r,function(a){!is(Ol,a)||t&&!is(rc,a)||C4(s,Ol[a])}),s};of||(ah=function(){if(tce(ry,this))throw new fce("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?nce(arguments[0]):void 0,t=S4(e),r=function(s){var a=this===void 0?q0:this;a===rc&&OR(r,$0,s),is(a,fo)&&is(a[fo],t)&&(a[fo][t]=!1);var l=kR(1,s);try{UR(a,t,l)}catch(u){if(!(u instanceof pce))throw u;R4(a,t,l)}};return sf&&jR&&UR(rc,t,{configurable:!0,set:r}),FR(t,e)},v4(ry=ah[Y0],"toString",function(){return T4(this).tag}),v4(ah,"withoutSetter",function(e){return FR(S4(e),e)}),E4.f=A4,_4.f=iy,sce.f=VR,g4.f=N4,rce.f=m4.f=I4,ice.f=O4,cce.f=function(e){return FR(ace(e),e)},sf&&oce(ry,"description",{configurable:!0,get:function(){return T4(this).description}})),Zv({global:!0,constructor:!0,wrap:!0,forced:!of,sham:!of},{Symbol:ah}),ty(f4(gce),function(e){lce(e)}),Zv({target:ny,stat:!0,forced:!of},{useSetter:function(){jR=!0},useSimple:function(){jR=!1}}),Zv({target:"Object",stat:!0,forced:!of,sham:!sf},{create:function(e,t){return t===void 0?af(e):VR(af(e),t)},defineProperty:iy,defineProperties:VR,getOwnPropertyDescriptor:N4}),Zv({target:"Object",stat:!0,forced:!of},{getOwnPropertyNames:I4}),dce(),uce(ah,ny),y4[fo]=!0;var D4=Ys&&!!Symbol.for&&!!Symbol.keyFor,_ce=yt,Ece=ot,vce=ii,yce=Ne,P4=Ya,Sce=D4,BR=P4("string-to-symbol-registry"),xce=P4("symbol-to-string-registry");_ce({target:"Symbol",stat:!0,forced:!Sce},{for:function(e){var t=yce(e);if(vce(BR,t))return BR[t];var r=Ece("Symbol")(t);return BR[t]=r,xce[r]=t,r}});var Tce=yt,bce=ii,wce=Uc,Cce=Xr,Rce=D4,k4=Ya("symbol-to-string-registry");Tce({target:"Symbol",stat:!0,forced:!Rce},{keyFor:function(e){if(!wce(e))throw new TypeError(Cce(e)+" is not a symbol");if(bce(k4,e))return k4[e]}});var L4=C0,Ace=Ee,M4=A,Nce=Ne,j4=R([].push),Ice=yt,U4=ot,F4=V,Oce=lt,X0=R,V4=f,B4=Ee,W4=Uc,H4=Td,Dce=function(e){if(Ace(e))return e;if(L4(e)){for(var t=e.length,r=[],s=0;s<t;s++){var a=e[s];typeof a=="string"?j4(r,a):typeof a!="number"&&M4(a)!=="Number"&&M4(a)!=="String"||j4(r,Nce(a))}var l=r.length,u=!0;return function(p,m){if(u)return u=!1,m;if(L4(this))return m;for(var g=0;g<l;g++)if(r[g]===p)return m}}},Pce=Ys,kce=String,Id=U4("JSON","stringify"),sy=X0(/./.exec),G4=X0("".charAt),Lce=X0("".charCodeAt),Mce=X0("".replace),jce=X0(1 .toString),Uce=/[\uD800-\uDFFF]/g,z4=/^[\uD800-\uDBFF]$/,K4=/^[\uDC00-\uDFFF]$/,q4=!Pce||V4(function(){var e=U4("Symbol")("stringify detection");return Id([e])!=="[null]"||Id({a:e})!=="{}"||Id(Object(e))!=="{}"}),Y4=V4(function(){return Id("\uDF06\uD834")!=='"\\udf06\\ud834"'||Id("\uDEAD")!=='"\\udead"'}),Fce=function(e,t){var r=H4(arguments),s=Dce(t);if(B4(s)||e!==void 0&&!W4(e))return r[1]=function(a,l){if(B4(s)&&(l=Oce(s,this,kce(a),l)),!W4(l))return l},F4(Id,null,r)},Vce=function(e,t,r){var s=G4(r,t-1),a=G4(r,t+1);return sy(z4,e)&&!sy(K4,a)||sy(K4,e)&&!sy(z4,s)?"\\u"+jce(Lce(e,0),16):e};Id&&Ice({target:"JSON",stat:!0,arity:3,forced:q4||Y4},{stringify:function(e,t,r){var s=H4(arguments),a=F4(q4?Fce:Id,null,s);return Y4&&typeof a=="string"?Mce(a,Uce,Vce):a}});var $4=R0,Bce=Ns;yt({target:"Object",stat:!0,forced:!Ys||f(function(){$4.f(1)})},{getOwnPropertySymbols:function(e){var t=$4.f;return t?t(Bce(e)):[]}}),si("asyncIterator"),si("hasInstance"),si("isConcatSpreadable"),si("iterator"),si("match"),si("matchAll"),si("replace"),si("search"),si("species"),si("split");var Wce=u4;si("toPrimitive"),Wce();var Hce=ot,Gce=Al;si("toStringTag"),Gce(Hce("Symbol"),"Symbol"),si("unscopables"),Al(P.JSON,"JSON",!0);var zce=$r.Symbol,Kce=Sr,qce=Os.f,X4=Kce("metadata"),J4=Function.prototype;J4[X4]===void 0&&qce(J4,X4,{value:null}),si("asyncDispose"),si("dispose"),si("metadata");var Yce=zce,$ce=R,WR=ot("Symbol"),Xce=WR.keyFor,Jce=$ce(WR.prototype.valueOf),Q4=WR.isRegisteredSymbol||function(e){try{return Xce(Jce(e))!==void 0}catch{return!1}};yt({target:"Symbol",stat:!0},{isRegisteredSymbol:Q4});for(var Qce=Ya,Z4=ot,Zce=R,ele=Uc,tle=Sr,oy=Z4("Symbol"),eF=oy.isWellKnownSymbol,tF=Z4("Object","getOwnPropertyNames"),nle=Zce(oy.prototype.valueOf),nF=Qce("wks"),HR=0,rF=tF(oy),rle=rF.length;HR<rle;HR++)try{var iF=rF[HR];ele(oy[iF])&&tle(iF)}catch{}var sF=function(e){if(eF&&eF(e))return!0;try{for(var t=nle(e),r=0,s=tF(nF),a=s.length;r<a;r++)if(nF[s[r]]==t)return!0}catch{}return!1};yt({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:sF}),si("customMatcher"),si("observable"),yt({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Q4}),yt({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:sF}),si("matcher"),si("metadataKey"),si("patternMatch"),si("replaceAll");var cf=d(Yce),oF=d(rf.f("iterator"));function J0(e){return J0=typeof cf=="function"&&typeof oF=="symbol"?function(t){return typeof t}:function(t){return t&&typeof cf=="function"&&t.constructor===cf&&t!==cf.prototype?"symbol":typeof t},J0(e)}var ile=d(rf.f("toPrimitive"));function sle(e){var t=function(r,s){if(J0(r)!="object"||!r)return r;var a=r[ile];if(a!==void 0){var l=a.call(r,s||"default");if(J0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(r)}(e,"string");return J0(t)=="symbol"?t:t+""}function z(e,t,r){return(t=sle(t))in e?ZU(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var aF=d(ase),ole={isBrowser:!0,classes:{URLSearchParams:aF!==void 0?aF:IR,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const GR=typeof window<"u"&&typeof document<"u",zR=typeof navigator=="object"&&navigator||void 0,ale=GR&&(!zR||["ReactNative","NativeScript","NS"].indexOf(zR.product)<0),cle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",lle=GR&&window.location.href||"http://localhost";function cF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function lF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cF(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}var Ds=lF(lF({},Object.freeze({__proto__:null,hasBrowserEnv:GR,hasStandardBrowserEnv:ale,hasStandardBrowserWebWorkerEnv:cle,navigator:zR,origin:lle})),ole),dle=es,ule=lt,hle=ii,ple=I,fle=function(){var e=dle(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},dF=RegExp.prototype,uF=function(e){var t=e.flags;return t!==void 0||"flags"in dF||hle(e,"flags")||!ple(dF,e)?t:ule(fle,e)},mle=OC.charAt,hF=lt,gle=es,_le=Ee,Ele=A,vle=/./.exec,yle=TypeError,Sle=yt,pF=lt,fF=oe,xle=Qw,ay=fv,mF=cr,gF=kp,Q0=Ne,Tle=es,ble=Pn,wle=A,Cle=x0,_F=uF,Rle=ms,Ale=f,Nle=iC,Ile=function(e,t,r){return t+(r?mle(e,t).length:1)},Ole=function(e,t){var r=e.exec;if(_le(r)){var s=hF(r,e,t);return s!==null&&gle(s),s}if(Ele(e)==="RegExp")return hF(vle,e,t);throw new yle("RegExp#exec called on incompatible receiver")},EF=Qu,Dle=Sr("matchAll"),vF="RegExp String",yF=vF+" Iterator",Ple=EF.set,kle=EF.getterFor(yF),Lle=TypeError,KR=fF("".indexOf),cy=fF("".matchAll),qR=!!cy&&!Ale(function(){cy("a",/./)}),Mle=xle(function(e,t,r,s){Ple(this,{type:yF,regexp:e,string:t,global:r,unicode:s,done:!1})},vF,function(){var e=kle(this);if(e.done)return ay(void 0,!0);var t=e.regexp,r=e.string,s=Ole(t,r);return s===null?(e.done=!0,ay(void 0,!0)):e.global?(Q0(s[0])===""&&(t.lastIndex=Ile(r,gF(t.lastIndex),e.unicode)),ay(s,!1)):(e.done=!0,ay(s,!1))}),SF=function(e){var t,r,s,a=Tle(this),l=Q0(e),u=Nle(a,RegExp),p=Q0(_F(a));return t=new u(u===RegExp?a.source:a,p),r=!!~KR(p,"g"),s=!!~KR(p,"u"),t.lastIndex=gF(a.lastIndex),new Mle(t,l,r,s)};Sle({target:"String",proto:!0,forced:qR},{matchAll:function(e){var t,r,s,a,l=mF(this);if(ble(e)){if(Cle(e)&&(t=Q0(mF(_F(e))),!~KR(t,"g")))throw new Lle("`.matchAll` does not allow non-global regexes");if(qR)return cy(l,e);if((s=Rle(e,Dle))===void 0&&wle(e)==="RegExp"&&(s=SF),s)return pF(s,e,l)}else if(qR)return cy(l,e);return r=Q0(l),a=new RegExp(e,"g"),pF(SF,a,r)}});var jle=ho("String","matchAll"),Ule=I,Fle=jle,YR=String.prototype,Vle=function(e){var t=e.matchAll;return typeof e=="string"||e===YR||Ule(YR,e)&&t===YR.matchAll?Fle:t},Ble=d(Vle);function xF(e){function t(r,s,a,l){let u=r[l++];if(u==="__proto__")return!0;const p=Number.isFinite(+u),m=l>=r.length;return u=!u&&Ge.isArray(a)?a.length:u,m?(Ge.hasOwnProp(a,u)?a[u]=[a[u],s]:a[u]=s,!p):(a[u]&&Ge.isObject(a[u])||(a[u]=[]),t(r,s,a[u],l)&&Ge.isArray(a[u])&&(a[u]=function(g){const E={},y=Object.keys(g);let b;const C=y.length;let B;for(b=0;b<C;b++)B=y[b],E[B]=g[B];return E}(a[u])),!p)}if(Ge.isFormData(e)&&Ge.isFunction(e.entries)){const r={};return Ge.forEachEntry(e,(s,a)=>{t(function(l){return Ble(Ge).call(Ge,/\w+|\[(\w*)]/g,l).map(u=>u[0]==="[]"?"":u[1]||u[0])}(s),a,r,0)}),r}return null}const $R={transitional:$U,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,a=Ge.isObject(e);if(a&&Ge.isHTMLForm(e)&&(e=new FormData(e)),Ge.isFormData(e))return s?JSON.stringify(xF(e)):e;if(Ge.isArrayBuffer(e)||Ge.isBuffer(e)||Ge.isStream(e)||Ge.isFile(e)||Ge.isBlob(e)||Ge.isReadableStream(e))return e;if(Ge.isArrayBufferView(e))return e.buffer;if(Ge.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(u,p){return Qv(u,new Ds.classes.URLSearchParams,Object.assign({visitor:function(m,g,E,y){return Ds.isNode&&Ge.isBuffer(m)?(this.append(g,m.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)}},p))}(e,this.formSerializer).toString();if((l=Ge.isFileList(e))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Qv(l?{"files[]":e}:e,u&&new u,this.formSerializer)}}return a||s?(t.setContentType("application/json",!1),function(u,p,m){if(Ge.isString(u))try{return(p||JSON.parse)(u),zi(Ge).call(Ge,u)}catch(g){if(g.name!=="SyntaxError")throw g}return(m||JSON.stringify)(u)}(e)):e}],transformResponse:[function(e){const t=this.transitional||$R.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(Ge.isResponse(e)||Ge.isReadableStream(e))return e;if(e&&Ge.isString(e)&&(r&&!this.responseType||s)){const a=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?Sn.from(l,Sn.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ds.classes.FormData,Blob:Ds.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ge.forEach(["delete","get","head","post","put","patch"],e=>{$R.headers[e]={}});var XR=$R;const Wle=Ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),TF=Symbol("internals");function Z0(e){var t;return e&&zi(t=String(e)).call(t).toLowerCase()}function ly(e){return e===!1||e==null?e:Ge.isArray(e)?e.map(ly):String(e)}function JR(e,t,r,s,a){return Ge.isFunction(s)?s.call(this,t,r):(a&&(t=r),Ge.isString(t)?Ge.isString(s)?t.indexOf(s)!==-1:Ge.isRegExp(s)?s.test(t):void 0:void 0)}class dy{constructor(t){t&&this.set(t)}set(t,r,s){const a=this;function l(m,g,E){const y=Z0(g);if(!y)throw new Error("header name must be a non-empty string");const b=Ge.findKey(a,y);(!b||a[b]===void 0||E===!0||E===void 0&&a[b]!==!1)&&(a[b||g]=ly(m))}const u=(m,g)=>Ge.forEach(m,(E,y)=>l(E,y,g));if(Ge.isPlainObject(t)||t instanceof this.constructor)u(t,r);else if(Ge.isString(t)&&(t=zi(t).call(t))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(zi(p=t).call(p)))u((m=>{const g={};let E,y,b;return m&&m.split(`
`).forEach(function(C){var B,M;b=C.indexOf(":"),E=zi(B=C.substring(0,b)).call(B).toLowerCase(),y=zi(M=C.substring(b+1)).call(M),!E||g[E]&&Wle[E]||(E==="set-cookie"?g[E]?g[E].push(y):g[E]=[y]:g[E]=g[E]?g[E]+", "+y:y)}),g})(t),r);else if(Ge.isObject(t)&&Ge.isIterable(t)){let m,g,E={};for(const y of t){if(!Ge.isArray(y))throw TypeError("Object iterator must return a key-value pair");E[g=y[0]]=(m=E[g])?Ge.isArray(m)?[...m,y[1]]:[m,y[1]]:y[1]}u(E,r)}else t!=null&&l(r,t,s);var p;return this}get(t,r){if(t=Z0(t)){const s=Ge.findKey(this,t);if(s){const a=this[s];if(!r)return a;if(r===!0)return function(l){const u=Object.create(null),p=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let m;for(;m=p.exec(l);)u[m[1]]=m[2];return u}(a);if(Ge.isFunction(r))return r.call(this,a,s);if(Ge.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Z0(t)){const s=Ge.findKey(this,t);return!(!s||this[s]===void 0||r&&!JR(0,this[s],s,r))}return!1}delete(t,r){const s=this;let a=!1;function l(u){if(u=Z0(u)){const p=Ge.findKey(s,u);!p||r&&!JR(0,s[p],p,r)||(delete s[p],a=!0)}}return Ge.isArray(t)?t.forEach(l):l(t),a}clear(t){const r=Object.keys(this);let s=r.length,a=!1;for(;s--;){const l=r[s];t&&!JR(0,this[l],l,t,!0)||(delete this[l],a=!0)}return a}normalize(t){const r=this,s={};return Ge.forEach(this,(a,l)=>{var u;const p=Ge.findKey(s,l);if(p)return r[p]=ly(a),void delete r[l];const m=t?function(g){return zi(g).call(g).toLowerCase().replace(/([a-z\d])(\w*)/g,(E,y,b)=>y.toUpperCase()+b)}(l):zi(u=String(l)).call(u);m!==l&&delete r[l],r[m]=ly(a),s[m]=!0}),this}concat(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return this.constructor.concat(this,...r)}toJSON(t){const r=Object.create(null);return Ge.forEach(this,(s,a)=>{s!=null&&s!==!1&&(r[a]=t&&Ge.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[r,s]=t;return r+": "+s}).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const r=new this(t);for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return a.forEach(u=>r.set(u)),r}static accessor(t){const r=(this[TF]=this[TF]={accessors:{}}).accessors,s=this.prototype;function a(l){const u=Z0(l);r[u]||(function(p,m){const g=Ge.toCamelCase(" "+m);["get","set","has"].forEach(E=>{Object.defineProperty(p,E+g,{value:function(y,b,C){return this[E].call(this,m,y,b,C)},configurable:!0})})}(s,l),r[u]=!0)}return Ge.isArray(t)?t.forEach(a):a(t),this}}dy.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ge.reduceDescriptors(dy.prototype,(e,t)=>{let{value:r}=e,s=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(a){this[s]=a}}}),Ge.freezeMethods(dy);var ic=dy;function QR(e,t){const r=this||XR,s=t||r,a=ic.from(s.headers);let l=s.data;return Ge.forEach(e,function(u){l=u.call(r,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function bF(e){return!(!e||!e.__CANCEL__)}function lf(e,t,r){Sn.call(this,e??"canceled",Sn.ERR_CANCELED,t,r),this.name="CanceledError"}function wF(e,t,r){const s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(new Sn("Request failed with status code "+r.status,[Sn.ERR_BAD_REQUEST,Sn.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}Ge.inherits(lf,Sn,{__CANCEL__:!0});const uy=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,s=0;const a=function(l,u){l=l||10;const p=new Array(l),m=new Array(l);let g,E=0,y=0;return u=u!==void 0?u:1e3,function(b){const C=Date.now(),B=m[y];g||(g=C),p[E]=b,m[E]=C;let M=y,F=0;for(;M!==E;)F+=p[M++],M%=l;if(E=(E+1)%l,E===y&&(y=(y+1)%l),C-g<u)return;const q=B&&C-B;return q?Math.round(1e3*F/q):void 0}}(50,250);return function(l,u){let p,m,g=0,E=1e3/u;const y=function(b){g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),p=null,m&&(clearTimeout(m),m=null),l.apply(null,b)};return[function(){const b=Date.now(),C=b-g;for(var B=arguments.length,M=new Array(B),F=0;F<B;F++)M[F]=arguments[F];C>=E?y(M,b):(p=M,m||(m=setTimeout(()=>{m=null,y(p)},E-C)))},()=>p&&y(p)]}(l=>{const u=l.loaded,p=l.lengthComputable?l.total:void 0,m=u-s,g=a(m);s=u,e({loaded:u,total:p,progress:p?u/p:void 0,bytes:m,rate:g||void 0,estimated:g&&p&&u<=p?(p-u)/g:void 0,event:l,lengthComputable:p!=null,[t?"download":"upload"]:!0})},r)},CF=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},RF=e=>function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Ge.asap(()=>e(...r))};var Hle=Ds.hasStandardBrowserEnv?((e,t)=>r=>(r=new Fv(r,Ds.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new Fv(Ds.origin),Ds.navigator&&/(msie|trident)/i.test(Ds.navigator.userAgent)):()=>!0,Gle=Ds.hasStandardBrowserEnv?{write(e,t,r,s,a,l){const u=[e+"="+encodeURIComponent(t)];Ge.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),Ge.isString(s)&&u.push("path="+s),Ge.isString(a)&&u.push("domain="+a),l===!0&&u.push("secure"),document.cookie=u.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function AF(e,t,r){let s=!function(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}(t);return e&&(s||r==0)?function(a,l){return l?a.replace(/\/?\/$/,"")+"/"+l.replace(/^\/+/,""):a}(e,t):t}function NF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}const IF=e=>e instanceof ic?function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?NF(Object(s),!0).forEach(function(a){z(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):NF(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}({},e):e;function lh(e,t){t=t||{};const r={};function s(g,E,y,b){return Ge.isPlainObject(g)&&Ge.isPlainObject(E)?Ge.merge.call({caseless:b},g,E):Ge.isPlainObject(E)?Ge.merge({},E):Ge.isArray(E)?E.slice():E}function a(g,E,y,b){return Ge.isUndefined(E)?Ge.isUndefined(g)?void 0:s(void 0,g,0,b):s(g,E,0,b)}function l(g,E){if(!Ge.isUndefined(E))return s(void 0,E)}function u(g,E){return Ge.isUndefined(E)?Ge.isUndefined(g)?void 0:s(void 0,g):s(void 0,E)}function p(g,E,y){return y in t?s(g,E):y in e?s(void 0,g):void 0}const m={url:l,method:l,data:l,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:p,headers:(g,E,y)=>a(IF(g),IF(E),0,!0)};return Ge.forEach(Object.keys(Object.assign({},e,t)),function(g){const E=m[g]||a,y=E(e[g],t[g],g);Ge.isUndefined(y)&&E!==p||(r[g]=y)}),r}var OF=e=>{const t=lh({},e);let r,{data:s,withXSRFToken:a,xsrfHeaderName:l,xsrfCookieName:u,headers:p,auth:m}=t;if(t.headers=p=ic.from(p),t.url=qU(AF(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),m&&p.set("Authorization","Basic "+btoa((m.username||"")+":"+(m.password?unescape(encodeURIComponent(m.password)):""))),Ge.isFormData(s)){if(Ds.hasStandardBrowserEnv||Ds.hasStandardBrowserWebWorkerEnv)p.setContentType(void 0);else if((r=p.getContentType())!==!1){const[g,...E]=r?r.split(";").map(y=>zi(y).call(y)).filter(Boolean):[];p.setContentType([g||"multipart/form-data",...E].join("; "))}}if(Ds.hasStandardBrowserEnv&&(a&&Ge.isFunction(a)&&(a=a(t)),a||a!==!1&&Hle(t.url))){const g=l&&u&&Gle.read(u);g&&p.set(l,g)}return t},zle=typeof XMLHttpRequest<"u"&&function(e){return new Ye(function(t,r){const s=OF(e);let a=s.data;const l=ic.from(s.headers).normalize();let u,p,m,g,E,{responseType:y,onUploadProgress:b,onDownloadProgress:C}=s;function B(){g&&g(),E&&E(),s.cancelToken&&s.cancelToken.unsubscribe(u),s.signal&&s.signal.removeEventListener("abort",u)}let M=new XMLHttpRequest;function F(){if(!M)return;const Y=ic.from("getAllResponseHeaders"in M&&M.getAllResponseHeaders());wF(function(re){t(re),B()},function(re){r(re),B()},{data:y&&y!=="text"&&y!=="json"?M.response:M.responseText,status:M.status,statusText:M.statusText,headers:Y,config:e,request:M}),M=null}M.open(s.method.toUpperCase(),s.url,!0),M.timeout=s.timeout,"onloadend"in M?M.onloadend=F:M.onreadystatechange=function(){M&&M.readyState===4&&(M.status!==0||M.responseURL&&M.responseURL.indexOf("file:")===0)&&setTimeout(F)},M.onabort=function(){M&&(r(new Sn("Request aborted",Sn.ECONNABORTED,e,M)),M=null)},M.onerror=function(){r(new Sn("Network Error",Sn.ERR_NETWORK,e,M)),M=null},M.ontimeout=function(){let Y=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const re=s.transitional||$U;s.timeoutErrorMessage&&(Y=s.timeoutErrorMessage),r(new Sn(Y,re.clarifyTimeoutError?Sn.ETIMEDOUT:Sn.ECONNABORTED,e,M)),M=null},a===void 0&&l.setContentType(null),"setRequestHeader"in M&&Ge.forEach(l.toJSON(),function(Y,re){M.setRequestHeader(re,Y)}),Ge.isUndefined(s.withCredentials)||(M.withCredentials=!!s.withCredentials),y&&y!=="json"&&(M.responseType=s.responseType),C&&([m,E]=uy(C,!0),M.addEventListener("progress",m)),b&&M.upload&&([p,g]=uy(b),M.upload.addEventListener("progress",p),M.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(u=Y=>{M&&(r(!Y||Y.type?new lf(null,e,M):Y),M.abort(),M=null)},s.cancelToken&&s.cancelToken.subscribe(u),s.signal&&(s.signal.aborted?u():s.signal.addEventListener("abort",u)));const q=function(Y){const re=/^([-+\w]{1,25})(:?\/\/|:)/.exec(Y);return re&&re[1]||""}(s.url);q&&Ds.protocols.indexOf(q)===-1?r(new Sn("Unsupported protocol "+q+":",Sn.ERR_BAD_REQUEST,e)):M.send(a||null)})},Kle=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s,a=new AbortController;const l=function(g){if(!s){s=!0,p();const E=g instanceof Error?g:this.reason;a.abort(E instanceof Sn?E:new lf(E instanceof Error?E.message:E))}};let u=t&&setTimeout(()=>{u=null,l(new Sn("timeout ".concat(t," of ms exceeded"),Sn.ETIMEDOUT))},t);const p=()=>{e&&(u&&clearTimeout(u),u=null,e.forEach(g=>{g.unsubscribe?g.unsubscribe(l):g.removeEventListener("abort",l)}),e=null)};e.forEach(g=>g.addEventListener("abort",l));const{signal:m}=a;return m.unsubscribe=()=>Ge.asap(p),m}},ZR=d(EM),DF=rf.f("asyncIterator"),qle=d(DF);function eA(e,t){this.v=e,this.k=t}function Go(e){return function(){return new eg(e.apply(this,arguments))}}function eg(e){var t,r;function s(l,u){try{var p=e[l](u),m=p.value,g=m instanceof eA;ZR.resolve(g?m.v:m).then(function(E){if(g){var y=l==="return"?"return":"next";if(!m.k||E.done)return s(y,E);E=e[y](E).value}a(p.done?"return":"normal",E)},function(E){s("throw",E)})}catch(E){a("throw",E)}}function a(l,u){switch(l){case"return":t.resolve({value:u,done:!0});break;case"throw":t.reject(u);break;default:t.resolve({value:u,done:!1})}(t=t.next)?s(t.key,t.arg):r=null}this._invoke=function(l,u){return new ZR(function(p,m){var g={key:l,arg:u,resolve:p,reject:m,next:null};r?r=r.next=g:(t=r=g,s(l,u))})},typeof e.return!="function"&&(this.return=void 0)}function Zt(e){return new eA(e,0)}function hy(e){var t={},r=!1;function s(a,l){return r=!0,l=new ZR(function(u){u(e[a](l))}),{done:!1,value:new eA(l,1)}}return t[cf!==void 0&&oF||"@@iterator"]=function(){return this},t.next=function(a){return r?(r=!1,a):s("next",a)},typeof e.throw=="function"&&(t.throw=function(a){if(r)throw r=!1,a;return s("throw",a)}),typeof e.return=="function"&&(t.return=function(a){return r?(r=!1,a):s("return",a)}),t}eg.prototype[typeof cf=="function"&&qle||"@@asyncIterator"]=function(){return this},eg.prototype.next=function(e){return this._invoke("next",e)},eg.prototype.throw=function(e){return this._invoke("throw",e)},eg.prototype.return=function(e){return this._invoke("return",e)};var tA=d(DF);function nA(e){var t,r,s,a=2;for(typeof Symbol<"u"&&(r=tA,s=Symbol.iterator);a--;){if(r&&(t=e[r])!=null)return t.call(e);if(s&&(t=e[s])!=null)return new py(t.call(e));r="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function py(e){function t(r){if(Object(r)!==r)return Ye.reject(new TypeError(r+" is not an object."));var s=r.done;return Ye.resolve(r.value).then(function(a){return{value:a,done:s}})}return py=function(r){this.s=r,this.n=r.next},py.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var s=this.s.return;return s===void 0?Ye.resolve({value:r,done:!0}):t(s.apply(this.s,arguments))},throw:function(r){var s=this.s.return;return s===void 0?Ye.reject(r):t(s.apply(this.s,arguments))}},new py(e)}const Yle=function*(e,t){let r=e.byteLength;if(!t||r<t)return void(yield e);let s,a=0;for(;a<r;)s=a+t,yield e.slice(a,s),a=s},$le=function(){var e=Go(function*(t,r){var s,a=!1,l=!1;try{for(var u,p=nA(Xle(t));a=!(u=yield Zt(p.next())).done;a=!1){const m=u.value;yield*hy(nA(Yle(m,r)))}}catch(m){l=!0,s=m}finally{try{a&&p.return!=null&&(yield Zt(p.return()))}finally{if(l)throw s}}});return function(t,r){return e.apply(this,arguments)}}(),Xle=function(){var e=Go(function*(t){if(t[tA])return void(yield*hy(nA(t)));const r=t.getReader();try{for(;;){const{done:s,value:a}=yield Zt(r.read());if(s)break;yield a}}finally{yield Zt(r.cancel())}});return function(t){return e.apply(this,arguments)}}(),PF=(e,t,r,s)=>{const a=$le(e,t);let l,u=0,p=m=>{l||(l=!0,s&&s(m))};return new ReadableStream({async pull(m){try{const{done:g,value:E}=await a.next();if(g)return p(),void m.close();let y=E.byteLength;if(r){let b=u+=y;r(b)}m.enqueue(new Uint8Array(E))}catch(g){throw p(g),g}},cancel:m=>(p(m),a.return())},{highWaterMark:2})};function kF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function LF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kF(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kF(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const fy=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",MF=fy&&typeof ReadableStream=="function",Jle=fy&&(typeof TextEncoder=="function"?(jF=new TextEncoder,e=>jF.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var jF;const UF=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return!!e(...r)}catch{return!1}},Qle=MF&&UF(()=>{let e=!1;const t=new Request(Ds.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),rA=MF&&UF(()=>Ge.isReadableStream(new Response("").body)),my={stream:rA&&(e=>e.body)};var FF;fy&&(FF=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!my[e]&&(my[e]=Ge.isFunction(FF[e])?t=>t[e]():(t,r)=>{throw new Sn("Response type '".concat(e,"' is not supported"),Sn.ERR_NOT_SUPPORT,r)})}));const Zle=async(e,t)=>{const r=Ge.toFiniteNumber(e.getContentLength());return r??(async s=>s==null?0:Ge.isBlob(s)?s.size:Ge.isSpecCompliantForm(s)?(await new Request(Ds.origin,{method:"POST",body:s}).arrayBuffer()).byteLength:Ge.isArrayBufferView(s)||Ge.isArrayBuffer(s)?s.byteLength:(Ge.isURLSearchParams(s)&&(s+=""),Ge.isString(s)?(await Jle(s)).byteLength:void 0))(t)};var ede=fy&&(async e=>{let{url:t,method:r,data:s,signal:a,cancelToken:l,timeout:u,onDownloadProgress:p,onUploadProgress:m,responseType:g,headers:E,withCredentials:y="same-origin",fetchOptions:b}=OF(e);g=g?(g+"").toLowerCase():"text";let C,B=Kle([a,l&&l.toAbortSignal()],u);const M=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let F;try{if(m&&Qle&&r!=="get"&&r!=="head"&&(F=await Zle(E,s))!==0){let le,ae=new Request(t,{method:"POST",body:s,duplex:"half"});if(Ge.isFormData(s)&&(le=ae.headers.get("content-type"))&&E.setContentType(le),ae.body){const[_e,we]=CF(F,uy(RF(m)));s=PF(ae.body,65536,_e,we)}}Ge.isString(y)||(y=y?"include":"omit");const q="credentials"in Request.prototype;C=new Request(t,LF(LF({},b),{},{signal:B,method:r.toUpperCase(),headers:E.normalize().toJSON(),body:s,duplex:"half",credentials:q?y:void 0}));let Y=await fetch(C);const re=rA&&(g==="stream"||g==="response");if(rA&&(p||re&&M)){const le={};["status","statusText","headers"].forEach(Be=>{le[Be]=Y[Be]});const ae=Ge.toFiniteNumber(Y.headers.get("content-length")),[_e,we]=p&&CF(ae,uy(RF(p),!0))||[];Y=new Response(PF(Y.body,65536,_e,()=>{we&&we(),M&&M()}),le)}g=g||"text";let ce=await my[Ge.findKey(my,g)||"text"](Y,e);return!re&&M&&M(),await new Ye((le,ae)=>{wF(le,ae,{data:ce,headers:ic.from(Y.headers),status:Y.status,statusText:Y.statusText,config:e,request:C})})}catch(q){throw M&&M(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new Sn("Network Error",Sn.ERR_NETWORK,e,C),{cause:q.cause||q}):Sn.from(q,q&&q.code,e,C)}});const iA={http:null,xhr:zle,fetch:ede};Ge.forEach(iA,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const VF=e=>"- ".concat(e),tde=e=>Ge.isFunction(e)||e===null||e===!1;var BF={getAdapter:e=>{e=Ge.isArray(e)?e:[e];const{length:t}=e;let r,s;const a={};for(let l=0;l<t;l++){let u;if(r=e[l],s=r,!tde(r)&&(s=iA[(u=String(r)).toLowerCase()],s===void 0))throw new Sn("Unknown adapter '".concat(u,"'"));if(s)break;a[u||"#"+l]=s}if(!s){const l=Object.entries(a).map(u=>{let[p,m]=u;return"adapter ".concat(p," ")+(m===!1?"is not supported by the environment":"is not available in the build")});throw new Sn("There is no suitable adapter to dispatch the request "+(t?l.length>1?`since :
`+l.map(VF).join(`
`):" "+VF(l[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s},adapters:iA};function sA(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new lf(null,e)}function WF(e){return sA(e),e.headers=ic.from(e.headers),e.data=QR.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),BF.getAdapter(e.adapter||XR.adapter)(e).then(function(t){return sA(e),t.data=QR.call(e,e.transformResponse,t),t.headers=ic.from(t.headers),t},function(t){return bF(t)||(sA(e),t&&t.response&&(t.response.data=QR.call(e,e.transformResponse,t.response),t.response.headers=ic.from(t.response.headers))),Ye.reject(t)})}const HF="1.9.0",gy={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gy[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const GF={};gy.transitional=function(e,t,r){function s(a,l){return"[Axios v"+HF+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return(a,l,u)=>{if(e===!1)throw new Sn(s(l," has been removed"+(t?" in "+t:"")),Sn.ERR_DEPRECATED);return t&&!GF[l]&&(GF[l]=!0,console.warn(s(l," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(a,l,u)}},gy.spelling=function(e){return(t,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};var _y={assertOptions:function(e,t,r){if(typeof e!="object")throw new Sn("options must be an object",Sn.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const l=s[a],u=t[l];if(u){const p=e[l],m=p===void 0||u(p,l,e);if(m!==!0)throw new Sn("option "+l+" must be "+m,Sn.ERR_BAD_OPTION_VALUE)}else if(r!==!0)throw new Sn("Unknown option "+l,Sn.ERR_BAD_OPTION)}},validators:gy};const Gc=_y.validators;let Ey=class{constructor(e){this.defaults=e||{},this.interceptors={request:new YU,response:new YU}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{}).url=e:t=e||{},t=lh(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:a}=t;r!==void 0&&_y.assertOptions(r,{silentJSONParsing:Gc.transitional(Gc.boolean),forcedJSONParsing:Gc.transitional(Gc.boolean),clarifyTimeoutError:Gc.transitional(Gc.boolean)},!1),s!=null&&(Ge.isFunction(s)?t.paramsSerializer={serialize:s}:_y.assertOptions(s,{encode:Gc.function,serialize:Gc.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),_y.assertOptions(t,{baseUrl:Gc.spelling("baseURL"),withXsrfToken:Gc.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=a&&Ge.merge(a.common,a[t.method]);a&&Ge.forEach(["delete","get","head","post","put","patch","common"],C=>{delete a[C]}),t.headers=ic.concat(l,a);const u=[];let p=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(p=p&&C.synchronous,u.unshift(C.fulfilled,C.rejected))});const m=[];let g;this.interceptors.response.forEach(function(C){m.push(C.fulfilled,C.rejected)});let E,y=0;if(!p){const C=[WF.bind(this),void 0];for(C.unshift.apply(C,u),C.push.apply(C,m),E=C.length,g=Ye.resolve(t);y<E;)g=g.then(C[y++],C[y++]);return g}E=u.length;let b=t;for(y=0;y<E;){const C=u[y++],B=u[y++];try{b=C(b)}catch(M){B.call(this,M);break}}try{g=WF.call(this,b)}catch(C){return Ye.reject(C)}for(y=0,E=m.length;y<E;)g=g.then(m[y++],m[y++]);return g}getUri(e){return qU(AF((e=lh(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Ge.forEach(["delete","get","head","options"],function(e){Ey.prototype[e]=function(t,r){return this.request(lh(r||{},{method:e,url:t,data:(r||{}).data}))}}),Ge.forEach(["post","put","patch"],function(e){function t(r){return function(s,a,l){return this.request(lh(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}Ey.prototype[e]=t(),Ey.prototype[e+"Form"]=t(!0)});var vy=Ey;class oA{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Ye(function(a){r=a});const s=this;this.promise.then(a=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](a);s._listeners=null}),this.promise.then=a=>{let l;const u=new Ye(p=>{s.subscribe(p),l=p}).then(a);return u.cancel=function(){s.unsubscribe(l)},u},t(function(a,l,u){s.reason||(s.reason=new lf(a,l,u),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new oA(function(s){t=s}),cancel:t}}}var nde=oA;const aA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(aA).forEach(e=>{let[t,r]=e;aA[r]=t});var rde=aA;const ki=function e(t){const r=new vy(t),s=IU(vy.prototype.request,r);return Ge.extend(s,vy.prototype,r,{allOwnKeys:!0}),Ge.extend(s,r,null,{allOwnKeys:!0}),s.create=function(a){return e(lh(t,a))},s}(XR);ki.Axios=vy,ki.CanceledError=lf,ki.CancelToken=nde,ki.isCancel=bF,ki.VERSION=HF,ki.toFormData=Qv,ki.AxiosError=Sn,ki.Cancel=ki.CanceledError,ki.all=function(e){return Ye.all(e)},ki.spread=function(e){return function(t){return e.apply(null,t)}},ki.isAxiosError=function(e){return Ge.isObject(e)&&e.isAxiosError===!0},ki.mergeConfig=lh,ki.AxiosHeaders=ic,ki.formToJSON=e=>xF(Ge.isHTMLForm(e)?new FormData(e):e),ki.getAdapter=BF.getAdapter,ki.HttpStatusCode=rde,ki.default=ki;var _s=ki;const ide=()=>{};function tg(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:ide};return e.promise=new Ye((t,r)=>{e.resolve=s=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(s),e.value=s)},e.reject=s=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,r(s))}}),e}const yy=new Map,Sy=new Map,zc=new Map;let Ur=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),cn=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const cA=new Loe;let sc=cA.getResult(),lA=null;function en(e){if(!lA){e&&cA.setUA(e),sc=cA.getResult();const t=function(p){if(p.engine.name==="Blink"&&p.browser.name!=="WeChat")return cn.CHROME;switch(p.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return cn.CHROME;case"Safari":case"Mobile Safari":return cn.SAFARI;case"Edge":return cn.EDGE;case"Firefox":return cn.FIREFOX;case"QQ":case"QQBrowser":return cn.QQ;case"Opera":return cn.OPERA;case"WeChat":return cn.WECHAT;default:return p.browser.name||""}}(sc),r=zF(sc),s=function(p){return p.os.name==="Windows"?p.os.version?p.os.name+" "+p.os.version:p.os.name:p.os.name||""}(sc),a=sc.os.version,l=zF(sc,!1),u=sc.device.type;if(!(t&&r&&s&&a))return{name:t,version:r,os:s,osVersion:a,browserVersion:l,deviceType:u};lA={name:t,version:r,os:s,osVersion:a,browserVersion:l,deviceType:u}}return lA}function zF(e){let t,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return t=e.engine.name==="Blink"?e.engine.version||"":e.browser.version||"",r?t.split(".")[0]:t}function xy(){return en().os}function KF(){const e=en();return"".concat(e.os," ").concat(e.osVersion)}function Ty(){const e=en();return!!(sc.engine.name==="WebKit"&&e.os===Ur.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==cn.SAFARI||ss()&&e.name!==cn.SAFARI)}function Dl(){return en().name===cn.CHROME}function vi(){return en().name===cn.SAFARI}function qF(){return en().name===cn.EDGE}function rr(){return en().name===cn.FIREFOX}function ss(){return en().os===Ur.IOS}function ng(e){const t=en();return!(t.name!==cn.CHROME||!t.osVersion)&&Number(t.version)>=e}function YF(e){const t=en();return!(t.name!==cn.CHROME||!t.osVersion)&&Number(t.version)<e}function dA(e,t,r){const s=en();return!(s.name!==e||!s.osVersion)&&(r?Number(s.version)>=t&&Number(s.version)<=r:Number(s.version)===t)}function uA(e){const t=en();return!(t.name!==cn.EDGE||!t.osVersion)&&Number(t.version)>=e}function $F(e){const t=en();return!(t.name!==cn.SAFARI||!t.osVersion)&&Number(t.version)>=e}function XF(e,t,r){const s=en();if(s.os!==Ur.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return r?t&&Number(a[0])===e&&Number(a[1])<t||Number(a[0])<e:t?Number(a[0])===e&&Number(a[1])<=t||Number(a[0])<e:Number(a[0])<=e}function JF(e,t,r){const s=en();if(s.name!==cn.SAFARI||!s.osVersion||!s.browserVersion)return!1;const a=s.browserVersion.split(".");return r?t&&Number(a[0])===e&&Number(a[1])<t||Number(a[0])<e:t?Number(a[0])===e&&Number(a[1])<=t||Number(a[0])<e:Number(a[0])<=e}function hA(e){const t=en();return!(t.name!==cn.OPERA||!t.osVersion)&&Number(t.version)>=e}function QF(){const e=en();if(e.os!==Ur.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||Number(t[0])===14&&Number(t[1])<=6}function df(){const e=en();if(e.os!==Ur.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])===15}function pA(){const e=en();if(e.os!==Ur.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])===16}function ZF(){const e=en();if(e.os!==Ur.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])===15&&Number(t[1])>=1}function xa(){return vi()&&navigator.maxTouchPoints>0}function eV(){return en().name===cn.WECHAT}function tV(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function fA(){const e=xy();return function(){const{deviceType:t}=en();return t==="mobile"||t==="tablet"}()||e===Ur.ANDROID||e===Ur.IOS||e===Ur.HARMONY_OS}function Pl(){const e=en();return e.name!==cn.EDGE&&e.name!==cn.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function by(){return xy()===Ur.ANDROID}function rg(){const e=en();return by()&&(e.name===cn.CHROME||e.name===cn.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function Ct(e,t,r){return(t=function(s){var a=function(l,u){if(typeof l!="object"||!l)return l;var p=l[Symbol.toPrimitive];if(p!==void 0){var m=p.call(l,"string");if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s);return typeof a=="symbol"?a:a+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function tt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nV(Object(r),!0).forEach(function(s){Ct(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nV(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let $=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),Se=class extends Error{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;super(t),Ct(this,"code",void 0),Ct(this,"message",void 0),Ct(this,"data",void 0),Ct(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=r}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return e==="error"&&(t||console).error(this.toString()),e==="warning"&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function kl(e,t){if(typeof e!="boolean")throw new Se($.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function Mr(e,t,r){if(!je(r).call(r,e))throw new Se($.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(r)))}function xn(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(e<r||e>s||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(a){return typeof a=="number"&&a%1==0}(e))throw new Se($.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(r,", ").concat(s,"]. integer only"))}function mA(e,t){if(typeof e!="number"){if(!(e.min||e.max||e.ideal||e.exact))throw new Se($.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));e.min!==void 0&&xn(e.min,"".concat(t,".min"),0,1/0),e.max!==void 0&&xn(e.max,"".concat(t,".max"),1,1/0),e.exact!==void 0&&xn(e.exact,"".concat(t,".exact"),1,1/0),e.ideal!==void 0&&xn(e.ideal,"".concat(t,".ideal"),1,1/0)}else xn(e,t,1,1/0)}function oi(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e==null)throw new Se($.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!rV(e,r,s,a))throw new Se($.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(r,",").concat(s,"].").concat(a?" ASCII characters only.":""))}function Ll(e,t){if(!Array.isArray(e))throw new Se($.INVALID_PARAMS,"".concat(t," should be an array"))}function ir(e){return e==null}function rV(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof e=="string"&&e.length<=r&&e.length>=t&&(!s||function(a){if(typeof a!="string")return!1;for(let l=0;l<a.length;l+=1){const u=a.charCodeAt(l);if(u<0||u>255)return!1}return!0}(e))}var ig=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(ig||{}),gA=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}(gA||{});const iV=new class{constructor(){Ct(this,"_clientSize",null),Ct(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),Ct(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),Ct(this,"getStyle",e=>window.getComputedStyle(e,null)),Ct(this,"checkCssVisibleProperty",e=>{var t;let r=!0;const s=this.getStyle(e),{display:a,visibility:l,opacity:u,filter:p}=s;return(a==="none"||je(t=["hidden","collapse"]).call(t,l)||Number(u)<.1)&&(r=!1),!!r&&(p&&p.split(" ").filter(m=>{var g;const E=m.split("(")[0];return je(g=["brightness","blur","opacity"]).call(g,E)}).map(m=>{const[g,E]=m.split(/\(|\)/);return[g,Number(E.match(/^[0-9\.]+/))]}).forEach(m=>{const[g,E]=m;switch(g){case"brightness":(E<.1||E>3)&&(r=!1);break;case"blur":E>3&&(r=!1);break;case"opacity":E<.1&&(r=!1)}}),r)}),Ct(this,"checkPropertyUpToAllParentNodes",(e,t)=>{let r=!0,s=!0;const a=u=>t(u);let l=e;for(;l&&s;)a(l)||(r=!1,s=!1),l=l.parentElement,l||(s=!1);return r}),Ct(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),Ct(this,"getSizeAboutClient",e=>{const{width:t,height:r,left:s,right:a,top:l,bottom:u}=e.getBoundingClientRect(),p=this.getClientWidth(),m=this.getClientHeight();return{width:t,height:r,left:s,right:a,top:l,bottom:u,clientWidth:p,clientHeight:m,clientMin:Math.min(p,m)}}),Ct(this,"checkActualSize",()=>{const{width:e,height:t,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(e,t,r)}),Ct(this,"elementFromPoint",(e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null),Ct(this,"checkCoverForAPoint",(e,t,r)=>{const s=this.elementFromPoint(e,t);return s!==null&&s!==r}),Ct(this,"getPointPositionList",()=>{const{width:e,height:t,left:r,top:s}=this._clientSize,a=e/6,l=t/6,u=[],p=10**6;for(let m=0;m<5;m++)for(let g=0;g<5;g++){const E=(r*p+(m===0?.1:m===4?(a*m*p-1e5)/p:a*m)*p)/p,y=(s*p+(g===0?.1:g===4?(l*g*p-1e5)/p:l*g)*p)/p;u.push({x:E,y})}return[...u]}),Ct(this,"checkElementCover",e=>this.getPointPositionList().map(t=>this.checkCoverForAPoint(t.x,t.y,e)).filter(t=>!!t).length>6),Ct(this,"checkSizeIsVisible",(e,t,r)=>(e>50||r/e<=10)&&(t>50||r/t<=10)),Ct(this,"checkSizeOfPartInClient",()=>{const{left:e,right:t,top:r,bottom:s,clientHeight:a,clientWidth:l,clientMin:u}=this._clientSize;let p,m,g,E;if(e<0)p=0;else{if(!(e<l))return!1;p=e}if(t<0)return!1;if(m=t<l?t:l,r<0)g=0;else{if(!(r<a))return!1;g=r}if(s<0)return!1;E=s<a?s:a;const y=m-p,b=E-g;return this.checkSizeIsVisible(y,b,u)}),Ct(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),Ct(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(ig.COVERED);{const t=this.checkActualSize(),r=this.checkSizeOfPartInClient();return t&&!r?this.returnHiddenResult(ig.POSITION):t?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(ig.SIZE)}}return this.returnHiddenResult(ig.STYLE)}return this.returnHiddenResult(gA.UNMOUNTED)}return this.returnHiddenResult(gA.INVALID_HTML_ELEMENT)}),Ct(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,t=>t.nodeName.toUpperCase()!=="HTML"?t.parentElement!==null:!!document.documentElement))}};function _A(e){return new TextEncoder().encode(e)}const sV=function(e,t){const r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r},EA=async e=>function(t,r){let s="";return new Uint8Array(t).forEach(a=>{s+=a.toString(r).padStart(2,"0")}),s}(await crypto.subtle.digest("SHA-256",_A(e)),16);let Zn=class{constructor(){Ct(this,"_events",{}),Ct(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map(t=>t.listener):[]}on(e,t){this._events[e]||(this._events[e]=[]);const r=this._events[e];this._indexOfListener(r,t)===-1&&r.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const r=this._events[e];this._indexOfListener(r,t)===-1&&r.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const r=this._events[e],s=this._indexOfListener(r,t);s!==-1&&r.splice(s,1),this._events[e].length===0&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map(l=>l);for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];for(let l=0;l<t.length;l+=1){const u=t[l];u.once&&this.off(e,u.listener),u.listener.apply(this,s||[])}}safeEmit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];[...this._events[e]||[]].forEach(a=>{a.once&&this.off(e,a.listener);try{a.listener.apply(this,r)}catch(l){console.error("safeEmit event:".concat(e," error ").concat(l==null?void 0:l.toString()))}})}_indexOfListener(e,t){let r=e.length;for(;r--;)if(e[r].listener===t)return r;return-1}},sg=null;function oV(){if(sg)return sg;if(window.electron)return sg=window.electron;if(!window.require)return null;try{return sg=window.require("electron"),sg}catch{return null}}let xr=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",e}({}),sr=function(e){return e.TRACER="tracer",e}({});function aV(e){return xn(e.timeout,"config.timeout",0,1e5),xn(e.timeoutFactor,"config.timeoutFactor",0,100,!1),xn(e.maxRetryCount,"config.maxRetryConfig",0,1/0),xn(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let sde=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),hn=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function og(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(t=>{if(!t.urls)throw Error()})}catch{return!1}return!0}function cV(e){return oi(e.turnServerURL,"turnServerURL"),oi(e.username,"username"),oi(e.password,"password"),e.udpport&&xn(e.udpport,"udpport",1,99999,!0),e.forceturn&&kl(e.forceturn,"forceturn"),e.security&&kl(e.security,"security"),e.tcpport&&xn(e.tcpport,"tcpport",1,99999,!0),!0}function vA(e){return e.level!==void 0&&Mr(e.level,"level",[1,2,3]),e.delay!==void 0&&xn(e.delay,"delay",0,3e3,!0),!0}let Ht=function(e){return e.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",e.AUDIO_METADATA="audio-metadata",e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),yi=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",e}({}),Qs=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),uf=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function Si(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];return e.getListeners(t).length===0?Ye.reject(new Se($.UNEXPECTED_ERROR,"can not emit promise")):new Ye((l,u)=>{e.emit(t,...s,l,u)})}function Cn(e,t){if(e.getListeners(t).length===0)return Ye.resolve();for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];return Si(e,t,...s)}function mo(e,t){if(e.getListeners(t).length===0)return null;for(var r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];return ag(e,t,...s)}function ag(e,t){let r=null,s=null;for(var a=arguments.length,l=new Array(a>2?a-2:0),u=2;u<a;u++)l[u-2]=arguments[u];if(e.emit(t,...l,p=>{r=p},p=>{s=p}),s!==null)throw s;if(r===null)throw new Se($.UNEXPECTED_ERROR,"handler is not sync");return r}const Tr=new class extends Zn{set networkState(e){this.emit(uf.NETWORK_STATE_CHANGE,e,this._networkState),e===Qs.ONLINE?this.emit(uf.ONLINE):e===Qs.OFFLINE&&(this.onlineWaiter=new Ye(t=>{this.once(uf.ONLINE,()=>{this.onlineWaiter=void 0,t(Qs.ONLINE)})}),this.emit(uf.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===Qs.ONLINE}constructor(){super(),Ct(this,"_moduleName","network-indicator"),Ct(this,"_networkState",Qs.ONLINE),Ct(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Qs.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Qs.OFFLINE})}};function wy(e,t){const r=e.indexOf(t);r!==-1&&e.splice(r,1)}function hf(e){const t=[];return e.forEach(r=>{t.indexOf(r)===-1&&t.push(r)}),t}function Cy(e){Ye!==void 0?Ye.resolve().then(e):setTimeout(e,0)}function er(e){return JSON.parse(JSON.stringify(e))}function dh(e){try{return er(e)}catch{return e}}const lV={};function Od(e,t){lV[t]||(lV[t]=!0,e())}function uh(e){const t=window.atob(e),r=new Uint8Array(new ArrayBuffer(t.length));for(let s=0;s<t.length;s+=1)r[s]=t.charCodeAt(s);return r}function Dd(e){let t="";for(let r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return window.btoa(t)}function dV(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,r=new TextEncoder().encode(e);if(r.length>t)r=r.slice(0,t);else if(r.length<t){const s=new Uint8Array(t);s.set(r),r=s}return r}function uV(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=ma(t).call(t,(u,p)=>u+p.length,0),a=new Uint8Array(new ArrayBuffer(s));let l=0;return t.forEach(u=>{a.set(u,l),l+=u.length}),a}function Kc(e){return window.TextEncoder?new TextEncoder().encode(e).length:e.length}function hV(e){let t=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach(r=>{t+=typeof r=="string"?Kc(r):r.size}),t+138}function ode(e){const t=new Se($.TIMEOUT,"timeout");return new Ye((r,s)=>{window.setTimeout(()=>s(t),e)})}function ai(e){return new Ye(t=>{window.setTimeout(t,e)})}function An(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const r=Math.random().toString(16).substr(2,e).toLowerCase();return r.length===e?"".concat(t).concat(r):"".concat(t).concat(r)+An(e-r.length,"")}function hh(){return An(32,"").toUpperCase()}const Ry=()=>{},pV=new class{constructor(){Ct(this,"fnMap",new Map)}throttleByKey(e,t,r,s){for(var a=arguments.length,l=new Array(a>4?a-4:0),u=4;u<a;u++)l[u-4]=arguments[u];if(this.fnMap.has(t)){const p=this.fnMap.get(t);if(p.threshold!==r){p.fn(...p.args),clearTimeout(p.timer);const m=window.setTimeout(()=>{const g=this.fnMap.get(t);g&&g.fn(...g.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:m,args:l,skipFn:s})}else p.skipFn&&p.skipFn(...p.args),this.fnMap.set(t,tt(tt({},p),{},{fn:e,args:l,skipFn:s}))}else{const p=window.setTimeout(()=>{const m=this.fnMap.get(t);m&&m.fn(...m.args),this.fnMap.delete(t)},r);this.fnMap.set(t,{fn:e,threshold:r,timer:p,args:l,skipFn:s})}}},fV=pV.throttleByKey.bind(pV);function mV(e){return typeof e=="object"&&e!==null&&!(e instanceof RegExp)}function yA(e,t){if(!mV(e)||!mV(t)||Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const r=[...e];for(let s=0;s<t.length;s++)r[s]=yA(e[s],t[s]);return r}{const r=tt({},e);for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(Object.prototype.hasOwnProperty.call(e,s)?r[s]=yA(e[s],t[s]):r[s]=t[s]);return r}}function gV(e,t){let r=[0];if(t&&(r=new Array(t).fill(0)),e===0)return r;let s=0;for(;e>0&&(r[s]=255&e,e>>=8,s++,!t||s!==t););return r}function SA(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function xA(e){return ma(e).call(e,(t,r)=>t+r,0)}function _V(e){const t="0123456789abcdef";function r(re){let ce,le="";for(ce=0;ce<=3;ce++)le+=t.charAt(re>>8*ce+4&15)+t.charAt(re>>8*ce&15);return le}function s(re,ce){const le=(65535&re)+(65535&ce);return(re>>16)+(ce>>16)+(le>>16)<<16|65535&le}function a(re,ce,le,ae,_e,we){return s(function(Be,Xe){return Be<<Xe|Be>>>32-Xe}(s(s(ce,re),s(ae,we)),_e),le)}function l(re,ce,le,ae,_e,we,Be){return a(ce&le|~ce&ae,re,ce,_e,we,Be)}function u(re,ce,le,ae,_e,we,Be){return a(ce&ae|le&~ae,re,ce,_e,we,Be)}function p(re,ce,le,ae,_e,we,Be){return a(ce^le^ae,re,ce,_e,we,Be)}function m(re,ce,le,ae,_e,we,Be){return a(le^(ce|~ae),re,ce,_e,we,Be)}const g=function(re){let ce;const le=1+(re.length+8>>6),ae=new Array(16*le);for(ce=0;ce<16*le;ce++)ae[ce]=0;for(ce=0;ce<re.length;ce++)ae[ce>>2]|=re.charCodeAt(ce)<<ce%4*8;return ae[ce>>2]|=128<<ce%4*8,ae[16*le-2]=8*re.length,ae}(e);let E,y,b,C,B,M=1732584193,F=-271733879,q=-1732584194,Y=271733878;for(E=0;E<g.length;E+=16)y=M,b=F,C=q,B=Y,M=l(M,F,q,Y,g[E+0],7,-680876936),Y=l(Y,M,F,q,g[E+1],12,-389564586),q=l(q,Y,M,F,g[E+2],17,606105819),F=l(F,q,Y,M,g[E+3],22,-1044525330),M=l(M,F,q,Y,g[E+4],7,-176418897),Y=l(Y,M,F,q,g[E+5],12,1200080426),q=l(q,Y,M,F,g[E+6],17,-1473231341),F=l(F,q,Y,M,g[E+7],22,-45705983),M=l(M,F,q,Y,g[E+8],7,1770035416),Y=l(Y,M,F,q,g[E+9],12,-1958414417),q=l(q,Y,M,F,g[E+10],17,-42063),F=l(F,q,Y,M,g[E+11],22,-1990404162),M=l(M,F,q,Y,g[E+12],7,1804603682),Y=l(Y,M,F,q,g[E+13],12,-40341101),q=l(q,Y,M,F,g[E+14],17,-1502002290),F=l(F,q,Y,M,g[E+15],22,1236535329),M=u(M,F,q,Y,g[E+1],5,-165796510),Y=u(Y,M,F,q,g[E+6],9,-1069501632),q=u(q,Y,M,F,g[E+11],14,643717713),F=u(F,q,Y,M,g[E+0],20,-373897302),M=u(M,F,q,Y,g[E+5],5,-701558691),Y=u(Y,M,F,q,g[E+10],9,38016083),q=u(q,Y,M,F,g[E+15],14,-660478335),F=u(F,q,Y,M,g[E+4],20,-405537848),M=u(M,F,q,Y,g[E+9],5,568446438),Y=u(Y,M,F,q,g[E+14],9,-1019803690),q=u(q,Y,M,F,g[E+3],14,-187363961),F=u(F,q,Y,M,g[E+8],20,1163531501),M=u(M,F,q,Y,g[E+13],5,-1444681467),Y=u(Y,M,F,q,g[E+2],9,-51403784),q=u(q,Y,M,F,g[E+7],14,1735328473),F=u(F,q,Y,M,g[E+12],20,-1926607734),M=p(M,F,q,Y,g[E+5],4,-378558),Y=p(Y,M,F,q,g[E+8],11,-2022574463),q=p(q,Y,M,F,g[E+11],16,1839030562),F=p(F,q,Y,M,g[E+14],23,-35309556),M=p(M,F,q,Y,g[E+1],4,-1530992060),Y=p(Y,M,F,q,g[E+4],11,1272893353),q=p(q,Y,M,F,g[E+7],16,-155497632),F=p(F,q,Y,M,g[E+10],23,-1094730640),M=p(M,F,q,Y,g[E+13],4,681279174),Y=p(Y,M,F,q,g[E+0],11,-358537222),q=p(q,Y,M,F,g[E+3],16,-722521979),F=p(F,q,Y,M,g[E+6],23,76029189),M=p(M,F,q,Y,g[E+9],4,-640364487),Y=p(Y,M,F,q,g[E+12],11,-421815835),q=p(q,Y,M,F,g[E+15],16,530742520),F=p(F,q,Y,M,g[E+2],23,-995338651),M=m(M,F,q,Y,g[E+0],6,-198630844),Y=m(Y,M,F,q,g[E+7],10,1126891415),q=m(q,Y,M,F,g[E+14],15,-1416354905),F=m(F,q,Y,M,g[E+5],21,-57434055),M=m(M,F,q,Y,g[E+12],6,1700485571),Y=m(Y,M,F,q,g[E+3],10,-1894986606),q=m(q,Y,M,F,g[E+10],15,-1051523),F=m(F,q,Y,M,g[E+1],21,-2054922799),M=m(M,F,q,Y,g[E+8],6,1873313359),Y=m(Y,M,F,q,g[E+15],10,-30611744),q=m(q,Y,M,F,g[E+6],15,-1560198380),F=m(F,q,Y,M,g[E+13],21,1309151649),M=m(M,F,q,Y,g[E+4],6,-145523070),Y=m(Y,M,F,q,g[E+11],10,-1120210379),q=m(q,Y,M,F,g[E+2],15,718787259),F=m(F,q,Y,M,g[E+9],21,-343485551),M=s(M,y),F=s(F,b),q=s(q,C),Y=s(Y,B);return r(M)+r(F)+r(q)+r(Y)}let ade=1,EV=console,Ai=class{static setLogger(e){EV=e}constructor(e,t){Ct(this,"id",void 0),Ct(this,"lockingPromise",Ye.resolve()),Ct(this,"locks",0),Ct(this,"name",""),Ct(this,"lockId",void 0),this.lockId=ade++,e&&(this.name=e),t&&(this.id=t),this.logger("created")}logger(e,t){const r=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),s=e==="created"?"is ".concat(e,"."):"is ".concat(e,", current queue ").concat(this.locks,". ").concat(t??"");EV.debug("".concat(r," ").concat(s))}setId(e){this.id=e}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,this.logger("locked",e);const r=new Ye(a=>{t=()=>{this.locks-=1,this.logger("unlocked",e),a()}}),s=this.lockingPromise.then(()=>t);return this.lockingPromise=this.lockingPromise.then(()=>r),s}};function pf(e,t){return function(r,s,a){const l=a.value;if(typeof l!="function")throw new Error("Cannot use mutex on object property.");return a.value=async function(){const u=this[t];if(!u)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const p=await u.lock("From ".concat(e,".").concat(s));try{for(var m=arguments.length,g=new Array(m),E=0;E<m;E++)g[E]=arguments[E];return await l.apply(this,g)}finally{p()}},a}}const Rr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function TA(e,t){const r=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,r)}function oc(e,t,r,s){const a=Object.assign({},Rr,s);let l=a.timeout;const u=async()=>{await function(g){return new Ye(E=>{window.setTimeout(E,g)})}(l),l*=a.timeoutFactor,l=Math.min(a.maxRetryTimeout,l)};let p=!1;const m=new Ye(async(g,E)=>{t=t||(()=>!1),r=r||(()=>!0);for(let y=0;y<a.maxRetryCount;y+=1){if(p)return E(new Se($.OPERATION_ABORTED));try{const b=await e();if(!t(b,y)||y+1===a.maxRetryCount)return g(b);await u()}catch(b){if(!r(b,y)||y+1===a.maxRetryCount)return E(b);await u()}}});return m.cancel=()=>p=!0,m}let Ay,vV=class{constructor(e){Ct(this,"input",[]),Ct(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return this.input.length===0?0:ma(e=this.input).call(e,(t,r)=>t+r)/this.input.length}},Ny=0,bA=0;function wA(e,t,r,s){return new Ye((a,l)=>{t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),Ny+=Kc(t.data)):r&&(t.data.size?Ny+=t.data.size:t.data instanceof FormData?Ny+=hV(t.data):Ny+=Kc(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,_s.request(t).then(u=>{typeof u.data=="string"?bA+=Kc(u.data):u.data instanceof ArrayBuffer||u.data instanceof Uint8Array?bA+=u.data.byteLength:bA+=Kc(JSON.stringify(u.data)),s&&a({data:u.data,headers:u.headers}),a(u.data)}).catch(u=>{_s.isCancel(u)?l(new Se($.OPERATION_ABORTED,"cancel token canceled")):u.code==="ECONNABORTED"?l(new Se($.NETWORK_TIMEOUT,u.message)):u.response?l(new Se($.NETWORK_RESPONSE_ERROR,u.response.status)):l(new Se($.NETWORK_ERROR,u.message))})})}async function cde(e,t){const r=new Blob([t.data],{type:"buffer"});return await wA(e,tt(tt({},t),{},{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}const yV=()=>window.isSecureContext!==void 0;function Ta(e){if(Array.isArray(e))return e.map(r=>r);if(!SV(e))return e;const t={};for(const r in e){const s=e[r];SV(s)||Array.isArray(s)?t[r]=Ta(s):t[r]=s}return t}function SV(e){return!(typeof e!="object"||Array.isArray(e)||!e)}let CA=class{constructor(e){Ct(this,"input",[]),Ct(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const qc={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},cg={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:qc,remoteCandidate:qc},updateInterval:0},xV={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},TV={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},bV={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},wV={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let RA=class{constructor(e,t){Ct(this,"onFirstVideoReceived",void 0),Ct(this,"onFirstVideoDecoded",void 0),Ct(this,"onFirstAudioReceived",void 0),Ct(this,"onFirstVideoDecodedTimeout",void 0),Ct(this,"onFirstAudioDecoded",void 0),Ct(this,"onSelectedLocalCandidateChanged",void 0),Ct(this,"onSelectedRemoteCandidateChanged",void 0),Ct(this,"videoIsReady",!1),Ct(this,"videoIsReady2",{}),Ct(this,"pc",void 0),Ct(this,"options",void 0),Ct(this,"intervalTimer",void 0),Ct(this,"stats",Ta(cg)),Ct(this,"isFirstVideoReceived",{}),Ct(this,"isFirstVideoDecoded",{}),Ct(this,"isFirstAudioReceived",{}),Ct(this,"isFirstAudioDecoded",{}),Ct(this,"isFirstVideoDecodedTimeout",{}),Ct(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new Ye(e=>{e({local:tt({},qc),remote:tt({},qc)})})}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const t=this.lossRateWindowStats.length,r=["videoSend","audioSend","videoRecv","audioRecv"];let s=0,a=0,l=0,u=0;for(const p of r)e[p].forEach((m,g)=>{if(!this.lossRateWindowStats[t-1][p][g]||!this.lossRateWindowStats[0][p][g])return;const E=this.lossRateWindowStats[t-1][p][g].packets-this.lossRateWindowStats[0][p][g].packets,y=this.lossRateWindowStats[t-1][p][g].packetsLost-this.lossRateWindowStats[0][p][g].packetsLost;p==="videoSend"||p==="audioSend"?(s+=E,l+=y):(a+=E,u+=y),Number.isNaN(E)||Number.isNaN(E)?m.packetLostRate=0:m.packetLostRate=E<=0||y<=0?0:y/(E+y)});e.sendPacketLossRate=s<=0||l<=0?0:l/(s+l),e.recvPacketLossRate=a<=0||u<=0?0:u/(a+u)}},lde=class extends RA{constructor(){super(...arguments),Ct(this,"_stats",cg),Ct(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=Ta(cg);const r=t.filter(a=>a.type==="ssrc");this.processSSRCStats(r);const s=t.find(a=>a.type==="VideoBwe");s&&this.processBandwidthStats(s),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach(t=>{var r;const s=je(r=t.id).call(r,"send");switch("".concat(t.mediaType,"_").concat(s?"send":"recv")){case"video_send":{const a=Ta(TV);a.codec=t.googCodecName,a.adaptionChangeReason="none",t.googCpuLimitedResolution&&(a.adaptionChangeReason="cpu"),t.googBandwidthLimitedResolution&&(a.adaptionChangeReason="bandwidth"),a.avgEncodeMs=Number(t.googAvgEncodeMs),a.inputFrame={width:Number(t.googFrameWidthInput)||Number(t.googFrameWidthSent),height:Number(t.googFrameHeightInput)||Number(t.googFrameHeightSent),frameRate:Number(t.googFrameRateInput)},a.sentFrame={width:Number(t.googFrameWidthSent),height:Number(t.googFrameHeightSent),frameRate:Number(t.googFrameRateInput)},a.firsCount=Number(t.googFirReceived),a.nacksCount=Number(t.googNacksReceived),a.plisCount=Number(t.googPlisReceived),a.frameCount=Number(t.framesEncoded),a.bytes=Number(t.bytesSent),a.packets=Number(t.packetsSent),a.packetsLost=Number(t.packetsLost),a.ssrc=Number(t.ssrc),a.rttMs=Number(t.googRtt||0),this._stats.videoSend.push(a),this._stats.rtt=a.rttMs;break}case"video_recv":{const a=Ta(xV),l=this.lastDecodeVideoReceiverStats.get(Number(t.ssrc));if(a.codec=t.googCodecName,a.targetDelayMs=Number(t.googTargetDelayMs),a.renderDelayMs=Number(t.googRenderDelayMs),a.currentDelayMs=Number(t.googCurrentDelayMs),a.minPlayoutDelayMs=Number(t.googMinPlayoutDelayMs),a.decodeMs=Number(t.googDecodeMs),a.maxDecodeMs=Number(t.googMaxDecodeMs),a.receivedFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateReceived)},a.decodedFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateDecoded)},a.decodeFrameRate=Number(t.googFrameRateDecoded),a.outputFrame={width:Number(t.googFrameWidthReceived),height:Number(t.googFrameHeightReceived),frameRate:Number(t.googFrameRateOutput)},a.jitterBufferMs=Number(t.googJitterBufferMs),a.firsCount=Number(t.googFirsSent),a.nacksCount=Number(t.googNacksSent),a.plisCount=Number(t.googPlisSent),a.framesDecodeCount=Number(t.framesDecoded),a.bytes=Number(t.bytesReceived),a.packets=Number(t.packetsReceived),a.packetsLost=Number(t.packetsLost),a.ssrc=Number(t.ssrc),a.packets>0&&!this.isFirstVideoReceived[a.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(a.ssrc),this.isFirstVideoReceived[a.ssrc]=!0),a.framesDecodeCount>0&&!this.isFirstVideoDecoded[a.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(a.ssrc,a.decodedFrame.width,a.decodedFrame.height),this.isFirstVideoDecoded[a.ssrc]=!0),l){const u=l.stats,p=Date.now()-l.lts;a.framesDecodeFreezeTime=u.framesDecodeFreezeTime,a.framesDecodeInterval=u.framesDecodeInterval,a.framesDecodeCount>u.framesDecodeCount&&this.isFirstVideoDecoded[a.ssrc]?(l.lts=Date.now(),a.framesDecodeInterval=p,a.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(t.ssrc,10))?a.framesDecodeFreezeTime+=a.framesDecodeInterval:this.setVideoIsReady2(parseInt(t.ssrc,10),!0))):a.framesDecodeCount<l.stats.framesDecodeCount&&(a.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(a.ssrc,{stats:tt({},a),lts:Date.now()}),this._stats.videoRecv.push(a);break}case"audio_recv":{const a=Ta(wV);a.codec=t.googCodecName,a.outputLevel=Math.abs(Number(t.audioOutputLevel))/32767,a.decodingCNG=Number(t.googDecodingCNG),a.decodingCTN=Number(t.googDecodingCTN),a.decodingCTSG=Number(t.googDecodingCTSG),a.decodingNormal=Number(t.googDecodingNormal),a.decodingPLC=Number(t.googDecodingPLC),a.decodingPLCCNG=Number(t.googDecodingPLCCNG),a.expandRate=Number(t.googExpandRate),a.accelerateRate=Number(t.googAccelerateRate),a.preemptiveExpandRate=Number(t.googPreemptiveExpandRate),a.secondaryDecodedRate=Number(t.googSecondaryDecodedRate),a.speechExpandRate=Number(t.googSpeechExpandRate),a.preferredJitterBufferMs=Number(t.googPreferredJitterBufferMs),a.jitterBufferMs=Number(t.googJitterBufferMs),a.jitterMs=Number(t.googJitterReceived),a.bytes=Number(t.bytesReceived),a.packets=Number(t.packetsReceived),a.packetsLost=Number(t.packetsLost),a.ssrc=Number(t.ssrc),a.receivedFrames=Number(t.googDecodingCTN)||Number(t.packetsReceived),a.droppedFrames=Number(t.googDecodingPLC)+Number(t.googDecodingPLCCNG)||Number(t.packetsLost),a.receivedFrames>0&&!this.isFirstAudioReceived[a.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(a.ssrc),this.isFirstAudioReceived[a.ssrc]=!0),a.decodingNormal>0&&!this.isFirstAudioDecoded[a.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(a.ssrc),this.isFirstAudioDecoded[a.ssrc]=!0),this._stats.audioRecv.push(a);break}case"audio_send":{const a=Ta(bV);a.codec=t.googCodecName,a.inputLevel=Math.abs(Number(t.audioInputLevel))/32767,a.aecReturnLoss=Number(t.googEchoCancellationReturnLoss||0),a.aecReturnLossEnhancement=Number(t.googEchoCancellationReturnLossEnhancement||0),a.residualEchoLikelihood=Number(t.googResidualEchoLikelihood||0),a.residualEchoLikelihoodRecentMax=Number(t.googResidualEchoLikelihoodRecentMax||0),a.bytes=Number(t.bytesSent),a.packets=Number(t.packetsSent),a.packetsLost=Number(t.packetsLost),a.ssrc=Number(t.ssrc),a.rttMs=Number(t.googRtt||0),this._stats.rtt=a.rttMs,this._stats.audioSend.push(a);break}}})}_getStats(){return new Ye((e,t)=>{this.pc.getStats(e,t)})}statsResponsesToObjects(e){const t=[];return e.result().forEach(r=>{const s={id:r.id,timestamp:r.timestamp.valueOf().toString(),type:r.type};r.names().forEach(a=>{s[a]=r.stat(a)}),t.push(s)}),t}},lg=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({}),Iy=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),AA=function(e){return e[e.new=0]="new",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.disconnected=3]="disconnected",e[e.failed=4]="failed",e[e.closed=5]="closed",e}({}),go=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({});var ff=function(e){return e[e.kNone=1]="kNone",e[e.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",e[e.kBytesToBits=8]="kBytesToBits",e}(ff||{});function dg(e,t,r,s){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:ff.kNone;if(!t)return;const l=Number(t[r]);if(typeof l!="number")return;const u=Number(t[s]);if(typeof u!="number")return;if(!e)return u?l/u*a:void 0;const p=Number(e[r]);if(typeof p!="number")return;const m=Number(e[s]);if(typeof m!="number")return;const g=u-m;return g?(l-p)/g*a:void 0}let CV=class extends RA{constructor(){super(...arguments),Ct(this,"_stats",cg),Ct(this,"report",void 0),Ct(this,"lastDecodeVideoReceiverStats",new Map),Ct(this,"lastVideoFramesRecv",new Map),Ct(this,"lastVideoFramesSent",new Map),Ct(this,"lastVideoFramesDecode",new Map),Ct(this,"lastVideoFramesOutput",new Map),Ct(this,"lastVideoJBDelay",new Map),Ct(this,"lastAudioJBDelay",new Map),Ct(this,"mediaBytesSent",new Map),Ct(this,"mediaBytesRetransmit",new Map),Ct(this,"mediaBytesTargetEncode",new Map),Ct(this,"lastDecodeAudioReceiverStats",new Map),Ct(this,"lastAudioConcealment",new Map),Ct(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Ta(cg),this.report.forEach(e=>{switch(e.type){case go.OUTBOUND:case go.INBOUND:{const t=e.mediaType||e.kind,r=!t&&"frameWidth"in e,s=!t&&!("frameWidth"in e);e.type===go.OUTBOUND?t==="audio"||s?this.processAudioOutboundStats(e):(t==="video"||r)&&this.processVideoOutboundStats(e):e.type===go.INBOUND&&(t==="audio"||s?this.processAudioInboundStats(e):(t==="video"||r)&&this.processVideoInboundStats(e));break}case go.TRANSPORT:{const t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case go.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),t={local:tt({},qc),remote:tt({},qc)};return e.forEach(r=>{let s;if(r.type===go.TRANSPORT&&(s=e.get(r.selectedCandidatePairId)),r.type===go.CANDIDATE_PAIR&&r.selected&&(s=r),s){const a=(l,u)=>{l.type=u.type,l.id=u.id,u.address&&(l.address=u.address),u.candidateType&&(l.candidateType=u.candidateType),u.port&&(l.port=u.port),u.priority&&(l.priority=u.priority),u.protocol&&(l.protocol=u.protocol),u.relayProtocol&&(l.relayProtocol=u.relayProtocol)};if(s.localCandidateId){const l=e.get(s.localCandidateId);l&&a(t.local,l)}if(s.remoteCandidateId){const l=e.get(s.remoteCandidateId);l&&a(t.remote,l)}}}),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.audioSend.forEach(t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){const t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===go.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===go.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===go.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(tt({},t),tt({},this.stats.selectedCandidatePair.localCandidate)),e.type===go.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(tt({},t),tt({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find(s=>s.ssrc===e.ssrc);t||(t=Ta(wV),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.packetsDiscarded=e.packetsDiscarded,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived,t.totalProcessingDelay=e.totalProcessingDelay,t.jitterBufferEmittedCount=e.jitterBufferEmittedCount;const r=this.lastDecodeAudioReceiverStats.get(t.ssrc);t.avgProcessingDelayMs=dg(r,t,"totalProcessingDelay","jitterBufferEmittedCount",ff.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(e,e.trackId,t),this.calculateAudioFreeze(t,r,e),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),typeof e.concealedSamples=="number"&&(t.concealedSamples=e.concealedSamples),this.lastDecodeAudioReceiverStats.set(t.ssrc,tt({},t))}calculateAudioFreeze(e,t,r){const s=this.lastAudioConcealment.get(e.ssrc);if(t!=null&&s!=null){const a=s.lts,l=r.timestamp,u=l-a;if(u<=0)return;const p=e.concealedSamples-t.concealedSamples-0,m=s.nonSilent+p,g=e.totalSamplesReceived-t.totalSamplesReceived;if(g<=0)return;const E=80*g/u,y=200*g/u,b=u/g;let C=0;e.freezeSamples80=t.freezeSamples80,e.freezeMs80=t.freezeMs80,m>E&&(s.plc80>0?(e.freezeSamples80+=p,e.freezeMs80+=Math.round(p*b)):(e.freezeSamples80+=m,e.freezeMs80+=Math.round(m*b)),C=s.plc80+1);let B=0;e.freezeSamples200=t.freezeSamples200,e.freezeMs200=t.freezeMs200,m>y&&(s.plc200>0?(e.freezeSamples200+=p,e.freezeMs200+=Math.round(p*b)):(e.freezeSamples200+=m,e.freezeMs200+=Math.round(m*b)),B=s.plc200+1),this.lastAudioConcealment.set(e.ssrc,{nonSilent:p,lts:l,plc80:C,plc200:B})}else e.freezeSamples80=0,e.freezeSamples200=0,e.freezeMs80=0,e.freezeMs200=0,this.lastAudioConcealment.set(e.ssrc,{nonSilent:0,lts:r.timestamp,plc80:0,plc200:0})}processVideoInboundStats(e){let t=this._stats.videoRecv.find(u=>u.ssrc===e.ssrc);t||(t=Ta(xV),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.framesDroppedCount=e.framesDropped,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,t.totalFreezesDuration=e.totalFreezesDuration,t.totalProcessingDelay=e.totalProcessingDelay,t.packetsDiscarded=e.packetsDiscarded,t.framesAssembledFromMultiplePackets=e.framesAssembledFromMultiplePackets,t.totalAssemblyTime=e.totalAssemblyTime,t.keyFramesDecoded=e.keyFramesDecoded,t.retransmittedBytesReceived=e.retransmittedBytesReceived,t.retransmittedPacketsReceived=e.retransmittedPacketsReceived;const r=this.lastDecodeVideoReceiverStats.get(t.ssrc),s=this.lastVideoFramesDecode.get(t.ssrc),a=this.lastVideoFramesOutput.get(t.ssrc),l=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){const u=t.decodedFrame?t.decodedFrame.width:0,p=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,u,p),this.isFirstVideoDecoded[t.ssrc]=!0}if(r){const u=r.stats,p=l-r.lts;t.framesDecodeFreezeTime=u.framesDecodeFreezeTime,t.framesDecodeInterval=u.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&p>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>u.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(r.lts=Date.now(),t.framesDecodeInterval=p,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<u.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(r.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-r.qpSum)/(e.framesDecoded-r.stats.framesDecodeCount))}e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime,t.avgDecodeMs=dg(r==null?void 0:r.stats,t,"decodeMs","framesDecodeCount")),t.avgProcessingDelayMs=dg(r==null?void 0:r.stats,t,"totalProcessingDelay","framesDecodeCount",ff.kMillisecondsFromSeconds),t.avgFramesAssembledFromMultiplePacketsMs=dg(r==null?void 0:r.stats,t,"totalAssemblyTime","framesAssembledFromMultiplePackets",ff.kMillisecondsFromSeconds),t.avgInterFrameDelayMs=dg(r==null?void 0:r.stats,t,"totalInterFrameDelay","framesDecodeCount",ff.kMillisecondsFromSeconds),s&&l-s.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-s.count)/((l-s.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:l,rate:t.decodeFrameRate})):s?t.decodeFrameRate=s.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:l,rate:0}),t.framesDroppedCount&&e.framesReceived&&(a&&l-a.lts>=800?(t.outputFrameRate=Math.round((e.framesReceived-t.framesDroppedCount-a.count)/((l-a.lts)/1e3)),this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:l,rate:Math.max(t.outputFrameRate,0)})):a?t.outputFrameRate=a.rate:this.lastVideoFramesOutput.set(t.ssrc,{count:e.framesReceived-t.framesDroppedCount,lts:l,rate:0})),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:tt({},t),lts:r?r.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find(s=>s.ssrc===e.ssrc);t||(t=Ta(TV),this._stats.videoSend.push(t));const r=this.mediaBytesSent.get(e.ssrc);if(r)r.add(e.bytesSent);else{const s=new CA(10);s.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,s)}if(e.retransmittedBytesSent!==void 0){const s=this.mediaBytesRetransmit.get(e.ssrc);if(s)s.add(e.retransmittedBytesSent);else{const a=new CA(10);a.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,a)}}if(e.totalEncodedBytesTarget){const s=this.mediaBytesTargetEncode.get(e.ssrc);if(s)s.add(e.totalEncodedBytesTarget);else{const a=new CA(10);a.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,a)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,t.hugeFramesSent=e.hugeFramesSent,t.keyFramesEncoded=e.keyFramesEncoded,t.targetBitrate=e.targetBitrate,e.totalEncodeTime&&e.framesEncoded){const s=this.lastEncoderMs.get(e.ssrc);if(!s||s.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const a=e.framesEncoded-s.lastFrameCount,l=e.totalEncodeTime-s.lastEncoderTime;t.avgEncodeMs=1e3*l/a}}if(e.framesEncoded&&e.qpSum){const s=this.lastEncoderMs.get(e.ssrc);!s||s.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-s.lastQpSum)/(e.framesEncoded-s.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const s=this.findRemoteStatsId(e.ssrc,go.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find(r=>r.ssrc===e.ssrc);if(t||(t=Ta(bV),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,t.retransmittedBytesSent=e.retransmittedBytesSent,t.retransmittedPacketsSent=e.retransmittedPacketsSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const r=this.findRemoteStatsId(e.ssrc,go.REMOTE_INBOUND);r&&this.processRemoteInboundStats(r,t)}}findRemoteStatsId(e,t){var r;const s=Array.from($s(r=this.report).call(r)).find(a=>a.type===t&&a.ssrc===e);return s?s.id:null}processVideoMediaSource(e,t){const r=this.report.get(e);r&&r.width&&r.height&&r.framesPerSecond&&(t.inputFrame={width:r.width,height:r.height,frameRate:r.framesPerSecond})}processAudioMediaSource(e,t){const r=this.report.get(e);r&&(t.inputLevel=r.audioLevel)}processVideoTrackSenderStats(e,t,r){var s,a,l,u;const p=t?this.report.get(t):void 0,m=(s=p==null?void 0:p.framesSent)!==null&&s!==void 0?s:e.framesSent;if(typeof m!="number")return;let g=(a=p==null?void 0:p.frameWidth)!==null&&a!==void 0?a:e.frameWidth,E=(l=p==null?void 0:p.frameHeight)!==null&&l!==void 0?l:e.frameHeight,y=(u=p==null?void 0:p.framesPerSecond)!==null&&u!==void 0?u:e.framesPerSecond;if(typeof g=="number"&&typeof E=="number"||(g=0,E=0),y==null){const b=Date.now(),C=this.lastVideoFramesSent.get(r.ssrc);C&&b-C.lts>=800?(y=Math.round((m-C.count)/((b-C.lts)/1e3)),this.lastVideoFramesSent.set(r.ssrc,{count:m,lts:b,rate:y})):C?y=C.rate:this.lastVideoFramesSent.set(r.ssrc,{count:m,lts:b,rate:0})}r.sentFrame={width:g,height:E,frameRate:Math.max(0,y)}}processVideoTrackReceiverStats(e,t,r){var s,a,l,u,p;const m=t?this.report.get(t):void 0,g=(s=m==null?void 0:m.framesReceived)!==null&&s!==void 0?s:e.framesReceived,E=(a=m==null?void 0:m.frameWidth)!==null&&a!==void 0?a:e.frameWidth,y=(l=m==null?void 0:m.frameHeight)!==null&&l!==void 0?l:e.frameHeight,b=(u=m==null?void 0:m.jitterBufferDelay)!==null&&u!==void 0?u:e.jitterBufferDelay,C=(p=m==null?void 0:m.jitterBufferEmittedCount)!==null&&p!==void 0?p:e.jitterBufferEmittedCount;if(typeof g=="number"){const B=this.lastVideoFramesRecv.get(r.ssrc),M=Date.now();r.framesReceivedCount=g;let F=0;B&&M-B.lts>=800?(F=Math.round((g-B.count)/((M-B.lts)/1e3)),this.lastVideoFramesRecv.set(r.ssrc,{count:g,lts:M,rate:F})):B?F=B.rate:this.lastVideoFramesRecv.set(r.ssrc,{count:g,lts:M,rate:0}),r.receivedFrame={width:E||0,height:y||0,frameRate:F||0},r.decodedFrame={width:E||0,height:y||0,frameRate:r.decodeFrameRate||0},r.outputFrame={width:E||0,height:y||0,frameRate:r.outputFrameRate||r.decodeFrameRate||0}}if(b&&C){const B=this.lastVideoJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let M=B.jitterBufferMs;const F=C-B.jitterBufferEmittedCount;F>0&&(M=1e3*(b-B.jitterBufferDelay)/F),r.jitterBufferMs=M,r.currentDelayMs=Math.round(M),this.lastVideoJBDelay.set(r.ssrc,{jitterBufferDelay:b,jitterBufferEmittedCount:C,jitterBufferMs:r.currentDelayMs})}}processAudioTrackSenderStats(e,t,r){var s,a,l,u;const p=t?this.report.get(t):void 0,m=(s=(a=p==null?void 0:p.echoReturnLoss)!==null&&a!==void 0?a:e.echoReturnLoss)!==null&&s!==void 0?s:0,g=(l=(u=p==null?void 0:p.echoReturnLossEnhancement)!==null&&u!==void 0?u:e.echoReturnLossEnhancement)!==null&&l!==void 0?l:0;r.aecReturnLoss=m,r.aecReturnLossEnhancement=g}processAudioTrackReceiverStats(e,t,r){var s,a,l,u,p,m,g,E,y;const b=t?this.report.get(t):void 0,C=(s=b==null?void 0:b.removedSamplesForAcceleration)!==null&&s!==void 0?s:e.removedSamplesForAcceleration,B=(a=b==null?void 0:b.totalSamplesReceived)!==null&&a!==void 0?a:e.totalSamplesReceived,M=(l=b==null?void 0:b.jitterBufferDelay)!==null&&l!==void 0?l:e.jitterBufferDelay,F=(u=b==null?void 0:b.jitterBufferEmittedCount)!==null&&u!==void 0?u:e.jitterBufferEmittedCount,q=(p=b==null?void 0:b.audioLevel)!==null&&p!==void 0?p:e==null?void 0:e.audioLevel,Y=(m=b==null?void 0:b.totalSamplesDuration)!==null&&m!==void 0?m:e==null?void 0:e.totalSamplesDuration,re=(g=b==null?void 0:b.concealedSamples)!==null&&g!==void 0?g:e.concealedSamples,ce=(E=b==null?void 0:b.silentConcealedSamples)!==null&&E!==void 0?E:e.silentConcealedSamples,le=(y=b==null?void 0:b.concealmentEvents)!==null&&y!==void 0?y:e.concealmentEvents;if(typeof B=="number"&&(r.totalSamplesReceived=B),typeof ce=="number"&&(r.silentConcealedSamples=ce),typeof le=="number"&&(r.concealmentEvents=le),typeof re=="number"&&(r.concealedSamples=re),C&&B&&(r.accelerateRate=C/B),M&&F){const _e=this.lastAudioJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let we=_e.jitterBufferMs;const Be=F-_e.jitterBufferEmittedCount;Be>0&&(we=1e3*(M-_e.jitterBufferDelay)/Be),r.jitterBufferMs=Math.round(we),this.lastAudioJBDelay.set(r.ssrc,{jitterBufferDelay:M,jitterBufferEmittedCount:F,jitterBufferMs:r.jitterBufferMs})}r.outputLevel=q;let ae=1920;Y&&B&&(ae=B/Y/50,r.receivedFrames=Math.round(B/ae)),re&&(r.droppedFrames=Math.round(re/ae))}processRemoteInboundStats(e,t){const r=this.report.get(e);r&&(t.packetsLost=r.packetsLost,r.roundTripTime&&(t.rttMs=1e3*r.roundTripTime),r.jitter&&(t.jitterMs=1e3*r.jitter),r.timestamp&&(t.timestamp=r.timestamp))}getCodecFromCodecStats(e){const t=this.report.get(e);if(!t)return"";const r=t.mimeType.match(/\/(.*)$/);return r&&r[1]?r[1]:""}updateSendBitrate(){let e=0,t=null,r=null;this.mediaBytesSent.forEach(a=>{e+=a.diffMean()}),this.mediaBytesRetransmit.forEach(a=>{t=t===null?a.diffMean():t+a.diffMean()}),this.mediaBytesTargetEncode.forEach(a=>{r=r===null?a.diffMean():r+a.diffMean()});const s=t!==null?e-t:e;this._stats.bitrate={actualEncoded:8*s/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},t!==null&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),r!==null&&(this._stats.bitrate.targetEncoded=8*r/(this.options.updateInterval/1e3))}},dde=class extends RA{updateStats(){return Ye.resolve()}};function NA(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const l=function(){const u=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return u&&u[0]?Number(u[0].split("/")[1]):null}();return l?l<76?new lde(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:a}):new CV(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:a}):function(u){if(!window.RTCStatsReport)return!1;const p=u.getStats();return!!(p instanceof Ye||function(m){return!!m&&(typeof m=="object"||typeof m=="function")&&typeof m.then=="function"}(p))}(e)?new CV(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:a}):new dde(e,{updateInterval:t,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:a})}const RV="websdk_ng_install_id";function IA(){try{if(Z("INSTALL_ID"))return Z("INSTALL_ID");let e=window.localStorage.getItem(RV);return e||(e=hh(),window.localStorage.setItem(RV,e)),vn("INSTALL_ID",e),e}catch{return}}const zo=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(t&&t[1]&&t[2]){const r=t[1],s=t[2];return"".concat(r,".").concat(s)}return"4.0.0.999"}("4.23.4"),OA=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let ph=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const xi=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),r=["t","s","t"];r.splice(1,0,"e");const s=r.join(""),a=[];for(let p=0;p<6;p++)a.push("1");const l=a.join(""),u={};return u[e]=s,u[t]=l,Object.assign(u,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=xi;const Oy={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},DA={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},PA="v4.23.4-0-g17410532-dirty(6/5/2025, 4:24:52 PM)",kA={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!1,NEW_TURN_MODE:void 0,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1},Wn=tt(tt(tt(tt({},kA),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:DA,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},Oy),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:void 0,BASELINE_MORE_H264_BITRATE_RATIO:1.1});function vn(e,t,r){var s,a,l;je(s=Object.keys(Wn)).call(s,e)&&(!r&&je(a=Object.keys(ac)).call(a,e)||(Wn[e]=t,e!=="ENABLE_VIDEO_SEI"&&e!=="ENABLE_AUDIO_TOPN"&&e!=="ENABLE_AUDIO_METADATA"&&e!=="ENABLE_AUDIO_PTS_METADATA"||t!==!0||(Wn.ENABLE_ENCODED_TRANSFORM=!0,e==="ENABLE_AUDIO_PTS_METADATA"&&(Wn.ENABLE_AUDIO_METADATA=!0)),e==="USE_NEW_NETWORK_CONFIG"&&t&&(l=!!t,Wn.USE_NEW_NETWORK_CONFIG=l,l&&(Wn.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],Wn.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],Wn.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],Wn.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],Wn.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",Wn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",Wn.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),e==="ENABLE_PRE_SUB"&&t&&(Wn.ENABLE_INSTANT_VIDEO=!0,Wn.ENABLE_PREALLOC_PC=!0),e==="ENABLE_SVC"&&t&&(Wn.ENABLE_AUT_CC=!0),e==="NEW_FORCE_TURN"&&t&&(Wn.NEW_TURN_MODE||(Wn.NEW_TURN_MODE=4))))}function Z(e){return Wn[e]}OA||(Wn.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Wn.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Wn.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Wn.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Wn.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Wn.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Wn.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Wn.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Wn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Wn.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Wn.AREAS=["NORTH_AMERICA","OVERSEA"]);let AV=function(e){return e[e.REALTIME=1]="REALTIME",e}({});const ac={};var $t=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}($t||{});let Dy=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});(function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"})({});const NV=128,ude=96,IV=1e3,mf=10;let hde=0;var OV=(()=>{var e={8:(s,a,l)=>{l.r(a),l.d(a,{Parser:()=>Be,Printer:()=>jn,parse:()=>ke,print:()=>nt});const u=`
`,p="".concat("\r").concat(u),m=" ";let g;function E(Re){return Re>="0"&&Re<="9"}function y(Re){return Re>="!"&&Re<="~"}function b(Re){return y(Re)||Re>=""&&Re<=""}function C(Re){return Re==="!"||Re>="#"&&Re<="'"||Re>="*"&&Re<="+"||Re>="-"&&Re<="."||Re>="0"&&Re<="9"||Re>="A"&&Re<="Z"||Re>="^"&&Re<="~"}function B(Re){return Re>="1"&&Re<="9"}function M(Re){return Re>="A"&&Re<="Z"||Re>="a"&&Re<="z"}function F(Re){return Re==="d"||Re==="h"||Re==="m"||Re==="s"}function q(Re){return Re>""&&Re<"	"||Re>"\v"&&Re<"\f"||Re>""&&Re<""}function Y(Re){return M(Re)||E(Re)||Re==="+"||Re==="/"}function re(Re){return E(Re)||M(Re)||Re==="+"||Re==="/"||Re==="-"||Re==="_"}function ce(Re){return M(Re)||E(Re)||Re==="+"||Re==="/"}function le(Re,D){var ee=Object.keys(Re);if(Object.getOwnPropertySymbols){var se=Object.getOwnPropertySymbols(Re);D&&(se=se.filter(function(Pe){return Object.getOwnPropertyDescriptor(Re,Pe).enumerable})),ee.push.apply(ee,se)}return ee}function ae(Re){for(var D=1;D<arguments.length;D++){var ee=arguments[D]!=null?arguments[D]:{};D%2?le(Object(ee),!0).forEach(function(se){_e(Re,se,ee[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Re,Object.getOwnPropertyDescriptors(ee)):le(Object(ee)).forEach(function(se){Object.defineProperty(Re,se,Object.getOwnPropertyDescriptor(ee,se))})}return Re}function _e(Re,D,ee){return D in Re?Object.defineProperty(Re,D,{value:ee,enumerable:!0,configurable:!0,writable:!0}):Re[D]=ee,Re}(function(Re){Re.VERSION="v",Re.ORIGIN="o",Re.SESSION_NAME="s",Re.INFORMATION="i",Re.URI="u",Re.EMAIL="e",Re.PHONE="p",Re.CONNECTION="c",Re.BANDWIDTH="b",Re.TIME="t",Re.REPEAT="r",Re.ZONE_ADJUSTMENTS="z",Re.KEY="k",Re.ATTRIBUTE="a",Re.MEDIA="m"})(g||(g={}));class we{consumeText(D,ee){let se=ee;for(;se<D.length;){const Pe=D[se];if(Pe==="\0"||Pe==="\r"||Pe===u)break;se+=1}if(se-ee==0)throw new Error("Invalid text, at ".concat(D));return se}consumeUnicastAddress(D,ee,se){return this.consumeTill(D,ee,m)}consumeOneOrMore(D,ee,se){let Pe=ee;for(;se(D[Pe]);)Pe++;if(Pe-ee==0)throw new Error("Invalid rule at ".concat(ee,"."));return Pe}consumeSpace(D,ee){if(D[ee]===m)return ee+1;throw new Error("Invalid space at ".concat(ee,"."))}consumeIP4Address(D,ee){let se=ee;for(let Pe=0;Pe<4;Pe++)if(se=this.consumeDecimalUChar(D,se),Pe!==3){if(D[se]!==".")throw new Error("Invalid IP4 address.");se++}return se}consumeDecimalUChar(D,ee){let se=ee;for(let Ot=0;Ot<3&&E(D[se]);Ot++,se++);if(se-ee==0)throw new Error("Invalid decimal uchar.");const Pe=parseInt(D.slice(ee,se));if(Pe>=0&&Pe<=255)return se;throw new Error("Invalid decimal uchar")}consumeIP6Address(D,ee){let se=this.consumeHexpart(D,ee);return D[se]===":"&&(se+=1,se=this.consumeIP4Address(D,se)),se}consumeHexpart(D,ee){let se=ee;if(D[se]===":"&&D[se+1]===":"){se+=2;try{se=this.consumeHexseq(D,se)}catch{}return se}if(se=this.consumeHexseq(D,se),D[se]===":"&&D[se+1]===":"){se+=2;try{se=this.consumeHexseq(D,se)}catch{}return se}return se}consumeHexseq(D,ee){let se=ee;for(;se=this.consumeHex4(D,se),D[se]===":"&&D[se+1]!==":";)se+=1;return se}consumeHex4(D,ee){let se=0;for(;se<4;se++)if(!((Pe=D[ee+se])>="0"&&Pe<="9"||Pe>="a"&&Pe<="f"||Pe>="A"&&Pe<="F")){if(se===0)throw new Error("Invalid hex 4");break}var Pe;return ee+se}consumeFQDN(D,ee){let se=ee;for(;E(D[se])||M(D[se])||D[se]==="-"||D[se]===".";)se+=1;if(se-ee<4)throw new Error("Invalid FQDN");return se}consumeExtnAddr(D,ee){return this.consumeOneOrMore(D,ee,b)}consumeMulticastAddress(D,ee,se){switch(se){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(D,ee);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(D,ee);default:try{return this.consumeFQDN(D,ee)}catch{return this.consumeExtnAddr(D,ee)}}}consumeIP6MulticastAddress(D,ee){const se=this.consumeHexpart(D,ee);return D[se]==="/"?this.consumeInteger(D,se+1):se}consumeIP4MulticastAddress(D,ee){let se=ee+3;const Pe=D.slice(ee,se),Ot=parseInt(Pe);if(Ot<224||Ot>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let Nn=0;Nn<3;Nn++){if(D[se]!==".")throw new Error("Invalid IP4 multicast address.");se+=1,se=this.consumeDecimalUChar(D,se)}return D[se]==="/"&&(se+=1),se=this.consumeTTL(D,se),D[se]==="/"&&(se=this.consumeInteger(D,se)),se}consumeInteger(D,ee){if(!B(D[ee]))throw new Error("Invalid integer.");for(ee+=1;E(D[ee]);)ee+=1;return ee}consumeTTL(D,ee){if(D[ee]==="0")return ee+1;if(!B(D[ee]))throw new Error("Invalid TTL.");ee+=1;for(let se=0;se<2&&E(D[ee]);se++)ee+=1;return ee}consumeToken(D,ee){return this.consumeOneOrMore(D,ee,C)}consumeTime(D,ee){let se=ee;if(D[se]==="0")return se+1;for(B(D[se])&&(se+=1);E(D[se]);)se++;if(se-ee<10)throw new Error("Invalid time");return se}consumeAddress(D,ee){return this.consumeTill(D,ee,m)}consumeTypedTime(D,ee){let se=ee;return se=this.consumeOneOrMore(D,se,E),F(D[se])?se+1:se}consumeRepeatInterval(D,ee){if(!B(D[ee]))throw new Error("Invalid repeat interval");for(ee+=1;E(D[ee]);)ee+=1;return F(D[ee])&&(ee+=1),ee}consumePort(D,ee){return this.consumeOneOrMore(D,ee,E)}consume(D,ee,se){for(let Pe=0;Pe<se.length;Pe++){if(ee+Pe>=D.length)throw new Error("consume exceeding value length");if(D[ee+Pe]!==se[Pe])throw new Error("consume ".concat(se," failed at ").concat(Pe))}return ee+se.length}consumeTill(D,ee,se){let Pe=ee;for(;Pe<D.length&&(typeof se!="string"||D[Pe]!==se)&&(typeof se!="function"||!se(D[Pe]));)Pe++;return Pe}}class Be extends we{constructor(){super(),_e(this,"records",[]),_e(this,"currentLine",0)}parse(D){const ee=this.probeEOL(D);this.records=D.split(ee).filter(Gl=>!!zi(Gl).call(Gl)).map(this.parseLine),this.currentLine=0;const se=this.parseVersion(),Pe=this.parseOrigin(),Ot=this.parseSessionName(),Nn=this.parseInformation(),Pr=this.parseUri(),Qo=this.parseEmail(),Ma=this.parsePhone(),Xg=this.parseConnection(),Ph=this.parseBandWidth(),Xf=this.parseTimeFields(),US=this.parseKey(),FS=this.parseSessionAttribute(),Zo=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:se,origin:Pe,sessionName:Ot,information:Nn,uri:Pr,emails:Qo,phones:Ma,connection:Xg,bandwidths:Ph,timeFields:Xf,key:US,attributes:FS,mediaDescriptions:Zo}}getCurrentRecord(){const D=this.records[this.currentLine];if(!D)throw new Error("Record doesn't exit.");return D}probeEOL(D){for(let ee=0;ee<D.length;ee++)if(D[ee]===u)return D[ee-1]==="\r"?p:u;throw new Error("Invalid newline character.")}parseLine(D,ee){if(D.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const se=D[0];if(D[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:se,value:D.slice(2),line:ee,cur:0}}parseSessionAttribute(){const D=new jt;for(;this.currentLine<this.records.length;){const ee=this.getCurrentRecord();if(ee.type!==g.ATTRIBUTE)break;const se={attField:this.extractOneOrMore(ee,Pe=>C(Pe)&&Pe!==":"),_cur:0};ee.value[ee.cur]===":"&&(ee.cur+=1,se.attValue=this.extractOneOrMore(ee,q)),D.parse(se),this.currentLine++}return D.digest()}parseMediaAttributes(D){const ee=new kt(D);for(;this.currentLine<this.records.length;){const se=this.getCurrentRecord();if(se.type!==g.ATTRIBUTE)break;const Pe={attField:this.extractOneOrMore(se,Ot=>C(Ot)&&Ot!==":"),_cur:0};se.value[se.cur]===":"&&(se.cur+=1,Pe.attValue=this.extractOneOrMore(se,q)),ee.parse(Pe),this.currentLine++}return ee.digest()}parseKey(){const D=this.getCurrentRecord();if(D.type===g.KEY){if(D.value==="prompt"||D.value==="clear:"||D.value==="base64:"||D.value==="uri:")return D.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const D=this.getCurrentRecord();if(D.type===g.ZONE_ADJUSTMENTS){const ee=[];for(;;)try{const se=this.extract(D,this.consumeTime);this.consumeSpaceForRecord(D);let Pe=!1;D.value[D.cur]==="-"&&(Pe=!0,D.cur+=1);const Ot=this.extract(D,this.consumeTypedTime);ee.push({time:se,typedTime:Ot,back:Pe})}catch{break}if(ee.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,ee}return[]}parseRepeat(){const D=[];for(;;){const ee=this.getCurrentRecord();if(ee.type!==g.REPEAT)break;{const se=this.extract(ee,this.consumeRepeatInterval),Pe=this.parseTypedTime(ee);D.push({repeatInterval:se,typedTimes:Pe}),this.currentLine++}}return D}parseTypedTime(D){const ee=[];for(;;)try{this.consumeSpaceForRecord(D),ee.push(this.extract(D,this.consumeTypedTime))}catch{break}if(ee.length===0)throw new Error("Invalid typed time.");return ee}parseTime(){const D=this.getCurrentRecord(),ee=this.extract(D,this.consumeTime);this.consumeSpaceForRecord(D);const se=this.extract(D,this.consumeTime);return this.currentLine++,{startTime:ee,stopTime:se}}parseBandWidth(){const D=[];for(;this.currentLine<this.records.length;){const ee=this.getCurrentRecord();if(ee.type!==g.BANDWIDTH)break;{const se=this.extractOneOrMore(ee,C);if(ee.value[ee.cur]!==":")throw new Error("Invalid bandwidth field.");ee.cur++;const Pe=this.extractOneOrMore(ee,E);D.push({bwtype:se,bandwidth:Pe}),this.currentLine++}}return D}parseVersion(){const D=this.getCurrentRecord();if(D.type!==g.VERSION)throw new Error("first sdp record must be version");const ee=D.value.slice(0,this.consumeOneOrMore(D.value,0,E));if(ee.length!==D.value.length)throw new Error('invalid proto version, "v='.concat(D.value,'"'));return this.currentLine++,ee}parseOrigin(){const D=this.getCurrentRecord();if(D.type!==g.ORIGIN)throw new Error("second line of sdp must be origin");const ee=this.extractOneOrMore(D,b);this.consumeSpaceForRecord(D);const se=this.extractOneOrMore(D,E);this.consumeSpaceForRecord(D);const Pe=this.extractOneOrMore(D,E);this.consumeSpaceForRecord(D);const Ot=this.extractOneOrMore(D,C);this.consumeSpaceForRecord(D);const Nn=this.extractOneOrMore(D,C);this.consumeSpaceForRecord(D);const Pr=this.extract(D,this.consumeUnicastAddress);return this.currentLine++,{username:ee,sessId:se,sessVersion:Pe,nettype:Ot,addrtype:Nn,unicastAddress:Pr}}parseSessionName(){const D=this.getCurrentRecord();if(D.type===g.SESSION_NAME){const ee=this.extract(D,this.consumeText);return this.currentLine++,ee}}parseInformation(){const D=this.getCurrentRecord();if(D.type!==g.INFORMATION)return;const ee=this.extract(D,this.consumeText);return this.currentLine++,ee}parseUri(){const D=this.getCurrentRecord();if(D.type===g.URI)return this.currentLine++,D.value}parseEmail(){const D=[];for(;;){const ee=this.getCurrentRecord();if(ee.type!==g.EMAIL)break;D.push(ee.value),this.currentLine++}return D}parsePhone(){const D=[];for(;;){const ee=this.getCurrentRecord();if(ee.type!==g.PHONE)break;D.push(ee.value),this.currentLine++}return D}parseConnection(){const D=this.getCurrentRecord();if(D.type===g.CONNECTION){const ee=this.extractOneOrMore(D,C);this.consumeSpaceForRecord(D);const se=this.extractOneOrMore(D,C);this.consumeSpaceForRecord(D);const Pe=this.extract(D,this.consumeAddress);return this.currentLine++,{nettype:ee,addrtype:se,address:Pe}}}parseMedia(){const D=this.getCurrentRecord(),ee=this.extract(D,this.consumeToken);this.consumeSpaceForRecord(D);let se=this.extract(D,this.consumePort);D.value[D.cur]==="/"&&(D.cur+=1,se+=this.extract(D,this.consumeInteger)),this.consumeSpaceForRecord(D);const Pe=[];for(Pe.push(this.extract(D,this.consumeToken));D.value[D.cur]==="/";)D.cur+=1,Pe.push(this.extract(D,this.consumeToken));if(Pe.length===0)throw new Error("Invalid proto");const Ot=this.parseFmt(D);return this.currentLine++,{mediaType:ee,port:se,protos:Pe,fmts:Ot}}parseTimeFields(){const D=[];for(;this.getCurrentRecord().type===g.TIME;){const ee=this.parseTime(),se=this.parseRepeat(),Pe=this.parseZone();D.push({time:ee,repeats:se,zones:Pe})}return D}parseMediaDescription(){const D=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===g.MEDIA;){const ee=this.parseMedia(),se=this.parseInformation(),Pe=this.parseConnections(),Ot=this.parseBandWidth(),Nn=this.parseKey(),Pr=this.parseMediaAttributes(ee);D.push({media:ee,information:se,connections:Pe,bandwidths:Ot,key:Nn,attributes:Pr})}return D}parseConnections(){const D=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===g.CONNECTION;)D.push(this.parseConnection());return D}parseFmt(D){const ee=[];for(;;)try{this.consumeSpaceForRecord(D),ee.push(this.extract(D,this.consumeToken))}catch{break}if(ee.length===0)throw new Error("Invalid fmts");return ee}extract(D,ee){for(var se=arguments.length,Pe=new Array(se>2?se-2:0),Ot=2;Ot<se;Ot++)Pe[Ot-2]=arguments[Ot];const Nn=ee.call(this,D.value,D.cur,...Pe),Pr=D.value.slice(D.cur,Nn);return D.cur=Nn,Pr}extractOneOrMore(D,ee){const se=this.consumeOneOrMore(D.value,D.cur,ee),Pe=D.value.slice(D.cur,se);return D.cur=se,Pe}consumeSpaceForRecord(D){if(D.value[D.cur]!==m)throw new Error("Invalid space at ".concat(D.cur,"."));D.cur+=1}}class Xe extends we{constructor(){super(...arguments),_e(this,"attributes",void 0),_e(this,"digested",!1)}extractOneOrMore(D,ee,se){const Pe=this.consumeOneOrMore(D.attValue,D._cur,ee),Ot=D.attValue.slice(D._cur,Pe),[Nn,Pr]=se||[];if(typeof Nn=="number"&&Ot.length<Nn)throw new Error("error in length, should be more or equal than ".concat(Nn," characters."));if(typeof Pr=="number"&&Ot.length>Pr)throw new Error("error in length, should be less or equal than ".concat(Pr," characters."));return D._cur=Pe,Ot}consumeAttributeSpace(D){if(D.attValue[D._cur]!==m)throw new Error("Invalid space at ".concat(D._cur,"."));D._cur+=1}extract(D,ee){if(!D.attValue)throw new Error("Nothing to extract from attValue.");for(var se=arguments.length,Pe=new Array(se>2?se-2:0),Ot=2;Ot<se;Ot++)Pe[Ot-2]=arguments[Ot];const Nn=ee.call(this,D.attValue,D._cur,...Pe),Pr=D.attValue.slice(D._cur,Nn);return D._cur=Nn,Pr}atEnd(D){if(!D.attValue)throw new Error;return D._cur>=D.attValue.length}peekChar(D){if(!D.attValue)throw new Error;return D.attValue[D._cur]}peek(D,ee){if(!D.attValue)throw new Error;for(let se=0;se<ee.length;se++)if(ee[se]!==D.attValue[D._cur+se])return!1;return!0}parseIceUfrag(D){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(D,Y,[4,256])}parseIcePwd(D){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(D,Y,[22,256])}parseIceOptions(D){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const ee=[];for(;!this.atEnd(D);){ee.push(this.extractOneOrMore(D,Y));try{this.consumeAttributeSpace(D)}catch(se){if(this.atEnd(D))break;throw se}}this.attributes.iceOptions=ee}parseFingerprint(D){const ee=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D);const se=this.extract(D,this.consumeTill);this.attributes.fingerprints.push({hashFunction:ee,fingerprint:se})}parseExtmap(D){const ee=this.extractOneOrMore(D,E);let se;this.peekChar(D)==="/"&&(this.extract(D,this.consume,"/"),se=this.extract(D,this.consumeToken)),this.consumeAttributeSpace(D);const Pe=this.extract(D,this.consumeTill,m),Ot=ae(ae({entry:parseInt(ee,10)},se&&{direction:se}),{},{extensionName:Pe});this.peekChar(D)===m&&(this.consumeAttributeSpace(D),Ot.extensionAttributes=this.extract(D,this.consumeTill)),this.attributes.extmaps.push(Ot)}parseSetup(D){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const ee=this.extract(D,this.consumeTill);if(ee!=="active"&&ee!=="passive"&&ee!=="actpass"&&ee!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=ee}}class jt extends Xe{constructor(){super(...arguments),_e(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(D){if(this.digested)throw new Error("already digested");try{switch(D.attField){case"group":this.parseGroup(D);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(D);break;case"ice-pwd":this.parseIcePwd(D);break;case"ice-options":this.parseIceOptions(D);break;case"fingerprint":this.parseFingerprint(D);break;case"setup":this.parseSetup(D);break;case"tls-id":this.parseTlsId(D);break;case"identity":this.parseIdentity(D);break;case"extmap":this.parseExtmap(D);break;case"msid-semantic":this.parseMsidSemantic(D);break;default:D.ignored=!0,this.attributes.unrecognized.push(D)}}catch(ee){throw console.error("parsing session attribute ".concat(D.attField,' error, "a=').concat(D.attField,":").concat(D.attValue,'"')),ee}if(!D.ignored&&D.attValue&&!this.atEnd(D))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(D){const ee=this.extract(D,this.consumeToken),se=[];for(;!this.atEnd(D)&&this.peekChar(D)===m;)this.consumeAttributeSpace(D),se.push(this.extract(D,this.consumeToken));this.attributes.groups.push({semantic:ee,identificationTag:se})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(D){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(D,re)}parseIdentity(D){const ee=this.extractOneOrMore(D,ce),se=[];for(;!this.atEnd(D)&&this.peekChar(D)===m;){this.consumeAttributeSpace(D);const Pe=this.extract(D,this.consumeToken);this.extract(D,this.consume,"=");const Ot=this.extractOneOrMore(D,Nn=>Nn!==m&&q(Nn));se.push({name:Pe,value:Ot})}this.attributes.identities.push({assertionValue:ee,extensions:se})}parseMsidSemantic(D){this.peekChar(D)===m&&this.consumeAttributeSpace(D);const ee={semantic:this.extract(D,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(D)}catch{break}if(this.peekChar(D)==="*"){this.extract(D,this.consume,"*"),ee.applyForAll=!0;break}{const se=this.extract(D,this.consumeTill,m);ee.identifierList.push(se)}}this.attributes.msidSemantic=ee}}class kt extends Xe{constructor(D){super(),_e(this,"attributes",void 0),D.protos.indexOf("RTP")!==-1||D.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(D){if(this.digested)throw new Error("already digested");try{switch(D.attField){case"extmap":this.parseExtmap(D);break;case"setup":this.parseSetup(D);break;case"ice-ufrag":this.parseIceUfrag(D);break;case"ice-pwd":this.parseIcePwd(D);break;case"ice-options":this.parseIceOptions(D);break;case"candidate":this.parseCandidate(D);break;case"remote-candidate":this.parseRemoteCandidate(D);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(D);break;case"rtpmap":this.parseRtpmap(D);break;case"ptime":this.parsePtime(D);break;case"maxptime":this.parseMaxPtime(D);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(D);break;case"ssrc":this.parseSSRC(D);break;case"fmtp":this.parseFmtp(D);break;case"rtcp-fb":this.parseRtcpFb(D);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(D);break;case"mid":this.parseMid(D);break;case"msid":this.parseMsid(D);break;case"imageattr":this.parseImageAttr(D);break;case"rid":this.parseRid(D);break;case"simulcast":this.parseSimulcast(D);break;case"sctp-port":this.parseSctpPort(D);break;case"max-message-size":this.parseMaxMessageSize(D);break;case"ssrc-group":this.parseSSRCGroup(D);break;default:D.ignored=!0,this.attributes.unrecognized.push(D)}}catch(ee){throw console.error("parsing media attribute ".concat(D.attField,' error, "a=').concat(D.attField,":").concat(D.attValue,'"')),ee}if(!D.ignored&&D.attValue&&!this.atEnd(D))throw new Error("attribute parsing error")}parseCandidate(D){const ee=this.extractOneOrMore(D,Y,[1,32]);this.consumeAttributeSpace(D);const se=this.extractOneOrMore(D,E,[1,5]);this.consumeAttributeSpace(D);const Pe=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D);const Ot=this.extractOneOrMore(D,E,[1,10]);this.consumeAttributeSpace(D);const Nn=this.extract(D,this.consumeAddress);this.consumeAttributeSpace(D);const Pr=this.extract(D,this.consumePort);this.consumeAttributeSpace(D),this.extract(D,this.consume,"typ"),this.consumeAttributeSpace(D);const Qo={foundation:ee,componentId:se,transport:Pe,priority:Ot,connectionAddress:Nn,port:Pr,type:this.extract(D,this.consumeToken),extension:{}};for(this.peek(D," raddr")&&(this.extract(D,this.consume," raddr"),this.consumeAttributeSpace(D),Qo.relAddr=this.extract(D,this.consumeAddress)),this.peek(D," rport")&&(this.extract(D,this.consume," rport"),this.consumeAttributeSpace(D),Qo.relPort=this.extract(D,this.consumePort));this.peekChar(D)===m;){this.consumeAttributeSpace(D);const Ma=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D),Qo.extension[Ma]=this.extractOneOrMore(D,y)}this.attributes.candidates.push(Qo)}parseRemoteCandidate(D){const ee=[];for(;;){const se=this.extractOneOrMore(D,E,[1,5]);this.consumeAttributeSpace(D);const Pe=this.extract(D,this.consumeAddress);this.consumeAttributeSpace(D);const Ot=this.extract(D,this.consumePort);ee.push({componentId:se,connectionAddress:Pe,port:Ot});try{this.consumeAttributeSpace(D)}catch{break}}this.attributes.remoteCandidatesList.push(ee)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(D){const ee=this.extract(D,this.consumeToken);this.consumeAttributeSpace(D);const se=this.extract(D,this.consumeTill,"/");this.extract(D,this.consume,"/");const Pe={encodingName:se,clockRate:this.extractOneOrMore(D,E)};this.atEnd(D)||this.peekChar(D)!=="/"||(this.extract(D,this.consume,"/"),Pe.encodingParameters=parseInt(this.extract(D,this.consumeTill),10));const Ot=this.attributes.payloads.find(Nn=>Nn.payloadType===parseInt(ee,10));Ot?Ot.rtpMap=Pe:this.attributes.payloads.push({payloadType:parseInt(ee,10),rtpMap:Pe,rtcpFeedbacks:[]})}parsePtime(D){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(D,this.consumeTill)}parseMaxPtime(D){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(D,this.consumeTill)}parseDirection(D){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=D.attField}parseSSRC(D){const ee=this.extractOneOrMore(D,E);this.consumeAttributeSpace(D);const se=this.extract(D,this.consumeTill,":");let Pe;this.peekChar(D)===":"&&(this.extract(D,this.consume,":"),Pe=this.extract(D,this.consumeTill));const Ot=this.attributes.ssrcs.find(Nn=>Nn.ssrcId===parseInt(ee,10));Ot?Ot.attributes[se]=Pe:this.attributes.ssrcs.push({ssrcId:parseInt(ee,10),attributes:{[se]:Pe}})}parseFmtp(D){const ee=this.extract(D,this.consumeTill,m);this.consumeAttributeSpace(D);const se=this.extract(D,this.consumeTill),Pe={};se.split(";").forEach(Nn=>{let[Pr,Qo]=Nn.split("=");Pr=zi(Pr).call(Pr);const Ma=typeof Qo=="string"?zi(Qo).call(Qo):null;typeof Pr=="string"&&Pr.length>0&&(Pe[Pr]=Ma)});const Ot=this.attributes.payloads.find(Nn=>Nn.payloadType===parseInt(ee,10));Ot?Ot.fmtp={parameters:Pe}:this.attributes.payloads.push({payloadType:parseInt(ee,10),rtcpFeedbacks:[],fmtp:{parameters:Pe}})}parseFmtParameters(D){const ee={},se=this.extract(D,this.consumeTill,"=");D._cur++;const Pe=this.extract(D,this.consumeTill,";");for(ee[se]=Pe;D.attValue[D._cur]===";";){const Ot=this.extract(D,this.consumeTill,"=");D._cur++;const Nn=this.extract(D,this.consumeTill,";");ee[Ot]=Nn}return ee}parseRtcpFb(D){let ee="";ee=this.peekChar(D)==="*"?this.extract(D,this.consume,"*"):this.extract(D,this.consumeTill,m),this.consumeAttributeSpace(D);const se=this.extract(D,this.consumeTill,m);let Pe;if(se==="trr-int")Pe={type:se,interval:this.extract(D,this.consumeTill)};else{const Ot={type:se};this.peekChar(D)===m&&(this.consumeAttributeSpace(D),Ot.parameter=this.extract(D,this.consumeToken),this.peekChar(D)===m&&(Ot.additional=this.extract(D,this.consumeTill))),Pe=Ot}if(ee==="*")this.attributes.rtcpFeedbackWildcards.push(Pe);else{const Ot=this.attributes.payloads.find(Nn=>Nn.payloadType===parseInt(ee,10));Ot?Ot.rtcpFeedbacks.push(Pe):this.attributes.payloads.push({payloadType:parseInt(ee,10),rtcpFeedbacks:[Pe]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(D){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const ee={port:this.extract(D,this.consumePort)};this.peekChar(D)===m&&(this.consumeAttributeSpace(D),ee.netType=this.extractOneOrMore(D,C),this.consumeAttributeSpace(D),ee.addressType=this.extractOneOrMore(D,C),this.consumeAttributeSpace(D),ee.address=this.extract(D,this.consumeAddress)),this.attributes.rtcp=ee}parseMsid(D){const ee={id:this.extractOneOrMore(D,C,[1,64])};this.peekChar(D)===m&&(this.consumeAttributeSpace(D),ee.appdata=this.extractOneOrMore(D,C,[1,64])),this.attributes.msids.push(ee)}parseImageAttr(D){this.attributes.imageattr.push(D.attValue)}parseRid(D){const ee=this.extractOneOrMore(D,Pe=>M(Pe)||E(Pe)||Pe==="_"||Pe==="-");this.consumeAttributeSpace(D);const se={id:ee,direction:this.extract(D,this.consumeToken),params:[]};if(this.peekChar(D)===m){if(this.consumeAttributeSpace(D),this.peek(D,"pt=")){this.extract(D,this.consume,"pt=");const Pe=[];for(;;){const Ot=this.extract(D,this.consumeToken);Pe.push(Ot);try{this.extract(D,this.consume,",")}catch{break}}se.payloads=Pe,this.peekChar(D)===m&&this.extract(D,this.consume,m)}for(;;){const Pe=this.extract(D,this.consumeToken);switch(Pe){case"depend":{const Ot={type:Pe,rids:this.extract(D,this.consume,"=").split(",")};se.params.push(Ot);break}default:{const Ot={type:Pe};this.peekChar(D)==="="&&(this.extract(D,this.consume,"="),Ot.val=this.extract(D,this.consumeTill,";")),se.params.push(Ot)}}try{this.extract(D,this.consume,";")}catch{break}}}this.attributes.rids.push(se)}parseSimulcast(D){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=D.attValue,this.extract(D,this.consumeTill)}parseSctpPort(D){this.attributes.sctpPort=this.extractOneOrMore(D,E,[1,5])}parseMaxMessageSize(D){this.attributes.maxMessageSize=this.extractOneOrMore(D,E,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(D){this.attributes.mid=this.extract(D,this.consumeToken)}parseSSRCGroup(D){const ee=this.extract(D,this.consumeToken),se=[];for(;;)try{this.consumeAttributeSpace(D);const Pe=this.extract(D,this.consumeInteger);se.push(parseInt(Pe,10))}catch{break}this.attributes.ssrcGroups.push({semantic:ee,ssrcIds:se})}}function Tt(Re,D,ee){return D in Re?Object.defineProperty(Re,D,{value:ee,enumerable:!0,configurable:!0,writable:!0}):Re[D]=ee,Re}class jn{constructor(){Tt(this,"eol",p)}print(D,ee){let se="";return ee&&(this.eol=ee),se+=this.printVersion(D.version),se+=this.printOrigin(D.origin),se+=this.printSessionName(D.sessionName),se+=this.printInformation(D.information),se+=this.printUri(D.uri),se+=this.printEmail(D.emails),se+=this.printPhone(D.phones),se+=this.printConnection(D.connection),se+=this.printBandwidth(D.bandwidths),se+=this.printTimeFields(D.timeFields),se+=this.printKey(D.key),se+=this.printSessionAttributes(D.attributes),se+=this.printMediaDescription(D.mediaDescriptions),se}printVersion(D){return"v=".concat(D).concat(this.eol)}printOrigin(D){return"o=".concat(D.username," ").concat(D.sessId," ").concat(D.sessVersion," ").concat(D.nettype," ").concat(D.addrtype," ").concat(D.unicastAddress).concat(this.eol)}printSessionName(D){return D?"s=".concat(D).concat(this.eol):""}printInformation(D){return D?"i=".concat(D).concat(this.eol):""}printUri(D){return D?"u=".concat(D).concat(this.eol):""}printEmail(D){let ee="";for(const se of D)ee+="e=".concat(se).concat(this.eol);return ee}printPhone(D){let ee="";for(const se of D)ee+="e=".concat(se).concat(this.eol);return ee}printConnection(D){return D?"c=".concat(D.nettype," ").concat(D.addrtype," ").concat(D.address).concat(this.eol):""}printBandwidth(D){let ee="";for(const se of D)ee+="b=".concat(se.bwtype,":").concat(se.bandwidth).concat(this.eol);return ee}printTimeFields(D){let ee="";for(const se of D){ee+="t=".concat(se.time.startTime," ").concat(se.time.startTime).concat(this.eol);for(const Pe of se.repeats)ee+="r=".concat(Pe.repeatInterval," ").concat(Pe.typedTimes.join(" ")).concat(this.eol);se.zoneAdjustments&&(ee+="z=",ee+="z=".concat(se.zoneAdjustments.map(Pe=>"".concat(Pe.time," ").concat(Pe.back?"-":""," ").concat(Pe.typedTime)).join(" ")).concat(this.eol),ee+=this.eol)}return ee}printKey(D){return D?"k=".concat(D).concat(this.eol):""}printAttributes(D){let ee="";for(const se of D)ee+="a=".concat(se.attField).concat(se.attValue?":".concat(se.attValue):"").concat(this.eol);return ee}printMediaDescription(D){let ee="";for(const se of D)ee+=this.printMedia(se.media),ee+=this.printInformation(se.information),ee+=this.printConnections(se.connections),ee+=this.printBandwidth(se.bandwidths),ee+=this.printKey(se.key),ee+=this.printMediaAttributes(se);return ee}printConnections(D){let ee="";for(const se of D)ee+=this.printConnection(se);return ee}printMedia(D){return"m=".concat(D.mediaType," ").concat(D.port," ").concat(D.protos.join("/")," ").concat(D.fmts.join(" ")).concat(this.eol)}printSessionAttributes(D){return new xs(this.eol).print(D)}printMediaAttributes(D){return new Ce(this.eol).print(D)}}class bn{constructor(D){Tt(this,"eol",void 0),this.eol=D}printIceUfrag(D){return D===void 0?"":"a=ice-ufrag:".concat(D).concat(this.eol)}printIcePwd(D){return D===void 0?"":"a=ice-pwd:".concat(D).concat(this.eol)}printIceOptions(D){return D===void 0?"":"a=ice-options:".concat(D.join(m)).concat(this.eol)}printFingerprints(D){return D.length>0?D.map(ee=>"a=fingerprint:".concat(ee.hashFunction).concat(m).concat(ee.fingerprint)).join(this.eol)+this.eol:""}printExtmap(D){return D.map(ee=>"a=extmap:".concat(ee.entry).concat(ee.direction?"/".concat(ee.direction):"").concat(m).concat(ee.extensionName).concat(ee.extensionAttributes?"".concat(m).concat(ee.extensionAttributes):"").concat(this.eol)).join("")}printSetup(D){return D===void 0?"":"a=setup:".concat(D).concat(this.eol)}printUnrecognized(D){return D.map(ee=>"a=".concat(ee.attField).concat(ee.attValue?":".concat(ee.attValue):"").concat(this.eol)).join("")}}class xs extends bn{print(D){let ee="";return ee+=this.printGroups(D.groups),ee+=this.printMsidSemantic(D.msidSemantic),ee+=this.printIceLite(D.iceLite),ee+=this.printIceUfrag(D.iceUfrag),ee+=this.printIcePwd(D.icePwd),ee+=this.printIceOptions(D.iceOptions),ee+=this.printFingerprints(D.fingerprints),ee+=this.printSetup(D.setup),ee+=this.printTlsId(D.tlsId),ee+=this.printIdentity(D.identities),ee+=this.printExtmap(D.extmaps),ee+=this.printUnrecognized(D.unrecognized),ee}printGroups(D){let ee="";return D.length>0&&(ee+=D.map(se=>"a=group:".concat(se.semantic).concat(se.identificationTag.map(Pe=>"".concat(m).concat(Pe)).join("")).concat(this.eol)).join("")),ee}printIceLite(D){return D===void 0?"":"a=ice-lite"+this.eol}printTlsId(D){return D?"a=tls-id:".concat(D).concat(this.eol):""}printIdentity(D){return D.length===0?"":D.map(ee=>"a=identity:".concat(ee.assertionValue).concat(ee.extensions.map(se=>"".concat(m).concat(se.name).concat(se.value?"=".concat(se.value):"")))).join(this.eol)+this.eol}printMsidSemantic(D){if(!D)return"";let ee="a=msid-semantic:".concat(D.semantic);return D.applyForAll?ee+="".concat(m,"*"):D.identifierList.length>0&&(ee+=D.identifierList.map(se=>"".concat(m).concat(se))),ee+this.eol}}class Ce extends bn{print(D){const ee=D.attributes;let se="";return se+=this.printRTCP(ee.rtcp),se+=this.printIceUfrag(ee.iceUfrag),se+=this.printIcePwd(ee.icePwd),se+=this.printIceOptions(ee.iceOptions),se+=this.printCandidates(ee.candidates),se+=this.printRemoteCandidatesList(ee.remoteCandidatesList),se+=this.printEndOfCandidates(ee.endOfCandidates),se+=this.printFingerprints(ee.fingerprints),se+=this.printSetup(ee.setup),se+=this.printMid(ee.mid),se+=this.printExtmap(ee.extmaps),se+=this.printRTPRelated(ee),se+=this.printPtime(ee.ptime),se+=this.printMaxPtime(ee.maxPtime),se+=this.printDirection(ee.direction),se+=this.printSSRCGroups(ee.ssrcGroups),se+=this.printSSRC(ee.ssrcs),se+=this.printRTCPMux(ee.rtcpMux),se+=this.printRTCPMuxOnly(ee.rtcpMuxOnly),se+=this.printRTCPRsize(ee.rtcpRsize),se+=this.printMSId(ee.msids),se+=this.printImageattr(ee.imageattr),se+=this.printRid(ee.rids),se+=this.printSimulcast(ee.simulcast),se+=this.printSCTPPort(ee.sctpPort),se+=this.printMaxMessageSize(ee.maxMessageSize),se+=this.printUnrecognized(ee.unrecognized),se}printCandidates(D){return D.map(ee=>"a=candidate:".concat(ee.foundation).concat(m).concat(ee.componentId).concat(m).concat(ee.transport).concat(m).concat(ee.priority).concat(m).concat(ee.connectionAddress).concat(m).concat(ee.port).concat(m,"typ").concat(m).concat(ee.type).concat(ee.relAddr?"".concat(m,"raddr").concat(m).concat(ee.relAddr):"").concat(ee.relPort?"".concat(m,"rport").concat(m).concat(ee.relPort):"").concat(Object.keys(ee.extension).map(se=>"".concat(m).concat(se).concat(m).concat(ee.extension[se])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(D){return D.map(ee=>"a=remote-candidates:".concat(ee.join(m)).concat(this.eol)).join("")}printEndOfCandidates(D){return D===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(D){if(!D.payloads)return"";const ee=D.payloads;let se="";se+=D.rtcpFeedbackWildcards.map(Pe=>this.printRTCPFeedback("*",Pe)).join("");for(const Pe of ee)se+=this.printRtpMap(Pe.payloadType,Pe.rtpMap),se+=this.printFmtp(Pe.payloadType,Pe.fmtp),se+=Pe.rtcpFeedbacks.map(Ot=>this.printRTCPFeedback(Pe.payloadType,Ot)).join("");return se}printFmtp(D,ee){if(!ee)return"";const se=Object.keys(ee.parameters);return se.length===1&&ee.parameters[se[0]]===null?"a=fmtp:".concat(D).concat(m).concat(se[0]).concat(this.eol):"a=fmtp:".concat(D).concat(m).concat(Object.keys(ee.parameters).map(Pe=>"".concat(Pe,"=").concat(ee.parameters[Pe])).join(";")).concat(this.eol)}printRtpMap(D,ee){return ee?"a=rtpmap:".concat(D).concat(m).concat(ee.encodingName,"/").concat(ee.clockRate).concat(ee.encodingParameters?"/".concat(ee.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(D,ee){let se="a=rtcp-fb:".concat(D).concat(m),Pe=ee;return Pe.type==="trr-int"?se+="ttr-int".concat(m).concat(Pe.interval):(se+="".concat(Pe.type),Pe.parameter&&(se+="".concat(m).concat(Pe.parameter),Pe.additional&&(se+="".concat(m).concat(Pe.additional)))),se+this.eol}printPtime(D){return D===void 0?"":"a=ptime:".concat(D).concat(this.eol)}printMaxPtime(D){return D===void 0?"":"a=maxptime:".concat(D).concat(this.eol)}printDirection(D){return D===void 0?"":"a=".concat(D).concat(this.eol)}printSSRC(D){return D.map(ee=>Object.keys(ee.attributes).map(se=>"a=ssrc:".concat(ee.ssrcId.toString(10)).concat(m).concat(se).concat(ee.attributes[se]?":".concat(ee.attributes[se]):"").concat(this.eol)).join("")).join("")}printRTCPMux(D){return D===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(D){return D===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(D){return D===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(D){if(D===void 0)return"";let ee="a=rtcp:".concat(D.port);return D.netType&&(ee+="".concat(m).concat(D.netType)),D.addressType&&(ee+="".concat(m).concat(D.addressType)),D.address&&(ee+="".concat(m).concat(D.address)),ee+this.eol}printMSId(D){return D.map(ee=>"a=msid:".concat(ee.id).concat(ee.appdata?"".concat(m).concat(ee.appdata):"").concat(this.eol)).join("")}printImageattr(D){return D.map(ee=>"a=imageattr:".concat(ee).concat(this.eol)).join("")}printRid(D){return D.map(ee=>{let se="a=rid:".concat(ee.id).concat(m).concat(ee.direction);return ee.payloads&&(se+="".concat(m,"pt=").concat(ee.payloads.join(","))),ee.params.length>0&&(se+="".concat(m).concat(ee.params.map(Pe=>Pe.type==="depend"?"depend=".concat(Pe.rids.join(",")):"".concat(Pe.type,"=").concat(Pe.val)).join(";"))),se+this.eol}).join("")}printSimulcast(D){return D===void 0?"":"a=simulcast:".concat(D).concat(this.eol)}printSCTPPort(D){return D===void 0?"":"a=sctp-port:".concat(D).concat(this.eol)}printMaxMessageSize(D){return D===void 0?"":"a=max-message-size:".concat(D).concat(this.eol)}printMid(D){return D===void 0?"":"a=mid:".concat(D).concat(this.eol)}printSSRCGroups(D){return D.map(ee=>"a=ssrc-group:".concat(ee.semantic).concat(ee.ssrcIds.map(se=>"".concat(m).concat(se.toString(10))).join("")).concat(this.eol)).join("")}}function ke(Re){return new Be().parse(Re)}function nt(Re,D){return new jn().print(Re,D)}}},t={};function r(s){if(t[s])return t[s].exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}return r.d=(s,a)=>{for(var l in a)r.o(a,l)&&!r.o(s,l)&&Object.defineProperty(s,l,{enumerable:!0,get:a[l]})},r.o=(s,a)=>Object.prototype.hasOwnProperty.call(s,a),r.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r(8)})();function Ps(e){return OV.parse(e)}function Pd(e,t){return OV.print(e,t)}var pde=ho("Array","keys"),fde=Qa,mde=ii,gde=I,_de=pde,LA=Array.prototype,Ede={DOMTokenList:!0,NodeList:!0},vde=function(e){var t=e.keys;return e===LA||gde(LA,e)&&t===LA.keys||mde(Ede,fde(e))?_de:t},_o=d(vde);function or(e,t,r){return(t=function(s){var a=function(l,u){if(typeof l!="object"||!l)return l;var p=l[Symbol.toPrimitive];if(p!==void 0){var m=p.call(l,"string");if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s);return typeof a=="symbol"?a:a+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DV(Object(r),!0).forEach(function(s){or(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DV(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const PV=new class extends Zn{constructor(){super(...arguments),or(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:t}=e;t[t.length-1]&&t[t.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=t[t.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class yde{constructor(t){or(this,"logger",void 0),or(this,"prefixLists",[]),this.logger=t}debug(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.debug(...this.prefixLists,...r)}info(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.info(...this.prefixLists,...r)}warning(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.warning(...this.prefixLists,...r)}error(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];this.logger.error(...this.prefixLists,...r)}prefix(t){return this.prefixLists.push(t),this}popPrefix(){return this.prefixLists.pop(),this}}function MA(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function kV(){const e=new Date,t=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return t?(t==null?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const Ko={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Py=Date.now(),ug=e=>{for(const t in Ko)if(Object.prototype.hasOwnProperty.call(Ko,t)&&Ko[t]===e)return t;return"DEFAULT"},O=new class{constructor(){or(this,"proxyServerURL",void 0),or(this,"logLevel",Ko.DEBUG),or(this,"uploadState","collecting"),or(this,"uploadLogWaitingList",[]),or(this,"uploadLogUploadingList",[]),or(this,"uploadErrorCount",0),or(this,"currentLogID",0),or(this,"url",void 0),or(this,"extLog",(e,t)=>{this.appendLogToWaitingList(e,...t)})}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[Ko.DEBUG].concat(t);this.log.apply(this,s)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[Ko.INFO].concat(t);this.log.apply(this,s)}warning(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[Ko.WARNING].concat(t);this.log.apply(this,s)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[Ko.ERROR].concat(t);this.log.apply(this,s)}upload(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=[Ko.DEBUG].concat(t);this.uploadLog.apply(this,s)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){vn("UPLOAD_LOG",!0)}disableLogUpload(){vn("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new yde(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(Date.now()-Py<100)return void setTimeout(()=>{this.log(...t)},Date.now()-Py);const s=Math.max(0,Math.min(4,t[0]));if(t[0]=MA()+" Agora-SDK [".concat(ug(s),"]:"),this.appendLogToWaitingList(s,...t),s<this.logLevel)return;const a=MA()+" %cAgora-SDK [".concat(ug(s),"]:");let l=[];if(!Z("USE_NEW_LOG"))switch(s){case Ko.DEBUG:l=[a,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,l);break;case Ko.INFO:l=[a,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,l);break;case Ko.WARNING:l=[a,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,l);break;case Ko.ERROR:l=[a,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,l)}}uploadLog(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(Date.now()-Py<100)return void setTimeout(()=>{this.uploadLog(...t)},Date.now()-Py);const s=Math.max(0,Math.min(4,t[0]));t[0]=MA()+" Agora-SDK [".concat(ug(s),"]:"),this.appendLogToWaitingList(s,...t)}appendLogToWaitingList(e){if(!Z("UPLOAD_LOG"))return;for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];Array.isArray(r[0])?r[0][0]=kV()+" Agora-SDK [".concat(ug(e),"]:"):r[0]=kV()+" Agora-SDK [".concat(ug(e),"]:");let a="";r.forEach(l=>{typeof l=="object"&&(l=JSON.stringify(l)),a+="".concat(l," ")}),this.uploadLogWaitingList.push({payload_str:a,log_level:e,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:zo,process_id:Z("PROCESS_ID"),payload:JSON.stringify(e)};return oc(async()=>{const r=await _s.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(Z("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Z("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if(r.data!=="OK"){const s=new Error("unexpected upload log response");throw s.response=r,s}},()=>(this.uploadLogUploadingList=[],!1),r=>{const s={status:-1,message:r.message,errorRange:e.map(a=>a.log_item_id)};return r.response?(s.status=r.response.status,s.data=r.response.data,s.headers=r.response.headers):r.request&&(s.status=r.request.status),PV.reportLogUploadError(s),!0},{timeout:Z("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:Z("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,Z("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_INTERVAL"))}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),Z("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var LV;function Sde(e){return oi(e.reportId,"params.reportId",0,100,!1),oi(e.category,"params.category",0,100,!1),oi(e.event,"params.event",0,100,!1),oi(e.label,"params.label",0,100,!1),xn(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(LV={}).FREE="free",LV.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const xde={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let Fr=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e.AB_TEST="ab_test",e}({}),qn=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e.AB_TEST="io.agora.pb.Wrtc.ABTest",e}({});(function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let Tde=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});function _t(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(t,r,s){const a=s.value;if(typeof a=="function"){const l=e.className||t.__className__||(t.constructor.name==="AgoraRTCClient"?"Client":t.constructor.name);s.value=function(){for(var u,p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];let E=m;if(e.argsMap)try{E=e.argsMap(this,...m)}catch(b){O.warning(b),E=[]}try{JSON.stringify(E)}catch{O.warning("arguments for method ".concat(l,".").concat(String(r)," not serializable for apiInvoke.")),E=[]}const y=(e.report||st).reportApiInvoke(this._sessionId||null,{id:this._clientId||((u=this.store)===null||u===void 0?void 0:u.clientId)||this._ID,name:"".concat(l,".").concat(String(r)),options:E,tag:sr.TRACER,reportResult:e.reportResult},e.throttleTime);try{const b=a.apply(this,m);return b instanceof Ye?b.then(C=>(y.onSuccess(e.reportResult&&C),C)).catch(C=>{throw y.onError(C),C}):(y.onSuccess(e.reportResult&&b),b)}catch(b){throw y.onError(b),b}}}return s}}const st=new class{constructor(){or(this,"baseInfoMap",new Map),or(this,"proxyServer",void 0),or(this,"eventUploadTimer",void 0),or(this,"setSessionIdTimer",void 0),or(this,"url",void 0),or(this,"sids",new Set),or(this,"backupUrl",void 0),or(this,"_appId",void 0),or(this,"_aid",0),or(this,"keyEventUploadPendingItems",[]),or(this,"normalEventUploadPendingItems",[]),or(this,"apiInvokeUploadPendingItems",[]),or(this,"apiInvokeCount",0),or(this,"apiInvokeLoggedCount",0),or(this,"ltsList",[]),or(this,"lastSendNormalEventTime",Date.now()),or(this,"customReportCounterTimer",void 0),or(this,"customReportCount",0),or(this,"extApiInvoke",async e=>{for(const t of e){const r=Lt(Lt({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:sr.TRACER});this.sendApiInvoke(r)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),Z("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),Z("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}setAppId(e){this._appId=e,this._aid=parseInt(e.replace(/[a-fA-F0-9]{8}/g,t=>{let[r,s]=t;return r+s}),16)||0}reportApiInvoke(e,t,r){t.timeout=t.timeout||6e4,t.reportResult=t.reportResult===void 0||t.reportResult;const s=Date.now();this.apiInvokeCount+=1;const a=this.apiInvokeCount,l=!!Z("SHOW_REPORT_INVOKER_LOG"),u=!!Z("SHOW_REPORT_USER_INVOKER_LOG"),p=l||u&&t.id;p&&(this.apiInvokeLoggedCount+=1);const m=this.apiInvokeLoggedCount;function g(C,B){if(p){let M="[apiInvoke-".concat(m,"]");if(t.id&&(M+="[".concat(t.id,"]")),t.name&&(M+="[".concat(t.name,"]"),t.name===xr.JOIN))return O.info("".concat(M," ").concat(C));O.info("".concat(M," ").concat(C),C==="start"?t.options:B||"")}}const E=()=>({tag:t.tag,invokeId:a,sid:e,name:t.name,apiInvokeTime:s,options:t.options,states:t.states||null});g("start");let y=!1;ai(t.timeout).then(()=>{y||(this.sendApiInvoke(Lt(Lt({},E()),{},{error:$.API_INVOKE_TIMEOUT,success:!1})),g("timeout"))});const b=new Se($.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:C=>{const B=()=>{if(y)throw b;return y=!0,this.sendApiInvoke(Lt(Lt({},E()),{},{success:!0},t.reportResult&&{result:C})),g("onSuccess"),C};return r?fV(B,t.name+"Success",r,()=>y=!0):B()},onError:C=>{const B=()=>{if(y)throw C;y=!0,this.sendApiInvoke(Lt(Lt({},E()),{},{success:!1,error:C})),g("onFailure",C.toString())};return r?fV(B,t.name+"Error",r,()=>y=!0):B()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const r=Date.now(),s=this.createBaseInfo(e,r);s.cname=t.cname;const a=Object.assign({},{willUploadConsoleLog:Z("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:OA?"global":"oversea",areas:Z("AREAS")&&Z("AREAS").join(",")},t.extend),{stringUid:l,channelProfile:u,channelMode:p,isABTestSuccess:m,lsid:g,clientRole:E}=t,y=Date.now(),b=Lt(Lt({},s),{},{eventType:Fr.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,buildFormat:t.buildFormat,build:PA,lts:y,elapse:y-r,extend:JSON.stringify(a),mode:t.mode,process:Z("PROCESS_ID"),appType:Z("APP_TYPE"),success:!0,version:zo,stringUid:l,channelProfile:u,channelMode:p,isABTestSuccess:m,lsid:g,clientType:je(C=window.navigator.userAgent).call(C,"AgoraWebView")?42:20,clientRole:E,serviceId:Z("PROCESS_ID"),extensionID:Z("PLUGIN_INFO").join(",")||""});var C;this.send({type:qn.SESSION,data:b},!0)}joinChooseServer(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{role:t.role,eventType:Fr.JOIN_CHOOSE_SERVER,lts:a,eventElapse:t.elapse||a-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:a-r.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3,corssRegionTagReq:t.corssRegionTagReq||void 0,corssRegionTagRes:t.corssRegionTagRes||void 0});this.send({type:qn.JOIN_CHOOSE_SERVER,data:l},!0)}reqUserAccount(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{eventType:Fr.REQ_USER_ACCOUNT,lts:a,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:t.elapse||a-r.startTime,eventElapse:a-t.lts,extend:JSON.stringify(t.extend)});this.send({type:qn.REQ_USER_ACCOUNT,data:l},!0)}joinGateway(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info;t.vid&&(s.vid=t.vid),s.uid=t.uid,s.cid=t.cid;const a=Date.now(),{firstSuccess:l,addr:u,isProxy:p}=t,m=a-r.startTime,g=Lt(Lt({},s),{},{eventType:Fr.JOIN_GATEWAY,lts:a,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,errorMsg:t.errorMsg||"",elapse:m,eventElapse:a-t.lts,firstSuccess:l,signalChannel:t.signalChannel,preload:t.preload?1:0,installId:IA(),isABTestSuccess:t.isABTestSuccess?1:0}),E=g.success?1:0;if(t.succ&&(r.lastJoinSuccessTime=a),l)this.send({type:qn.JOIN_GATEWAY,data:g},!0);else{let y;if(u)if(p){const C=u.match(/h=(\d{1,3}-){3}\d{1,3}/g),B=u.match(/p=[0-9]{1,6}/g);y={isSuccess:E,gatewayIp:C&&C.length?C[0].split("=")[1].replace(/-/g,"."):"",port:B&&B.length?B[0].split("=")[1]:"",isProxy:p?1:0}}else{const C=u.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),B=u.match(/(:|p=)[0-9]{1,6}/g);y={isSuccess:E,gatewayIp:C&&C.length?C[0].split("//")[1].replace(/-/g,"."):"",port:B&&B.length?B[0].split(/:|p=/g)[1]:"",isProxy:p?1:0}}else y={isSuccess:E,gatewayIp:"",port:"",isProxy:p?1:0};delete g.success,delete g.eventType,delete g.firstSuccess,g.vid=Number(g.vid);const b=Object.assign({},g,y,{eventType:Fr.REJOIN_GATEWAY});this.send({type:qn.RE_JOIN_GATEWAY,data:b},!0)}}joinChannelTimeout(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=Date.now(),a=Lt(Lt({},r.info),{},{lts:s,timeout:t,elapse:s-r.startTime});this.send({type:qn.JOIN_CHANNEL_TIMEOUT,data:a},!0)}publish(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{eventType:Fr.PUBLISH,lts:a,eventElapse:t.eventElapse,elapse:a-r.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:qn.PUBLISH,data:l},!0)}subscribe(e,t,r){const s=this.baseInfoMap.get(e);if(!s)return;const a=s.info,l=Date.now(),u=Lt(Lt({},a),{},{eventType:Fr.SUBSCRIBE,lts:l,eventElapse:t.eventElapse,elapse:l-s.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid,preSsrc:t.preSsrc?1:0},r&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof t.peerid=="string"?u.peerSuid=t.peerid:u.peer=t.peerid,this.send({type:qn.SUBSCRIBE,data:u},!0)}wsCompressorInit(e){var t;const r=[..._o(t=this.baseInfoMap).call(t)],s=r.length?r[0]:"UnableToGetSid",a=this.baseInfoMap.get(s);if(!a)return;const l=a.info,u=Date.now(),p=Lt(Lt({},l),{},{eventType:Fr.WS_COMPRESSOR_INIT,lts:u,eventElapse:e.eventElapse,elapse:u-a.startTime,status:e.status?1:2});this.send({type:qn.WS_COMPRESSOR_INIT,data:p},!0)}firstRemoteVideoDecode(e,t,r,s){const a=this.baseInfoMap.get(e);if(!a)return;const l=a.info,u=Date.now(),p=Lt(Lt(Lt({},l),s),{},{elapse:u-a.startTime,eventType:t,lts:u,firstDecodeFrame:Math.max((s.firstFrame||u)-a.startTime,0),apEnd:Math.max(s.apEnd-a.startTime,0),apStart:Math.max(s.apStart-a.startTime,0),joinGwEnd:Math.max(s.joinGwEnd-a.startTime,0),joinGwStart:Math.max(s.joinGwStart-a.startTime,0),pcEnd:Math.max(s.pcEnd-a.startTime,0),pcStart:Math.max(s.pcStart-a.startTime,0),subscriberEnd:Math.max(s.subscriberEnd-a.startTime,0),subscriberStart:Math.max(s.subscriberStart-a.startTime,0),videoAddNotify:Math.max(s.videoAddNotify-a.startTime,0)});this.send({type:r,data:p},!0)}firstRemoteFrame(e,t,r,s){const a=this.baseInfoMap.get(e);if(!a)return;const l=a.info,u=Date.now(),p=Lt(Lt(Lt({},l),s),{},{elapse:u-a.startTime,eventType:t,lts:u});this.send({type:r,data:p},!0)}abTest(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt(Lt({},s),t),{},{vid:s.vid===void 0?0:Number(s.vid),elapse:a-r.startTime,eventType:Fr.AB_TEST,lts:a});this.send({type:qn.AB_TEST,data:l},!0)}pcStats(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt(Lt({},s),t),{},{vid:s.vid===void 0?0:Number(s.vid),elapse:a-r.startTime,eventType:Fr.PC_STATS,lts:a,preallocation:t.preallocation?1:0});this.send({type:qn.PC_STATS,data:l},!0)}updateRemoteRTPCapabilities(e,t){if(e){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt(Lt({},s),t),{},{vid:s.vid===void 0?0:Number(s.vid),eventType:Fr.UPDATE_REMOTE_RTPCAPABILITIES,lts:a});this.send({type:qn.UPDATE_REMOTE_RTPCAPABILITIES,data:l},!0)}}onGatewayStream(e,t,r,s){const a=this.baseInfoMap.get(e);if(!a)return;const l=a.info,u=Date.now(),p=Lt(Lt(Lt({},l),s),{},{eventType:t,lts:u});this.send({type:r,data:p},!0)}streamSwitch(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{eventType:Fr.STREAM_SWITCH,lts:a,isDual:t.isdual,elapse:a-r.startTime,success:t.succ});this.send({type:qn.STREAM_SWITCH,data:l},!0)}requestProxyAppCenter(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{eventType:Fr.REQUEST_PROXY_APPCENTER,lts:a,eventElapse:a-t.lts,elapse:a-r.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:qn.REQUEST_PROXY_APPCENTER,data:l},!0)}requestProxyWorkerManager(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{eventType:Fr.REQUEST_PROXY_WORKER_MANAGER,lts:a,eventElapse:a-t.lts,elapse:a-r.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:qn.REQUEST_PROXY_WORKER_MANAGER,data:l},!0)}setProxyServer(e){this.proxyServer=e,e?O.debug("reportProxyServerurl: ".concat(e)):O.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt({},s),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:a,elapse:a-r.startTime,joinChannelSuccessElapse:a-(r.lastJoinSuccessTime||a),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:qn.PEER_PUBLISH_STATUS,data:l},!0)}workerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now();(function(l,u,p){const m=l[u];if(!m||typeof m!="string")return[l];l[u]="";const g=Kc(JSON.stringify(l));let E=0;const y=[];let b=0;for(let C=0;C<m.length;C++)b+=m.charCodeAt(C)<=127?1:3,b<=p-g||(y[y.length]=tt(tt({},l),{},{[u]:m.substring(E,C)}),E=C,b=m.charCodeAt(C)<=127?1:3);return E!==m.length-1&&(y[y.length]=tt(tt({},l),{},{[u]:m.substring(E)})),y})(Lt(Lt(Lt({},s),t),{},{elapse:a-r.startTime,lts:a,productType:"WebRTC"}),"payload",1300).forEach(l=>this.send({type:qn.WORKER_EVENT,data:l},!0))}apworkerEvent(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt(Lt({},s),t),{},{elapse:a-r.startTime,lts:a});this.send({type:qn.AP_WORKER_EVENT,data:l},!0)}joinWebProxyAP(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt(Lt({},s),t),{},{elapse:a-r.startTime,lts:a,extend:t.extend||void 0});this.send({type:qn.JOIN_WEB_PROXY_AP,data:l},!0)}WebSocketQuit(e,t){const r=this.baseInfoMap.get(e);if(!r)return;const s=r.info,a=Date.now(),l=Lt(Lt(Lt({},s),t),{},{elapse:a-r.startTime,lts:a});this.send({type:qn.WEBSOCKET_QUIT,data:l},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>Z("CUSTOM_REPORT_LIMIT"))throw new Se($.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const r=Date.now(),s=t.map(a=>({type:qn.USER_ANALYTICS,data:Lt(Lt({sid:e},a),{},{lts:r})}));try{Z("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(s):await this.postDataToStatsCollector(s)}catch(a){throw O.error("send custom report message failed",a.toString()),new Se($.CUSTOM_REPORT_SEND_FAILED,a.message)}}sendApiInvoke(e){const t=Z("NOT_REPORT_EVENT");if(e.tag&&je(t)&&je(t).call(t,e.tag))return!1;if(e.sid===null)return this.apiInvokeUploadPendingItems.push(e),!1;const r=this.baseInfoMap.get(e.sid);if(!r)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:s,uid:a,cid:l}=r.info;let u;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof Se){const{code:m,message:g}=e.error;u=m||g||e.error.toString()}else u=e.error.toString();const p={invokeId:e.invokeId,sid:e.sid,cname:s,cid:l,uid:a,lts:e.lts,success:e.success,elapse:e.lts-r.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?u:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:qn.API_INVOKE,data:p},!1),!0}addSid(e){this.sids.add(e)}removeSid(e){this.sids.delete(e)}appendSessionId(){const e=this.apiInvokeUploadPendingItems;if(e.length===0)return;const t=Array.from(this.sids).find(r=>r!==null);t&&e.forEach(r=>{r&&(r.sid=t,this.sendApiInvoke(Object.assign({},r)))}),e.length=0}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>Z("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const r=[],s=[];for(;e.length;){const l=e.shift();r.length<20?r.push(l):s.push(l)}e.push(...s);for(const l of[...r]){var a;this.ltsList.indexOf(l.data.lts)!==-1?(l.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(l.data.lts)):(this.ltsList.push(l.data.lts),th(a=this.ltsList).call(a,(u,p)=>u-p))}return t||(this.lastSendNormalEventTime=Date.now()),Z("ENABLE_EVENT_REPORT")&&r.length&&(Z("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(r):this.postDataToStatsCollector(r)).catch((l=>u=>{Z("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(l):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(l),this.normalEventUploadPendingItems.length>Z("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-Z("NORMAL_EVENT_QUEUE_CAPACITY")),O.warning("report: drop normal events"))))})(r)),e}async postDataToStatsCollector2(e){Tr.networkState===Qs.OFFLINE&&await Ye.race([Tr.onlineWaiter,ai(2*Rr.maxRetryTimeout)]);const t=a=>{let l=new Uint8Array;return a.forEach(u=>{const p=_A(JSON.stringify(u.data)),m=new ArrayBuffer(5),g=(y=>{let b=0;return Object.entries(qn).forEach(C=>{let[B,M]=C;M===y.type&&(b=Tde[B])}),b})(u),E=new DataView(m);E.setUint16(0,p.byteLength,!0),E.setUint8(2,255&g),E.setUint8(3,g>>>8&255),E.setUint8(4,g>>>16&255),l=sV(l,new Uint8Array(m)),l=sV(l,p)}),l},r="event";let s=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(r):"https://".concat(Z("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(r);for(let a=0;a<2;a+=1){a===1&&(s=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(r):"https://".concat(Z("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(r));try{await wA(s,{timeout:1e4,data:t(e),headers:Lt(Lt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(l){if(a===1)throw l;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=(p=>{const m=p&&p.data.sid&&this.baseInfoMap.get(p.data.sid);return m&&m.info.vid&&+m.info.vid||0})(e[0]),s=r?void 0:this._aid,a={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map(p=>JSON.stringify(p)),vid:r,aid:s};Tr.networkState===Qs.OFFLINE&&await Ye.race([Tr.onlineWaiter,ai(2*Rr.maxRetryTimeout)]);const l=t?"/events/proto-raws":"/events/messages";let u=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("EVENT_REPORT_DOMAIN"),"&p=").concat(Z("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(Z("EVENT_REPORT_DOMAIN"),":").concat(Z("STATS_COLLECTOR_PORT")).concat(l));for(let p=0;p<2;p+=1){p===1&&(u=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Z("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(Z("STATS_COLLECTOR_PORT"),"&d=").concat(l):"https://".concat(Z("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(Z("STATS_COLLECTOR_PORT")).concat(l)));try{t?await cde(u,{timeout:1e4,data:a}):await wA(u,{timeout:1e4,data:a})}catch(m){if(p===1)throw m;continue}return}}createBaseInfo(e,t){const r=Object.assign({},xde);return r.sid=e,this.baseInfoMap.set(e,{info:r,startTime:t}),r}reportResourceTiming(e,t){const r=performance.getEntriesByName(e),s=r[r.length-1];s&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:s,tag:sr.TRACER}).onSuccess()}};PV.on("REPORT_LOG_UPLOAD",e=>{e.networkState=Tr.networkState,st.reportApiInvoke(null,{name:"logUploadError",options:e,tag:sr.TRACER}).onSuccess("logUploadError")});class me extends Se{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),or(this,"name","AgoraRTCException")}print(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(t,O)}throw(){super.throw(O)}}const ci={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function tn(){return ci}function MV(){return"setSinkId"in HTMLAudioElement.prototype&&(!Z("RESTRICTION_SET_PLAYBACK_DEVICE")||(Dl()||qF())&&!fA())}function jV(){return!ci.supportUnifiedPlan||Z("CHROME_FORCE_PLAN_B")&&Pl()}let li=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function gf(e,t,r){return{sampleRate:e,stereo:t,bitrate:r}}function nn(e,t,r,s,a){return{width:e,height:t,frameRate:r,bitrateMin:s,bitrateMax:a}}function ba(e,t,r,s,a){return{width:{max:e},height:{max:t},frameRate:r,bitrateMin:s,bitrateMax:a}}function jA(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}const bde={"90p":nn(160,90),"90p_1":nn(160,90),"120p":nn(160,120,15,30,65),"120p_1":nn(160,120,15,30,65),"120p_3":nn(120,120,15,30,50),"120p_4":nn(212,120),"180p":nn(320,180,15,30,140),"180p_1":nn(320,180,15,30,140),"180p_3":nn(180,180,15,30,100),"180p_4":nn(240,180,15,30,120),"240p":nn(320,240,15,40,200),"240p_1":nn(320,240,15,40,200),"240p_3":nn(240,240,15,40,140),"240p_4":nn(424,240,15,40,220),"360p":nn(640,360,15,80,400),"360p_1":nn(640,360,15,80,400),"360p_3":nn(360,360,15,80,260),"360p_4":nn(640,360,30,80,600),"360p_6":nn(360,360,30,80,400),"360p_7":nn(480,360,15,80,320),"360p_8":nn(480,360,30,80,490),"360p_9":nn(640,360,15,80,800),"360p_10":nn(640,360,24,80,800),"360p_11":nn(640,360,24,80,1e3),"480p":nn(640,480,15,100,500),"480p_1":nn(640,480,15,100,500),"480p_2":nn(640,480,30,100,1e3),"480p_3":nn(480,480,15,100,400),"480p_4":nn(640,480,30,100,750),"480p_6":nn(480,480,30,100,600),"480p_8":nn(848,480,15,100,610),"480p_9":nn(848,480,30,100,930),"480p_10":nn(640,480,10,100,400),"720p":nn(1280,720,15,120,1130),"720p_auto":nn(1280,720,30,900,3e3),"720p_1":nn(1280,720,15,120,1130),"720p_2":nn(1280,720,30,120,2e3),"720p_3":nn(1280,720,30,120,1710),"720p_5":nn(960,720,15,120,910),"720p_6":nn(960,720,30,120,1380),"1080p":nn(1920,1080,15,120,2080),"1080p_1":nn(1920,1080,15,120,2080),"1080p_2":nn(1920,1080,30,120,3e3),"1080p_3":nn(1920,1080,30,120,3150),"1080p_5":nn(1920,1080,60,120,4780),"1440p":nn(2560,1440,30,120,4850),"1440p_1":nn(2560,1440,30,120,4850),"1440p_2":nn(2560,1440,60,120,7350),"4k":nn(3840,2160,30,120,8910),"4k_1":nn(3840,2160,30,120,8910),"4k_3":nn(3840,2160,60,120,13500)},wde={"480p":ba(640,480,5),"480p_1":ba(640,480,5),"480p_2":ba(640,480,30),"480p_3":ba(640,480,15),"720p":ba(1280,720,5),"720p_auto":nn(1280,720,30,900,3e3),"720p_1":ba(1280,720,5),"720p_2":ba(1280,720,30),"720p_3":ba(1280,720,15),"1080p":ba(1920,1080,5),"1080p_1":ba(1920,1080,5),"1080p_2":ba(1920,1080,30),"1080p_3":ba(1920,1080,15)},Cde={"1SL1TL":jA(1,1),"3SL3TL":jA(3,3),"2SL3TL":jA(2,3)};function wa(e){return e||(e="480p_1"),typeof e=="string"?Object.assign({},bde[e]):e}function UA(e){return typeof e=="string"?Object.assign({},wde[e]):e}function ky(e){return typeof e=="string"?Object.assign({},Cde[e]):e}const Rde={speech_low_quality:gf(16e3,!1),speech_standard:gf(32e3,!1,18),music_standard:gf(48e3,!1),standard_stereo:gf(48e3,!0,56),high_quality:gf(48e3,!1,128),high_quality_stereo:gf(48e3,!0,192)};function Ly(e){return typeof e=="string"?Object.assign({},Rde[e]):e}const _f=[];function UV(e){return Mr(e,"mediaSource",["screen","window","application"]),!0}let rt=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),Tn=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e.SCREEN_LOW_TRACK="screen_low_track",e}({}),Ef=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),Ade=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",e}({}),Nde=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e[e.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",e}({}),fh=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),vf=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),yf=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),Sf=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),Eo=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});(function(e){e.UPDATE_TRACK_SOURCE="update-track-source"})({});const FA={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},VA={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},FV={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Ide={uplinkNetworkQuality:0,downlinkNetworkQuality:0},VV={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let os=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),vo=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),hg=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),mh=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),Li=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),Yc=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const BA={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let My=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function Xt(e,t,r,s,a){var l,u,p={};return Object.keys(s).forEach(function(m){p[m]=s[m]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=ma(l=C2(u=r.slice()).call(u)).call(l,function(m,g){return g(e,t,m)||m},p),a&&p.initializer!==void 0&&(p.value=p.initializer?p.initializer.call(a):void 0,p.initializer=void 0),p.initializer===void 0?(Object.defineProperty(e,t,p),null):p}function pe(e,t,r){return(t=function(s){var a=function(l,u){if(typeof l!="object"||!l)return l;var p=l[Symbol.toPrimitive];if(p!==void 0){var m=p.call(l,"string");if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}(s);return typeof a=="symbol"?a:a+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Yn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BV(Object(r),!0).forEach(function(s){pe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BV(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class WV extends Zn{set _mediaStreamTrack(t){t!==this.mediaStreamTrack&&(this.safeEmit(fh.TRACK_UPDATED,t),this.mediaStreamTrack=t)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(t,r){super(),pe(this,"trackMediaType",void 0),pe(this,"_ID",void 0),pe(this,"_rtpTransceiver",void 0),pe(this,"_lowRtpTransceiver",void 0),pe(this,"_hints",[]),pe(this,"_isClosed",!1),pe(this,"_originMediaStreamTrack",void 0),pe(this,"mediaStreamTrack",void 0),pe(this,"_external",{}),this._ID=r||An(8,"track-"),this._originMediaStreamTrack=t,this.mediaStreamTrack=t,function(s){je(_f).call(_f,s)||_f.push(s)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(t){return t||Od(()=>{var r;st.reportApiInvoke(null,{name:xr.GET_MEDIA_STREAM_TRACK,options:[],tag:sr.TRACER}).onSuccess(((r=this._mediaStreamTrack)===null||r===void 0?void 0:r.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(t){return t===Ef.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(t){const r=_f.indexOf(t);r!==-1&&_f.splice(r,1)}(this),this.emit(vf.CLOSED),this.removeAllListeners(fh.SEI_RECEIVED)}_updateRtpTransceiver(t,r){if(r===Ef.LOW_STREAM){if(this._lowRtpTransceiver===t)return;this._lowRtpTransceiver=t}else{if(this._rtpTransceiver===t)return;this._rtpTransceiver=t}this.emit(fh.TRANSCEIVER_UPDATED,t,r)}}class xf extends WV{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(t,r){super(t,r),pe(this,"_enabled",!0),pe(this,"_muted",!1),pe(this,"_isExternalTrack",!1),pe(this,"_isClosed",!1),pe(this,"_enabledMutex",void 0),pe(this,"processor",void 0),pe(this,"_processorContext",void 0),pe(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Ai("".concat(this.getTrackId())),t.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var t,r;return(t=(r=this._originMediaStreamTrack)===null||r===void 0?void 0:r.label)!==null&&t!==void 0?t:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,O.debug("[".concat(this.getTrackId(),"] close")),this.emit(rt.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(t,r){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=s,t!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Cn(this,rt.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){O.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(vf.TRACK_ENDED)}stateCheck(t,r){if(O.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(t,": ").concat(r,"]")),kl(r,t),this._enabled&&this._muted&&t==="enabled"&&r===!1)throw new Se($.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",O);if(!this._enabled&&!this._muted&&t==="muted"&&r===!0)throw new Se($.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",O)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():Ye.resolve([])}}const HV=window.AudioContext||window.webkitAudioContext;let yo=null;const yn=new class extends Zn{constructor(){super(...arguments),pe(this,"prevState",void 0),pe(this,"curState",void 0),pe(this,"currentTime",void 0),pe(this,"currentTimeStuckAt",void 0),pe(this,"interruptDetectorTrack",void 0),pe(this,"onLocalAudioTrackMute",()=>{O.info("ios15-interruption-start"),this.emit(li.IOS_15_16_INTERRUPTION_START)}),pe(this,"onLocalAudioTrackUnmute",async()=>{O.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?O.info("ios15-interruption-end-canceled"):(yo&&await yo.suspend(),this.emit(li.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(e){O.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){O.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Tf(){if(!yo){if(function(){if(!HV)return void O.error("your browser is not support web audio");O.info("create audio context");const e=Yn({},Z("WEBAUDIO_INIT_OPTIONS"));O.debug("audio context init option:",JSON.stringify(e)),yo=new HV(e),yn.curState=yo.state,yo.onstatechange=()=>{yn.prevState=yn.curState,yn.curState=yo?yo.state:void 0;const{prevState:t,curState:r}=yn,s=r==="running",a=r==="interrupted",l=t==="running",u=t==="suspended",p=t==="interrupted",m=en().osVersion;(ss()||xa())&&l&&a&&(O.info("ios".concat(m,"-interruption-start")),yn.emit(li.IOS_INTERRUPTION_START)),(ss()||xa())&&(u||p)&&s&&(O.info("ios".concat(m,"-interruption-end")),yn.emit(li.IOS_INTERRUPTION_END)),t!==r&&yn.emit(li.STATE_CHANGE,r,t)},setInterval(()=>{var t;const r=(t=yo)===null||t===void 0?void 0:t.currentTime;yn.currentTime!==r?(yn.currentTimeStuckAt&&(O.debug("AudioContext current time resume at ".concat(r)),yn.currentTimeStuckAt=void 0),yn.currentTime=r):(r!==yn.currentTimeStuckAt&&(st.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:r},tag:sr.TRACER}).onSuccess(),O.warning("AudioContext current time stuck at ".concat(r))),yn.currentTimeStuckAt=r)},5e3),async function(t){const r=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let s,a=!1,l=!1,u=!1;function p(M){t.state==="running"?m(!1):ss()||xa()?t.state==="suspended"&&(m(!0),M&&t.resume().then(g,g)):t.state!=="closed"&&(m(!0),M&&t.resume().then(g,g))}function m(M){if(a!==M){a=M;for(let F=0,q=r;F<q.length;F+=1){const Y=q[F];M?window.addEventListener(Y,E,{capture:!0,passive:!0}):window.removeEventListener(Y,E,{capture:!0,passive:!0})}}}function g(){p(!1)}function E(){p(!0)}function y(M){if(!u)if(s.paused)if(M){let F;b(!1),u=!0;try{F=s.play(),F?F.then(C,C):(s.addEventListener("playing",C),s.addEventListener("abort",C),s.addEventListener("error",C))}catch{C()}}else b(!0);else b(!1)}function b(M){if(l!==M){l=M;for(let F=0,q=r;F<q.length;F++){const Y=q[F];M?window.addEventListener(Y,B,{capture:!0,passive:!0}):window.removeEventListener(Y,B,{capture:!0,passive:!0})}}}function C(){s.removeEventListener("playing",C),s.removeEventListener("abort",C),s.removeEventListener("error",C),u=!1,y(!1)}function B(){y(!0)}if(ss()){const M=t.createMediaStreamDestination(),F=document.createElement("div");F.innerHTML="<audio x-webkit-airplay='deny'></audio>",s=F.children.item(0),s.controls=!1,s.disableRemotePlayback=!0,s.preload="auto",s.srcObject=M.stream,y(!0)}yn.on(li.STATE_CHANGE,function(){p(!0)}),p(!1)}(yo)}(),!yo)throw new Se($.NOT_SUPPORTED,"can not create audio context");return yo}return yo}function gh(e){if(function(){if(WA!==null)return WA;const s=Tf(),a=s.createBufferSource(),l=s.createGain(),u=s.createGain();a.connect(l),a.connect(u),a.disconnect(l);let p=!1;try{a.disconnect(l)}catch{p=!0}return a.disconnect(),WA=p,p}())return;const t=e.connect,r=e.disconnect;e.connect=(s,a,l)=>{var u;return e._inputNodes||(e._inputNodes=[]),je(u=e._inputNodes).call(u,s)||(s instanceof AudioNode?(e._inputNodes.push(s),t.call(e,s,a,l)):t.call(e,s,a)),e},e.disconnect=(s,a,l)=>{r.call(e),s?wy(e._inputNodes,s):e._inputNodes=[];for(const u of e._inputNodes)t.call(e,u)}}let WA=null;function HA(e,t){let r=!1;const s=1/t;if(Z("DISABLE_WEBAUDIO")){const a=window.setInterval(()=>{r?window.clearInterval(a):e(performance.now()/1e3)},1e3*s)}else{const a=Tf();let l=a.createGain();l.gain.value=0,l.connect(a.destination);const u=()=>{if(r)return void(l=null);const p=a.createOscillator();p.onended=u,p.connect(l),p.start(0),p.stop(a.currentTime+s),e(a.currentTime)};u()}return()=>{r=!0}}class GV{constructor(){pe(this,"context",void 0),pe(this,"analyserNode",void 0),pe(this,"sourceNode",void 0),this.context=Tf(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(t){if(t!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=t,t==null||t.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||ss()||xa()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const t=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(t);else{const s=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(s);for(let a=0;a<t.length;++a)t[a]=s[a]/128-1}const r=ma(t).call(t,(s,a)=>s+a*a,0)/t.length;return Math.max(10*Math.log10(r)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var t,r;(t=this.sourceNode)===null||t===void 0||t.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(r=this.sourceNode)===null||r===void 0||r.connect(this.analyserNode)}catch{O.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class zV extends Zn{get processSourceNode(){return this.sourceNode}set processedNode(t){var r;if(!this.isDestroyed&&this._processedNode!==t){try{var s;(s=this.sourceNode)===null||s===void 0||s.disconnect(this.outputNode)}catch{}(r=this._processedNode)===null||r===void 0||r.disconnect(),this._processedNode=t,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),pe(this,"outputNode",void 0),pe(this,"outputTrack",void 0),pe(this,"isPlayed",!1),pe(this,"sourceNode",void 0),pe(this,"context",void 0),pe(this,"audioBufferNode",void 0),pe(this,"destNode",void 0),pe(this,"audioOutputLevel",0),pe(this,"volumeLevelAnalyser",void 0),pe(this,"_processedNode",void 0),pe(this,"playNode",void 0),pe(this,"isDestroyed",!1),pe(this,"onNoAudioInput",void 0),pe(this,"isNoAudioInput",!1),pe(this,"_noAudioInputCount",0),this.context=Tf(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),gh(this.outputNode),this.volumeLevelAnalyser=new GV}startGetAudioBuffer(t){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(t),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=r=>{this.emit(Eo.ON_AUDIO_BUFFER,function(s){for(let a=0;a<s.outputBuffer.numberOfChannels;a+=1){const l=s.outputBuffer.getChannelData(a);for(let u=0;u<l.length;u+=1)l[u]=0}return s.inputBuffer}(r))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!tn().webAudioMediaStreamDest)throw new Se($.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(t){this.context.state!=="running"&&Cy(()=>{yn.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=t||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(t>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;ss()||xa()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const r=this.volumeLevelAnalyser.getAnalyserNode();let s;r.getFloatTimeDomainData?(s=new Float32Array(r.fftSize),r.getFloatTimeDomainData(s)):(s=new Uint8Array(r.fftSize),r.getByteTimeDomainData(s));let a=!1;for(let l=0;l<s.length;l++)s[l]!==0&&(a=!0);return a?(this.isNoAudioInput=!1,!0):(await ai(200),await this.checkHasAudioInput(t?t+1:1)&&a)}getAudioVolume(){return this.outputNode.gain.value}setVolume(t){this.outputNode.gain.setValueAtTime(t,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var t,r;(t=this.processedNode)===null||t===void 0||t.disconnect(),(r=this.sourceNode)===null||r===void 0||r.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var t;this.processedNode?(t=this.processedNode)===null||t===void 0||t.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class KV extends zV{get isFreeze(){return!1}constructor(t,r,s){var a;if(super(),pe(this,"sourceNode",void 0),pe(this,"track",void 0),pe(this,"clonedTrack",void 0),pe(this,"audioElement",void 0),pe(this,"isCurrentTrackCloned",!1),pe(this,"isRemoteTrack",!1),pe(this,"originVolumeLevelAnalyser",void 0),pe(this,"rebuildWebAudio",async()=>{if(O.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void O.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>O.info("resume success")),O.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const p=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?p.stop():this.isCurrentTrackCloned=!0;const m=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(m),gh(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const g=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(g,this.context.currentTime),gh(this.outputNode),this.emit(Eo.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=m,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),t.kind!=="audio")throw new Se($.UNEXPECTED_ERROR);this.track=t;const l=new MediaStream([this.track]);if(this.isRemoteTrack=!!r,this.sourceNode=this.context.createMediaStreamSource(l),gh(this.sourceNode),s){const p=s.clone();p.enabled=!0,this.clonedTrack=p,O.debug("create an unmuted track ".concat(p.id," from the original track ").concat(s.id," to get the volume"));const m=this.context.createMediaStreamSource(new MediaStream([p]));gh(m),this.originVolumeLevelAnalyser=new GV,this.originVolumeLevelAnalyser.updateSource(m)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=l;const u=en();r&&u.os===Ur.IOS&&Number((a=u.osVersion)===null||a===void 0?void 0:a.split(".")[0])<15&&(yn.on(li.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(p=>{p||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(t){this.sourceNode.disconnect(),this.track=t,this.isCurrentTrackCloned=!1;const r=new MediaStream([t]);this.sourceNode=this.context.createMediaStreamSource(r),gh(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Eo.UPDATE_SOURCE),this.audioElement.srcObject=r}destroy(){var t;this.audioElement.srcObject=null,this.audioElement.remove(),yn.off("state-change",this.rebuildWebAudio),(t=this.originVolumeLevelAnalyser)===null||t===void 0||t.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(t){return this.context.createMediaStreamSource(new MediaStream([t]))}updateOriginTrack(t){const r=t.clone();r.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=r),O.debug("create an unmuted track ".concat(r.id," from the original track ").concat(t.id," to get the volume"));const s=this.context.createMediaStreamSource(new MediaStream([r]));gh(s),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(s)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function qV(e,t,r){const s=(l,u)=>l?typeof l!="number"?l.max||l.exact||l.ideal||l.min||u:l:u,a={audio:!!r&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:s(t.height,1080),maxWidth:s(t.width,1920)}}};return t.frameRate&&typeof t.frameRate!="number"?(a.video.mandatory.maxFrameRate=t.frameRate.max,a.video.mandatory.minFrameRate=t.frameRate.min):typeof t.frameRate=="number"&&(a.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(a)}async function Ode(e,t){const r=await YV(e.mediaSource),{sourceId:s,audio:a}=await function(l){let u=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ye((p,m)=>{const g=document.createElement("div");g.innerText="share screen",g.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const E=document.createElement("div");E.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const y=document.createElement("div");y.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",y.setAttribute("style","height: 12%;");const b=document.createElement("div");b.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const C=document.createElement("div");C.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const B=document.createElement("button");B.innerHTML="cancel",B.setAttribute("style","width: 85px;"),B.onclick=()=>{document.body.removeChild(q);const Y=new Error("NotAllowedError");Y.name="NotAllowedError",m(Y)};let M=u;const F=document.createElement("div");if(u){const Y=document.createElement("input");Y.setAttribute("type","checkbox");const re=document.createElement("span");Y.setAttribute("style","margin-right: 6px;"),re.innerText="Share audio",Y.checked=M,Y.onchange=()=>{M=Y.checked},F.appendChild(Y),F.appendChild(re)}C.appendChild(F),C.appendChild(B),E.appendChild(y),E.appendChild(b),E.appendChild(C);const q=document.createElement("div");q.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),q.appendChild(g),q.appendChild(E),document.body.appendChild(q),l.map(Y=>{if(Y.id){const re=document.createElement("div");re.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let ce=Y.thumbnail;try{const{width:le}=ce.getSize();le>1920&&(ce=ce.resize({width:1920}))}catch(le){throw le&&le.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),le}re.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+ce.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+Y.name.replace(/[\u00A0-\u9999<>\&]/g,function(le){return"&#"+le.charCodeAt(0)+";"})+"</span>",re.onclick=()=>{document.body.removeChild(q),p({sourceId:Y.id,audio:M})},b.appendChild(re)}})})}(r,t);return await qV(s,e,a)}async function YV(e){let t=["window","screen"];e!=="application"&&e!=="window"||(t=["window"]),e==="screen"&&(t=["screen"]);const r=oV();if(!r)throw console.error("failed to fetch electron, please mount it to window"),new Se($.ELECTRON_IS_NULL);let s=null;try{var a;s=((a=r.desktopCapturer)===null||a===void 0?void 0:a.getSources({types:t}))||r.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch{s=null}s&&s.then||(s=new Ye((l,u)=>{r.desktopCapturer.getSources({types:t},(p,m)=>{p?u(p):l(m)})}));try{return await s}catch(l){throw new Se($.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,l.toString())}}const GA=new Ai("safari");let $V=!1,XV=!1;async function So(e,t){let r=0,s=null;for(;r<2;)try{s=await Dde(e,t,r>0);break}catch(a){if(a instanceof Se)throw O.error("[".concat(t,"] ").concat(a.toString())),a;const l=jy(a.name||a.code||a,a.message);if(l.code===$.MEDIA_OPTION_INVALID){O.debug("[".concat(t,"] detect media option invalid, retry")),r+=1,await ai(500);continue}throw O.error("[".concat(t,"] ").concat(l.toString())),l}if(!s)throw new Se($.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return s}async function Dde(e,t,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Se($.NOT_SUPPORTED,"can not find getUserMedia");r&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const s=tn(),a=new MediaStream;if(e.audioSource&&a.addTrack(e.audioSource),e.videoSource&&a.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return O.debug("Using Video Source/ Audio Source"),a;if(e.screen)if(oV())e.screen.sourceId?bf(a,await qV(e.screen.sourceId,e.screen,!!e.screenAudio)):bf(a,await Ode(e.screen,!!e.screenAudio));else if(Dl()&&e.screen.extensionId&&e.screen.mandatory){if(!s.getStreamFromExtension)throw new Se($.NOT_SUPPORTED,"This browser does not support screen sharing");O.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const b=await(u=e.screen.extensionId,p=t,new Ye((C,B)=>{try{chrome.runtime.sendMessage(u,{getStream:!0},M=>{if(!M||!M.streamId)return O.error("[".concat(p,"] No response from Chrome Plugin. Plugin not installed properly"),M),void B(new Se($.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));C(M.streamId)})}catch(M){O.error("[".concat(p,"] AgoraRTC screensharing plugin is not accessible(").concat(u,")"),M.toString()),B(new Se($.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=b,bf(a,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(s.getDisplayMedia){var l;e.screen.mediaSource&&UV(e.screen.mediaSource);const b={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:(l=e.screen.displaySurface)!==null&&l!==void 0?l:e.screen.mediaSource==="screen"?"monitor":e.screen.mediaSource},{selfBrowserSurface:C,surfaceSwitching:B,systemAudio:M,preferCurrentTab:F}=e.screen,q={selfBrowserSurface:C,surfaceSwitching:B,systemAudio:M,preferCurrentTab:F};!C&&delete q.selfBrowserSurface,!B&&delete q.surfaceSwitching,!M&&delete q.systemAudio,!F&&delete q.preferCurrentTab,O.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:b,audio:e.screenAudio,controls:q})),bf(a,await navigator.mediaDevices.getDisplayMedia(Yn({video:b,audio:e.screenAudio},q)))}else{if(!rr())throw O.error("[".concat(t,"] This browser does not support screenSharing")),new Se($.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&UV(e.screen.mediaSource);const b={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};O.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(b))),bf(a,await navigator.mediaDevices.getUserMedia(b))}}var u,p;if(!e.video&&!e.audio)return a;let m={video:e.video,audio:e.audio},g=Z("MEDIA_DEVICE_CONSTRAINTS");if(g)try{typeof g=="string"&&(g=JSON.parse(g)),m=yA(m,g)}catch{}O.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(m)),en();let E,y=null;(vi()||ss()||Ty())&&(y=await GA.lock());try{E=await navigator.mediaDevices.getUserMedia(m)}catch(b){throw y&&y(),b}return m.audio&&($V=!0),m.video&&(XV=!0),bf(a,E),y&&y(),a}function jy(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new Se($.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new Se($.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new Se($.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new Se($.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new Se($.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new Se($.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return O.error("getUserMedia unexpected error",e),new Se($.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function bf(e,t){const r=e.getVideoTracks()[0],s=e.getAudioTracks()[0],a=t.getVideoTracks()[0],l=t.getAudioTracks()[0];l&&(s&&e.removeTrack(s),e.addTrack(l)),a&&(r&&e.removeTrack(r),e.addTrack(a))}const xo=new class extends Zn{get state(){return this._state}set state(e){e!==this._state&&(this.emit(mh.STATE_CHANGE,e),this._state=e)}constructor(){super(),pe(this,"_state",hg.IDLE),pe(this,"isAccessMicrophonePermission",!1),pe(this,"isAccessCameraPermission",!1),pe(this,"lastAccessMicrophonePermission",!1),pe(this,"lastAccessCameraPermission",!1),pe(this,"checkdeviceMatched",!1),pe(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(Z("ENUMERATE_DEVICES_INTERVAL")||(by()||xy()===Ur.HARMONY_OS)&&Pl())&&this.updateDevicesInfo()},Z("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>O.error(e.toString()))}async enumerateDevices(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new Se($.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const s=await navigator.mediaDevices.enumerateDevices(),a=this.checkMediaDeviceInfoIsOk(s);let l=!this.isAccessMicrophonePermission&&e,u=!this.isAccessCameraPermission&&t;a.audio&&(l=!1),a.video&&(u=!1);let p=null,m=null,g=null;if(!r&&(l||u)){if(GA.isLocked&&(O.debug("[device manager] wait GUM lock"),(await GA.lock())(),O.debug("[device manager] GUM unlock")),$V&&(l=!1,this.isAccessMicrophonePermission=!0),XV&&(u=!1,this.isAccessCameraPermission=!0),O.debug("[device manager] check media device permissions",e,t,l,u),l&&u){try{g=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(E){const y=jy(E.name||E.code||E,E.message);if(y.code===$.PERMISSION_DENIED)throw y;O.warning("getUserMedia failed in getDevices",y)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(l){try{p=await navigator.mediaDevices.getUserMedia({audio:e})}catch(E){const y=jy(E.name||E.code||E,E.message);if(y.code===$.PERMISSION_DENIED)throw y;O.warning("getUserMedia failed in getDevices",y)}this.isAccessMicrophonePermission=!0}else if(u){try{m=await navigator.mediaDevices.getUserMedia({video:t})}catch(E){const y=jy(E.name||E.code||E,E.message);if(y.code===$.PERMISSION_DENIED)throw y;O.warning("getUserMedia failed in getDevices",y)}this.isAccessCameraPermission=!0}O.debug("[device manager] mic permission",e,"cam permission",t)}try{const E=await navigator.mediaDevices.enumerateDevices();return p&&p.getTracks().forEach(y=>y.stop()),m&&m.getTracks().forEach(y=>y.stop()),g&&g.getTracks().forEach(y=>y.stop()),p=null,m=null,g=null,E}catch(E){return p&&p.getTracks().forEach(y=>y.stop()),m&&m.getTracks().forEach(y=>y.stop()),g&&g.getTracks().forEach(y=>y.stop()),p=null,m=null,g=null,new Se($.ENUMERATE_DEVICES_FAILED,E.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(t=>t.kind==="audioinput")}async getCamerasDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(t=>t.kind==="videoinput")}async getSpeakers(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(t=>t.kind==="audiooutput")}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach(r=>{r.device.label===e&&(t=r.device.deviceId)}),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find(r=>r.deviceId===e);if(!t)throw new Se($.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=hg.INITING;try{await this.updateDevicesInfo(),this.state=hg.INITEND}catch(e){throw O.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=hg.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new Se($.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),r=[];if(e[0]&&e[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const a=e.find(u=>u.kind==="audioinput"&&u.deviceId==="default"),l=e.find(u=>u.kind==="audiooutput"&&u.deviceId==="default");a&&l?l.groupId===a.groupId?O.debug("[device-check] default input ".concat(a.label," and output ").concat(l.label," is the same group")):O.debug("[device-check] default input ".concat(a.label," and output ").concat(l.label," is not the same group")):O.debug("[device-check] default input or output not found")}const s=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(a=>{if(!a.deviceId)return;const l=this.deviceInfoMap.get("".concat(a.kind,"_").concat(a.deviceId));if((l?l.state:"INACTIVE")!=="ACTIVE"){const u={initAt:t,updateAt:t,device:a,state:"ACTIVE"};this.deviceInfoMap.set("".concat(a.kind,"_").concat(a.deviceId),u),r.push(u)}l&&(l.updateAt=t)}),this.deviceInfoMap.forEach((a,l)=>{a.state==="ACTIVE"&&a.updateAt!==t&&(a.state="INACTIVE",r.push(a))}),this.state!==hg.INITEND)return s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));r.forEach(a=>{switch(a.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(mh.RECORDING_DEVICE_CHANGED,a);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(mh.CAMERA_DEVICE_CHANGED,a);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(mh.PLAYOUT_DEVICE_CHANGED,a)}}),s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter(a=>a.kind==="audioinput"),r=e.filter(a=>a.kind==="videoinput"),s={audio:!1,video:!1};for(const a of t)if(a.label&&a.deviceId){s.audio=!0;break}for(const a of r)if(a.label&&a.deviceId){s.video=!0;break}return s}};let zA=!1;const To=new class extends Zn{constructor(){super(...arguments),pe(this,"onAutoplayFailed",void 0),pe(this,"onAudioAutoplayFailed",void 0)}};function JV(){if(en(),!zA){const e=t=>{t.preventDefault(),zA=!1,rg()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};zA=!0,rg()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),O.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),To.onAutoplayFailed?To.onAutoplayFailed():To.onAudioAutoplayFailed?O.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):O.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),To.emit("autoplay-failed")}}function QV(e,t,r,s){if(!e)return;const a=st.getBaseInfoBySessionId(e);if(!a)return;const l=a.info,u=Date.now(),p=Yn(Yn({},l),{},{vid:l.vid===void 0?0:Number(l.vid),lts:u,elapse:u-a.startTime,cbRegistered:To.onAutoplayFailed||To.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:t,trackId:s,extend:void 0});st.send({type:qn.AUTOPLAY_FAILED,data:p},!0)}const Pde=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Es=new class{constructor(){pe(this,"onAutoplayFailed",void 0),pe(this,"elementMap",new Map),pe(this,"elementStateMap",new Map),pe(this,"elementsNeedToResume",[]),pe(this,"sinkIdMap",new Map),pe(this,"autoResumeAfterInterruption",e=>{Array.from(this.elementMap.entries()).forEach(t=>{let[r,s]=t;const a=this.elementStateMap.get(r),l=s.srcObject.getAudioTracks()[0],u=l&&l.readyState;if(O.debug("resume after interrupted, ele: ".concat(a," audio: ").concat(u," ").concat(e)),u==="live"){if(e)return s.pause(),void s.play();if(yn.curState==="running")return df()?(s.pause(),void s.play()):void(a&&a==="paused"&&s.play())}})}),pe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[t,r]=e;const s=r.srcObject.getAudioTracks()[0];s&&s.readyState==="live"&&(O.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),r.pause(),r.play())})}),this.autoResumeAudioElement(),yn.on(li.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),yn.on(li.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),yn.on(li.STATE_CHANGE,()=>{ss()&&yn.prevState==="suspended"&&yn.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(e,t){const r=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),r)try{await r.setSinkId(t)}catch(s){throw new Se($.PERMISSION_DENIED,"can not set sink id: "+s.toString())}}play(e,t,r,s){if(this.elementMap.has(t))return;const a=document.createElement("audio");a.autoplay=!0,a.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,a),this.elementMap.set(t,a),this.elementStateMap.set(t,Li.INIT),this.setVolume(t,r);const l=this.sinkIdMap.get(t);if(l)try{a.setSinkId(l).catch(p=>{O.warning("[".concat(t,"] set sink id failed"),p.toString())})}catch(p){O.warning("[".concat(t,"] set sink id failed"),p.toString())}const u=a.play();u&&u.then&&u.catch(p=>{s&&QV(s,"audio",p.message,t),O.warning("audio element play warning",p.toString()),this.elementMap.has(t)&&p.name==="NotAllowedError"&&(O.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(a),Cy(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),JV()}))})}updateTrack(e,t){const r=this.elementMap.get(e);r&&(r.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&this.elementStateMap.get(e)==="playing"}setVolume(e,t){const r=this.elementMap.get(e);r&&(t=Math.max(0,Math.min(100,t)),r.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const r=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(r,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){Pde.forEach(r=>{t.addEventListener(r,s=>{const a=this.elementStateMap.get(e),l=s.type==="pause"?"paused":s.type;if(O.debug("[".concat(e,"] audio-element-status change ").concat(a," => ").concat(l)),s.type==="error"){const u=t==null?void 0:t.error;u&&O.error("[".concat(e,"] media error, code: ").concat(u.code,", message: ").concat(u.message))}this.elementStateMap.set(e,l)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(t=>{t.play().then(r=>{O.debug("Auto resume audio element success")}).catch(r=>{O.warning("Auto resume audio element failed!",r)})}),this.elementsNeedToResume=[]};new Ye(t=>{document.body?t():window.addEventListener("load",()=>t())}).then(()=>{rg()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))})}};function pr(){return function(e,t,r){const s=r.value;return typeof s=="function"&&(r.value=function(){this._isClosed&&new Se($.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",O);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];const p=s.apply(this,l);return p instanceof Ye?new Ye((m,g)=>{p.then(m).catch(g)}):p}),r}}class ZV extends Zn{constructor(t){super(),pe(this,"name","VideoProcessorDestination"),pe(this,"ID","0"),pe(this,"_source",void 0),pe(this,"videoContext",void 0),pe(this,"inputTrack",void 0),this.videoContext=t}get kind(){return"video"}get enabled(){return!0}pipe(){throw new Se($.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new Se($.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(t){if(t.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);t.track&&t.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=t.track,this.emit(os.ON_TRACK,t.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(os.ON_TRACK,void 0)}}class e3 extends Zn{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,r){super(),pe(this,"constraintsMap",new Map),pe(this,"statsRegistry",[]),pe(this,"usageRegistry",[]),pe(this,"trackId",void 0),pe(this,"direction",void 0),pe(this,"_chained",!1),this.trackId=t,this.direction=r}async getConstraints(){return await Si(this,vo.REQUEST_CONSTRAINTS)}async requestApplyConstraints(t,r){var s;return O.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(r,t),Cn(this,vo.REQUEST_UPDATE_CONSTRAINTS,Array.from($s(s=this.constraintsMap).call(s)))}async requestRevertConstraints(t){var r;if(this.constraintsMap.has(t))return O.info("processor ".concat(t.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(t),Cn(this,vo.REQUEST_UPDATE_CONSTRAINTS,Array.from($s(r=this.constraintsMap).call(r)))}registerStats(t,r,s){this.statsRegistry.find(a=>a.processorID===t.ID&&a.processorName===t.name&&a.type===r)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:r,cb:s})}unregisterStats(t,r){const s=this.statsRegistry.findIndex(a=>a.processorID===t.ID&&a.processorName===t.name&&a.type===r);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const t=[];for(const{processorID:r,processorName:s,type:a,cb:l}of this.statsRegistry)try{const u=l();t.push({processorID:r,processorName:s,type:a,stats:u})}catch(u){O.error(new Se($.UNEXPECTED_ERROR,u.message))}return t}registerUsage(t,r){this.usageRegistry.find(s=>s.processorID===t.ID&&s.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:r})}unregisterUsage(t){const r=this.usageRegistry.findIndex(s=>s.processorID===t.ID&&s.processorName===t.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let s=r();s instanceof Ye&&(s=await s),t.push(Yn(Yn({},s),{},{direction:this.direction}))}catch(s){O.error("gather extension usage error",s)}return t}getDirection(){return this.direction}}class t3 extends Zn{constructor(t){super(),pe(this,"name","AudioProcessorDestination"),pe(this,"ID","0"),pe(this,"inputTrack",void 0),pe(this,"inputNode",void 0),pe(this,"audioProcessorContext",void 0),pe(this,"_source",void 0),this.audioProcessorContext=t}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new Se($.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Se($.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(os.ON_TRACK,void 0),this.emit(os.ON_NODE,void 0)}updateInput(t){if(t.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);t.track&&this.inputTrack!==t.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=t.track,this.emit(os.ON_TRACK,this.inputTrack)),t.node&&this.inputNode!==t.node&&(this.audioProcessorContext.chained=!0,this.inputNode=t.node,this.emit(os.ON_NODE,this.inputNode))}}class n3 extends Zn{set chained(t){this._chained=t}get chained(){return this._chained}constructor(t,r,s){super(),pe(this,"constraintsMap",new Map),pe(this,"statsRegistry",[]),pe(this,"audioContext",void 0),pe(this,"trackId",void 0),pe(this,"direction",void 0),pe(this,"usageRegistry",[]),pe(this,"_chained",!1),this.audioContext=t,this.trackId=r,this.direction=s}async getConstraints(){return Si(this,vo.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(t,r){var s;return O.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),t&&this.constraintsMap.set(r,t),Cn(this,vo.REQUEST_UPDATE_CONSTRAINTS,Array.from($s(s=this.constraintsMap).call(s)))}async requestRevertConstraints(t){var r;if(this.constraintsMap.has(t))return this.constraintsMap.delete(t),Cn(this,vo.REQUEST_UPDATE_CONSTRAINTS,Array.from($s(r=this.constraintsMap).call(r)))}registerStats(t,r,s){this.statsRegistry.find(a=>a.processorID===t.ID&&a.processorName===t.name&&a.type===r)||this.statsRegistry.push({processorName:t.name,processorID:t.ID,type:r,cb:s})}unregisterStats(t,r){const s=this.statsRegistry.findIndex(a=>a.processorID===t.ID&&a.processorName===t.name&&a.type===r);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const t=[];for(const{processorID:r,processorName:s,type:a,cb:l}of this.statsRegistry)try{const u=l();t.push({processorID:r,processorName:s,type:a,stats:u})}catch(u){O.error(new Se($.UNEXPECTED_ERROR,u.message))}return t}registerUsage(t,r){this.usageRegistry.find(s=>s.processorID===t.ID&&s.processorName===t.name)||this.usageRegistry.push({processorID:t.ID,processorName:t.name,cb:r})}unregisterUsage(t){const r=this.usageRegistry.findIndex(s=>s.processorID===t.ID&&s.processorName===t.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const t=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let s=r();s instanceof Ye&&(s=await s),t.push(Yn(Yn({},s),{},{direction:this.direction}))}catch(s){O.error("gather extension usage error",s)}return t}getDirection(){return this.direction}}class KA extends Zn{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),pe(this,"context",void 0),pe(this,"processSourceNode",void 0),pe(this,"outputTrack",void 0),pe(this,"processedNode",void 0),pe(this,"clonedTrack",void 0),pe(this,"outputNode",void 0),this.outputNode=new kde}setVolume(){}createOutputTrack(){throw new Se($.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class kde{disconnect(){}connect(){}}function r3(e){return new Ye((t,r)=>{let s=!1;const a=document.createElement("video");a.setAttribute("autoplay",""),a.setAttribute("muted",""),a.muted=!0,a.autoplay=!0,a.setAttribute("playsinline",""),a.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(a);const l=ss()?"canplay":"playing";a.addEventListener(l,()=>{const u=a.videoWidth,p=a.videoHeight;!u&&rr()||(s=!0,a.srcObject=null,a.remove(),t([u,p]))}),a.srcObject=new MediaStream([e]),a.play().catch(Ry),setTimeout(()=>{s||(a.srcObject=null,a.remove(),t([a.videoWidth,a.videoHeight]))},4e3)})}function Uy(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const r=wa(e.encoderConfig);return r.width!=null&&(t.width=r.width),r.height!=null&&(t.height=r.height),!tV()&&r.frameRate&&(t.frameRate=r.frameRate),qF()&&typeof t.frameRate=="object"&&(t.frameRate.max=60),rr()&&(t.frameRate={ideal:30,max:30}),t}function i3(e){const t={};return tV()||(e.AGC!==void 0&&(t.autoGainControl=e.AGC),e.AEC!==void 0&&(t.echoCancellation=e.AEC),e.ANS!==void 0&&(t.noiseSuppression=e.ANS,Dl()&&e.ANS&&(t.googHighpassFilter=e.ANS))),t}function s3(e){const t=i3(e);if(e.encoderConfig){const r=Ly(e.encoderConfig);t.channelCount=r.stereo?2:1,t.sampleRate=r.sampleRate,t.sampleSize=r.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),by()&&(t.sampleRate=void 0),t}const Lde=e=>{const t=e._encoderConfig;if(!t)return;const{frameRate:r,width:s,height:a}=e.getMediaStreamTrackSettings();let{frameRate:l=r,width:u=s,height:p=a}=t;if(!l||!u||!p)return;u=SA(u),p=SA(p),l=SA(l);const{max:m,min:g}=function(C,B,M){const F=200*Math.pow(M/15,.6)*Math.pow(C*B/640/360,.75);return{min:Math.floor(F),max:Math.floor(4*F)}}(u,p,l),{bitrateMax:E,bitrateMin:y}=t||{};E||O.debug("calculate bitrate: [w: ".concat(u,", h: ").concat(p,", fps: ").concat(l,"] => [brMax: ").concat(E,", brMin: ").concat(y,"]"));const{maxFramerate:b}=Z("ENCODER_CONFIG_LIMIT");return b&&typeof b=="number"&&(l=Math.min(l,b)),{frameRate:l,bitrateMax:E||m,bitrateMin:y||g,scaleResolutionDownBy:1,scale:0}},o3=async(e,t,r)=>await(async(s,a,l)=>{const u=function(g){const E=[];for(let y=0;y<g.length;y+=2)E.push(parseInt(g.slice(y,y+2),16));return Uint8Array.from(E)}(_V(""+a+l)).slice(0,16),p=u.slice(0,12),m=await window.crypto.subtle.importKey("raw",u,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:p},m,s))})(e.buffer,t,r),qA=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new Ye((r,s)=>{t.toBlob(async a=>{if(t.remove(),a){const l=await a3(a);r({buffer:l,width:t.width,height:t.height})}else s(new Se($.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,1)})},a3=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)};var c3,l3,d3,u3,h3,p3,f3,m3,g3,_3,E3,v3,y3,S3,x3,T3,b3,w3,tr,C3,R3,A3,N3,I3,O3,$c,D3,P3,k3,L3,M3,j3,U3,F3,V3,B3,W3,H3,G3,Ti;let dr=(c3=_t({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),l3=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),d3=pr(),u3=pf("LocalAudioTrack","_enabledMutex"),h3=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),p3=pr(),f3=pf("LocalAudioTrack","_enabledMutex"),m3=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),g3=pr(),_3=pr(),E3=pr(),v3=_t({argsMap:e=>[e.getTrackId()]}),y3=pr(),S3=_t({argsMap:e=>[e.getTrackId()]}),x3=pr(),T3=_t({argsMap:e=>[e.getTrackId()]}),b3=_t({argsMap:(e,t)=>[e.getTrackId(),t.name]}),w3=_t({argsMap:e=>[e.getTrackId()]}),Xt((tr=class extends xf{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?Es.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,r,s){super(e,r),pe(this,"trackMediaType",Sf.AUDIO),pe(this,"_encoderConfig",void 0),pe(this,"_trackSource",void 0),pe(this,"metadata",[]),pe(this,"_enabled",!0),pe(this,"_volume",100),pe(this,"_useAudioElement",!0),pe(this,"_bypassWebAudio",!1),pe(this,"processor",void 0),pe(this,"_processorContext",void 0),pe(this,"_processorDestination",void 0),pe(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!s,this._trackSource=new KA,Z("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),Z("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),vi()&&!yo?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){xn(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&Es.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void O.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const t=this._source.createOutputTrack();this._mediaStreamTrack!==t&&(this._mediaStreamTrack=t,Cn(this,rt.NEED_REPLACE_TRACK,this).then(()=>{O.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(r=>{O.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),r)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!MV())throw new Se($.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Es.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,r){return this._setEnabled(e,t,r)}async _setEnabled(e,t,r){if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{r||(this._enabled=!0),await Cn(this,rt.NEED_ENABLE_TRACK,this),O.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(s){throw r||(this._enabled=!1),O.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}}else{this._originMediaStreamTrack.enabled=!1,r||(this._enabled=!1);try{await Cn(this,rt.NEED_DISABLE_TRACK,this)}catch(s){throw r||(this._enabled=!0),O.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,O.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await Cn(this,rt.NEED_MUTE_TRACK,this):await Cn(this,rt.NEED_UNMUTE_TRACK,this))}getStats(){return Od(()=>{O.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),mo(this,rt.GET_STATS)||Yn({},FA)}setAudioFrameCallback(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Eo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Eo.ON_AUDIO_BUFFER),this._source.on(Eo.ON_AUDIO_BUFFER,r=>e(r))}play(){O.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(O.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Es.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){O.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Es.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];O.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Es.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Cn(this,rt.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return Ye.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new Se($.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new Se($.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(e){e.on(os.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(t),await Cn(this,rt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Cn(this,rt.NEED_REPLACE_TRACK,this))}),e.on(os.ON_NODE,t=>{this._source.processedNode=t})}unbindProcessorDestinationEvents(e){e.removeAllListeners(os.ON_TRACK),e.removeAllListeners(os.ON_NODE)}bindProcessorContextEvents(e){e.on(vo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(e){e.removeAllListeners(vo.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof KA&&(this._trackSource=new KV(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new n3(this._source.context,this.getTrackId(),"local"),t=new t3(e);return this._processorContext=e,this._processorDestination=t,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(t),this._source.on(Eo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(Es.stop(this.getTrackId()),this._source.play()),Cn(this,rt.NEED_REPLACE_MIXING_TRACK,this).then(()=>{O.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(r=>{O.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),r)})),{processorContext:e,processorDestination:t}}}).prototype,"setVolume",[c3],Object.getOwnPropertyDescriptor(tr.prototype,"setVolume"),tr.prototype),Xt(tr.prototype,"setPlaybackDevice",[l3,d3],Object.getOwnPropertyDescriptor(tr.prototype,"setPlaybackDevice"),tr.prototype),Xt(tr.prototype,"setEnabled",[u3,h3,p3],Object.getOwnPropertyDescriptor(tr.prototype,"setEnabled"),tr.prototype),Xt(tr.prototype,"setMuted",[f3,m3,g3],Object.getOwnPropertyDescriptor(tr.prototype,"setMuted"),tr.prototype),Xt(tr.prototype,"getStats",[_3],Object.getOwnPropertyDescriptor(tr.prototype,"getStats"),tr.prototype),Xt(tr.prototype,"setAudioFrameCallback",[E3],Object.getOwnPropertyDescriptor(tr.prototype,"setAudioFrameCallback"),tr.prototype),Xt(tr.prototype,"play",[v3,y3],Object.getOwnPropertyDescriptor(tr.prototype,"play"),tr.prototype),Xt(tr.prototype,"stop",[S3,x3],Object.getOwnPropertyDescriptor(tr.prototype,"stop"),tr.prototype),Xt(tr.prototype,"close",[T3],Object.getOwnPropertyDescriptor(tr.prototype,"close"),tr.prototype),Xt(tr.prototype,"pipe",[b3],Object.getOwnPropertyDescriptor(tr.prototype,"pipe"),tr.prototype),Xt(tr.prototype,"unpipe",[w3],Object.getOwnPropertyDescriptor(tr.prototype,"unpipe"),tr.prototype),tr),pg=(C3=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),R3=pr(),A3=pf("MicrophoneAudioTrack","_enabledMutex"),N3=_t({argsMap:(e,t,r)=>[e.getTrackId(),t,r]}),I3=pr(),O3=_t({argsMap:e=>[e.getTrackId()]}),Xt(($c=class extends dr{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,r,s){super(e,t.encoderConfig?Ly(t.encoderConfig):{},s,Z("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),pe(this,"_config",void 0),pe(this,"_deviceName","default"),pe(this,"_constraints",void 0),pe(this,"_originalConstraints",void 0),pe(this,"_enabled",!0),this._config=t,this._constraints=r,this._originalConstraints=r,this._deviceName=e.label,typeof t.bypassWebAudio=="boolean"&&(this._bypassWebAudio=t.bypassWebAudio),(df()||pA())&&yn.bindInterruptDetectorTrack(this)}async setDevice(e){if(O.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const t=await xo.getDeviceById(e),r={};r.audio=Yn({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let s=null;try{s=await So(r,this.getTrackId())}catch(a){throw O.error("[".concat(this.getTrackId(),"] setDevice failed"),a.toString()),s=await So({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),a}await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(t){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),t.toString()),t}else try{const t=await xo.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(t){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),t.toString()),t}O.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,r){if(t)return O.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),e),Z("AUTO_RESET_AUDIO_ROUTE")&&(ss()||xa())){const u=navigator.audioSession;u&&(e||(u.type="playback"),u.type="auto")}if(!e){var s;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(s=this._source.clonedTrack)===null||s===void 0||s.stop(),r||(this._enabled=!1);try{await Cn(this,rt.NEED_DISABLE_TRACK,this)}catch(u){throw O.error("[".concat(this.getTrackId(),"] setEnabled false failed"),u.toString()),u}return}const a=Yn({},this._constraints),l=xo.searchDeviceIdByName(this._deviceName);l&&!a.deviceId&&(a.deviceId=l);try{r||(this._enabled=!0);const u=await So({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(u.getAudioTracks()[0],!1),await Cn(this,rt.NEED_ENABLE_TRACK,this)}catch(u){throw r||(this._enabled=!1),O.error("[".concat(this.getTrackId(),"] setEnabled true failed"),u.toString()),u}O.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(df()||pA())&&yn.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((ss()||xa())&&this._enabled&&!this._isClosed&&yn.duringInterruption){const e=async()=>{yn.off(li.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(O.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};yn.on(li.IOS_INTERRUPTION_END,e)}else O.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(vf.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,r=xo.searchDeviceIdByName(this._deviceName);if(r&&!t.deviceId&&(t.deviceId=r),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();const s=await So({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(vo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,s)=>{try{const a=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(a),r()}catch(a){s(a)}})}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(vo.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[C3,R3],Object.getOwnPropertyDescriptor($c.prototype,"setDevice"),$c.prototype),Xt($c.prototype,"setEnabled",[A3,N3,I3],Object.getOwnPropertyDescriptor($c.prototype,"setEnabled"),$c.prototype),Xt($c.prototype,"close",[O3],Object.getOwnPropertyDescriptor($c.prototype,"close"),$c.prototype),$c),Mde=(D3=_t({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),P3=pr(),k3=_t({argsMap:e=>[e.getTrackId()]}),L3=pr(),M3=_t({argsMap:e=>[e.getTrackId()]}),j3=pr(),U3=_t({argsMap:e=>[e.getTrackId()]}),F3=pr(),V3=_t({argsMap:e=>[e.getTrackId()]}),B3=pr(),W3=_t({argsMap:e=>[e.getTrackId()]}),H3=_t({argsMap:e=>[e.getTrackId()]}),G3=pr(),Xt((Ti=class extends dr{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,r,s){super(t.createOutputTrack(),r,s),pe(this,"source",void 0),pe(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=t,this._bufferSource.on(Eo.AUDIO_SOURCE_STATE_CHANGE,a=>{this.safeEmit(vf.SOURCE_STATE_CHANGE,a)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){xn(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[D3,P3],Object.getOwnPropertyDescriptor(Ti.prototype,"startProcessAudioBuffer"),Ti.prototype),Xt(Ti.prototype,"pauseProcessAudioBuffer",[k3,L3],Object.getOwnPropertyDescriptor(Ti.prototype,"pauseProcessAudioBuffer"),Ti.prototype),Xt(Ti.prototype,"seekAudioBuffer",[M3,j3],Object.getOwnPropertyDescriptor(Ti.prototype,"seekAudioBuffer"),Ti.prototype),Xt(Ti.prototype,"resumeProcessAudioBuffer",[U3,F3],Object.getOwnPropertyDescriptor(Ti.prototype,"resumeProcessAudioBuffer"),Ti.prototype),Xt(Ti.prototype,"stopProcessAudioBuffer",[V3,B3],Object.getOwnPropertyDescriptor(Ti.prototype,"stopProcessAudioBuffer"),Ti.prototype),Xt(Ti.prototype,"close",[W3],Object.getOwnPropertyDescriptor(Ti.prototype,"close"),Ti.prototype),Xt(Ti.prototype,"setAudioBufferPlaybackSpeed",[H3,G3],Object.getOwnPropertyDescriptor(Ti.prototype,"setAudioBufferPlaybackSpeed"),Ti.prototype),Ti);class Or extends dr{get __className__(){return"MixingAudioTrack"}get isActive(){for(const t of this.trackList)if(t._enabled&&!t._isClosed&&!t.muted)return!0;return!1}constructor(){const t=Tf().createMediaStreamDestination();super(t.stream.getAudioTracks()[0],void 0,An(8,"track-mix-")),pe(this,"trackList",void 0),pe(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=t,this.trackList=[]}hasAudioTrack(t){return this.trackList.indexOf(t)!==-1}addAudioTrack(t){this.trackList.indexOf(t)===-1?(O.debug("add ".concat(t.getTrackId()," to mixing track")),t._source.outputNode.connect(this.destNode),this.trackList.push(t),this.updateEncoderConfig()):O.debug("track ".concat(t.getTrackId()," is already added"))}removeAudioTrack(t){if(this.trackList.indexOf(t)!==-1){O.debug("remove ".concat(t.getTrackId()," from mixing track"));try{t._source.outputNode.disconnect(this.destNode)}catch{}wy(this.trackList,t),this.updateEncoderConfig()}}updateEncoderConfig(){const t={};this.trackList.forEach(r=>{r._encoderConfig&&((r._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=r._encoderConfig.bitrate),(r._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=r._encoderConfig.sampleRate),(r._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=r._encoderConfig.sampleSize),r._encoderConfig.stereo&&(t.stereo=!0))}),this._encoderConfig=t}_updateRtpTransceiver(t){this._rtpTransceiver!==t&&(this._rtpTransceiver=t,this.trackList.forEach(r=>{r instanceof Or?r.emit(fh.TRANSCEIVER_UPDATED,t):r._updateRtpTransceiver(t)}))}}class jde extends zV{set currentState(t){t!==this._currentState&&(this._currentState=t,this.safeEmit(Eo.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),pe(this,"audioBuffer",void 0),pe(this,"sourceNode",void 0),pe(this,"startPlayTime",0),pe(this,"startPlayOffset",0),pe(this,"pausePlayTime",0),pe(this,"options",void 0),pe(this,"currentLoopCount",0),pe(this,"currentPlaybackSpeed",100),pe(this,"_currentState","stopped"),this.audioBuffer=t,this.options=r,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(t){this.currentState==="stopped"?(this.options=t,this.startPlayOffset=this.options.startPlayTime||0):O.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(t){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=t,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=t))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(t){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=t/100),this.currentPlaybackSpeed=t}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const t=this.context.createBufferSource();return t.buffer=this.audioBuffer,t.loop=!!this.options.loop,t.connect(this.outputNode),t.playbackRate.value=this.currentPlaybackSpeed/100,t}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const z3=new Map;function K3(e,t){if(e.length===0||t.length===0)return 1/0;const r=xA(e),s=xA(t);return Math.floor(s/r)}class YA{get rendFrameRate(){const t=Math.max(1,K3(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/t)}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(t){t!==this._videoElementStatus&&(O.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(t)),this._videoElementStatus=t)}get videoState(){return this._videoState}set videoState(t){var r;t!==this._videoState&&(this._videoState=t,(r=this.onVideoStateChanged)===null||r===void 0||r.call(this,this.videoState))}constructor(t){pe(this,"trackId",void 0),pe(this,"config",void 0),pe(this,"onFirstVideoFrameDecoded",void 0),pe(this,"onVideoStateChanged",void 0),pe(this,"freezeTimeCounterList",[]),pe(this,"renderFreezeAccTime",0),pe(this,"renderFreezeAccTime2",0),pe(this,"isKeepLastFrame",!1),pe(this,"timeUpdatedCount",0),pe(this,"freezeTime",0),pe(this,"playbackTime",0),pe(this,"lastTimeUpdatedTime",0),pe(this,"autoplayFailed",!1),pe(this,"videoTrack",void 0),pe(this,"videoElement",void 0),pe(this,"cacheVideoElement",void 0),pe(this,"_render_interframe_delays",[]),pe(this,"_render_interframe_delays_sizes",[]),pe(this,"_videoState",Yc.VideoStateStopped),pe(this,"videoElementCheckInterval",void 0),pe(this,"videoElementFreezeTimeout",void 0),pe(this,"_videoElementStatus",Li.NONE),pe(this,"isGettingVideoDimensions",!1),pe(this,"startGetVideoDimensions",()=>{const r=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return O.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(r,500)};!this.isGettingVideoDimensions&&r()}),pe(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&yn.curState==="running"&&(O.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(KF())),ZF()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),pe(this,"handleVideoEvents",r=>{switch(r.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=Li.PLAYING;break;case"loadeddata":if(this.videoState=Yc.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=Li.CANPLAY;break;case"stalled":this.videoElementStatus=Li.STALLED;break;case"suspend":this.videoElementStatus=Li.SUSPEND;break;case"pause":this.videoElementStatus=Li.PAUSED,ss()||xa()||vi()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(O.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=Li.WAITING;break;case"abort":this.videoElementStatus=Li.ABORT;break;case"ended":this.videoElementStatus=Li.ENDED;break;case"emptied":this.videoElementStatus=Li.EMPTIED;break;case"error":{const s=this.videoElement.error;s&&(this.videoElementStatus=Li.ERROR,O.error("[".concat(this.trackId,"] media error: ").concat(s.message," (").concat(s.code,")")));break}case"timeupdate":{const s=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=s);const a=s-this.lastTimeUpdatedTime,l=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=s,Xc.lastVisibleTime<Xc.lastHiddenTime||l<Xc.lastHiddenTime||l<Xc.lastVisibleTime)return;for(a>Z("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=a),this.playbackTime+=a;this.playbackTime>=6e3;){this.playbackTime-=6e3;const u=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(u),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),pe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(O.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(KF())),ZF()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=t.trackId,this.config=t,t.element instanceof HTMLVideoElement?this.videoElement=t.element:this.videoElement=document.createElement("video"),yn.on(li.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),yn.on(li.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var t;return(t=this.videoElement.parentElement)!==null&&t!==void 0?t:void 0}updateConfig(t){this.config=t,this.trackId=t.trackId,t.element!==this.videoElement&&(this.destroy(),this.videoElement=t.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.initVideoElement())}play(t){const r=this.videoElement.play();r&&r.catch&&r.catch(a=>{t&&QV(t,"video",a.message,this.trackId),a.name==="NotAllowedError"?(O.warning("detected video element autoplay failed",a),this.autoplayFailed=!0,this.handleAutoPlayFailed()):O.warning("[".concat(this.trackId,"] play warning: "),a)});const s=en();if((s.name==="Safari"&&Number(s.version)===15||df())&&r&&r.then){const a=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};r.then(a).catch(a)}}getCurrentFrame(){const t=document.createElement("canvas");t.width=this.videoElement.videoWidth,t.height=this.videoElement.videoHeight;const r=t.getContext("2d");if(!r)return O.error("create canvas context failed!"),new ImageData(2,2);r.drawImage(this.videoElement,0,0,t.width,t.height);const s=r.getImageData(0,0,t.width,t.height);return t.remove(),s}async getCurrentFrameToUint8Array(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=document.createElement("canvas");s.width=this.videoElement.videoWidth,s.height=this.videoElement.videoHeight;const a=s.getContext("2d");return a?(a.drawImage(this.videoElement,0,0,s.width,s.height),new Ye((l,u)=>{s.toBlob(async p=>{if(s.remove(),p){const m=await a3(p);l({buffer:m,width:s.width,height:s.height})}else u(new Se($.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},t,r<0?.1:r>1?1:r)})):await qA(t)}destroy(){yn.off(li.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),yn.off(li.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Yc.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=Li.INIT,!this.videoElementCheckInterval&&(q3.forEach(l=>{this.videoElement.addEventListener(l,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(l){return l!==document.body&&document.body.contains(l)})(this.videoElement)||(this.videoElementStatus=Li.DESTROYED)},1e3),Z("ENABLE_VIDEO_FRAME_CALLBACK"))){var t,r;let l;const u=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",u),this.videoElementFreezeTimeout=window.setTimeout(p,Z("VIDEO_FREEZE_DURATION")))},p=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Yc.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=Yc.VideoStateFrozen:document.addEventListener("visibilitychange",u))},m=(g,E)=>{if(this.videoElementStatus===Li.PLAYING){if(l){const C=E.presentationTime-l.presentationTime,B=E.presentedFrames-l.presentedFrames;this._render_interframe_delays_sizes.push(B),this._render_interframe_delays.push(C);const M=xA(this._render_interframe_delays_sizes),F=M-this._render_interframe_delays_sizes[0];if(M>30&&F>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===Yc.VideoStateStarting&&(this.videoState=Yc.VideoStateDecoding),this.videoState===Yc.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(p,Z("VIDEO_FREEZE_DURATION"))),C<Z("VIDEO_FREEZE_DURATION")&&this.videoState===Yc.VideoStateFrozen&&(this.videoState=Yc.VideoStateDecoding),C>Z("VIDEO_FREEZE_DURATION")&&Xc.lastVisibleTime>=Xc.lastHiddenTime&&l.timestamp>Xc.lastVisibleTime&&l.timestamp>Xc.lastHiddenTime){const q=Math.min(66,K3(this._render_interframe_delays_sizes,this._render_interframe_delays)),Y=Math.max(0,C-(B-1)*q);this.renderFreezeAccTime2+=Y>q?Y:0,this.renderFreezeAccTime+=C}}l=Yn(Yn({},E),{},{timestamp:g})}var y,b;Z("ENABLE_VIDEO_FRAME_CALLBACK")&&((y=(b=this.videoElement).requestVideoFrameCallback)===null||y===void 0||y.call(b,m))};(t=(r=this.videoElement).requestVideoFrameCallback)===null||t===void 0||t.call(r,m)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),by()&&!Z("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const s=en();s.name==="Safari"&&Number(s.version)===15||df()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,rr()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,rr()&&this.videoElement.load());const a=this.videoElement.play();a!==void 0&&a.catch(l=>{O.debug("[".concat(this.trackId,"] playback interrupted"),l.toString())})}resetVideoElement(){q3.forEach(t=>{this.videoElement&&this.videoElement.removeEventListener(t,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=Li.NONE}handleAutoPlayFailed(){const t=r=>{r.preventDefault(),this.videoElement.play().then(()=>{O.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(s=>{O.error(s)}),this.autoplayFailed=!1,rg()?document.body.removeEventListener("click",t,!0):(document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0))};rg()?document.body.addEventListener("click",t,!0):(document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)),JV()}}const q3=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class Y3 extends YA{constructor(t){super(t),pe(this,"container",void 0),pe(this,"slot",void 0),this.slot=t.element,this.updateConfig(t)}updateConfig(t){this.config=t,this.trackId=t.trackId;const r=t.element;r!==this.slot&&(this.destroy(),this.slot=r),this.createElements()}updateVideoTrack(t){this.videoTrack!==t&&(this.videoTrack=t,this.createElements())}play(t){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&super.play(t)}getCurrentFrame(){var t;return(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(t){var r;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(t,s):await qA(t)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",Z("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var t;!this.container||(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var t;if((t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var t;(t=this.container)!==null&&t!==void 0&&t.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var $3,X3,J3,Q3,Z3,eB,tB,nB,rB,iB,sB,oB,aB,cB,lB,dB,uB,hB,pB,fB,mB,gB,_B,EB,vB,yB,Gt,SB,xB,TB,bB,wB,CB,RB,AB,bo;let Un=($3=_t({argsMap:(e,t,r)=>[e.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),X3=pr(),J3=_t({argsMap:e=>[e.getTrackId()]}),Q3=pf("LocalVideoTrack","_enabledMutex"),Z3=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),eB=pr(),tB=pf("LocalVideoTrack","_enabledMutex"),nB=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),rB=pr(),iB=_t({argsMap:(e,t)=>[e.getTrackId(),t,e._saveEncodeBitrateRatio]}),sB=pr(),oB=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),aB=pr(),cB=pr(),lB=_t({argsMap:(e,t,r)=>[e.getTrackId(),t,r]}),dB=pr(),uB=pr(),hB=pr(),pB=pr(),fB=pr(),mB=pr(),gB=pr(),_B=_t({argsMap:(e,t)=>[e.getTrackId(),t.name]}),EB=_t({argsMap:e=>[e.getTrackId()]}),vB=_t({argsMap:e=>[e.getTrackId()]}),yB=_t({argsMap:(e,t,r)=>[e.getTrackId(),t.label,r]}),Gt=class hJ extends xf{get videoHeight(){if(vi()){const{height:t}=this._mediaStreamTrack.getSettings();return this._videoHeight=t,this._videoHeight}return this._videoHeight}get videoWidth(){if(vi()){const{width:t}=this._mediaStreamTrack.getSettings();return this._videoWidth=t,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Li.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(t){this._processorContext=t}get __className__(){return"LocalVideoTrack"}constructor(t,r,s,a,l,u){if(super(t,l),pe(this,"trackMediaType",Sf.VIDEO),pe(this,"_player",void 0),pe(this,"isUseScaleResolutionDownBy",!1),pe(this,"_videoVisibleTimer",null),pe(this,"_previousVideoVisibleStatus",void 0),pe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),pe(this,"_encoderConfig",void 0),pe(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),pe(this,"_optimizationMode",void 0),pe(this,"_saveEncodeBitrateRatio",1),pe(this,"_videoHeight",void 0),pe(this,"_videoWidth",void 0),pe(this,"_forceBitrateLimit",void 0),pe(this,"_enabled",!0),pe(this,"_processorDestination",void 0),pe(this,"_processorContext",void 0),vi()){const{width:p,height:m}=t.getSettings();this._videoWidth=p,this._videoHeight=m}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=s,this._optimizationMode=a,this._hints=u||[],r&&this._hints.indexOf(Tn.CUSTOM_TRACK)!==-1?this._encoderConfig=er(r):this._encoderConfig=r,this._hints.indexOf(Tn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(dA(cn.CHROME,115)&&xy().indexOf("Windows")!==-1){const p=function(m,g){if("VideoFrame"in window&&"TransformStream"in window&&tn().supportWebRTCInsertableStream){const E=new MediaStreamTrackProcessor(m),y=new MediaStreamTrackGenerator({kind:"video"});let b,C,B=Date.now();const M=()=>{F&&(clearInterval(F),F=void 0),b&&(b.close(),b=void 0),m.stop(),C=void 0,y.removeEventListener("ended",M)};let F=window.setInterval(()=>{if(C&&b&&Date.now()-B>(g??1e3))try{y.readyState==="live"?C.enqueue(b.clone()):M()}catch{M()}},g??1e3);const q=new TransformStream({transform:(Y,re)=>{y.readyState==="live"?(C=re,B=Date.now(),b===void 0?(b=Y,re.enqueue(Y.clone())):(re.enqueue(b),b=Y)):Y.close()}});return y.addEventListener("ended",M),E.readable.pipeThrough(q).pipeTo(y.writable),y}}(t);p&&(O.info("local screen video track begin to inject frame"),this._mediaStreamTrack=p)}r&&this._hints.indexOf(Tn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(r),this._processorContext=new e3(this.getTrackId(),"local"),this._processorDestination=new ZV(this.processorContext),this.bindProcessorDestinationEvents()}play(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof t=="string"){const a=document.getElementById(t);a?t=a:(O.warning("[".concat(this.getTrackId(),'] can not find "#').concat(t,'" element, use document.body')),t=document.body)}O.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const s=Yn(Yn(Yn({},this._getDefaultPlayerConfig()),r),{},{trackId:this.getTrackId(),element:t});this._player?this._player.updateConfig(s):(t instanceof HTMLVideoElement?this._player=new YA(s):this._player=new Y3(s),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const a=this.getVideoElementVisibleStatus();this.safeEmit(vf.VIDEO_ELEMENT_VISIBLE_STATUS,a)}catch{}},Z("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,O.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),t),!t){this._originMediaStreamTrack.enabled=!1;try{await Cn(this,rt.NEED_DISABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}return r||(this._enabled=!1),void O.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Cn(this,rt.NEED_ENABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}O.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}async setMuted(t){t!==this._muted&&(this.stateCheck("muted",t),this._muted=t,this._originMediaStreamTrack.enabled=!t,O.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(t)),t?await Cn(this,rt.NEED_MUTE_TRACK,this):await Cn(this,rt.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._saveEncodeBitrateRatio;if(this._saveEncodeBitrateRatio!==1&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*t),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*t),O.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(t)),this._saveEncodeBitrateRatio=1;try{await Cn(this,rt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(O)}}}async setEncoderConfiguration(t,r){if(!this._enabled)throw new Se($.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(t=wa(t),Z("USE_STANDARD_BITRATE_DEFAULT")&&(delete t.bitrateMax,delete t.bitrateMin),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),t.width||t.height||t.frameRate){const s=Uy({encoderConfig:t});(vi()||ss()||xa())&&(s.deviceId=void 0),O.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(s));try{await this._originMediaStreamTrack.applyConstraints(s),this.updateMediaStreamTrackResolution()}catch(a){const l=new Se($.UNEXPECTED_ERROR,a.toString());throw O.error("[".concat(this.getTrackId(),"] applyConstraints error"),l.toString()),l}}this._encoderConfig=t,this._hints.indexOf(Tn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Cn(this,rt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(O)}}getStats(){return Od(()=>{O.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),mo(this,rt.GET_STATS)||Yn({},VA)}async setBeautyEffect(t){O.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(t,r):await qA(t)}async setBitrateLimit(t){O.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(t))),t&&(this._forceBitrateLimit=t,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<t.max_bitrate?this._encoderConfig.bitrateMax:t.max_bitrate:this._encoderConfig.bitrateMax=t.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=t.min_bitrate))}async setOptimizationMode(t){if(t!=="motion"&&t!=="detail"&&t!=="balanced")return void O.error($.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const r=this._optimizationMode;try{this._optimizationMode=t,await Cn(this,rt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(s){throw this._optimizationMode=r,O.error("[".concat(this.getTrackId(),"] set optimization mode failed"),s.toString()),s}O.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(t,")"))}setScalabiltyMode(t){if(t.numSpatialLayers===1&&t.numTemporalLayers!==1)return O.error($.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=t,O.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(t,")"))}updateMediaStreamTrackResolution(){r3(this._originMediaStreamTrack).then(t=>{let[r,s]=t;this._videoHeight=s,this._videoWidth=r}).catch(Ry)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(t){if(!this._enabled)throw new Se($.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");O.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(t)),t=wa(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),this._encoderConfig=t,this._hints.indexOf(Tn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Cn(this,rt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(O)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:t,height:r,frameRate:s}=this.getMediaStreamTrackSettings();if(!t||!r||!s)return;const{bitrateMax:a,bitrateMin:l}=this._encoderConfig;if(l==null||a==null){const{max:u,min:p}=function(m,g,E,y,b){const C=Z("BITRATE_ADAPTER_TYPE");if(C==="DEFAULT_BITRATE")return{min:y,max:b};if(b===void 0){const B=Math.floor(200*Math.pow(E/15,.6)*Math.pow(m*g/640/360,.75));b=C==="STANDARD_BITRATE"?4*B:2*B,y=y??B}else y=y??Math.floor(b/10);return{min:y,max:b}}(t,r,s,l,a);if(this._encoderConfig.bitrateMin=p,this._encoderConfig.bitrateMax=u,Z("VIDEO_STANDARD_BITRATE_VERSION")&&l==null&&a==null){const[m,g]=function(E,y,b){const C=4*Math.floor(2e5*Math.pow(b/15,.6)*Math.pow(E*y/230400,.75)),B=E*y,M=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),F=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let q=$s(M).call(M).next().value,Y=1;if(M.has(B))q=M.get(B);else{var re;const Xe=th(re=Array.from(M.entries())).call(re,(kt,Tt)=>{let[jn]=kt,[bn]=Tt;return jn-bn}),jt=Xe.find(kt=>{let[Tt]=kt;return Tt>B});if(jt){const kt=Xe.indexOf(jt);if(kt>0){const Tt=Xe[kt-1],jn=(B-Tt[0])/(jt[0]-Tt[0]);q=Tt[1]+jn*(jt[1]-Tt[1])}else q=jt[1]}else q=Xe[Xe.length-1][1]}if(F.has(B))Y=F.get(B);else{var ce;const Xe=th(ce=Array.from(F.entries())).call(ce,(kt,Tt)=>{let[jn]=kt,[bn]=Tt;return jn-bn}),jt=Xe.find(kt=>{let[Tt]=kt;return Tt>B});if(jt){const kt=Xe.indexOf(jt);if(kt>0){const Tt=Xe[kt-1],jn=(B-Tt[0])/(jt[0]-Tt[0]);Y=Tt[1]+jn*(jt[1]-Tt[1])}else Y=jt[1]}else Y=Xe[Xe.length-1][1]}const le=Z("VIDEO_NEW_BITRATE_RATIO");le&&le>0&&(q=le/100);const ae=Math.floor(C*q),_e=Math.floor(65e4*Math.pow(E*y/230400,.5)*Math.pow(b/15,.69));let we=ae;const Be=Z("VIDEO_STANDARD_BITRATE_VERSION");return Be&&Be>0&&(Be===1?we=C:Be===2?we=ae:Be===3&&(we=_e)),[Math.floor(we/1e3),Y]}(t,r,s);this._encoderConfig.bitrateMax=m,this._encoderConfig.bitrateMin=p?Math.min(p,m):m,this._saveEncodeBitrateRatio=g,O.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(t,", h: ").concat(r,", fps: ").concat(s,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else O.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(t,", h: ").concat(r,", fps: ").concat(s,"] => [brMax: ").concat(u,", brMin: ").concat(p,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var t,r;const s=this==null||(t=this._player)===null||t===void 0?void 0:t.getContainerElement(),a={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:l,slot:u}=a;if(this.isPlaying&&l instanceof HTMLVideoElement&&u instanceof HTMLElement){const p=iV.checkOneElementVisible(l),m=Object.assign({},p);if(m.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=m.visible;const g=st.reportApiInvoke(null,{tag:sr.TRACER,name:xr.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});m.visible?g.onSuccess("Video is visible"):g.onSuccess("Invisible because of ".concat(m.reason))}return m}return}catch(s){throw new Se($.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}async renewMediaStreamTrack(t){}pipe(t){if(this.processor===t)return t;if(t._source)throw new Se($.INVALID_OPERATION,"Processor ".concat(t.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=t,this.processor._source=this,t.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),t}unpipe(){if(!this.processor)return;const t=this.processor;this.processor._source=void 0,this.processor=void 0,t.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;t&&(s=Yn(Yn({},s),wa(t))),s=dh(s);const a=An(8,"track-video-cloned-"),l=new hJ(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,s,dh(this._scalabilityMode),this._optimizationMode,a,dh(this._hints));return t&&s&&l.setEncoderConfiguration(s),O.debug("clone video track from ".concat(this.getTrackId()," to ").concat(a,", clone ").concat(r)),l}async replaceTrack(t,r){if(!(t instanceof MediaStreamTrack))throw new Se($.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(t.kind!=="video")throw new Se($.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(t,r,!0),this.updateMediaStreamTrackResolution()}sendSeiData(t){if(Od(()=>{st.reportApiInvoke(null,{name:xr.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:sr.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!Z("ENABLE_VIDEO_SEI")||!Z("ENABLE_ENCODED_TRANSFORM"))return void O.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(t instanceof Uint8Array==0)return new Se($.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const r=this.getRTCRtpTransceiver();if(!r)return void O.warning("Video track is not published, SEI can not be send");const s=r.sender.getParameters();if(s.codecs.length===0)return;const a=s.codecs[0].mimeType.toLocaleLowerCase();a==="video/h264"?this.safeEmit("sei-to-send",t):O.warning("SEI is not supported by ".concat(a))}bindProcessorDestinationEvents(){this.processorDestination.on(os.ON_TRACK,async t=>{t?t!==this._mediaStreamTrack&&(this._mediaStreamTrack=t,this._updatePlayerSource(),await Cn(this,rt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Cn(this,rt.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(os.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(vo.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(vo.REQUEST_CONSTRAINTS)}},Xt(Gt.prototype,"play",[$3,X3],Object.getOwnPropertyDescriptor(Gt.prototype,"play"),Gt.prototype),Xt(Gt.prototype,"stop",[J3],Object.getOwnPropertyDescriptor(Gt.prototype,"stop"),Gt.prototype),Xt(Gt.prototype,"setEnabled",[Q3,Z3,eB],Object.getOwnPropertyDescriptor(Gt.prototype,"setEnabled"),Gt.prototype),Xt(Gt.prototype,"setMuted",[tB,nB,rB],Object.getOwnPropertyDescriptor(Gt.prototype,"setMuted"),Gt.prototype),Xt(Gt.prototype,"setSaveEncodeBitrateRatio",[iB,sB],Object.getOwnPropertyDescriptor(Gt.prototype,"setSaveEncodeBitrateRatio"),Gt.prototype),Xt(Gt.prototype,"setEncoderConfiguration",[oB,aB],Object.getOwnPropertyDescriptor(Gt.prototype,"setEncoderConfiguration"),Gt.prototype),Xt(Gt.prototype,"getStats",[cB],Object.getOwnPropertyDescriptor(Gt.prototype,"getStats"),Gt.prototype),Xt(Gt.prototype,"setBeautyEffect",[lB,dB],Object.getOwnPropertyDescriptor(Gt.prototype,"setBeautyEffect"),Gt.prototype),Xt(Gt.prototype,"getCurrentFrameData",[uB],Object.getOwnPropertyDescriptor(Gt.prototype,"getCurrentFrameData"),Gt.prototype),Xt(Gt.prototype,"getCurrentFrameImage",[hB],Object.getOwnPropertyDescriptor(Gt.prototype,"getCurrentFrameImage"),Gt.prototype),Xt(Gt.prototype,"setBitrateLimit",[pB],Object.getOwnPropertyDescriptor(Gt.prototype,"setBitrateLimit"),Gt.prototype),Xt(Gt.prototype,"setOptimizationMode",[fB],Object.getOwnPropertyDescriptor(Gt.prototype,"setOptimizationMode"),Gt.prototype),Xt(Gt.prototype,"setScalabiltyMode",[mB],Object.getOwnPropertyDescriptor(Gt.prototype,"setScalabiltyMode"),Gt.prototype),Xt(Gt.prototype,"updateMediaStreamTrackResolution",[gB],Object.getOwnPropertyDescriptor(Gt.prototype,"updateMediaStreamTrackResolution"),Gt.prototype),Xt(Gt.prototype,"pipe",[_B],Object.getOwnPropertyDescriptor(Gt.prototype,"pipe"),Gt.prototype),Xt(Gt.prototype,"unpipe",[EB],Object.getOwnPropertyDescriptor(Gt.prototype,"unpipe"),Gt.prototype),Xt(Gt.prototype,"close",[vB],Object.getOwnPropertyDescriptor(Gt.prototype,"close"),Gt.prototype),Xt(Gt.prototype,"replaceTrack",[yB],Object.getOwnPropertyDescriptor(Gt.prototype,"replaceTrack"),Gt.prototype),Gt),$A=(SB=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),xB=pr(),TB=pf("CameraVideoTrack","_enabledMutex"),bB=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),wB=pr(),CB=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),RB=pr(),AB=_t({argsMap:e=>[e.getTrackId()]}),bo=class pJ extends Un{get __className__(){return"CameraVideoTrack"}constructor(t,r,s,a,l,u){super(t,wa(r.encoderConfig),a,l,u),pe(this,"_config",void 0),pe(this,"_originalConstraints",void 0),pe(this,"_constraints",void 0),pe(this,"_enabled",!0),pe(this,"_deviceName","default"),pe(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(df()||pA())&&!function(){const p=en();if(p.os!==Ur.IOS||!p.osVersion)return!1;const m=p.osVersion.split(".");return Number(m[0])===15&&Number(m[1])>=2}()&&eV()&&this._enabled&&!this._isClosed&&(O.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=r,this._originalConstraints=s,this._constraints=s,this._deviceName=t.label,this._encoderConfig=wa(this._config.encoderConfig),yn.on(li.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),yn.on(li.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(t){return typeof t=="string"?this._setDeviceById(t):t.deviceId?this._setDeviceById(t.deviceId):t.facingMode?this._setDeviceByFacingModel(t.facingMode):void 0}async _setDeviceById(t){if(O.info("[".concat(this.getTrackId(),"] set device to ").concat(t)),this._enabled)try{const r=await xo.getDeviceById(t),s={};s.video=Yn({},this._constraints),s.video.deviceId={exact:t},s.video.facingMode=void 0,this._originMediaStreamTrack.stop();let a=null;try{a=await So(s,this.getTrackId())}catch(l){throw O.error("[".concat(this.getTrackId(),"] setDevice failed"),l.toString()),a=await So({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),l}await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await xo.getDeviceById(t);this._deviceName=r.label,this._config.cameraId=t,this._constraints.deviceId={exact:t}}catch(r){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}O.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(t){O.info("[".concat(this.getTrackId(),"] set facingMode ").concat(t));const r={video:Yn(Yn({},this._constraints),{},{deviceId:void 0,facingMode:{exact:t}})};if(this._enabled){this._originMediaStreamTrack.stop();let s=null;try{s=await So(r,this.getTrackId())}catch(a){throw O.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),a.toString()),s=await So({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),a}await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=t,this._config.cameraId=void 0,this._constraints=Yn({},r.video),O.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(t,r){if(!r){if(t===this._enabled)return;this.stateCheck("enabled",t)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),t),t){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const s=await So({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1)}await Cn(this,rt.NEED_ENABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled true error"),s.toString()),s}this.updateMediaStreamTrackResolution(),O.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),r||(this._enabled=!1);try{await Cn(this,rt.NEED_DISABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}O.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(t,r){if(!this._enabled)throw new Se($.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");t=wa(t),Z("USE_STANDARD_BITRATE_DEFAULT")&&(delete t.bitrateMax,delete t.bitrateMin),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate||t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate||t.bitrateMin);const s=er(this._config);s.encoderConfig=t;const a=Uy(s);(vi()||ss()||xa())&&(a.deviceId=void 0),O.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(t),JSON.stringify(a));try{await this._originMediaStreamTrack.applyConstraints(a),this.updateMediaStreamTrackResolution()}catch(l){const u=new Se($.UNEXPECTED_ERROR,l.toString());throw O.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}this._config=s,this._constraints=a,this._originalConstraints=a,this._encoderConfig=t,this._hints.indexOf(Tn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Cn(this,rt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(l){return l.throw(O)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((ss()||xa())&&this._enabled&&!this._isClosed&&yn.duringInterruption){const t=async()=>{yn.off(li.IOS_INTERRUPTION_END,t),this._enabled&&!this._isClosed&&(O.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};yn.on(li.IOS_INTERRUPTION_END,t)}else O.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(vf.TRACK_ENDED)}async renewMediaStreamTrack(t){const r=t||this._constraints,s=xo.searchDeviceIdByName(this._deviceName);if(s&&!r.deviceId&&(r.deviceId={exact:s}),this._enabled){const a=await So({video:r},this.getTrackId());this._constraints=r,await this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),yn.off(li.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),yn.off(li.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;t&&(s=Yn(Yn({},s),wa(t))),s=dh(s);const a=An(8,"track-cam-cloned-"),l=new pJ(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,dh(Yn(Yn({},this._config),{},{encoderConfig:s})),dh(this._constraints),dh(this._scalabilityMode),this._optimizationMode,a);return t&&s&&l.setEncoderConfiguration(s),O.debug("clone track from ".concat(this.getTrackId()," to ").concat(a,", clone ").concat(r)),l}bindProcessorContextEvents(){this.processorContext.on(vo.REQUEST_UPDATE_CONSTRAINTS,async(t,r,s)=>{try{const a=Object.assign({},this._originalConstraints,...t);await this.renewMediaStreamTrack(a),r()}catch(a){s(a)}}),this.processorContext.on(vo.REQUEST_CONSTRAINTS,async t=>{t(this._originMediaStreamTrack.getSettings())})}},Xt(bo.prototype,"setDevice",[SB,xB],Object.getOwnPropertyDescriptor(bo.prototype,"setDevice"),bo.prototype),Xt(bo.prototype,"setEnabled",[TB,bB,wB],Object.getOwnPropertyDescriptor(bo.prototype,"setEnabled"),bo.prototype),Xt(bo.prototype,"setEncoderConfiguration",[CB,RB],Object.getOwnPropertyDescriptor(bo.prototype,"setEncoderConfiguration"),bo.prototype),Xt(bo.prototype,"close",[AB],Object.getOwnPropertyDescriptor(bo.prototype,"close"),bo.prototype),bo);function XA(e,t,r,s){r.optimizationMode&&(s&&s.width&&s.height?(r.encoderConfig=Yn(Yn({},s),{},{bitrateMin:s.bitrateMin,bitrateMax:s.bitrateMax}),r.optimizationMode!=="motion"&&r.optimizationMode!=="detail"||(t.contentHint=r.optimizationMode,t.contentHint===r.optimizationMode?O.debug("[".concat(e,"] set content hint to"),r.optimizationMode):O.debug("[".concat(e,"] set content hint failed")))):O.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var NB,IB,OB,DB,qo,PB,kB,LB,MB,jB,UB,Ki;class FB extends WV{getUserId(){return this._userId}constructor(t,r,s,a){super(t,"track-".concat(t.kind,"-").concat(r,"-").concat(a.clientId,"_").concat(An(5,""))),pe(this,"_userId",void 0),pe(this,"_uintId",void 0),pe(this,"_isDestroyed",!1),pe(this,"store",void 0),pe(this,"processor",void 0),pe(this,"processorContext",void 0),this._userId=r,this._uintId=s,this.store=a}_updateOriginMediaStreamTrack(t){this._originMediaStreamTrack=t,this._mediaStreamTrack=t,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,O.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let wf=(NB=_t({argsMap:(e,t,r)=>[e.getTrackId(),typeof t=="string"?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),IB=_t({argsMap:e=>[e.getTrackId()]}),OB=_t({argsMap:(e,t)=>[e.getTrackId(),t.name]}),DB=_t({argsMap:e=>[e.getTrackId()]}),Xt((qo=class extends FB{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==Li.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,r,s){super(e,t,r,s),pe(this,"_videoVisibleTimer",null),pe(this,"_previousVideoVisibleStatus",void 0),pe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),pe(this,"trackMediaType",Sf.VIDEO),pe(this,"_videoWidth",void 0),pe(this,"_videoHeight",void 0),pe(this,"_player",void 0),pe(this,"processorDestination",void 0),pe(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new e3(this.getTrackId(),"remote"),this.processorDestination=new ZV(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Od(()=>{O.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),mo(this,rt.GET_STATS)||Yn({},VV)}play(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){const s=document.getElementById(e);s?e=s:(O.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}O.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const r=Yn(Yn({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(r):(e instanceof HTMLVideoElement?this._player=new YA(r):this._player=new Y3(r),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(yf.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=s=>{this.safeEmit(yf.VIDEO_STATE_CHANGED,s)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const s=this.getVideoElementVisibleStatus();this.safeEmit(yf.VIDEO_ELEMENT_VISIBLE_STATUS,s)}catch{}},Z("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,O.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){r3(this._originMediaStreamTrack).then(e=>{let[t,r]=e;this._videoHeight=r,this._videoWidth=t}).catch(Ry)}_updatePlayerSource(){O.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const r=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),s={track:this,element:this==null||(t=this._player)===null||t===void 0?void 0:t.getVideoElement(),slot:r==null?void 0:r.parentElement},{element:a,slot:l}=s;if(this.isPlaying&&a instanceof HTMLVideoElement&&l instanceof HTMLElement){const u=iV.checkOneElementVisible(a),p=Object.assign({},u);if(p.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=p.visible;const m=st.reportApiInvoke(null,{tag:sr.TRACER,name:xr.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});p.visible?m.onSuccess("Video is visible"):m.onSuccess("Invisible because of ".concat(p.reason))}return p}return}catch(r){throw new Se($.GET_VIDEO_ELEMENT_VISIBLE_ERROR,r.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new Se($.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(os.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(os.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(fh.SEI_RECEIVED,e)}}).prototype,"play",[NB],Object.getOwnPropertyDescriptor(qo.prototype,"play"),qo.prototype),Xt(qo.prototype,"stop",[IB],Object.getOwnPropertyDescriptor(qo.prototype,"stop"),qo.prototype),Xt(qo.prototype,"pipe",[OB],Object.getOwnPropertyDescriptor(qo.prototype,"pipe"),qo.prototype),Xt(qo.prototype,"unpipe",[DB],Object.getOwnPropertyDescriptor(qo.prototype,"unpipe"),qo.prototype),qo),Cf=(PB=_t({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),kB=_t({argsMap:(e,t)=>[e.getTrackId(),t]}),LB=_t({argsMap:e=>[e.getTrackId()]}),MB=_t({argsMap:e=>[e.getTrackId()]}),jB=_t({argsMap:(e,t)=>[e.getTrackId(),t.name]}),UB=_t({argsMap:e=>[e.getTrackId()]}),Xt((Ki=class extends FB{get isPlaying(){return this._useAudioElement?Es.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,r,s){super(e,t,r,s),pe(this,"trackMediaType",Sf.AUDIO),pe(this,"_source",void 0),pe(this,"_useAudioElement",!0),pe(this,"_volume",100),pe(this,"processorContext",void 0),pe(this,"processorDestination",void 0),pe(this,"_played",!1),pe(this,"_bypassWebAudio",!1),Z("DISABLE_WEBAUDIO")?(this._source=new KA,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new KV(e,!0),Z("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Eo.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(yf.FIRST_FRAME_DECODED)}),this.processorContext=new n3(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new t3(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Eo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Eo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Eo.ON_AUDIO_BUFFER),this._source.on(Eo.ON_AUDIO_BUFFER,r=>e(r))}setVolume(e){this._volume=e,this._useAudioElement?Es.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!MV())throw new Se($.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Es.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Od(()=>{O.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),mo(this,rt.GET_STATS)||Yn({},FV)}play(){O.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(O.debug("[".concat(this.getTrackId(),"] use audio element to play")),Es.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){O.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Es.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];O.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Es.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new Se($.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new Se($.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new Se($.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(os.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(os.ON_NODE,e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(os.ON_TRACK),this.processorDestination.removeAllListeners(os.ON_NODE)}}).prototype,"setVolume",[PB],Object.getOwnPropertyDescriptor(Ki.prototype,"setVolume"),Ki.prototype),Xt(Ki.prototype,"setPlaybackDevice",[kB],Object.getOwnPropertyDescriptor(Ki.prototype,"setPlaybackDevice"),Ki.prototype),Xt(Ki.prototype,"play",[LB],Object.getOwnPropertyDescriptor(Ki.prototype,"play"),Ki.prototype),Xt(Ki.prototype,"stop",[MB],Object.getOwnPropertyDescriptor(Ki.prototype,"stop"),Ki.prototype),Xt(Ki.prototype,"pipe",[jB],Object.getOwnPropertyDescriptor(Ki.prototype,"pipe"),Ki.prototype),Xt(Ki.prototype,"unpipe",[UB],Object.getOwnPropertyDescriptor(Ki.prototype,"unpipe"),Ki.prototype),Ki);const Xc=new class extends Zn{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),pe(this,"_lastHiddenTime",0),pe(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),O.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class VB extends Zn{constructor(t,r){super(),pe(this,"trackMediaType",Sf.DATA),pe(this,"_version",1),pe(this,"_type",3),pe(this,"_config",void 0),pe(this,"_originDataChannel",void 0),pe(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),pe(this,"_dataStreamPacketHandler",{serialize:s=>s,deserialize:s=>s}),pe(this,"_datachannelEventMap",new Map),this._config=t,r&&(this._originDataChannel=r,this._bandDataChannelEvents(r)),this._initPacketHeader()}useDataStream(t){this._dataStreamPacketHandler=t}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return Z("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var t,r;return(t=(r=this._originDataChannel)===null||r===void 0?void 0:r.readyState)!==null&&t!==void 0?t:"connecting"}get _originDataChannelId(){var t,r;return(t=(r=this._originDataChannel)===null||r===void 0?void 0:r.id)!==null&&t!==void 0?t:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new Ye((t,r)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&t();const s=setTimeout(()=>{var a;r(new Se($.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((a=this._originDataChannel)===null||a===void 0?void 0:a.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(s),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),t()},this._originDataChannel.onerror=()=>{throw clearTimeout(s),new Se($.DATACHANNEL_CONNECTION_TIMEOUT)}}else r(new Se($.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(t){this._originDataChannel=t,this._bandDataChannelEvents(t)}_initPacketHeader(){const t=new DataView(this._dataStreamPacketHeader);t.setUint16(0,this._version),t.setUint8(2,this._type),t.setUint8(3,this._config.id)}_bandDataChannelEvents(t){this._unbindDataChannelEvents(t),[My.OPEN,My.CLOSE,My.ERROR].forEach(r=>{const s=()=>{this.emit(r)};this._datachannelEventMap.set(r,s),t.addEventListener(r,s)})}_unbindDataChannelEvents(t){Array.from(this._datachannelEventMap.entries()).forEach(r=>{let[s,a]=r;t.removeEventListener(s,a)}),this._datachannelEventMap.clear()}}class Ude extends VB{constructor(t){super(t),pe(this,"_messageListener",void 0),this._messageListener=r=>{if(r.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const s=r.data.slice(0,this._dataStreamPacketHeader.byteLength),a=new DataView(s).getUint8(3);if(a!==this.id)return void(Z("SHOW_DATASTREAM2_LOG")&&O.debug("invalid datachannel id: ".concat(a," !== ").concat(this.id)));let l=r.data.slice(this._dataStreamPacketHeader.byteLength);l=this._dataStreamPacketHandler.deserialize(l),this.emit(My.MESSAGE,l)}}_updateOriginDataChannel(t){super._updateOriginDataChannel(t),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class Fde extends VB{send(t){if(this._originDataChannel){let r=t;r=this._dataStreamPacketHandler.serialize(t);const s=new Uint8Array(this._dataStreamPacketHeader.byteLength+r.byteLength);s.set(new Uint8Array(this._dataStreamPacketHeader),0),s.set(new Uint8Array(r),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(s.buffer)}}}function Fy(){const e=new Blob([atob("ZnVuY3Rpb24gdCh0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLG89W10scj0wO2Zvcig7by5sZW5ndGg8bjspciszPG4mJjA9PT1hW3JdJiYwPT09YVtyKzFdJiYzPT09YVtyKzJdJiYoMD09PWFbciszXXx8MT09PWFbciszXXx8Mj09PWFbciszXXx8Mz09PWFbciszXSk/KG8ucHVzaChhW3JdLGFbcisxXSxhW3IrM10pLHIrPTQpOihvLnB1c2goYVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobyl9ZnVuY3Rpb24gZSh0LGUpe2NvbnN0IG49ZnVuY3Rpb24odCl7Y29uc3QgZT10Lmxlbmd0aDtsZXQgbj1bXSxhPTA7Zm9yKDthPGU7KWErMjxlJiYwPT09dFthXSYmMD09PXRbYSsxXSYmKDA9PT10W2ErMl18fDE9PT10W2ErMl18fDI9PT10W2ErMl18fDM9PT10W2ErMl0pPyhuLnB1c2godFthXSx0W2ErMV0sMyx0W2ErMl0pLGErPTMpOihuLnB1c2godFthXSksYSsrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxyPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNitvKzErYSt0LmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8bzspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1yLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNitpK2EpLHMuYnVmZmVyfWNvbnN0IG49NzEsYT0xLG89MixyPTEscz0yO3ZhciBpOyFmdW5jdGlvbih0KXt0W3QuQVVESU9fTEVWRUw9MV09IkFVRElPX0xFVkVMIix0W3QuTUVUQURBVEE9Ml09Ik1FVEFEQVRBIix0W3QuQVVESU9fNjRfQklUX1BUUz0zXT0iQVVESU9fNjRfQklUX1BUUyJ9KGl8fChpPXt9KSk7bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKT4tMSYmLTE9PT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkNocm9tZSIpJiYoc2VsZi5vbnJ0Y3RyYW5zZm9ybT1mPT57Y29uc3QgdT1mLnRyYW5zZm9ybWVyO2xldCBkPVtdLGw9W107dS5vcHRpb25zLnBvcnQub25tZXNzYWdlPXQ9Pnt0LmRhdGEuc2VpJiZkLnB1c2godC5kYXRhLnNlaSksdC5kYXRhLm1ldGFkYXRhJiZsLnB1c2godC5kYXRhLm1ldGFkYXRhKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IGc9dS5yZWFkYWJsZS5nZXRSZWFkZXIoKSxjPXUud3JpdGFibGUuZ2V0V3JpdGVyKCk7InNlaS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiBlKG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IGU9ZnVuY3Rpb24oZSl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5kYXRhKTtsZXQgYT0wO2Zvcig7YSs0PGUuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PW4uZ2V0VWludDgoYSswKSYmMD09PW4uZ2V0VWludDgoYSsxKSYmMD09PW4uZ2V0VWludDgoYSsyKSYmMT09PW4uZ2V0VWludDgoYSszKSYmNj09PW4uZ2V0VWludDgoYSs0KSl7bGV0IG89YSs2LHI9MCxzPTA7Zm9yKDsyNTU9PT0ocz1uLmdldFVpbnQ4KG8rKykpOylyKz0yNTU7cis9cztjb25zdCBpPXQoZS5kYXRhLG8scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGkpfWErK31yZXR1cm4gbnVsbH0oYS52YWx1ZSk7ZSYmbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTplfSl9Yy53cml0ZShhLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0odSk6InNlaS10eCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZC5zaGlmdCgpO3QmJihhLnZhbHVlLmRhdGE9ZShhLnZhbHVlLmRhdGEsdCkpfWMud3JpdGUoYS52YWx1ZSksbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChuKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2cucmVhZCgpLnRoZW4oKGY9PntpZighZi5kb25lKXtpZihmLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZEF1ZGlvRnJhbWUpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlPSExKXtjb25zdCBmPXQuZ2V0VWludDgoMCk7aWYoZiE9PW4pcmV0dXJuO2NvbnN0IHU9dC5nZXRVaW50MTYoMSksZD1hK28rdSxsPW5ldyBVaW50OEFycmF5KHQuYnl0ZUxlbmd0aC1kKTtsLnNldChuZXcgVWludDhBcnJheSh0LmJ1ZmZlcixkLHQuYnl0ZUxlbmd0aC1kKSk7Y29uc3QgZz17bTpmLHRsdkxlbjp1LHRsdjpbXSxmcmFtZTpsfTtsZXQgYz1hK287Zm9yKDtjPGQ7KXtjb25zdCBuPXQuZ2V0VWludDgoYyksYT10LmdldFVpbnQxNihjK3IpLG89citzO2lmKG49PT1pLkFVRElPX0xFVkVMKXtsZXQgcj10LmdldFVpbnQ4KGMrbyk7Zm9yKGxldCBlPTE7ZTxhO2UrKylyPXI8PDh8dC5nZXRVaW50OChjK28rZSk7Zy50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZT8xMjdecj4+MToxMjcmcn0pfWVsc2UgaWYobj09PWkuTUVUQURBVEF8fG49PT1pLkFVRElPXzY0X0JJVF9QVFMpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoYSk7Zm9yKGxldCBuPTA7bjxhO24rKyllW25dPXQuZ2V0VWludDgoYytvK24pO2cudGx2LnB1c2goe3RhZzpuLGxlbmd0aDphLHZhbHVlOmV9KX1jKz1vK2F9cmV0dXJuIGd9KG5ldyBEYXRhVmlldyhmLnZhbHVlLmRhdGEpKTtpZih0KXtjb25zdCBuPXQudGx2LmZpbmQoKHQ9PnQudGFnPT09aS5NRVRBREFUQXx8dC50YWc9PT1pLkFVRElPXzY0X0JJVF9QVFMpKTtuJiZuLnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe21ldGFkYXRhOm4udmFsdWV9KSxmLnZhbHVlLmRhdGE9dC5mcmFtZS5idWZmZXJ9fWMud3JpdGUoZi52YWx1ZSksZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChlKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS10eCI9PT11Lm9wdGlvbnMubmFtZSYmZnVuY3Rpb24gdChlKXtnLnJlYWQoKS50aGVuKChmPT57aWYoIWYuZG9uZSl7aWYoZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe2dldE1ldGFkYXRhOiEwfSksZi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PWwuc2hpZnQoKTt0JiYoZi52YWx1ZS5kYXRhPWZ1bmN0aW9uKHQsZSxpKXtjb25zdCBmPWkuYnl0ZUxlbmd0aCx1PWYrcitzLGQ9YStvK3UsbD1uZXcgQXJyYXlCdWZmZXIodC5ieXRlTGVuZ3RoK2QpLGc9bmV3IERhdGFWaWV3KGwpO2cuc2V0VWludDgoMCxuKSxnLnNldFVpbnQxNigxLHUpLGcuc2V0VWludDgoMyxlKSxnLnNldFVpbnQxNig0LGYpO2ZvcihsZXQgdD0wO3Q8Zjt0KyspZy5zZXRVaW50OCg2K3QsaVt0XSk7Y29uc3QgYz1uZXcgVWludDhBcnJheShnLmJ1ZmZlcik7cmV0dXJuIGMuc2V0KG5ldyBVaW50OEFycmF5KHQpLGQpLGMuYnVmZmVyfShmLnZhbHVlLmRhdGEsaS5BVURJT182NF9CSVRfUFRTLHQpKX1jLndyaXRlKGYudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfSh1KX0sc2VsZi5wb3N0TWVzc2FnZSgicmVnaXN0ZXJlZCIpKTsK")],{type:"text/javascript"});return setTimeout(()=>Fv.revokeObjectURL(e),0),new Worker(Fv.createObjectURL(e))}const BB=71,JA=1,QA=2,ZA=1,WB=2;var Ml=function(e){return e[e.AUDIO_LEVEL=1]="AUDIO_LEVEL",e[e.METADATA=2]="METADATA",e[e.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",e}(Ml||{});function HB(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=e.getUint8(0);if(r!==BB)return;const s=e.getUint16(1),a=JA+QA+s,l=new Uint8Array(e.byteLength-a);l.set(new Uint8Array(e.buffer,a,e.byteLength-a));const u={m:r,tlvLen:s,tlv:[],frame:l};let p=JA+QA;for(;p<a;){const m=e.getUint8(p),g=e.getUint16(p+ZA),E=ZA+WB;if(m===Ml.AUDIO_LEVEL){let y=e.getUint8(p+E);for(let b=1;b<g;b++)y=y<<8|e.getUint8(p+E+b);u.tlv.push({tag:m,length:g,value:t?127^y>>1:127&y})}else if(m===Ml.METADATA||m===Ml.AUDIO_64_BIT_PTS){const y=new Uint8Array(g);for(let b=0;b<g;b++)y[b]=e.getUint8(p+E+b);u.tlv.push({tag:m,length:g,value:y})}p+=E+g}return u}const Vy=new Map,By=127,_h=1e-10,e1=139/13,Wy=new Map;function t1(e,t,r){const s="".concat(e,"-").concat(t,"-").concat(r);let a=0;return Wy.has(s)?a=Wy.get(s):(a=Math.log(function(u,p){const m=u-p;p<m&&(p=m);let g=1;for(let E=u,y=1;E>p;E--,y++)g=g*E/y;return g}(t,e))+e*Math.log(.5)+(t-e)*Math.log(1-.5)-Math.log(r)+r*e,Wy.set(s,a)),a<_h&&(a=_h),a}function GB(e,t,r){const s=t.length,a=e.length/s;let l=!1;for(let u=0,p=0;u<s;u++){let m=0;for(let g=p+a;p<g;p++)e[p]>r&&m++;t[u]!==m&&(t[u]=m,l=!0)}return l}window.cache=Wy;let Vde=0;class zB{constructor(t){pe(this,"id",void 0),pe(this,"immediates",[]),pe(this,"lastNonSilence",-1),pe(this,"immediateSpeechActivityScore",_h),pe(this,"lastLevelChangedTime",Date.now()),pe(this,"levels",[]),pe(this,"longs",[]),pe(this,"longSpeechActivityScore",_h),pe(this,"mediums",[]),pe(this,"mediumSpeechActivityScore",_h),pe(this,"minLevel",0),pe(this,"nextMinLevel",0),pe(this,"nextMinLevelWindowLength",0),pe(this,"energyScore",0),this.id=t||"".concat(Vde++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const t=this.immediates,r=this.levels,s=this.minLevel+e1;let a=!1;for(let l=0;l<t.length;++l){let u=r[l];u<s&&(u=0);const p=Math.floor(u/e1);t[l]!==p&&(t[l]=p,a=!0)}return a}computeLongs(){return GB(this.mediums,this.longs,4)}computeMediums(){return GB(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=t1(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(t){this.longSpeechActivityScore=t1(this.longs[0],10,47),this.longSpeechActivityScore>_h&&(this.lastNonSilence=t)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=t1(this.mediums[0],5,24)}evaluateSpeechActivityScores(t){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(t)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var t;return"[".concat(C2(t=[...this.levels]).call(t).join(),"]")}getSpeechActivityScore(t){switch(t){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+t)}}levelChanged(t,r){if(this.lastLevelChangedTime<=r){this.lastLevelChangedTime=r;let s=t;return t<0&&(s=0),t>By&&(s=By),this.levels.unshift(s),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(s),s>=this.minLevel+e1?s:s/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(t){if(t!==0){if(this.minLevel===0||this.minLevel>t)return this.minLevel=t,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=t,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>t&&(this.nextMinLevel=t),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let r=Math.sqrt(this.minLevel*this.nextMinLevel);r<0?r=0:r>By&&(r=By),this.minLevel=r,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class Bde{constructor(t){pe(this,"algorithm",void 0),this.algorithm=t}execute(){let t=!this.algorithm;if(!t)try{const r=this.algorithm.runInDecisionMaker(this);r<=0?t=!0:setTimeout(this.execute.bind(this),r)}catch{t=!0}t&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class n1{constructor(t,r,s){pe(this,"isDominant",void 0),pe(this,"energyRanking",void 0),pe(this,"energyScore",void 0),this.isDominant=t,this.energyRanking=r,this.energyScore=s}}class Wde extends Zn{constructor(t){super(),pe(this,"dominantId",null),pe(this,"lastDecisionTime",0),pe(this,"lastLevelChangedTime",0),pe(this,"lastLevelIdleTime",0),pe(this,"relativeSpeechActivities",[]),pe(this,"speakers",new Map),pe(this,"enableSilence",!1),pe(this,"timeoutToSilenceInterval",0),pe(this,"decisionMaker",null),pe(this,"loudest",[]),pe(this,"numLoudestToTrack",3),pe(this,"energyExpireTimeMs",250),pe(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=t,this.enableSilence=t>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,r=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=t,r!=null&&(this.energyExpireTimeMs=r),s!=null&&(this.energyAlphaPct=s),this.loudest.length>t&&this.loudest.splice(t)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(t){return this.loudest.some(r=>r.id===t)}levelChanged(t,r){const s=Date.now(),a=this.getOrCreateSpeaker(t);this.lastLevelChangedTime<s&&(this.lastLevelChangedTime=s,this.maybeStartDecisionMaker());const l=a.levelChanged(r,s);return this.updateLoudestList(a,l,s)}runInDecisionMaker(t){return this.decisionMaker!==t||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(t){this.decisionMaker===t&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(t){t.forEach(r=>{this.speakers.has(r.id)||this.speakers.set(r.id,r)})}removeSpeakers(t){t.forEach(r=>{this.speakers.delete(r.id)})}getOrCreateSpeaker(t){let r=this.speakers.get(t);return r||(r=new zB(t),this.speakers.set(t,r),this.maybeStartDecisionMaker()),r}updateLoudestList(t,r,s){const a=t.id===this.dominantId;if(r<0){let m=0;for(;m<this.loudest.length&&this.loudest[m]!==t;)++m;return new n1(a,m,t.energyScore)}if(t.energyScore=Math.floor((this.energyAlphaPct*r+(100-this.energyAlphaPct)*t.energyScore+50)/100),this.numLoudestToTrack===0)return new n1(a,0,t.energyScore);const l=s-this.energyExpireTimeMs;let u=0;for(;u<this.loudest.length;){const m=this.loudest[u];if(m.getLastLevelChangedTime()<l&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(u,1);else if(m.id!==t.id)++u;else if(this.loudest.splice(u,1),this.loudest.length<this.numLoudestToTrack)break}let p=0;for(;p<this.loudest.length&&!(this.loudest[p].energyScore<t.energyScore);)++p;return p<this.numLoudestToTrack&&(this.loudest.splice(p,0,t),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new n1(a,p,t.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new Bde(this),this.decisionMaker.execute())}makeDecision(t){let r=null,s=null;const a=this.speakers.size;let l=null;if(a===0)l=null;else if(a===1){var u;const p=$s(u=this.speakers).call(u).next().value;this.enableSilence&&p&&(l=p.id,p.evaluateSpeechActivityScores(t),t-p.lastNonSilence>this.timeoutToSilenceInterval&&(l=null))}else{let p=this.dominantId==null?null:this.speakers.get(this.dominantId);if(p==null){const E=this.speakers.entries().next();E.value&&(l=E.value[0],p=E.value[1])}else l=p.id;p!=null&&p.evaluateSpeechActivityScores(t);const m=this.relativeSpeechActivities;let g=2;for(const E of this.speakers.entries()){const[y,b]=E;if(b===p)continue;b.evaluateSpeechActivityScores(t);for(let F=0;F<m.length;++F){const q=p==null?_h:p.getSpeechActivityScore(F);m[F]=Math.log(b.getSpeechActivityScore(F)/q)}const C=m[0],B=m[1],M=m[2];C>3&&B>2&&M>0&&B>g&&(g=B,l=y)}this.enableSilence&&p!=null&&l===p.id&&t-p.lastNonSilence>this.timeoutToSilenceInterval&&(l=null)}l==null&&!this.enableSilence||l===this.dominantId||(r=this.dominantId,this.dominantId=l,s=this.dominantId),s==null&&!this.enableSilence||s===r||this.emit("ActiveSpeakerChanged",s)}_runInDecisionMaker(){const t=Date.now(),r=300-(t-this.lastLevelIdleTime);let s=0;r<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(t),this.lastLevelIdleTime=t):s=r;let a=300-(t-this.lastDecisionTime);return a<=0&&(this.lastDecisionTime=t,this.makeDecision(t),a=300-(Date.now()-t)),a>0&&s>a&&(s=a),s}timeoutIdleLevels(t){const r=[];for(const a of $s(s=this.speakers).call(s)){var s;const l=t-a.getLastLevelChangedTime();36e5<l&&(this.dominantId==null||a.id!==this.dominantId)?r.push(a.id):300<l&&a.levelTimedOut()}r.forEach(a=>this.speakers.delete(a))}}const Rf=new Map;let cc=null,Hy=null;const KB=3;let Eh=[];const lc=new Map,Gy=new Map;class Hde{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(t,r){pe(this,"id",void 0),pe(this,"track",void 0),pe(this,"score",0),pe(this,"active",!0),pe(this,"muted",!1),pe(this,"timer",0),pe(this,"actives",0),pe(this,"inactives",0),this.id=t,this.track=r,this.setActive(lc.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const t=this.active;this.active=this.activeRate>=.8;const{actives:r,inactives:s}=function(){const a=[],l=[];return Array.from($s(lc).call(lc)).forEach(u=>{u.active?a.push(u):l.push(u)}),{actives:a,inactives:l}}();if(r.length>3){let a;r.forEach(l=>{(!a||a.score>l.score)&&(a=l)}),a&&a.setActive(!1)}if(r.length<3&&s.length>0){let a;s.forEach(l=>{(!a||a.score<l.score)&&l.id!==this.id&&(a=l)}),a&&t&&!this.active&&(a.samples>40&&a.activeRate-this.activeRate>.4?a.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(t){this.active=t,this.resetTimer(),this.setMuted(!t)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const t=function(r){let s;return Array.from($s(lc).call(lc)).forEach(a=>{!a.active||a.id===r||a.samples<40||(!s||a.score<s.score)&&(s=a)}),s}(this.id);t&&this.activeRate-t.activeRate>.4&&(t.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const t=function(r){let s;return Array.from($s(lc).call(lc)).forEach(a=>{a.active||a.id===r||a.samples<40||(!s||a.score>s.score)&&(s=a)}),s}(this.id);t&&t.activeRate-this.activeRate>.4&&(t.setActive(!0),this.setActive(!1))}addSample(t){t?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(t){this.track&&(this.track.enabled=!t,this.muted=t)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let zy;function qB(e){const t=lc.get(e);t&&(lc.delete(e),t.clearTimer())}const Ky=new Map,Gde=new Map;function zde(e,t,r){let s=new Uint8Array(e,t,r),a=[],l=0;for(;a.length<r;)l+3<r&&s[l]===0&&s[l+1]===0&&s[l+2]===3&&(s[l+3]===0||s[l+3]===1||s[l+3]===2||s[l+3]===3)?(a.push(s[l],s[l+1],s[l+3]),l+=4):(a.push(s[l]),l++);return new Uint8Array(a)}const qy=new Map,fg=new Map;(function(){const e=en();ci.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),ci.getStreamFromExtension=e.name===cn.CHROME&&Number(e.version)>34,ci.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const t=new RTCPeerConnection;let r=!1;try{t.addTransceiver("audio"),r=!0}catch{}return t.close(),r}(),ci.supportMinBitrate=e.name===cn.CHROME||e.name===cn.EDGE,ci.supportSetRtpSenderParameters=function(){const t=en();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Pl()||!(!vi()&&!Ty())||t.name===cn.FIREFOX&&Number(t.version)>=64)}(),e.name===cn.SAFARI&&(Number(e.version)>=14?ci.supportDualStream=!0:ci.supportDualStream=!1),ci.webAudioMediaStreamDest=function(){const t=en();return!(t.name===cn.SAFARI&&Number(t.version)<12)}(),ci.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",ci.supportWebGL=typeof WebGLRenderingContext<"u",ci.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Pl()||(ci.webAudioWithAEC=!0),ci.supportShareAudio=function(){const t=en();return(t.os===Ur.WIN_10||t.os===Ur.WIN_81||t.os===Ur.WIN_7||t.os===Ur.LINUX||t.os===Ur.MAC_OS||t.os===Ur.CHROMIUM_OS)&&t.name===cn.CHROME&&Number(t.version)>=74}(),ci.supportDataChannel=!!(ng(76)||function(t){const r=en();return!(r.name!==cn.FIREFOX||!r.osVersion)&&Number(r.version)>=t}(68)||$F(14)),ci.supportPCSetConfiguration=function(){const t=window.RTCPeerConnection;return!rr()&&!!t&&t.prototype.setConfiguration instanceof Function}(),ci.supportWebRTCEncodedTransform=function(){const t=en();return t.name==="Chrome"&&Number(t.version)>=87||t.name==="Safari"&&Number(t.version)>=15}(),ci.supportWebRTCInsertableStream=function(){const t=en();return(t.name===cn.CHROME||t.name===cn.EDGE)&&Number(t.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),ci.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,ci.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,Cy(()=>{ci.supportDualStreamEncoding=function(){const t=en();return!!Z("DISABLE_WEBAUDIO")||t.name==="Safari"&&Number(t.version)>=14||!!(t.name==="Chrome"&&/Windows/i.test(t.os||"")&&Number(t.version)>=100&&Z("CHROME_DUAL_STREAM_USE_ENCODING"))}(),O.debug("browser ua: ",navigator.userAgent),O.info("browser info: ",e),O.info("browser compatibility: ",ci)})})();const Kde=["CHINA","GLOBAL"],YB=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],vh=[],Af=[];function yh(e,t){return!!t&&vh.some(r=>r.uid===e&&r.channelName===t)}function r1(){return Af.length>0}var qde=p4.forEach,$B=JE("forEach")?[].forEach:function(e){return qde(this,e,arguments.length>1?arguments[1]:void 0)};yt({target:"Array",proto:!0,forced:[].forEach!==$B},{forEach:$B});var Yde=ho("Array","forEach"),$de=Qa,Xde=ii,Jde=I,Qde=Yde,i1=Array.prototype,Zde={DOMTokenList:!0,NodeList:!0},eue=function(e){var t=e.forEach;return e===i1||Jde(i1,e)&&t===i1.forEach||Xde(Zde,$de(e))?Qde:t},tue=d(eue),nue=Ns,XB=rv;yt({target:"Object",stat:!0,forced:f(function(){XB(1)})},{keys:function(e){return XB(nue(e))}});var rue=d($r.Object.keys),iue=d(T2),sue=d(w2),oue=yt,JB=C0,aue=_v,cue=Pn,QB=pa,lue=ts,due=gi,uue=zC,hue=Sr,pue=Td,fue=r4("slice"),mue=hue("species"),s1=Array,gue=Math.max;oue({target:"Array",proto:!0,forced:!fue},{slice:function(e,t){var r,s,a,l=due(this),u=lue(l),p=QB(e,u),m=QB(t===void 0?u:t,u);if(JB(l)&&(r=l.constructor,(aue(r)&&(r===s1||JB(r.prototype))||cue(r)&&(r=r[mue])===null)&&(r=void 0),r===s1||r===void 0))return pue(l,p,m);for(s=new(r===void 0?s1:r)(gue(m-p,0)),a=0;p<m;p++,a++)p in l&&uue(s,a,l[p]);return s.length=a,s}});var _ue=ho("Array","slice"),Eue=I,vue=_ue,o1=Array.prototype,yue=function(e){var t=e.slice;return e===o1||Eue(o1,e)&&t===o1.slice?vue:t},Sue=d(yue);function it(e,t,r,s,a){var l,u,p,m={};return tue(l=rue(s)).call(l,function(g){m[g]=s[g]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=iue(u=sue(p=Sue(r).call(r)).call(p)).call(u,function(g,E){return E(e,t,g)||g},m),a&&m.initializer!==void 0&&(m.value=m.initializer?m.initializer.call(a):void 0,m.initializer=void 0),m.initializer===void 0?(ZU(e,t,m),null):m}let Yy=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),a1=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),Ca=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),as=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),ft=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),Mn=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),bt=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e.RECOVER_NOTIFICATION="recover_notification",e}({}),xt=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),mg=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),zt=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),cs=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),Pt=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({});function $y(e){if(typeof e!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw O.error("Invalid Channel Name ".concat(e)),new me($.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function Xy(e){if(t=e,!(typeof t=="number"&&Math.floor(t)===t&&0<=t&&t<=4294967295||rV(e,1,255)))throw new me($.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;typeof e=="string"&&O.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let Jc=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const xue={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},c1={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function l1(e,t){oi(e.url,"".concat(t,".url"),1,1e3,!1),ir(e.x)||xn(e.x,"".concat(t,".x"),0,1e4),ir(e.y)||xn(e.y,"".concat(t,".y"),0,1e4),ir(e.width)||xn(e.width,"".concat(t,".width"),0,1e4),ir(e.height)||xn(e.height,"".concat(t,".height"),0,1e4),ir(e.zOrder)||xn(e.zOrder,"".concat(t,".zOrder"),0,255),ir(e.alpha)||xn(e.alpha,"".concat(t,".alpha"),0,1,!1)}const Tue={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let kd=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),d1=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),Dr=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function ZB(e){if(!e.channelName)throw new me($.INVALID_PARAMS,"invalid channelName in info");if(typeof e.uid!="number")throw new me($.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&oi(e.token,"info.token",1,2047),Xy(e.uid),$y(e.channelName),!0}let ls=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),jl=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),ks=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),Nf=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),gn=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),Qr=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e.UPDATE_GATEWAY_CONFIG="update-gateway-config",e}({}),Jy=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),Vr=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),ln=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const e5=[ln.AFRICA,ln.ASIA,ln.CHINA,ln.EUROPE,ln.GLOBAL,ln.INDIA,ln.JAPAN,ln.NORTH_AMERICA,ln.OCEANIA,ln.OVERSEA,ln.SOUTH_AMERICA];let Ni=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const Qy={CHINA:{},ASIA:{CODE:Ni.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Ni.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Ni.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Ni.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Ni.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Ni.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Ni.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Ni.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Ni.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Ni.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Ni.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Ni.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Ni.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};OA&&(Qy.CHINA={CODE:Ni.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let gg=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",e}({});function t5(e){return!!e&&!(!e.uplink||!e.id)&&e.uplink.max_bitrate!==void 0&&e.uplink.min_bitrate!==void 0}class n5 extends Zn{constructor(t,r){super(),z(this,"onICEConnectionStateChange",void 0),z(this,"onConnectionStateChange",void 0),z(this,"onDTLSTransportStateChange",void 0),z(this,"onDTLSTransportError",void 0),z(this,"onICETransportStateChange",void 0),z(this,"onFirstAudioReceived",void 0),z(this,"onFirstVideoReceived",void 0),z(this,"onFirstAudioDecoded",void 0),z(this,"onFirstVideoDecoded",void 0),z(this,"onFirstVideoDecodedTimeout",void 0),z(this,"onSelectedLocalCandidateChanged",void 0),z(this,"onSelectedRemoteCandidateChanged",void 0),z(this,"onICECandidateError",void 0),z(this,"getLocalVideoStats",void 0)}}class r5 extends n5{constructor(t,r){super(t,r),z(this,"establishPromise",void 0)}}let Ze=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),Ii=function(e){return e.UDP_RELAY="udp_relay",e.UDP_TCP_RELAY="udp_tcp_relay",e.TCP_RELAY="tcp_relay",e.RELAY="relay",e}({}),Ul=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.TCP_RESTART=3]="TCP_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({});const i5=["disconnected","failed"];let Ie=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),pn=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),ht=function(e){return e.AudioMetadata="audioMetadata",e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),Ra=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),Aa=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),Zr=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),s5=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),Qc=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),Yo=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),dc=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),If=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),gr=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),Of=function(e){return e.ABORT="abort",e}({}),Ld=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),bue=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const wue={[Yy.ACCESS_POINT]:{[as.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[as.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[as.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[as.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[as.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[as.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[as.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[as.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[as.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[as.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[as.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[as.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[as.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[as.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[as.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[as.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[as.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[as.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[Yy.UNILBS]:{[Ca.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Ca.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Ca.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Ca.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Ca.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Ca.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Ca.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Ca.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Ca.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Ca.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Ca.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Ca.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[Yy.STRING_UID_ALLOCATOR]:{[a1.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[a1.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[a1.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Df(e){const t=wue[Math.floor(e/1e4)];if(!t)return{desc:"unknown error",retry:!1};const r=t[e%1e4];if(!r){if(Math.floor(e/1e4)===Yy.ACCESS_POINT){const s=e%1e4;if(s.toString()[0]==="1")return{desc:e.toString(),retry:!1};if(s.toString()[0]==="2")return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return r}const Cue={[ft.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[ft.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[ft.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[ft.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[ft.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[ft.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[ft.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[ft.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[ft.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[ft.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[ft.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[ft.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[ft.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[ft.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[ft.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[ft.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[ft.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[ft.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[ft.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[ft.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[ft.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[ft.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[ft.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[ft.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[ft.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[ft.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[ft.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[ft.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[ft.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[ft.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[ft.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[ft.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[ft.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[ft.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[ft.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[ft.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[ft.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[ft.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[ft.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[ft.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[ft.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[ft.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[ft.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[ft.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[ft.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[ft.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[ft.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[ft.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[ft.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[ft.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[ft.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[ft.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[ft.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[ft.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[ft.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[ft.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[ft.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[ft.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[ft.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[ft.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[ft.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[ft.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[ft.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[ft.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function _g(e){return Cue[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function o5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function u1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function h1(e,t){if(typeof e=="string")return e;const{proxy:r,host:s,port:a}=e;if(t){const l=Z("JOIN_GATEWAY_FALLBACK_PORT")||443;return l===443?"wss://".concat(s,"/ws/?p=").concat(Number(a)+150):"wss://".concat(s,":").concat(l,"/ws/?p=").concat(Number(a)+150)}return r?"wss://".concat(r,"/ws/?h=").concat(s,"&p=").concat(a):"wss://".concat(s,":").concat(a)}const Rue=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,Aue=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,Nue=/wss:\/\/(.+):([0-9]+)\/?/,Iue=/wss:\/\/(.[^\/]+)\/?/;let Oue=0;class Due{constructor(t,r){z(this,"id",0),z(this,"store",void 0),z(this,"recordIndex",void 0),z(this,"websockets",[]),z(this,"try443PortDuration",2e3),z(this,"forceCloseWSDuration",5e3),z(this,"try443PortTimeout",null),z(this,"forceCloseTimeout",null),z(this,"isTry443PortFailed",!1),z(this,"isNormalPortFailed",!1),z(this,"useDoubleDomain",!1),z(this,"useProxy",!1),z(this,"startTime",Date.now()),this.id=++Oue,this.try443PortDuration=Z("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=t||5e3,this.store=r}closeAllWebsockets(){this.websockets.forEach(t=>{t.onopen=null,t.onclose=null,t.onmessage=null,t.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var t;const r=Date.now()-this.startTime;for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];O.debug("[choose-best-ws ".concat((t=this.store)===null||t===void 0?void 0:t.clientId," ").concat(this.id,"] ").concat(r,"ms:"),...a)}createWebSocket(t,r,s){this.logger("createWebSocket:",t,{isTry443Port:r,hasTimeoutDetection:s});const a=Z("GATEWAY_DOMAINS"),l=Date.now(),u=[],p=a.find(b=>{var C;return je(C=t.host).call(C,b)});p||(this.useDoubleDomain=!1);const m=[];if(this.useDoubleDomain)a.forEach(b=>{m.push(h1(u1(u1({},t),{},{host:t.host.replace(p,b)}),r))});else{const b=u1({},t);if(r&&p){const C=a.find(B=>B!==p);C&&(b.host=b.host.replace(p,C))}m.push(h1(b,r))}try{m.forEach(b=>{const C=new WebSocket(b);C.binaryType="arraybuffer",u.push(C),this.logger("ws is connecting:",C.url)})}catch(b){if(this.logger("ws create failed"),u.forEach(C=>C.close()),u.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(t,r,s);if(!r&&Number(t.port)!==443)return this.createWebSocket(t,!0,s);throw new me($.WS_ERR,"init websocket failed! Error: ".concat(b.toString()))}const g=tg();this.store&&this.store.recordJoinChannelService({urls:u.map(b=>b.url),service:"gateway"},this.recordIndex),u.forEach(b=>{b.onopen=()=>{this.logger("onopen: ws ".concat(b.url," open cost ").concat(Date.now()-l,"ms")),this.websockets.forEach(C=>{C!==b&&(C.onopen=null,C.onclose=null,C.onmessage=null,C.close(),this.logger("close backup websocket: ".concat(C.url)))}),this.websockets.length=0,g.resolve(b)},b.onclose=C=>{this.logger("onclose: ws ".concat(b.url," closed cost ").concat(Date.now()-l,"ms state: ").concat(b.readyState));const B=u.every(M=>M.readyState===WebSocket.CLOSED||M.readyState===WebSocket.CLOSING);this.logger("".concat(r?"443":"47xx"," websocket closed, all failed: ").concat(B)),B&&(r||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(C.reason)),g.reject({code:C.code,reason:Jy.A_ROUND_WS_FAILED})):!r&&B&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),y()),r?this.isTry443PortFailed=B:this.isNormalPortFailed=B},b.onmessage=C=>this.logger("".concat(b.url," onmessage: ").concat(C.data))}),this.websockets.push(...u);const E=()=>{this.websockets.forEach(b=>b.readyState!==WebSocket.OPEN&&b.close())},y=()=>{if(g.isResolved)return E();en().os===Ur.MAC_OS&&rr()&&E(),this.createWebSocket(t,!0,!0).then(b=>{g.resolve(b)}).catch(b=>{this.isNormalPortFailed&&g.reject(b),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",g.isResolved),this.forceCloseTimeout=null,E()},this.forceCloseWSDuration)};return s||(()=>{if(r||this.useProxy)return this.logger("add 5s timeout at ".concat(r?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,E()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",g.isResolved),this.try443PortTimeout=null,y()},this.try443PortDuration)})(),g.promise}chooseBestWebsocket(t,r,s,a){return this.useDoubleDomain=!!r,typeof t=="string"&&(t=function(l){let u,p,m;return[,u,p,m]=l.match(Rue)||[],u||([,p,m]=l.match(Aue)||[]),p&&m||([,p,m]=l.match(Nue)||[]),p&&m||([,p]=l.match(Iue)||[]),p||O.warning("un-destructible url: ",l),{proxy:u,host:p,port:m||"443"}}(t)),this.recordIndex=a,this.useProxy=!!t.proxy,s&&this.useProxy&&(O.warn("cannot use 443 only when use proxy"),s=!1),this.createWebSocket(t,!!s,!1).finally(()=>this.clearTimeout())}}function a5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}class c5 extends Zn{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(t){var r;je(r=["tryNext","recover"]).call(r,t)&&this.resetReconnectCount(t),this._reconnectMode=t}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._state==="reconnecting"?this.emit(Pt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(Pt.CONNECTED):this._state==="closed"?this.emit(Pt.CLOSED):this._state==="failed"&&this.emit(Pt.FAILED))}resetReconnectCount(t){O.debug("websocket reset reconnect count, reason: "+t),this.reconnectCount=0}constructor(t,r){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=arguments.length>3&&arguments[3]!==void 0&&arguments[3],l=arguments.length>4&&arguments[4]!==void 0&&arguments[4],u=arguments.length>5?arguments[5]:void 0;super(),z(this,"_websocketUrl",null),z(this,"connectionID",0),z(this,"currentURLIndex",0),z(this,"urls",[]),z(this,"_reconnectMode","tryNext"),z(this,"reconnectReason",void 0),z(this,"_initMutex",void 0),z(this,"name",void 0),z(this,"_state","closed"),z(this,"reconnectInterrupter",void 0),z(this,"websocket",void 0),z(this,"retryConfig",void 0),z(this,"reconnectCount",0),z(this,"forceCloseTimeout",5e3),z(this,"onlineReconnectListener",void 0),z(this,"useCompress",void 0),z(this,"tryDoubleDomain",!1),z(this,"use443PortOnly",!1),z(this,"wsInflateLength",0),z(this,"wsDeflateLength",0),z(this,"closeEstablishingWs",()=>{}),z(this,"store",void 0),z(this,"joinGatewayRecordIndex",void 0),this.store=u,this.name=t,this.retryConfig=function(y){for(var b=1;b<arguments.length;b++){var C=arguments[b]!=null?arguments[b]:{};b%2?a5(Object(C),!0).forEach(function(B){z(y,B,C[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(C)):a5(Object(C)).forEach(function(B){Object.defineProperty(y,B,Object.getOwnPropertyDescriptor(C,B))})}return y}({},r),this.useCompress=s,this.tryDoubleDomain=a,this.use443PortOnly=l,this._initMutex=new Ai("websocket",u?u.clientId:void 0);const{timeout:p,timeoutFactor:m}=r,g=Math.max(300,Math.floor(3*p/5)),E=Math.max(1.2,Math.floor(8*m)/10);Qs.ONLINE&&(this.retryConfig.timeout=g,this.retryConfig.timeoutFactor=E),Tr.on(uf.NETWORK_STATE_CHANGE,(y,b)=>{y!==b&&(this.resetReconnectCount("network state change: ".concat(b," -> ").concat(y)),y===Qs.ONLINE?(this.retryConfig.timeout=g,this.retryConfig.timeoutFactor=E):(this.retryConfig.timeout=p,this.retryConfig.timeoutFactor=m))})}getConnection(){return this.websocket||void 0}async init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=r,this.urls=t,this.state="connecting";try{const a=tg(),l=this.urls[this.currentURLIndex];Z("ENABLE_PREALLOC_PC")&&this.emit(s5.PRE_CONNECT_PC),this.createWebSocketConnection(l).then(a.resolve).catch(a.reject),this.once(Pt.CLOSED,()=>{a.reject(new Se($.WS_DISCONNECT))}),this.once(Pt.CONNECTED,a.resolve),await a.promise}catch{}finally{s()}}close(t,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const s=this.websocket;r?setTimeout(()=>s.close(),500):s.close(),this.websocket=void 0,this._websocketUrl=null}this.state=t?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(t,r){if(!this.websocket)return void O.warning("[".concat(this.name,"] can not reconnect, no websocket"));t!==void 0&&(this.reconnectMode=t),O.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(r)]},this.joinGatewayRecordIndex);const s=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),s&&s.bind(this.websocket)({code:9999,reason:r})}sendMessage(t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Se($.WS_ABORT,"websocket is not ready");try{r||(t=JSON.stringify(t)),this.websocket.send(t)}catch(s){throw new Se($.WS_ERR,"send websocket message error"+s.toString())}}setWsInflateData(t){this.wsDeflateLength=this.wsDeflateLength+t.originLength,this.wsInflateLength=this.wsInflateLength+t.compressedLength}getWsInflateData(){const t=this.wsInflateLength,r=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:t,wsDeflateLength:r}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(t){var r;const s=tg();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const a=E=>{var y;(y=this.store)===null||y===void 0||y.signalChannelOpen(),O.debug("[".concat(this.name,"] websocket opened:"),E),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),s.resolve()},l=async E=>{var y;if(O.debug("[".concat(this.name,"] websocket close ").concat((y=this.websocket)===null||y===void 0?void 0:y.url,", code: ").concat(E.code,", reason: ").concat(E.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)s.reject(new Se($.WS_DISCONNECT,"websocket close: ".concat(E.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=E.reason,this.state="reconnecting");const b=mo(this,Pt.WILL_RECONNECT,this.reconnectMode,E.reason)||this.reconnectMode,C=await this.reconnectWithAction(b);if(this.state==="closed")return void O.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!C)return s.reject(new Se($.WS_DISCONNECT,"websocket reconnect failed: ".concat(E.code))),this.close(!0);s.resolve()}},u=E=>{this.emit(Pt.ON_MESSAGE,E)},p=E=>{O.warn("[".concat(this.connectionID,"] ws open error ").concat(E))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),Z("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(t=Z("GATEWAY_WSS_ADDRESS")),O.debug("[".concat(this.name,"] start connect, url:"),t);const m=(r=this.store)===null||r===void 0?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var g;this._websocketUrl=h1(t);const E=await this.chooseBestWebsocketConnection(t);this.websocket=E,a&&a(this.websocket.url),this.websocket.onclose=l,this.websocket.onmessage=u,this.websocket.onerror=p,(g=this.store)===null||g===void 0||g.recordJoinChannelService({endTs:Date.now(),status:"success"},m),this.joinGatewayRecordIndex=m}catch(E){const y=this.state==="closed",b=E instanceof Se,C=b&&E.code===$.WS_ABORT,B=b&&E.code===$.WS_ERR,M=b?E.message:E&&(E.reason||E.toString());O.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(M)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:C?"aborted":"error",errors:[E]},m),y||B?(s.reject(y?new Se($.WS_DISCONNECT,"websocket is closed: ".concat(M)):new Se($.WS_ERR,"init websocket failed: ".concat(M))),B&&O.error("[".concat(this.name,"] init websocket failed: ").concat(M))):l&&l(E)}return s.promise}async reconnectWithAction(t){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;O.warning("[choose-best-ws] action: =>",t),this.onlineReconnectListener||Tr.isOnline||!Tr.onlineWaiter||(this.onlineReconnectListener=Tr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let s=!0;if(this.reconnectInterrupter=()=>s=!1,r){const u=TA(this.reconnectCount,this.retryConfig);O.debug("[".concat(this.name,"] wait ").concat(u,"ms to reconnect websocket, mode: ").concat(t)),await Ye.race([ai(u),this.onlineReconnectListener||new Ye(()=>{})])}if(this._state==="closed"||!s)return!1;this.reconnectCount+=1;const a=async(u,p)=>{this.emit(Pt.RECONNECT_CREATE_CONNECTION,p),await this.createWebSocketConnection(u)};try{if(t==="retry")await a(this.urls[this.currentURLIndex],t);else if(t==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);O.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await a(this.urls[this.currentURLIndex],t)}else t==="recover"&&(O.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await Si(this,Pt.REQUEST_NEW_URLS),this.currentURLIndex=0,await a(this.urls[this.currentURLIndex],t))}catch(u){var l;O.error("[".concat(this.name,"] reconnect failed ").concat(u&&u.toString()));const p=u==null||(l=u.data)===null||l===void 0?void 0:l.desc;return Array.isArray(p)&&je(p).call(p,"dynamic key expired")?(this.emit(Pt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(t,r)}return!0}}class p1 extends c5{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,r){const s=tg(),a=function(u,p){return new Due(u,p)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{O.debug("[choose-best-ws] close establishing websockets"),a.closeAllWebsockets(),s.reject(new Se($.WS_ABORT,"choose best websocket aborted"))};const l=Z("GATEWAY_DOMAINS");return O.debug("[choose-best-ws] currentDomain: ",t,", domains: ",l,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),a.chooseBestWebsocket(t,this.tryDoubleDomain,this.use443PortOnly,r).then(s.resolve).catch(s.reject),s.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class Eg extends c5{constructor(t,r){super(t,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(t,r){return new Ye((s,a)=>{let l=!1;const u=[];this.closeEstablishingWs=()=>{O.debug("[choose-best-ws] close establishing websockets"),u.forEach(B=>{B.onclose=null,B.onopen=null,B.onmessage=null,B.close()}),a(new Se($.WS_ABORT,"choose best websocket aborted"))};const p=Z("GATEWAY_DOMAINS");let m;const g=t.indexOf("?h="),E=p.find(B=>g!==-1?je(t).call(t,B,g):je(t).call(t,B));O.debug("[choose-best-ws] currentDomain: ",E,", domains: ",p);let y=!this.tryDoubleDomain||!E;if(!y&&E){var b;const B=Date.now();try{p.forEach(M=>{const F=g===-1?t.replace(E,M):t.substr(0,g)+t.substr(g).replace(E,M),q=new WebSocket(F);q.binaryType="arraybuffer",u.push(q),O.debug("[choose-best-ws] ws is connecting:",q.url)})}catch{for(O.debug("[choose-best-ws] ws create failed, fallback to single url"),u.forEach(F=>F.close());u.length;)u.pop();y=!0}(b=this.store)===null||b===void 0||b.recordJoinChannelService({urls:u.map(M=>M.url),service:"gateway"},r),u.forEach(M=>{M.onopen=()=>{if(l)return;const F=Date.now()-B;O.debug("[choose-best-ws] ws open cost ".concat(F,"ms")),u.filter(q=>q!==M).forEach(q=>{O.debug("[choose-best-ws]close backup websocket: ".concat(q.url)),q.close()}),l=!0,s(M)},M.onclose=F=>{m=F,!l&&(u.find(q=>!(q.readyState===WebSocket.CLOSED||q.readyState===WebSocket.CLOSING))||(O.debug("[choose-best-ws] all websocket is closed"),l=!0,a(m)))},M.onmessage=F=>{O.debug("[choose-best-ws]".concat(M.url," onmessage: ").concat(F.data))}}),ai(this.forceCloseTimeout).then(()=>{u.forEach(M=>{M.readyState!==WebSocket.OPEN&&M.close()})})}if(y){var C;let B;O.debug("[choose-best-ws] use single url: ",t),(C=this.store)===null||C===void 0||C.recordJoinChannelService({urls:[t],service:"gateway"},r);try{B=new WebSocket(t),u.push(B),B.binaryType="arraybuffer"}catch(M){const F=new Se($.WS_ERR,"init websocket failed! Error: ".concat(M.toString()));return O.error("[".concat(this.name,"]").concat(F)),void a(F)}B.onopen=()=>{s(B)},B.onclose=M=>{a(M)},B.onmessage=M=>{O.debug("[choose-best-ws]".concat(B.url," onmessage: ").concat(M.data))},ai(this.forceCloseTimeout).then(()=>{B&&B.readyState!==WebSocket.OPEN&&B.close()})}}).then(s=>(this.closeEstablishingWs=void 0,s)).catch(s=>{throw this.closeEstablishingWs=void 0,s})}}class Pue extends Zn{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===Mn.CONNECTED?this.emit(bt.WS_CONNECTED):t===Mn.RECONNECTING?this.emit(bt.WS_RECONNECTING,this._websocketReconnectReason):t===Mn.CLOSED&&this.emit(bt.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),z(this,"_disconnectedReason",void 0),z(this,"_websocketReconnectReason",void 0),z(this,"_connectionState",Mn.CLOSED),z(this,"reconnectToken",void 0),z(this,"websocket",void 0),z(this,"openConnectionTime",void 0),z(this,"clientId",void 0),z(this,"lastMsgTime",Date.now()),z(this,"uploadCache",[]),z(this,"uploadCacheInterval",void 0),z(this,"rttRolling",new vV(5)),z(this,"pingpongTimer",void 0),z(this,"wsInflateDataTimer",void 0),z(this,"pingpongTimeoutCount",0),z(this,"joinResponse",void 0),z(this,"multiIpOption",void 0),z(this,"initError",void 0),z(this,"spec",void 0),z(this,"store",void 0),z(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(bt.ON_BINARY_DATA,s.data);const a=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(a,"_id")){const l="res-@".concat(a._id);this.emit(l,a._result,a._message)}else if(Object.prototype.hasOwnProperty.call(a,"_type")){if(this.emit(a._type,a._message),a._type===zt.ON_NOTIFICATION&&this.handleNotification(a._message),a._type===zt.ON_USER_BANNED)switch(a._message.error_code){case 14:this.close(hn.UID_BANNED);break;case 15:this.close(hn.IP_BANNED);break;case 16:this.close(hn.CHANNEL_BANNED)}if(a._type===zt.ON_USER_LICENSE_BANNED)switch(a._message.error_code){case ft.ERR_LICENSE_MISSING:this.close(hn.LICENSE_MISSING);break;case ft.ERR_LICENSE_EXPIRED:this.close(hn.LICENSE_EXPIRED);break;case ft.ERR_LICENSE_MINUTES_EXCEEDED:this.close(hn.LICENSE_MINUTES_EXCEEDED);break;case ft.ERR_LICENSE_PERIOD_INVALID:this.close(hn.LICENSE_PERIOD_INVALID);break;case ft.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(hn.LICENSE_MULTIPLE_SDK_SERVICE);break;case ft.ERR_LICENSE_ILLEGAL:this.close(hn.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new p1("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Mn.CONNECTED&&this.reconnect("retry",yi.OFFLINE)})}async request(t,r,s,a){const l=An(6,""),u={_id:l,_type:t,_message:r},p=this.websocket.connectionID,m=()=>new Ye((B,M)=>{if(this.connectionState===Mn.CONNECTED)return B();const F=()=>{this.off(bt.WS_CLOSED,q),B()},q=()=>{this.off(bt.WS_CONNECTED,F),M(new me($.WS_ABORT))};this.once(bt.WS_CONNECTED,F),this.once(bt.WS_CLOSED,q),t!==xt.PUBLISH&&t!==xt.PUBLISH_DATASTREAM&&t!==xt.SUBSCRIBE&&t!==xt.SUBSCRIBE_DATASTREAM&&t!==xt.UNSUBSCRIBE&&t!==xt.UNSUBSCRIBE_DATASTREAM&&t!==xt.UNPUBLISH&&t!==xt.UNPUBLISH_DATASTREAM&&t!==xt.CONTROL&&t!==xt.RESTART_ICE||this.once(bt.DISCONNECT_P2P,()=>{M(new me($.DISCONNECT_P2P))}),t!==xt.PUBLISH&&t!==xt.RESTART_ICE||this.once(bt.ABORT_P2P_EXECUTION,()=>{M(new me($.DISCONNECT_P2P))})});if(this.connectionState!==Mn.CONNECTING&&this.connectionState!==Mn.RECONNECTING||t===xt.JOIN||t===xt.REJOIN||await m(),this.websocket.sendMessage(u,!0),a)return;const g=new Ye((B,M)=>{let F=!1;const q=(re,ce)=>{F=!0,B({isSuccess:re==="success",message:ce||{}}),this.off(bt.WS_CLOSED,Y),this.off(bt.WS_RECONNECTING,Y),this.emit(bt.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(l),q);const Y=()=>{M(new me($.WS_ABORT,"type: ".concat(t))),this.off(bt.WS_CLOSED,Y),this.off(bt.WS_RECONNECTING,Y),this.off("res-@".concat(l),q)};this.once(bt.WS_CLOSED,Y),this.once(bt.WS_RECONNECTING,Y),ai(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||F||(O.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(bt.REQUEST_TIMEOUT,t,r))})});let E=null;try{E=await g}catch(B){if(this.connectionState===Mn.CLOSED||t===xt.LEAVE)throw new me($.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?B.throw():t===xt.JOIN||t===xt.REJOIN?null:(await m(),await this.request(t,r))}if(E.isSuccess)return E.message;const y=Number(E.message.error_code||E.message.code),b=_g(y),C=new me($.UNEXPECTED_RESPONSE,"".concat(b.desc,": ").concat(E.message.error_str),{code:y,data:E.message,desc:b.desc});return b.action==="success"?E.message:(O.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(y,", message: ").concat(b.desc,", action: ").concat(b.action)),y===ft.ERR_TOO_MANY_BROADCASTERS?((t===xt.JOIN||t===xt.REJOIN)&&(this.initError=C,this.close()),C.throw()):b.action==="failed"?C.throw():b.action==="quit"?(this.initError=C,this.close(),C.throw()):(y===ft.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,O.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",yi.MULTI_IP)):this.reconnect(b.action,yi.SERVER_ERROR),t===xt.JOIN||t===xt.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new Ye(s=>{const a=l=>{(!r||r(l))&&(this.off(t,a),s(l))};this.on(t,a)})}uploadWRTCStats(t){if(!this.store.sessionId)return void O.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(mg.WRTC_STATS,r)}upload(t,r){const s={_type:t,_message:r};try{this.websocket.sendMessage(s)}catch{const l=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>l&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Mn.CONNECTED)return;const u=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(u._type,u._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const s={_type:t,_message:r};this.websocket.sendMessage(s)}init(t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ye((r,s)=>{this.once(bt.WS_CONNECTED,()=>r(this.joinResponse)),this.once(bt.WS_CLOSED,a=>s(this.initError||new me($.WS_ABORT,a))),this.connectionState=Mn.CONNECTING,this.websocket.init(t).catch(s),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=t||hn.LEAVE,this.connectionState=Mn.CLOSED,O.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(bt.ABORT_P2P_EXECUTION);const t=await Si(this,bt.REQUEST_JOIN_INFO),r=await this.request(xt.JOIN,t);if(!r)return this.emit(bt.REPORT_JOIN_GATEWAY,Jy.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(bt.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Mn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new me($.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const t=ag(this,bt.REQUEST_REJOIN_INFO);t.token=this.reconnectToken;const r=await this.request(xt.REJOIN,t);return!!r&&(this.connectionState=Mn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(s=>{this.emit(zt.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(zt.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(zt.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(zt.MUTE_AUDIO,{uid:s.uid}):this.emit(zt.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(zt.MUTE_VIDEO,{uid:s.uid}):this.emit(zt.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(zt.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(zt.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(zt.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(zt.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(zt.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleNotification(t){O.debug("[".concat(this.clientId,"] receive notification: "),t);const r=_g(t.code);if(t.code===28&&"detail"in t&&(O.info("[".concat(this.clientId,"] receive recover notification: "),t.detail),this.emit(bt.RECOVER_NOTIFICATION,t.detail)),r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(hn.UID_BANNED),void this.close()):void this.reconnect(r.action,yi.SERVER_ERROR);O.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=Z("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(O.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",yi.TIMEOUT):this.request(xt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),Z("REPORT_STATS")&&this.send(xt.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWsInflateData(){const{wsInflateLength:t,wsDeflateLength:r}=this.websocket.getWsInflateData();t!==0&&r!==0&&this.upload(mg.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:t})}handleWebsocketEvents(){this.websocket.on(Pt.RECONNECT_CREATE_CONNECTION,t=>{this.emit(bt.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(Pt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Pt.CLOSED,()=>{this.connectionState=Mn.CLOSED}),this.websocket.on(Pt.FAILED,()=>{this._disconnectedReason=hn.NETWORK_ERROR,this.connectionState=Mn.CLOSED}),this.websocket.on(Pt.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===Mn.CONNECTED?this.connectionState=Mn.RECONNECTING:this.connectionState=Mn.CONNECTING}),this.websocket.on(Pt.WILL_RECONNECT,(t,r,s)=>{const a=ag(this,bt.IS_P2P_DISCONNECTED),l=a||t!=="retry";a&&t==="retry"&&(O.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),t="tryNext",r=Jy.P2P_DISCONNECTED),l&&(O.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(t)),this.emit(bt.REPORT_JOIN_GATEWAY,r||Jy.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(bt.DISCONNECT_P2P)),s(t)}),this.websocket.on(Pt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(t=>{O.warning("[".concat(this.clientId,"] rejoin failed ").concat(t)),this.reconnect("tryNext",yi.SERVER_ERROR)}):this.join().catch(t=>{if(this.emit(bt.REPORT_JOIN_GATEWAY,t,this.url||""),t instanceof me){if(t.code===$.UNEXPECTED_RESPONSE&&t.data.code===ft.ERR_NO_AUTHORIZED)return this.initError=new me($.TOKEN_EXPIRE,"dynamic key expired"),void this.close(hn.TOKEN_EXPIRE);O.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",yi.SERVER_ERROR):(this.initError=t,this.close())}})}),this.websocket.on(Pt.REQUEST_NEW_URLS,(t,r)=>{Si(this,bt.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(Pt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(zt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(s5.PRE_CONNECT_PC,()=>{this.emit(bt.PRE_CONNECT_PC)})}}let kue=function(e){return e.NATIVE_RTC="native_rtc",e.NATIVE_RTM="native_rtm",e.WEB_RTC="web_rtc",e.WEB_RTM="web_rtm",e}({}),br=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function l5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Zy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Md(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(Z("TURN_DOMAIN")):(O.debug("Cannot recognized as ip address: ".concat(e,", use as host")),e)}function f1(e,t){e.addresses||(e.addresses=[]);const r=function(p,m){if(Z("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return p.map(y=>{let{ip:b,port:C}=y;return{address:"".concat(b,":").concat(C)}});const g=Z("GATEWAY_DOMAINS");let E=g[1]&&je(m).call(m,g[1])?1:0;return p.map(y=>{let{domain_prefix:b,port:C,ip:B}=y;if(b)return{address:"".concat(b,".").concat(g[E++%g.length],":").concat(C)};const M=/^[\.\:\d]+$/.test(B),F=M?"".concat(B.replace(/[^\d]/g,"-"),".").concat(g[E++%g.length],":").concat(C):"".concat(B,":").concat(C);return M||O.debug("Cannot recognized as ip address: ".concat(B,", use as host")),{ip:B,port:C,address:F}})}(e.addresses,t),s=Array.isArray(e.detail)&&e.detail[18];if(s&&typeof s=="string"){const p=s.split(";");for(let m=0;m<p.length;m++){var a;const g=zi(a=p[m]).call(a);r[m]&&g&&(r[m].ip6=g)}}const l=e.detail&&e.detail.candidate;let u;if(l){const[p,m]=l.split(":");p&&m&&(u={port:Number(m),ip:p,address:"".concat(p,":").concat(m)})}return{gatewayAddrs:r,apGatewayAddress:u,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function Zs(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function d5(e){const t=e._encoderConfig;if(!t)return{};const r={resolution:t.width&&t.height?"".concat(Zs(t.width),"x").concat(Zs(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return typeof t.frameRate=="number"?(r.maxFrameRate=t.frameRate,r.minFrameRate=t.frameRate):t.frameRate&&(r.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,r.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),r}function u5(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function vg(e,t){let r,s,a;switch(t){case br.CHOOSE_SERVER:s=4096,a="choose server";break;case br.CLOUD_PROXY:s=1048576,a="proxy";break;case br.CLOUD_PROXY_5:s=4194304,a="proxy5";break;case br.CLOUD_PROXY_FALLBACK:s=4194310,a="proxy fallback";break;default:throw new me($.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(l=>{l.buffer&&l.buffer.flag===s&&(r={code:l.buffer.code,addresses:(l.buffer.edges_services||[]).map(u=>Zy(Zy({},u),{},{ticket:l.buffer.cert})),server_ts:e.enter_ts,uid:l.buffer.uid,cid:l.buffer.cid,cname:l.buffer.cname,detail:Zy(Zy({},l.buffer.detail),e.detail),flag:l.buffer.flag,opid:e.opid,cert:l.buffer.cert})}),!r)throw new me($.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(a," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return r}async function h5(e,t){return await Ye.all(e.addresses.map(async r=>({address:Z("USE_TURN_IP")?r.ip:Md(r.ip),tcpport:r.port,udpport:r.port,username:t&&Z("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():xi.username,password:t&&Z("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await EA(t.toString()):xi.password})))}function m1(e,t){const r=t.getMediaStreamTrack(!0).getSettings(),s=t.videoHeight||r.height,a=t.videoWidth||r.width;return s&&a?Math.max(Math.min(s,a)/Math.min(Zs(e.height),Zs(e.width)),1):(O.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function jd(e){let{candidateType:t,relayProtocol:r,type:s,address:a,port:l,protocol:u}=e;const p={candidateType:t,relayProtocol:r,protocol:u};if(s!=="local-candidate"){const m=a.split(".");m.length>=4&&(m[1]="*",m[2]="*"),p.address=m.join("."),p.port=l}return p}function eS(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Z("SVC_MODE");if(Z("ENABLE_SVC"))return function(t){return t in Iy}(e)?e:Iy.L1T3}const p5={[Ze.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[Ze.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function tS(e,t,r){t.forEach(s=>{var a;const l=p5[e].find(p=>{var m;let{key:g}=p;return je(m=s.extensionName).call(m,g)});if(!l)return;const u=r.find(p=>{let{extensionName:m}=p;return je(m).call(m,l.key)});u&&je(a=u.extensionName).call(a,"gdpr_forbidden")&&(s.extensionName=u.extensionName)})}function Pf(e,t){t.forEach(r=>{var s;const a=p5[e].find(l=>{var u;let{key:p}=l;return je(u=r.extensionName).call(u,p)});je(s=r.extensionName).call(s,"gdpr_forbidden")&&a&&(r.extensionName=a.extensionName)})}function f5(e){return e==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||je(e).call(e,"abs-send-time")}function nS(e){return e==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||je(e).call(e,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function m5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function g5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function yg(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;const{filterRTX:a,filterVideoFec:l,filterAudioFec:u,filterAudioCodec:p,filterVideoCodec:m}=t,{useXR:g}=r;let E=[],y=[],b=[],C=[],B=!1,M=!1;if(Ps(e).mediaDescriptions.forEach(q=>{s&&s!==q.attributes.direction||(q.media.mediaType!=="video"||B||(y=q.attributes.payloads,C=q.attributes.extmaps,B=!0),q.media.mediaType!=="audio"||M||(E=q.attributes.payloads,b=q.attributes.extmaps,M=!0))}),!C||y.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!b||E.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(y.forEach(q=>{var Y;(Y=q.rtpMap)!==null&&Y!==void 0&&Y.clockRate&&(q.rtpMap.clockRate=parseInt(q.rtpMap.clockRate)),g&&q.rtcpFeedbacks.push({type:"rrtr"})}),E.forEach(q=>{var Y;(Y=q.rtpMap)!==null&&Y!==void 0&&Y.clockRate&&(q.rtpMap.clockRate=parseInt(q.rtpMap.clockRate)),g&&q.rtcpFeedbacks.push({type:"rrtr"})}),a&&(E=E.filter(q=>{var Y;return((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName.toLowerCase())!=="rtx"}),y=y.filter(q=>{var Y;return((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName.toLowerCase())!=="rtx"})),l&&(y=y.filter(q=>{var Y;return!/(red)|(ulpfec)|(flexfec)/i.test(((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName)||"")})),u&&(E=E.filter(q=>{var Y;return!/(red)|(ulpfec)|(flexfec)/i.test(((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName)||"")})),p&&(p==null?void 0:p.length)>0&&(E=E.filter(q=>{var Y;return je(p).call(p,((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName.toLowerCase())||"")})),m&&(m==null?void 0:m.length)>0){const q=y.filter(Y=>{var re;return je(m).call(m,((re=Y.rtpMap)===null||re===void 0?void 0:re.encodingName.toLowerCase())||"")});y=q.concat(a?[]:E1(q,y))}const F=Z("UNSUPPORTED_VIDEO_CODEC");return F&&F.length>0&&(y=y.filter(q=>!(q.rtpMap&&je(F).call(F,q.rtpMap.encodingName.toLowerCase())))),{audioCodecs:E,videoCodecs:y,audioExtensions:b,videoExtensions:C}}function Ud(e){const t=Ps(e);let r,s;for(const a of t.mediaDescriptions){if(!r){const l=a.attributes.iceUfrag,u=a.attributes.icePwd;if(!l||!u)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:l,icePwd:u}}if(!s){const l=a.attributes.fingerprints;l.length>0&&(s={fingerprints:l})}}if(!s&&t.attributes.fingerprints.length>0&&(s={fingerprints:t.attributes.fingerprints}),!s||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:s}}function _5(e,t){const r=[],s=e.attributes.ssrcGroups.filter(u=>u.semantic==="FID"),a=e.attributes.ssrcGroups.find(u=>u.semantic==="SIM"),l=e.attributes.ssrcs;if(a)a.ssrcIds.forEach(u=>{var p;const m=(p=s.find(g=>g.ssrcIds[0]===u))===null||p===void 0?void 0:p.ssrcIds[1];r.push({ssrcId:u,rtx:t?m:void 0})});else if(s.length>0){const u=s[0].ssrcIds[0],p=s[0].ssrcIds[1];r.push({ssrcId:u,rtx:t?p:void 0})}else{if(l.length===0)throw new Error("No ssrcs found on local media description.");r.push({ssrcId:l[0].ssrcId})}return r}function E5(e,t,r){const{cname:s}=e;let a=[];t&&(a=v5(t)),a.length===0&&(a=e.iceParameters.candidates.map(E=>({foundation:E.foundation,componentId:"1",transport:E.protocol,priority:E.priority.toString(),connectionAddress:E.ip,port:E.port.toString(),type:E.type,extension:{}})),O.debug("Using candidates from gateway."));const l={fingerprints:e.dtlsParameters.fingerprints.map(E=>({hashFunction:E.algorithm,fingerprint:E.fingerprint}))},u={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let p;switch(e.dtlsParameters.role){case"server":p="passive";break;case"client":p="active";break;case"auto":p="actpass"}const m=iS(e.rtpCapabilities),g=[];return Array.isArray(r)&&r.length>0&&r.forEach(E=>{g.push({kind:Ze.VIDEO,ssrcId:E.v,rtx:E.v_rtx,mslabel:"".concat(E.v,"_").concat(E.a)},{kind:Ze.AUDIO,ssrcId:E.a,mslabel:"".concat(E.v,"_").concat(E.a)})}),{dtlsParameters:l,iceParameters:u,candidates:a,rtpCapabilities:m,setup:p,cname:s,preSSRCs:g}}function v5(e){let t=[];return e.ip&&typeof e.port=="number"&&(t=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],O.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(t.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),O.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),t}function Sh(e,t,r){const s=[],a=[];return e.forEach(l=>{let{ssrcId:u,rtx:p}=l;const m=An(8,"track-"),g={ssrcId:u,attributes:g5({label:m,mslabel:r=r||An(10,""),msid:"".concat(r," ").concat(m)},t&&{cname:t})};if(s.push(g),p!==void 0){const E={ssrcId:p,attributes:g5({label:m,mslabel:r,msid:"".concat(r," ").concat(m)},t&&{cname:t})};s.push(E),a.push({semantic:"FID",ssrcIds:[u,p]})}}),e.length>1&&a.push({semantic:"SIM",ssrcIds:e.map(l=>{let{ssrcId:u}=l;return u})}),{ssrcs:s,ssrcGroups:a}}function kf(e,t){t instanceof dr&&e.attributes.payloads.forEach(r=>{var s;const a=(s=r.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase();if(!a||["opus","pcmu","pcma","g722"].indexOf(a)===-1)return;r.fmtp||(r.fmtp={parameters:{}}),a==="opus"&&typeof Z("OPUS_PTIME")=="number"?r.fmtp.parameters.ptime=Z("OPUS_PTIME"):r.fmtp.parameters.minptime="10",r.fmtp.parameters.useinbandfec="1";const l=t._encoderConfig;l&&(a!=="pcmu"&&a!=="pcma"&&a!=="g722"&&(l.bitrate&&!rr()&&(r.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*l.bitrate))),l.sampleRate&&(r.fmtp.parameters.maxplaybackrate="".concat(l.sampleRate),r.fmtp.parameters["sprop-maxcapturerate"]="".concat(l.sampleRate)),l.stereo&&(r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1")),t instanceof pg&&a==="opus"&&t._config.DTX&&(r.fmtp.parameters.usedtx="1"))})}function g1(e){const t=e.attributes.unrecognized.findIndex(r=>r.attField==="x-google-flag"&&r.attValue==="conference");t!==-1&&e.attributes.unrecognized.splice(t,1)}function _1(e,t){var r;if(!(t instanceof Un&&t._encoderConfig&&t._hints.indexOf(Tn.SCREEN_TRACK)===-1))return;const s=t._encoderConfig;tn().supportMinBitrate&&s.bitrateMin&&e.attributes.payloads.forEach(a=>{var l,u;je(l=["h264","h265","vp8","vp9","av1"]).call(l,((u=a.rtpMap)===null||u===void 0?void 0:u.encodingName.toLowerCase())||"")&&(a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters["x-google-min-bitrate"]="".concat(s.bitrateMin))}),tn().supportMinBitrate&&!je(r=t._hints).call(r,Tn.LOW_STREAM)&&s.bitrateMax&&e.attributes.payloads.forEach(a=>{var l,u;je(l=["h264","h265","vp8","vp9","av1"]).call(l,((u=a.rtpMap)===null||u===void 0?void 0:u.encodingName.toLowerCase())||"")&&(a.fmtp||(a.fmtp={parameters:{}}),a.fmtp.parameters["x-google-start-bitrate"]="".concat(Z("X_GOOGLE_START_BITRATE")||Math.floor(s.bitrateMax)))})}function y5(e){if(e.media.mediaType!=="video")return;const t=en();if(t.name!==cn.SAFARI&&t.os!==Ur.IOS)return;const r=e.attributes.extmaps.findIndex(s=>/video-orientation/g.test(s.extensionName));r!==-1&&e.attributes.extmaps.splice(r,1)}function rS(e,t,r){if(!t)return;let s,a;if(e.media.mediaType==="video"?(s=r.videoExtensions,a=r.videoCodecs):(s=r.audioExtensions,a=r.audioCodecs),t.twcc===!0){const l=s.find(u=>nS(u.extensionName));if(l){const u=l.extensionName;e.attributes.extmaps.find(m=>nS(m.extensionName))||e.attributes.extmaps.push({entry:l.entry,extensionName:u}),function(m,g){return g.filter(E=>!!m.find(y=>y.payloadType===E.payloadType&&!!y.rtcpFeedbacks.find(b=>b.type==="transport-cc")))}(a,e.attributes.payloads).forEach(m=>{m.rtcpFeedbacks.find(g=>g.type==="transport-cc")||m.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(t.twcc===!1){const l=e.attributes.extmaps.findIndex(u=>nS(u.extensionName));l!==-1&&e.attributes.extmaps.splice(l,1),e.attributes.payloads.forEach(u=>{const p=u.rtcpFeedbacks.findIndex(m=>m.type==="transport-cc");p!==-1&&u.rtcpFeedbacks.splice(p,1)})}if(t.remb===!0){const l=s.find(u=>f5(u.extensionName));if(l){const u=l.extensionName;e.attributes.extmaps.find(m=>m.extensionName===u)||e.attributes.extmaps.push({entry:l.entry,extensionName:u}),function(m,g){return g.filter(E=>!!m.find(y=>y.payloadType===E.payloadType&&!!y.rtcpFeedbacks.find(b=>b.type==="goog-remb")))}(a,e.attributes.payloads).forEach(m=>{m.rtcpFeedbacks.find(g=>g.type==="goog-remb")||m.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(t.remb===!1){const l=e.attributes.extmaps.findIndex(u=>f5(u.extensionName));l!==-1&&e.attributes.extmaps.splice(l,1),e.attributes.payloads.forEach(u=>{const p=u.rtcpFeedbacks.findIndex(m=>m.type==="goog-remb");p!==-1&&u.rtcpFeedbacks.splice(p,1)})}}function S5(e,t,r){if(rr()||e.media.mediaType!=="video"||!(t instanceof Un)||r!=="vp9"&&r!=="vp8"||r==="vp8"&&!Z("SIMULCAST")||r==="vp9"&&Z("ENABLE_SVC")||t._scalabilityMode===void 0||t._scalabilityMode.numSpatialLayers<=1)return;const s=r==="vp8"?2:t._scalabilityMode.numSpatialLayers,a=e.attributes.ssrcs[0],l=e.attributes.ssrcGroups.find(p=>p.semantic==="FID"&&p.ssrcIds[0]===a.ssrcId),u={semantic:"SIM",ssrcIds:[a.ssrcId]};for(let p=1;p<s;p++)e.attributes.ssrcs.push({ssrcId:a.ssrcId+p,attributes:er(a.attributes)}),u.ssrcIds.push(a.ssrcId+p),l&&(e.attributes.ssrcs.push({ssrcId:l.ssrcIds[1]+p,attributes:er(a.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[a.ssrcId+p,l.ssrcIds[1]+p]}));e.attributes.ssrcGroups.unshift(u)}async function x5(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new RTCPeerConnection;r.addTransceiver("video",{direction:"sendonly"}),r.addTransceiver("audio",{direction:"sendonly"}),r.addTransceiver("video",{direction:"recvonly"}),r.addTransceiver("audio",{direction:"recvonly"});const s=(await r.createOffer()).sdp,{send:a,recv:l,sendrecv:u}=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=arguments.length>2?arguments[2]:void 0;const E=yg(g,p,m,"sendonly"),y=yg(g,p,m,"recvonly"),b={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},C={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},B={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Na(E,y,"videoExtensions",b,C,B),Na(E,y,"videoCodecs",b,C,B),Na(E,y,"audioExtensions",b,C,B),Na(E,y,"audioCodecs",b,C,B),Z("RAISE_H264_BASELINE_PRIORITY")){const M=[],F=[];B.videoCodecs.forEach((q,Y)=>{var re;if(((re=q.rtpMap)===null||re===void 0?void 0:re.encodingName.toLocaleLowerCase())==="h264"){var ce,le;const ae=B.videoCodecs[Y+1],_e=ae&&R5(q,ae),we=(ce=q.fmtp)===null||ce===void 0?void 0:ce.parameters["profile-level-id"],Be=(le=q.fmtp)===null||le===void 0?void 0:le.parameters["packetization-mode"];!we||we!==Z("FIRST_H264_PROFILE_LEVEL_ID")||Z("FIRST_PACKETIZATION_MODE")&&Be!==Z("FIRST_PACKETIZATION_MODE")?_e?F.push([q,ae]):F.push([q]):_e?M.push([q,ae]):M.push([q])}}),M.length>0&&F.length>0&&(O.debug("raising H264 baseline profile priority"),B.videoCodecs.forEach((q,Y)=>{var re;if(((re=q.rtpMap)===null||re===void 0?void 0:re.encodingName.toLocaleLowerCase())==="h264"){const ce=R5(q,B.videoCodecs[Y+1]),le=M.shift()||F.shift()||[];le.length>0&&(ce?B.videoCodecs.splice(Y,2,...le):B.videoCodecs.splice(Y,1,...le))}}),C.videoCodecs=C.videoCodecs.filter(q=>{var Y,re;return!(((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName.toLocaleLowerCase())==="h264"&&((re=q.fmtp)===null||re===void 0?void 0:re.parameters["profile-level-id"])!==Z("FIRST_H264_PROFILE_LEVEL_ID"))}),Z("FILTER_SEND_H264_BASELINE")&&(b.videoCodecs=b.videoCodecs.filter(q=>{var Y,re;return!(((Y=q.rtpMap)===null||Y===void 0?void 0:Y.encodingName.toLocaleLowerCase())==="h264"&&((re=q.fmtp)===null||re===void 0?void 0:re.parameters["profile-level-id"])!==Z("FIRST_H264_PROFILE_LEVEL_ID"))})))}return{send:b,recv:C,sendrecv:B}}(e,t,s);try{r.close()}catch{}return{send:a,recv:l,sendrecv:u}}function T5(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=yg(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Na(e,t,"videoExtensions",r,s,a),Na(e,t,"videoCodecs",r,s,a),Na(e,t,"audioExtensions",r,s,a),Na(e,t,"audioCodecs",r,s,a),Z("RAISE_H264_BASELINE_PRIORITY")){const l=a.videoCodecs.findIndex(u=>u.rtpMap&&u.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&u.fmtp&&u.fmtp.parameters["profile-level-id"]==="42001f");if(l!==-1){const u=a.videoCodecs.findIndex(p=>p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(u<l){O.debug("raising H264 baseline profile priority");const p=a.videoCodecs[l];a.videoCodecs.splice(l,1),a.videoCodecs.splice(u,0,p)}u!==-1&&(s.videoCodecs=s.videoCodecs.filter(p=>!(p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&p.fmtp&&p.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:r,recv:s,sendrecv:a}}function Na(e,t,r,s,a,l){if(r==="videoExtensions"||r==="audioExtensions"){const u=[];return e[r].forEach(p=>{t[r].some((m,g)=>{if(p.entry===m.entry&&p.extensionName===m.extensionName)return u.push(g),!0})?l[r].push(p):s[r].push(p)}),void t[r].forEach((p,m)=>{u.indexOf(m)===-1&&a[r].push(p)})}if(r==="videoCodecs"||r==="audioCodecs"){const u=[];return e[r].forEach(p=>{t[r].some((m,g)=>{if(p.payloadType===m.payloadType&&JSON.stringify(p)===JSON.stringify(m))return u.push(g),!0})?l[r].push(p):s[r].push(p)}),void t[r].forEach((p,m)=>{u.indexOf(m)===-1&&a[r].push(p)})}}function iS(e){const{send:t,recv:r,sendrecv:s}=e;if(!s){if(!t||!r)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:r}}let a,l;return t?(a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a.audioCodecs=[...t.audioCodecs,...s.audioCodecs],a.videoCodecs=[...t.videoCodecs,...s.videoCodecs],a.audioExtensions=[...t.audioExtensions,...s.audioExtensions],a.videoExtensions=[...t.videoExtensions,...s.videoExtensions]):a=s,r?(l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l.audioCodecs=[...r.audioCodecs,...s.audioCodecs],l.videoCodecs=[...r.videoCodecs,...s.videoCodecs],l.audioExtensions=[...r.audioExtensions,...s.audioExtensions],l.videoExtensions=[...r.videoExtensions,...s.videoExtensions]):l=s,{send:a,recv:l}}function Lf(e){e.media.mediaType==="audio"&&e.attributes.payloads.filter(t=>{var r;return((r=t.rtpMap)===null||r===void 0?void 0:r.encodingName.toLowerCase())==="opus"}).forEach(t=>{t.fmtp||(t.fmtp={parameters:{}}),t.fmtp.parameters.stereo="1",t.fmtp.parameters["sprop-stereo"]="1"})}function Sg(e,t,r,s){let a=[];if(e===Ze.VIDEO){if(Z("H264_PROFILE_LEVEL_ID")&&s==="h264"&&(a=t.videoCodecs.filter(l=>{var u;return je(u=l.rtpMap&&l.rtpMap.encodingName.toLowerCase()||"").call(u,s)&&l&&l.fmtp&&l.fmtp.parameters["profile-level-id"]===Z("H264_PROFILE_LEVEL_ID")})),!Array.isArray(a)||a.length===0){let l=[];const u=[],p=[],m=[];if(r.videoCodecs.forEach(g=>{const E=g.rtpMap&&g.rtpMap.encodingName.toLowerCase()||"";je(E).call(E,s)?l.push(g):je(E).call(E,"vp9")?u.push(g):je(E).call(E,"vp8")?p.push(g):je(E).call(E,"h264")&&m.push(g)}),l.length===0){let g="";u.length!==0?(l=u,g="vp9"):p.length!==0?(l=p,g="vp8"):m.length!==0&&(l=m,g="h264"),O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(g))}l.length!==0&&(a=t.videoCodecs.filter(g=>l.some(E=>E.payloadType===g.payloadType)))}if(a.length===0&&(O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),a=t.videoCodecs),Z("USE_PUB_RTX")||Z("USE_SUB_RTX")){const l=E1(a,t.videoCodecs);a=[...a,...l]}}else{a=t.audioCodecs.filter(u=>{var p;return je(p=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(p,s)});const l=t.audioCodecs.filter(u=>{var p;return je(p=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(p,"red")});a.length===0&&(O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to opus")),a=t.audioCodecs.filter(u=>{var p;return je(p=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(p,"opus")})),Z("ENABLE_AUDIO_RED")&&l.length!==0&&(a=[...l,...a])}return a}function E1(e,t){const r=e.map(s=>s.payloadType.toString());return t.filter(s=>s.rtpMap&&s.rtpMap.encodingName==="rtx"&&s.fmtp&&s.fmtp.parameters.apt&&je(r).call(r,s.fmtp&&s.fmtp.parameters.apt))}async function xg(e,t,r){const s=t.toString(),a=w5(s,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:s});const l=await e.createAnswer();if(!l.sdp)throw new Error("cannot get answer sdp");let u=l.sdp;u=b5(u,r||{}),a==null||a(u||""),await e.setLocalDescription({type:"answer",sdp:u})}function b5(e,t,r){const s=Ps(e),{useXR:a}=t;return s.mediaDescriptions.forEach(l=>{var u;l.attributes.mid&&(Array.isArray(r)&&!je(r).call(r,l.attributes.mid)||(l.media.mediaType==="audio"&&Lf(l),a&&je(u=["audio","video"]).call(u,l.media.mediaType)&&l.attributes.payloads.forEach(p=>{p.rtcpFeedbacks.findIndex(m=>m.type==="rrtr")===-1&&p.rtcpFeedbacks.push({type:"rrtr"})})))}),Pd(s)}function w5(e,t,r,s){if(Z("SDP_LOGGING"))return O.upload("exchanging ".concat(r," ").concat(t," SDP during P2PConnection.").concat(s,`
`),e),t==="offer"?a=>{w5(a,"answer",r==="local"?"remote":"local",s)}:void 0}function C5(e){const t=Z("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(t)&&t.length>0)&&t.some(r=>je(e).call(e,r))}function R5(e,t){try{var r;return((r=e.fmtp)===null||r===void 0?void 0:r.parameters.apt)===t.payloadType.toString()}catch{return!1}}function A5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function eo(e,t){return typeof Z(e)===t?Z(e):void 0}function Lue(){try{const e=Z("EXPERIMENTS")||{};return typeof e=="string"||Array.isArray(e)?{}:function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?A5(Object(s),!0).forEach(function(a){z(t,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):A5(Object(s)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(s,a))})}return t}({},e)}catch(e){return O.debug("handle gateway attributes failed: ",e),{}}}const N5={};function Fd(e){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&O.debug("install service ".concat(e.name)),N5[e.name]=e}function Fl(e){const t=N5[e];if(!t)throw new Se($.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return t}function I5(e,t){return Fl("DataStream").create(e,t)}function sS(){return Fl("InterceptFrame").create()}function O5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Zc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const v1=new Map;class Mue extends Zn{get state(){return this._state}set state(t){if(t===this._state)return;const r=this._state;this._state=t,t==="DISCONNECTED"&&this._disconnectedReason?this.emit(Qr.CONNECTION_STATE_CHANGE,t,r,this._disconnectedReason):this.emit(Qr.CONNECTION_STATE_CHANGE,t,r)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(t){O.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(t)),this._joinGatewayStartTime=t}constructor(t,r){var s,a,l;super(),z(this,"store",void 0),z(this,"joinInfo",void 0),z(this,"key",void 0),z(this,"ntpOffset",0),z(this,"signal",void 0),z(this,"role",void 0),z(this,"inChannelInfo",{joinAt:null,duration:0}),z(this,"spec",void 0),z(this,"_state","DISCONNECTED"),z(this,"_statsCollector",void 0),z(this,"_disconnectedReason",void 0),z(this,"isSignalRecover",!1),z(this,"hasChangeBGPAddress",!1),z(this,"trafficStatsInterval",void 0),z(this,"networkQualityInterval",void 0),z(this,"_joinGatewayStartTime",0),z(this,"_signalTimeout",!1),z(this,"_clientRoleOptions",void 0),z(this,"_isProactiveJoin",!1),this.store=t,this.spec=r,this.signal=this.store.useP2P?(s={spec:Zc(Zc({},r),{},{retryConfig:r.websocketRetryConfig}),store:t},(a=(l=Fl("P2PChannel")).createSubmodule)===null||a===void 0?void 0:a.call(l,s)):new Pue(Zc(Zc({},r),{},{retryConfig:r.websocketRetryConfig}),t),this._statsCollector=r.statsCollector,this.role=r.role||"audience",this._clientRoleOptions=r.clientRoleOptions,this.handleSignalEvents()}async join(t,r,s){this.store.joinGatewayStart(),t.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const a=Date.now();let l=v1.get(t.cname);if(l||(l=new Map,v1.set(t.cname,l)),this._isProactiveJoin=!0,l.has(t.uid)){const g=new me($.UID_CONFLICT);throw st.joinGateway(t.sid,{lts:a,succ:!1,ec:g.code,addr:null,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,isProxy:!!t.proxyServer,signalChannel:"0",preload:t.preload}),g}l.set(t.uid,!0),this.joinInfo=t,this.key=r;let u=0;this.joinGatewayStartTime=a;const p=t.proxyServer;try{O.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(u));const g=t.gatewayAddrs.map(E=>{let{address:y}=E;const[b,C]=y.split(":"),B={host:b,port:C};return t.proxyServer&&(B.proxy=t.proxyServer),B});u=(await this.signal.init(g)).uid,O.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(u," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(g){var m;throw O.error("[".concat(this.store.clientId,"] User join failed"),g.toString()),st.joinGateway(t.sid,{lts:a,succ:!1,ec:((m=g.data)===null||m===void 0?void 0:m.desc)||g.code,errorMsg:g.message,addr:this.signal.url,uid:t.uid,cid:t.cid,firstSuccess:this._isProactiveJoin,isProxy:!!p,signalChannel:"0",preload:t.preload}),l.delete(t.uid),this.signal.close(),g}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),O.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(g=>{O.warning("[".concat(this.store.clientId,"] get traffic stats error"),g.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(Qr.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(Qr.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(Qr.NETWORK_QUALITY,{uplinkNetworkQuality:u5(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:u5(this._statsCollector.trafficStats.B_dnq)}):this.emit(Qr.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),u}async leave(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){r!==hn.FALLBACK&&(this.state="DISCONNECTING");try{t||this.signal.connectionState!==Mn.CONNECTED||await function(s,a){return a===1/0?s:Ye.race([s,ode(a)])}(this.signal.request(xt.LEAVE,void 0,!0),3e3)}catch(s){O.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),s)}this.signal.close(r),r!==hn.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const a={state:"offer",p2p_id:this.store.p2pId,ortc:r,mode:this.spec.mode,extend:Z("PUB_EXTEND"),twcc:!!Z("PUBLISH_TWCC"),rtx:!!Z("USE_PUB_RTX")};try{return(await this.signal.request(xt.PUBLISH,a,!0))._message}catch(l){if(s&&l.data&&l.data.code===ft.ERR_PUBLISH_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),l.toString()),await this.tryUnpubBeforeRepub(t,r),this.publish(t,r,!1);throw l}}async publishDataChannel(t,r,s){var a;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const l={stream_id:r.streamId,ordered:r.ordered?1:0,max_retrans_times:(a=r.maxRetransmits)!==null&&a!==void 0?a:10,channel_id:r.channelId,metadata:r.metadata};try{await this.signal.request(xt.PUBLISH_DATASTREAM,l,!0)}catch(u){if(s&&u.data&&u.data.code===ft.ERR_PUBLISH_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),u.toString()),await this.tryUnpubDataChannelBeforeRepub(t,r),this.publishDataChannel(t,r,!1);throw u}}async unpublish(t,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(xt.UNPUBLISH,{stream_id:r,ortc:t},!0)}catch(s){O.warning("[".concat(this.store.clientId,"] unpublish warning: "),s)}}async unpublishDataChannel(t){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ye.all(t.map(r=>this.signal.request(xt.UNPUBLISH_DATASTREAM,{channel_id:r},!0)))}catch(r){O.warning("unpublish datachannels warning: ",r)}}async presubscribe(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const a={stream_id:t,stream_type:r,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Z("SUBSCRIBE_TWCC"),rtx:!!Z("USE_SUB_RTX")||void 0,extend:Z("SUB_EXTEND"),svc:Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0};try{return await this.signal.request(xt.PRE_SUBSCRIBE,a,!0)}catch(l){if(s&&l.data&&l.data.code===ft.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),l.toString()),this.presubscribe(t,r,!1);throw l}}async subscribe(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const a={stream_id:t,stream_type:r.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Z("SUBSCRIBE_TWCC"),rtx:!!Z("USE_SUB_RTX"),extend:Z("SUB_EXTEND"),ssrcId:r.ssrcId,svc:Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0};try{return(await this.signal.request(xt.SUBSCRIBE,a,!0))._message}catch(l){if(s&&l.data&&l.data.code===ft.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),l.toString()),await this.tryUnsubBeforeResub(t,r),await this.subscribe(t,r,!1);throw l}}async subscribeDataChannel(t,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const a={uid:t,stream_id:r.id,channel_id:r.datachannelId};try{return void await this.signal.request(xt.SUBSCRIBE_DATASTREAM,a,!0)}catch(l){if(s&&l.data&&l.data.code===ft.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),l.toString()),await this.tryUnsubDataChannelBeforeResub(t,r),await this.subscribeDataChannel(t,r,!1);throw l}}async subscribeAll(t,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const s={p2p_id:this.store.p2pId,users:t,dtx:!1,rtx:!!Z("USE_SUB_RTX"),twcc:!!Z("SUBSCRIBE_TWCC"),svc:Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0};try{return await this.signal.request(xt.SUBSCRIBE_STREAMS,s,!0)}catch(a){if(r&&a.data&&a.data.code===ft.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),a.toString()),await this.tryMassUnsubBeforeResub(t),await this.subscribeAll(t,!1);throw a}}async setVideoProfile(t){const r=function(s){if(!(s.bitrateMax&&s.bitrateMin&&s.frameRate&&s.height&&s.width))return;let a=s.frameRate,l=s.width,u=s.height,p=!0;return typeof a!="number"&&(a=a.exact||a.ideal||a.max||a.min||0,a||(p=!1)),typeof l!="number"&&(l=l.exact||l.ideal||l.max||l.min||0,l||(p=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,a||(p=!1)),p?{stream_type:0,width:l,height:u,fps:a,start_bps:1e3*s.bitrateMax,min_bps:1e3*s.bitrateMin,target_bps:1e3*s.bitrateMax}:void 0}(t);if(r)return this.signal.request(xt.SET_VIDEO_PROFILE,r);O.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(t,r){try{await this.signal.request(xt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:t,stream_id:r},!0)}catch(s){O.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),s)}}async unsubscribeDataChannel(t,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await Ye.all(t.map(s=>this.signal.request(xt.UNSUBSCRIBE_DATASTREAM,{stream_id:s,uid:r},!0)))}catch(s){O.warning("unsubscribeDataChannel warning: ",s)}}async massUnsubscribe(t){try{await this.signal.request(xt.UNSUBSCRIBE_STREAMS,t,!0)}catch(r){O.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),r)}}async reconnectPC(t){const{iceParameters:r,dtlsParameters:s,rtpCapabilities:a}=t;return{gatewayEstablishParams:await this.signal.request(xt.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:r,dtlsParameters:s,rtpCapabilities:a}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(xt.GATEWAY_INFO)}async renewToken(t){await this.signal.request(xt.RENEW_TOKEN,t),this.key=t.token}updateClientRole(t,r){r&&(this._clientRoleOptions=Object.assign({},r)),Z("CLIENT_ROLE_OPTIONS")&&(O.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(Z("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},Z("CLIENT_ROLE_OPTIONS"))),this.role=t}async setClientRole(t,r){if(r&&(this._clientRoleOptions=Object.assign({},r)),Z("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},Z("CLIENT_ROLE_OPTIONS")),O.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(Z("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=t);let s,a=0;t==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(s=this._clientRoleOptions.delay,a=1):a=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:a=0,await this.signal.request(xt.SET_CLIENT_ROLE,{role:t,level:a,delay:s,client_ts:Date.now()}),this.role=t}async setRemoteVideoStreamType(t,r){await this.signal.request(xt.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:r})}async setDefaultRemoteVideoStreamType(t){await this.signal.request(xt.DEFAULT_VIDEO_STREAM,{stream_type:t})}async setStreamFallbackOption(t,r){await this.signal.request(xt.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:r})}async pickSVCLayer(t,r){await this.signal.request(xt.PICK_SVC_LAYER,{stream_id:t,spatial_layer:r.spatialLayer,temporal_layer:r.temporalLayer})}async setRTM2Flag(t){await this.signal.request(xt.SET_RTM2_FLAG,{rtm2_flag:t})}async sendExtensionMessage(t,r,s){if(this.store.useP2P)return this.signal.sendExtensionMessage(t,r,s)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Zc({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(xt.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const t=v1.get(this.joinInfo.cname);t&&t.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const t=function(r){let s;return s=r.startsWith("dc")?r.match(/(dc\:\/\/)?([^:]+):(\d+)/):r.match(/(wss\:\/\/)?([^:]+):(\d+)/),s?{username:xi.username,password:xi.password,turnServerURL:s[2],tcpport:parseInt(s[3])+30,udpport:parseInt(s[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],t&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(Zc(Zc({},xi),{},{turnServerURL:t.turnServerURL,tcpport:t.tcpport,udpport:t.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const t=await this.signal.request(xt.TRAFFIC_STATS,void 0,!0);t.timestamp=Date.now(),t.ntp_offset!=null&&(this.ntpOffset=t.ntp_offset),t.peer_delay.forEach(r=>{const s=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(a=>a.peer_uid===r.peer_uid);s&&s.B_st!==r.B_st&&Cy(()=>{this.emit(Qr.STREAM_TYPE_CHANGE,r.peer_uid,r.B_st)})}),this._statsCollector.updateTrafficStats(t)}getJoinMessage(t){var r;if(!this.joinInfo||!this.key)throw new me($.UNEXPECTED_ERROR,"can not generate join message, no join info");const s=Object.assign({},this.joinInfo.apResponse);let a=Z("REPORT_APP_SCENARIO");if(typeof a!="string")try{a=JSON.stringify(a)}catch{a=void 0}var l;a&&a.length>128&&(a=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(Qr.UPDATE_GATEWAY_CONFIG),l=this.store.clientId,je(Af).call(Af,l)||Af.push(l);const u=!(rr()||YF(87)||jV())&&typeof Z("ENABLE_PRE_SUB")=="boolean"&&Z("ENABLE_PRE_SUB"),p=!jV()&&eo("ENABLE_PREALLOC_PC","boolean"),m=Lue(),g=ng(87)||function(){const y=en();if(y.name!==cn.SAFARI||!y.browserVersion)return!1;const b=y.browserVersion.split(".");return Number(b[0])>15||Number(b[0])===15&&Number(b[1])>=4}(),E=Zc({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:zo,browser:navigator.userAgent,process_id:Z("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:s,extend:Z("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:a,attributes:{userAttributes:Zc(Zc({enableEncodedTransform:!!Z("ENABLE_AUDIO_METADATA")&&g||!!Z("ENABLE_AUDIO_TOPN")&&dA(cn.CHROME,87,116)||void 0,enableAudioMetadata:!!Z("ENABLE_AUDIO_METADATA")&&g,enableAudioPts:!!Z("ENABLE_AUDIO_PTS_METADATA")&&g,topnSmoothLevel:Z("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:Z("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:Z("TOPN_SWITCH_HOLD_MS"),topnAudioGain:Z("TOPN_AUDIO_GAIN"),enablePublishedUserList:Z("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:Z("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:eo("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:eo("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:eo("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:Z("USE_PUB_RTX")===!0||Z("USE_SUB_RTX")===!0||void 0,disableFEC:Z("DISABLE_FEC"),enableNTPReport:!!Z("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!Z("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!Z("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:eo("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!Z("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!Z("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:eo("USE_XR","boolean"),enableLossbasedBwe:eo("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!Z("ENABLE_AUT_CC")||void 0,enableCCFallback:eo("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:p,preSubNum:u?eo("PRE_SUB_NUM","number"):void 0,enablePubTWCC:eo("PUBLISH_TWCC","boolean"),enableSubTWCC:eo("SUBSCRIBE_TWCC","boolean"),enablePubRTX:eo("USE_PUB_RTX","boolean"),enableSubRTX:eo("USE_SUB_RTX","boolean"),enableSubSVC:Z("ENABLE_SVC")?Z("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(Z("SVC"))&&Z("SVC").length!==0?Z("SVC"):void 0,enableSvcExtended:Z("ENABLE_SVC")&&Array.isArray(Z("SVC_EXTENDED"))&&Z("SVC_EXTENDED").length!==0?Z("SVC_EXTENDED"):void 0},m),{},{audioDuplicate:eo("ENABLE_AUDIO_RED","boolean")?(r=eo("AUDIO_DUPLICATE_NUM","number"))!==null&&r!==void 0?r:2:void 0})},join_ts:this.joinGatewayStartTime},t);return this.joinInfo.stringUid&&(E.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(E.aes_mode=this.joinInfo.aesmode,Z("ENCRYPT_AES")?(E.aes_secret=this.joinInfo.aespassword,E.aes_encrypt=!0):E.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(E.aes_salt=this.joinInfo.aessalt)),s.addresses[this.signal.websocket.currentURLIndex]&&(E.ap_response.ticket=s.addresses[this.signal.websocket.currentURLIndex].ticket,delete s.addresses),this.joinInfo.defaultVideoStream!==void 0&&(E.default_video_stream=this.joinInfo.defaultVideoStream),E}getRejoinMessage(){if(!this.joinInfo)throw new me($.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(bt.WS_RECONNECT_CREATE_CONNECTION,t=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(bt.WS_RECONNECTING,t=>{this.joinInfo&&st.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t||yi.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",st.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(bt.WS_CLOSED,t=>{let r;switch(t){case hn.LEAVE:r=yi.LEAVE;break;case hn.UID_BANNED:case hn.IP_BANNED:case hn.CHANNEL_BANNED:case hn.SERVER_ERROR:r=yi.SERVER_ERROR;break;case hn.FALLBACK:r=yi.FALLBACK;break;case hn.LICENSE_MISSING:case hn.LICENSE_EXPIRED:case hn.LICENSE_MINUTES_EXCEEDED:case hn.LICENSE_PERIOD_INVALID:case hn.LICENSE_MULTIPLE_SDK_SERVICE:case hn.LICENSE_ILLEGAL:case hn.TOKEN_EXPIRE:r=t;break;default:r=yi.NETWORK_ERROR}O.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(r||"undefined -> "+yi.NETWORK_ERROR)),this.joinInfo&&st.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:t===hn.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r}),this._disconnectedReason=t,t!==hn.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(bt.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const t=Z("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;t&&(t.level||t.delay)&&(O.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(t.level,", delay: ").concat(t.delay)),this.setClientRole(this.role,t))}if(st.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const t=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!t)return void O.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(t));vn("EVENT_REPORT_DOMAIN",t[1]),vn("EVENT_REPORT_BACKUP_DOMAIN",t[1]),vn("LOG_UPLOAD_SERVER","".concat(t[1],":6444"))}}}),this.signal.on(zt.ON_UPLINK_STATS,t=>{this._statsCollector.updateUplinkStats(t)}),this.signal.on(bt.REQUEST_RECOVER,(t,r,s)=>{if(!this.joinInfo)return s(new me($.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));t&&(this.joinInfo.multiIP=t,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Si(this,Qr.REQUEST_NEW_GATEWAY_LIST).then(r).catch(s)}),this.signal.on(bt.REQUEST_JOIN_INFO,async(t,r,s)=>{var a;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void t(this.getJoinMessage({ortc:{}}));const l=er((a=this.joinInfo)===null||a===void 0?void 0:a.turnServer);if(Z("NEW_TURN_MODE")&&l){let g=l.servers,E=l.serversFromGateway;const y=this.signal.currentURLIndex;g.length>0&&(g=[g[y%g.length]],l.servers=g),Array.isArray(E)&&E.length>0&&(E=[E[0]],l.serversFromGateway=E),O.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(y))}const{iceParameters:u,dtlsParameters:p,rtpCapabilities:m}=await Si(this,Qr.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:l});try{t(this.getJoinMessage({ortc:{iceParameters:u,dtlsParameters:p,rtpCapabilities:m,version:"2"}}))}catch(g){r(g)}}),this.signal.on(bt.REQUEST_REJOIN_INFO,t=>{t(this.getRejoinMessage())}),this.signal.on(bt.REPORT_JOIN_GATEWAY,(t,r)=>{if(!this.joinInfo)return;let s,a="";var l;t instanceof me?(s=((l=t.data)===null||l===void 0?void 0:l.desc)||t.code,a=t.message):s=t,st.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:s,errorMsg:a,addr:r,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(bt.IS_P2P_DISCONNECTED,t=>{t(ag(this,Qr.IS_P2P_DISCONNECTED))}),this.signal.on(bt.DISCONNECT_P2P,()=>{this.emit(Qr.DISCONNECT_P2P)}),this.signal.on(bt.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(bt.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(bt.JOIN_RESPONSE,t=>{const r=this.getCurrentGatewayAddress();this.emit(Qr.JOIN_RESPONSE,t,r)}),this.signal.on(bt.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const t=this.getCurrentGatewayAddress(),r=Z("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(t&&r){const s=v5(t);this.emit(Qr.PRE_CONNECT_PC,{candidates:s,fingerprint:r})}}}),this.signal.on(bt.RECOVER_NOTIFICATION,t=>{this.joinInfo&&typeof Z("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(Z("AP_REQUEST_DETAIL"),";").concat(t))})}async tryUnsubBeforeResub(t,r){try{await this.signal.request(xt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:t,ortc:[r]},!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),s),s}}async tryUnsubDataChannelBeforeResub(t,r){try{await this.signal.request(xt.UNSUBSCRIBE,{stream_id:r.id},!0)}catch(s){throw O.warning("unsubscribe datachannel warning",s),s}}async tryUnpubBeforeRepub(t,r){try{await this.signal.request(xt.UNPUBLISH,{stream_id:t,ortc:r},!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),s),s}}async tryUnpubDataChannelBeforeRepub(t,r){try{await this.signal.request(xt.UNPUBLISH_DATASTREAM,{channnel_id:r.channelId},!0)}catch(s){throw O.warning("unpublish datastream warning: ",s),s}}async tryMassUnsubBeforeResub(t){const r={users:t.map(s=>({stream_id:s.stream_id,stream_type:s.stream_type}))};try{await this.signal.request(xt.UNSUBSCRIBE_STREAMS,r,!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),s),s}}async muteLocal(t,r){const s={action:t.find(a=>a.stream_type===gn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:r};try{await this.signal.request(xt.CONTROL,s,!0,!0)}catch(a){throw O.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),a),a}}async unmuteLocal(t,r){const s={action:t.find(a=>a.stream_type===gn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:t,stream_id:r};try{await this.signal.request(xt.CONTROL,s,!0,!0)}catch(a){throw O.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),a),a}}async muteRemote(t,r){const s={action:t===Ze.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(xt.CONTROL,s,!0,!0)}catch(a){throw O.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),a),a}}async unmuteRemote(t,r){const s={action:t===Ze.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(xt.CONTROL,s,!0,!0)}catch(a){throw O.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),a),a}}uploadWRTCStats(t){this.signal.uploadWRTCStats(t)}upload(t,r){this.signal.upload(t,r)}getSignalRTT(){return this.signal.rtt}async restartICE(t){const r={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:t};try{return await this.signal.request(xt.RESTART_ICE,r,!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),s),s}}reconnect(t,r){this.state==="CONNECTED"&&this.signal.reconnect(t||void 0,r||yi.P2P_FAILED)}getCurrentGatewayAddress(){var t,r;if(!Z("GATEWAY_WSS_ADDRESS"))return Z("USE_CANDIDATE_FROM_AP_DETAIL")&&(t=this.joinInfo)!==null&&t!==void 0&&t.apGatewayAddress?(O.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(r=this.joinInfo)!==null&&r!==void 0&&r.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(t){await this.signal.request(xt.SET_PARAMETER,{enablePublishAudioFilter:t})}}let oS=0,y1=0;function uc(e,t,r,s){return new Ye((a,l)=>{t.timeout=t.timeout||Z("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!r?(t.data=JSON.stringify(t.data),oS+=Kc(t.data)):r&&(t.data.size?oS+=t.data.size:t.data instanceof FormData?oS+=hV(t.data):oS+=Kc(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,_s.request(t).then(u=>{typeof u.data=="string"?y1+=Kc(u.data):u.data instanceof ArrayBuffer||u.data instanceof Uint8Array?y1+=u.data.byteLength:y1+=Kc(JSON.stringify(u.data)),s&&a({data:u.data,headers:u.headers}),a(u.data)}).catch(u=>{_s.isCancel(u)?l(new me($.OPERATION_ABORTED,"cancel token canceled")):u.code==="ECONNABORTED"?l(new me($.NETWORK_TIMEOUT,u.message)):u.response?l(new me($.NETWORK_RESPONSE_ERROR,u.response.status)):l(new me($.NETWORK_ERROR,u.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var e;function t(Ce){var ke=0;return function(){return ke<Ce.length?{done:!1,value:Ce[ke++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(Ce,ke,nt){return Ce==Array.prototype||Ce==Object.prototype||(Ce[ke]=nt.value),Ce},s,a=function(Ce){Ce=[typeof globalThis=="object"&&globalThis,Ce,typeof window=="object"&&window,typeof self=="object"&&self,typeof c=="object"&&c];for(var ke=0;ke<Ce.length;++ke){var nt=Ce[ke];if(nt&&nt.Math==Math)return nt}throw Error("Cannot find global object")}(this);function l(Ce,ke){if(ke)e:{var nt=a;Ce=Ce.split(".");for(var Re=0;Re<Ce.length-1;Re++){var D=Ce[Re];if(!(D in nt))break e;nt=nt[D]}(ke=ke(Re=nt[Ce=Ce[Ce.length-1]]))!=Re&&ke!=null&&r(nt,Ce,{configurable:!0,writable:!0,value:ke})}}function u(Ce){return(Ce={next:Ce})[Symbol.iterator]=function(){return this},Ce}function p(Ce){var ke=typeof Symbol<"u"&&Symbol.iterator&&Ce[Symbol.iterator];return ke?ke.call(Ce):{next:t(Ce)}}if(l("Symbol",function(Ce){function ke(D,ee){this.A=D,r(this,"description",{configurable:!0,writable:!0,value:ee})}if(Ce)return Ce;ke.prototype.toString=function(){return this.A};var nt="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Re=0;return function D(ee){if(this instanceof D)throw new TypeError("Symbol is not a constructor");return new ke(nt+(ee||"")+"_"+Re++,ee)}}),l("Symbol.iterator",function(Ce){if(Ce)return Ce;Ce=Symbol("Symbol.iterator");for(var ke="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),nt=0;nt<ke.length;nt++){var Re=a[ke[nt]];typeof Re=="function"&&typeof Re.prototype[Ce]!="function"&&r(Re.prototype,Ce,{configurable:!0,writable:!0,value:function(){return u(t(this))}})}return Ce}),typeof Object.setPrototypeOf=="function")s=Object.setPrototypeOf;else{var m;e:{var g={};try{g.__proto__={a:!0},m=g.a;break e}catch{}m=!1}s=m?function(Ce,ke){if(Ce.__proto__=ke,Ce.__proto__!==ke)throw new TypeError(Ce+" is not extensible");return Ce}:null}var E=s;function y(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function b(Ce){if(Ce.m)throw new TypeError("Generator is already running");Ce.m=!0}function C(Ce,ke){return Ce.h=3,{value:ke}}function B(Ce){this.g=new y,this.G=Ce}function M(Ce,ke,nt,Re){try{var D=ke.call(Ce.g.j,nt);if(!(D instanceof Object))throw new TypeError("Iterator result "+D+" is not an object");if(!D.done)return Ce.g.m=!1,D;var ee=D.value}catch(se){return Ce.g.j=null,Ce.g.s(se),F(Ce)}return Ce.g.j=null,Re.call(Ce.g,ee),F(Ce)}function F(Ce){for(;Ce.g.h;)try{var ke=Ce.G(Ce.g);if(ke)return Ce.g.m=!1,{value:ke.value,done:!1}}catch(nt){Ce.g.v=void 0,Ce.g.s(nt)}if(Ce.g.m=!1,Ce.g.l){if(ke=Ce.g.l,Ce.g.l=null,ke.F)throw ke.D;return{value:ke.return,done:!0}}return{value:void 0,done:!0}}function q(Ce){this.next=function(ke){return Ce.o(ke)},this.throw=function(ke){return Ce.s(ke)},this.return=function(ke){return function(nt,Re){b(nt.g);var D=nt.g.j;return D?M(nt,"return"in D?D.return:function(ee){return{value:ee,done:!0}},Re,nt.g.return):(nt.g.return(Re),F(nt))}(Ce,ke)},this[Symbol.iterator]=function(){return this}}function Y(Ce,ke){return ke=new q(new B(ke)),E&&Ce.prototype&&E(ke,Ce.prototype),ke}if(y.prototype.o=function(Ce){this.v=Ce},y.prototype.s=function(Ce){this.l={D:Ce,F:!0},this.h=this.C||this.u},y.prototype.return=function(Ce){this.l={return:Ce},this.h=this.u},B.prototype.o=function(Ce){return b(this.g),this.g.j?M(this,this.g.j.next,Ce,this.g.o):(this.g.o(Ce),F(this))},B.prototype.s=function(Ce){return b(this.g),this.g.j?M(this,this.g.j.throw,Ce,this.g.o):(this.g.s(Ce),F(this))},l("Array.prototype.entries",function(Ce){return Ce||function(){return function(ke,nt){ke instanceof String&&(ke+="");var Re=0,D=!1,ee={next:function(){if(!D&&Re<ke.length){var se=Re++;return{value:nt(se,ke[se]),done:!1}}return D=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}(this,function(ke,nt){return[ke,nt]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var re=function(Ce,ke){for(var nt=0;nt<Ce.length;nt++)ke(Ce[nt])},ce=function(Ce){return Ce.replace(/\r?\n|\r/g,`\r
`)},le=function(Ce,ke,nt){return ke instanceof Blob?(nt=nt!==void 0?nt+"":typeof ke.name=="string"?ke.name:"blob",ke.name===nt&&Object.prototype.toString.call(ke)!=="[object Blob]"||(ke=new File([ke],nt)),[String(Ce),ke]):[String(Ce),String(ke)]},ae=function(Ce,ke){if(Ce.length<ke)throw new TypeError(ke+" argument required, but only "+Ce.length+" present.")},_e=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,we=_e.FormData,Be=_e.XMLHttpRequest&&_e.XMLHttpRequest.prototype.send,Xe=_e.Request&&_e.fetch,jt=_e.navigator&&_e.navigator.sendBeacon,kt=_e.Element&&_e.Element.prototype,Tt=_e.Symbol&&Symbol.toStringTag;Tt&&(Blob.prototype[Tt]||(Blob.prototype[Tt]="Blob"),"File"in _e&&!File.prototype[Tt]&&(File.prototype[Tt]="File"));try{new File([],"")}catch{_e.File=function(ke,nt,Re){return ke=new Blob(ke,Re||{}),Object.defineProperties(ke,{name:{value:nt},lastModified:{value:+(Re&&Re.lastModified!==void 0?new Date(Re.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),Tt&&Object.defineProperty(ke,Tt,{value:"File"}),ke}}var jn=function(Ce){return Ce.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},bn=function(Ce){this.i=[];var ke=this;Ce&&re(Ce.elements,function(nt){if(nt.name&&!nt.disabled&&nt.type!=="submit"&&nt.type!=="button"&&!nt.matches("form fieldset[disabled] *"))if(nt.type==="file"){var Re=nt.files&&nt.files.length?nt.files:[new File([],"",{type:"application/octet-stream"})];re(Re,function(D){ke.append(nt.name,D)})}else nt.type==="select-multiple"||nt.type==="select-one"?re(nt.options,function(D){!D.disabled&&D.selected&&ke.append(nt.name,D.value)}):nt.type==="checkbox"||nt.type==="radio"?nt.checked&&ke.append(nt.name,nt.value):(Re=nt.type==="textarea"?ce(nt.value):nt.value,ke.append(nt.name,Re))})};if((e=bn.prototype).append=function(Ce,ke,nt){ae(arguments,2),this.i.push(le(Ce,ke,nt))},e.delete=function(Ce){ae(arguments,1);var ke=[];Ce=String(Ce),re(this.i,function(nt){nt[0]!==Ce&&ke.push(nt)}),this.i=ke},e.entries=function Ce(){var ke,nt=this;return Y(Ce,function(Re){if(Re.h==1&&(ke=0),Re.h!=3)return ke<nt.i.length?Re=C(Re,nt.i[ke]):(Re.h=0,Re=void 0),Re;ke++,Re.h=2})},e.forEach=function(Ce,ke){ae(arguments,1);for(var nt=p(this),Re=nt.next();!Re.done;Re=nt.next()){var D=p(Re.value);Re=D.next().value,D=D.next().value,Ce.call(ke,D,Re,this)}},e.get=function(Ce){ae(arguments,1);var ke=this.i;Ce=String(Ce);for(var nt=0;nt<ke.length;nt++)if(ke[nt][0]===Ce)return ke[nt][1];return null},e.getAll=function(Ce){ae(arguments,1);var ke=[];return Ce=String(Ce),re(this.i,function(nt){nt[0]===Ce&&ke.push(nt[1])}),ke},e.has=function(Ce){ae(arguments,1),Ce=String(Ce);for(var ke=0;ke<this.i.length;ke++)if(this.i[ke][0]===Ce)return!0;return!1},e.keys=function Ce(){var ke,nt,Re,D,ee=this;return Y(Ce,function(se){if(se.h==1&&(ke=p(ee),nt=ke.next()),se.h!=3)return nt.done?void(se.h=0):(Re=nt.value,D=p(Re),C(se,D.next().value));nt=ke.next(),se.h=2})},e.set=function(Ce,ke,nt){ae(arguments,2),Ce=String(Ce);var Re=[],D=le(Ce,ke,nt),ee=!0;re(this.i,function(se){se[0]===Ce?ee&&(ee=!Re.push(D)):Re.push(se)}),ee&&Re.push(D),this.i=Re},e.values=function Ce(){var ke,nt,Re,D,ee=this;return Y(Ce,function(se){if(se.h==1&&(ke=p(ee),nt=ke.next()),se.h!=3)return nt.done?void(se.h=0):(Re=nt.value,(D=p(Re)).next(),C(se,D.next().value));nt=ke.next(),se.h=2})},bn.prototype._asNative=function(){for(var Ce=new we,ke=p(this),nt=ke.next();!nt.done;nt=ke.next()){var Re=p(nt.value);nt=Re.next().value,Re=Re.next().value,Ce.append(nt,Re)}return Ce},bn.prototype._blob=function(){var Ce="----formdata-polyfill-"+Math.random(),ke=[],nt="--"+Ce+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(Re,D){return typeof Re=="string"?ke.push(nt+jn(ce(D))+`"\r
\r
`+ce(Re)+`\r
`):ke.push(nt+jn(ce(D))+'"; filename="'+jn(Re.name)+`"\r
Content-Type: `+(Re.type||"application/octet-stream")+`\r
\r
`,Re,`\r
`)}),ke.push("--"+Ce+"--"),new Blob(ke,{type:"multipart/form-data; boundary="+Ce})},bn.prototype[Symbol.iterator]=function(){return this.entries()},bn.prototype.toString=function(){return"[object FormData]"},kt&&!kt.matches&&(kt.matches=kt.matchesSelector||kt.mozMatchesSelector||kt.msMatchesSelector||kt.oMatchesSelector||kt.webkitMatchesSelector||function(Ce){for(var ke=(Ce=(this.document||this.ownerDocument).querySelectorAll(Ce)).length;0<=--ke&&Ce.item(ke)!==this;);return-1<ke}),Tt&&(bn.prototype[Tt]="FormData"),Be){var xs=_e.XMLHttpRequest.prototype.setRequestHeader;_e.XMLHttpRequest.prototype.setRequestHeader=function(Ce,ke){xs.call(this,Ce,ke),Ce.toLowerCase()==="content-type"&&(this.B=!0)},_e.XMLHttpRequest.prototype.send=function(Ce){Ce instanceof bn?(Ce=Ce._blob(),this.B||this.setRequestHeader("Content-Type",Ce.type),Be.call(this,Ce)):Be.call(this,Ce)}}Xe&&(_e.fetch=function(Ce,ke){return ke&&ke.body&&ke.body instanceof bn&&(ke.body=ke.body._blob()),Xe.call(this,Ce,ke)}),jt&&(_e.navigator.sendBeacon=function(Ce,ke){return ke instanceof bn&&(ke=ke._asNative()),jt.call(this,Ce,ke)}),_e.FormData=bn}})();const Tg=()=>{const e=Z("AREAS");return e.length===0&&e.push(ln.GLOBAL),ma(e).call(e,(t,r,s)=>{const a=D5(r);return a?s===0?a:"".concat(t,",").concat(a):t},"")},D5=e=>e===ln.OVERSEA?"".concat(Ni.ASIA,",").concat(Ni.EUROPE,",").concat(Ni.AFRICA,",").concat(Ni.NORTH_AMERICA,",").concat(Ni.SOUTH_AMERICA,",").concat(Ni.OCEANIA):Ni[e],jue=e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map(r=>{const s=Qy[r],a=Object.keys(s);a&&a.map(l=>{l!=="CODE"&&(t[l]=t[l].concat(s[l]))})}),t},aS={GLOBAL:{ASIA:[ln.CHINA,ln.JAPAN,ln.INDIA,ln.KOREA,ln.HKMC],EUROPE:[],NORTH_AMERICA:[ln.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},cS=Object.keys(aS[ln.GLOBAL]),S1=[ln.CHINA,ln.NORTH_AMERICA,ln.EUROPE,ln.ASIA,ln.JAPAN,ln.INDIA,ln.OCEANIA,ln.SOUTH_AMERICA,ln.AFRICA,ln.KOREA,ln.HKMC,ln.US],Uue=function(e,t){let r=[];if(je(e).call(e,ln.GLOBAL)){const l=[ln.GLOBAL,ln.OVERSEA],u=Object.keys(Qy);if(t===ln.GLOBAL)throw new me($.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===ln.CHINA)r=[ln.OVERSEA];else if(a=t,je(cS).call(cS,a)){const p=(s=t,aS[ln.GLOBAL][s]||[]),m=[...l,t,...p];r=u.filter(g=>!je(m).call(m,g))}else if(function(p){let m=!1;return cS.forEach(g=>{var E;je(E=aS[ln.GLOBAL][g]).call(E,p)&&(m=!0)}),m}(t)){const p=function(g){let E;return cS.forEach(y=>{var b;je(b=aS[ln.GLOBAL][y]).call(b,g)&&(E=y)}),E}(t),m=[...l,p,t];r=u.filter(g=>!je(m).call(m,g))}else r=e;r=function(p){const m=[];return S1.forEach(g=>{je(p).call(p,g)&&m.push(g)}),m.concat(p.filter(g=>!je(S1).call(S1,g)))}(r)}else r=e;var s,a;return r};function P5(e){var t,r;if(!e&&je(t=Z("AREAS")).call(t,ln.EXTENSIONS))return O.debug("update area from ap : reset"),void x1(Kde,!0);if(!je(r=Z("AREAS")).call(r,ln.GLOBAL)||!e)return;let s=Qy.EXTENSIONS;s&&(s={CODE:D5(ln.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},O.debug("update area from ap success: ".concat(e,",config is "),s),vn("AREAS",[ln.EXTENSIONS],!0),Object.keys(s).map(a=>{a==="LOG_UPLOAD_SERVER"||a==="EVENT_REPORT_DOMAIN"||a==="EVENT_REPORT_BACKUP_DOMAIN"||a==="PROXY_SERVER_TYPE3"?vn(a,s[a][0]):vn(a,s[a])}))}function x1(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=st.reportApiInvoke(null,{name:xr.SET_AREA,options:e,tag:sr.TRACER});try{let s=[];if(typeof e=="string"&&(s=[e]),Array.isArray(e)&&(e.forEach(l=>{if(!je(e5).call(e5,l))throw new me($.INVALID_PARAMS,"invalid area code")}),s=e),Object.prototype.toString.call(e)==="[object Object]"){const{areaCode:l,excludedArea:u}=e;if(!l)throw new me($.INVALID_PARAMS,"area code is needed");let p=l;typeof l=="string"&&(p=[l]),s=u?Uue(p,u):p}if(!t){if(ac.AREAS){const l=new me($.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return r.onError(l),void O.warning("setArea is prohibited because of config-distribute")}if(je(s).call(s,ln.GLOBAL)&&Z("AREAS")===ln.EXTENSIONS){const l=new me($.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return r.onError(l),void O.warning("setArea is prohibited because of ap extensions")}}vn("AREAS",s,t);const a=jue(s);Object.keys(a).map(l=>{l==="LOG_UPLOAD_SERVER"||l==="EVENT_REPORT_DOMAIN"||l==="EVENT_REPORT_BACKUP_DOMAIN"||l==="PROXY_SERVER_TYPE3"?vn(l,a[l][0]):vn(l,a[l])}),O.debug("set area success:",s.join(","))}catch(s){throw r.onError(s),s}r.onSuccess()}function k5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function el(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let T1=1;function Fue(e,t,r,s,a){T1+=1;const l={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Date.now()/1e3),seq:T1,requestId:T1,version:zo,cname:r.cname},u={service_name:t,json_body:JSON.stringify(l)};let p,m,g=e[0];return oc(async()=>{p=Date.now();const E=await uc(g,{data:u,cancelToken:s,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(m=Date.now()-p,E.code!==0){const C=new me($.UNEXPECTED_RESPONSE,"live streaming ap error, code"+E.code,{retry:!0,responseTime:m});throw O.error(C.toString()),C}const y=JSON.parse(E.json_body);if(y.code!==200){const C=new me($.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(y.code,", reason: ").concat(y.reason),{code:y.code,responseTime:m});throw O.error(C.toString()),C}if(!y.servers||y.servers.length===0){const C=new me($.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:y.code,responseTime:m});throw O.error(C.toString()),C}const b=function(C,B){return{addressList:C.servers.map(M=>"wss://".concat(M.address.replace(/\./g,"-"),".").concat(Z("WORKER_DOMAIN"),":").concat(M.wss,"?serviceName=").concat(encodeURIComponent(B))),workerToken:C.workerToken,vid:C.vid}}(y,t);return Z("LIVE_STREAMING_ADDRESS")&&(b.addressList=Z("LIVE_STREAMING_ADDRESS")instanceof Array?Z("LIVE_STREAMING_ADDRESS"):[Z("LIVE_STREAMING_ADDRESS")]),el(el({},b),{},{responseTime:m})},(E,y)=>(st.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(E.addressList),firstSuccess:y===0,responseTime:m,serverIp:e[y%e.length]}),!1),(E,y)=>(st.apworkerEvent(r.sid,{success:!1,sc:E.data&&E.data.code||200,serviceName:t,responseTime:m,serverIp:e[y%e.length]}),!!(E.code!==$.OPERATION_ABORTED&&E.code!==$.UNEXPECTED_RESPONSE||E.data&&E.data.retry)&&(g=e[(y+1)%e.length],!0)),a)}let b1=1;function L5(e,t,r,s){let{url:a,areaCode:l}=e;const{clientId:u,sid:p}=t,m=Date.now();let g;const E=t.role,[y,b]=C1(t,l,[br.CHOOSE_SERVER]);let C=Tr.networkState;return oc(async()=>{C&&Tr.networkState===Qs.OFFLINE&&Tr.onlineWaiter&&await Ye.race([Tr.onlineWaiter,ai(s&&s.maxRetryTimeout||Rr.maxRetryTimeout)]),C=Tr.networkState;const{data:B,headers:M}=await uc(a,{data:y,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);g=M.http3==="1"?1:-1,st.reportResourceTiming(a,p),j5(B,a,t,m,[br.CHOOSE_SERVER],g);const F=vg(B,br.CHOOSE_SERVER);return w1(F),f1(F,a)},B=>(B&&st.joinChooseServer(p,{role:E,lts:m,succ:!0,csAddr:a,opid:b,serverList:B.gatewayAddrs.map(M=>M.address),ec:null,cid:B.cid.toString(),uid:B.uid.toString(),csIp:B.csIp,unilbsServerIds:[br.CHOOSE_SERVER].toString(),isHttp3:g,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:B.res.detail&&B.res.detail[38]}),!1),B=>B.code!==$.OPERATION_ABORTED&&(B.code===$.CAN_NOT_GET_GATEWAY_SERVER?B.data.retry:(st.joinChooseServer(p,{role:E,lts:m,succ:!1,csAddr:a,serverList:null,opid:b,ec:B.code,csIp:B.data&&B.data.csIp,unilbsServerIds:[br.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:C}),isHttp3:g,corssRegionTagReq:t.apRequestDetail}),O.warning("[".concat(u||"sid-".concat(p.slice(0,6)),"] Choose server network error, retry"),B),!0)),s)}function M5(e,t,r,s){let a,{url:l,areaCode:u,serviceIds:p}=e;const m=Date.now(),g=t.role,[E,y]=C1(t,u,p);let b;return oc(async()=>{b&&Tr.networkState===Qs.OFFLINE&&Tr.onlineWaiter&&await Ye.race([Tr.onlineWaiter,ai(s&&s.maxRetryTimeout||Rr.maxRetryTimeout)]),b=Tr.networkState;const{data:C,headers:B}=await uc(l,{data:E,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);a=B.http3==="1"?1:-1,st.reportResourceTiming(l,t.sid),j5(C,l,t,m,p,a);const M=vg(C,br.CHOOSE_SERVER),F=vg(C,t.cloudProxyServer==="proxy5"?br.CLOUD_PROXY_5:t.cloudProxyServer==="proxy3"||t.cloudProxyServer==="proxy4"?br.CLOUD_PROXY:br.CLOUD_PROXY_FALLBACK);return w1(M),{gatewayInfo:f1(M,l),proxyInfo:F,url:l}},C=>(C.gatewayInfo&&st.joinChooseServer(t.sid,{role:g,lts:m,succ:!0,csAddr:l,serverList:C.gatewayInfo.gatewayAddrs.map(B=>B.address),ec:null,opid:y,cid:C.gatewayInfo.cid.toString(),uid:C.gatewayInfo.uid.toString(),csIp:C.gatewayInfo.csIp,unilbsServerIds:p.toString(),isHttp3:a,corssRegionTagReq:t.apRequestDetail,corssRegionTagRes:C.gatewayInfo.res.detail&&C.gatewayInfo.res.detail[38]}),C.proxyInfo&&st.joinWebProxyAP(t.sid,{lts:m,sucess:1,apServerAddr:l,turnServerAddrList:C.proxyInfo.addresses.map(B=>B.ip).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:p.toString()}),!1),C=>C.code!==$.OPERATION_ABORTED&&(C.code===$.CAN_NOT_GET_GATEWAY_SERVER?C.data.retry:(st.joinWebProxyAP(t.sid,{lts:m,sucess:0,apServerAddr:l,turnServerAddrList:null,errorCode:C.code,eventType:t.cloudProxyServer,unilbsServerIds:p.toString(),extend:JSON.stringify({networkState:b})}),O.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),C),!0)),s)}const j5=(e,t,r,s,a,l)=>{const{sid:u,clientId:p,cloudProxyServer:m}=r,g=[],E=y=>{y.flag===4096?st.joinChooseServer(u,{role:r.role,lts:s,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:y.error.message,csIp:y.error.data&&y.error.data.csIp,unilbsServerIds:a.toString(),isHttp3:l,corssRegionTagReq:r.apRequestDetail}):y.flag!==1048576&&y.flag!==4194304&&y.flag!==4194310||st.joinWebProxyAP(u,{lts:s,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:y.error.code,eventType:m,unilbsServerIds:a.toString()})};if(e.response_body.forEach(y=>{const b=y.buffer.code;if(y.uri===23&&b===0&&!y.buffer.edges_services)if(y.buffer.flag===4194310)O.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),y.buffer.edges_services=[];else{const C={error:new me($.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:y.buffer.flag};g.push(C),E(C)}if(b!==0){const C=Df(b),B={error:new me($.CAN_NOT_GET_GATEWAY_SERVER,C.desc,{desc:C.desc,retry:C.retry,csIp:e.detail[502]}),flag:y.buffer.flag};y.buffer.flag===4194310?O.warning(B.error.toString()):g.push(B),E(B)}}),g.length)throw O.warning("[".concat(p||"sid-".concat(u.slice(0,6)),"] multi unilbs ").concat(t," failed, ").concat(g.map(y=>"flag: ".concat(y.flag,", message: ").concat(y.error.message,", retry: ").concat(y.error.data.retry)).join(" | "))),new me($.CAN_NOT_GET_GATEWAY_SERVER,g.map(y=>"flag: ".concat(y.flag,", message: ").concat(y.error.message)).join(" | "),{retry:!!g.find(y=>y.error.data.retry),csIp:e.detail[502],desc:[...new Set(g.map(y=>{var b;return y==null||(b=y.error)===null||b===void 0||(b=b.data)===null||b===void 0?void 0:b.desc}).filter(y=>!!y))]})},w1=e=>{var t,r,s,a;if(e.addresses&&e.addresses.length===0&&e.code===0)throw new me($.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(Z("AP_AREA")&&((s=e.detail)!==null&&s!==void 0&&s[23]&&typeof((a=e.detail)===null||a===void 0?void 0:a[23])=="string"?P5(e.detail[23].toLowerCase()):P5()),(t=e.detail)!==null&&t!==void 0&&t[19]&&typeof((r=e.detail)===null||r===void 0?void 0:r[19])=="string"){const u=e.detail[19],p=u==null?void 0:u.split(";");for(let m=0;m<p.length;m++){var l;const g=zi(l=p[m]).call(l);e.addresses[m]&&p&&(e.addresses[m].fingerprint=g)}}if(Z("GATEWAY_ADDRESS")&&Z("GATEWAY_ADDRESS").length>0){O.debug("assign gateway address to",Z("GATEWAY_ADDRESS"));const u=Z("GATEWAY_ADDRESS").map(p=>{var m,g;const E=(m=(g=e.addresses.find(y=>y.ip===p.ip&&y.port===p.port))===null||g===void 0?void 0:g.fingerprint)!==null&&m!==void 0?m:"";return{ip:p.ip,port:p.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:E}});e.addresses=u}},Vue=(e,t)=>{if(e.response_body&&e.response_body.length){const r=e.response_body[0];if(r.buffer.code!==0){const s=Df(r.buffer.code);throw new me($.UPDATE_TICKET_FAILED,"[".concat(r.buffer.code,"]: ").concat(s.desc),{retry:s.retry})}return r.buffer.ticket}throw O.debug("update ticket request received ap response without response body:",t),new me($.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},C1=(e,t,r)=>{const s=Math.floor(Math.random()*1e12),a=e.role==="host"?"1":e.role==="audience"?"2":void 0,l={appid:e.appId,client_ts:Date.now(),opid:s,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:el(el(el({6:e.stringUid,11:t,12:Z("USE_NEW_TOKEN")?"1":void 0},a?{17:a}:{}),{},{22:t},e.apRequestDetail?{33:e.apRequestDetail}:{}),e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:r,uid:e.uid||0}}]};l.request_bodies.forEach(p=>{e.multiIP&&e.multiIP.gateway_ip&&(p.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const u=new FormData;return u.append("request",JSON.stringify(l)),[u,s]},Bue=(e,t)=>{const r=Math.floor(Math.random()*1e12),s={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map(l=>({ip:l.ip,port:l.port}))}}]},a=new FormData;return a.append("request",JSON.stringify(s)),[a,r]};let Mf=0;function jf(e){return Ye.all(e.map(t=>t.then(r=>{throw r},r=>r))).then(t=>{throw t},t=>t)}const bg=async e=>{let{fragementLength:t,referenceList:r,asyncMapHandler:s,allFailedhandler:a,promisesCollector:l}=e,u=0;const p=t;let m,g=0;const E=async()=>{const y=(()=>{const b=u*p,C=b+p;return r.slice(b,C).map(s)})();l&&l.push(...y);try{m=await jf(y)}catch(b){if(g+=p,u++,!(g>=r.length))return void await E();a(b)}y.forEach(b=>b.cancel())};return await E(),m},U5=async e=>{let{referenceList:t,asyncMapHandler:r,closeFn:s}=e;const a=t.length;let l=0;const u=async()=>{const p=r(t.shift());try{return await p}catch(m){if(l++,l>=a||s!=null&&s(m))throw m;return u()}};return u()};async function R1(e,t,r,s){return{gatewayInfo:await async function(l,u,p,m){let g=null;const E=[],y=async()=>{const C=Z("WEBCS_DOMAIN").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(F=>({url:l.proxyServer?"https://".concat(l.proxyServer,"/ap/?url=").concat(F+"/api/v2/transpond/webrtc?v=2"):"https://".concat(F,"/api/v2/transpond/webrtc?v=2"),areaCode:Tg()})),B=m.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(F=>F.url)}),M=await bg({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:F=>(O.debug("[".concat(l.clientId,"] Connect to choose_server:"),F.url),L5(F,l,u,p)),allFailedhandler:F=>{throw m.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:E});return m.recordJoinChannelService({endTs:Date.now(),status:"success"},B),M},b=async()=>{if(await ai(1e3),g!==null)return g;const C=Z("WEBCS_DOMAIN_BACKUP_LIST").map(F=>({url:l.proxyServer?"https://".concat(l.proxyServer,"/ap/?url=").concat(F+"/api/v2/transpond/webrtc?v=2"):"https://".concat(F,"/api/v2/transpond/webrtc?v=2"),areaCode:Tg()})),B=m.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(F=>F.url)}),M=await bg({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:F=>(O.debug("[".concat(l.clientId,"] Connect to backup choose_server:"),F.url),L5(F,l,u,p)),allFailedhandler:F=>{throw m.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:E});return m.recordJoinChannelService({endTs:Date.now(),status:"success"},B),M};try{return g=await jf([y(),b()]),E.length&&E.forEach(C=>C.cancel&&typeof C.cancel=="function"&&C.cancel()),g}catch(C){throw C[0]}}(e,t,r,s)}}async function F5(e,t,r,s,a){const l=e.cloudProxyServer;if(l==="disabled"){if(!s)return;if(e.useLocalAccessPoint)return await R1(e,t,r,a);if(Z("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:b,proxyInfo:C}=await W5(e,t,r,a);if(e.turnServer&&e.turnServer.mode!=="auto")return{gatewayInfo:b};const B=C.map(M=>({turnServerURL:M.address,tcpport:M.tcpport||xi.tcpport,udpport:M.udpport||xi.udpport,username:M.username||xi.username,password:M.password||xi.password,forceturn:!1,security:!0}));if(a.useP2P){var u;const M=(u=e.uid)!==null&&u!==void 0?u:b.uid,F="glb:".concat(M.toString()),q=await EA(F),Y=C.map(re=>({turnServerURL:re.address,tcpport:re.tcpport||xi.tcpport,udpport:re.udpport||xi.udpport,username:F,password:q,forceturn:!1,security:!0}));B.push(...Y)}return e.turnServer={mode:"manual",servers:B},{gatewayInfo:b}}return await R1(e,t,r,a)}const{proxyInfo:p,gatewayInfo:m}=await W5(e,t,r,a),g={gatewayInfo:m},E=p.map(b=>({turnServerURL:b.address,tcpport:l==="proxy3"?void 0:b.tcpport?b.tcpport:xi.tcpport,udpport:l==="proxy4"?void 0:b.udpport?b.udpport:xi.udpport,username:b.username||xi.username,password:b.password||xi.password,forceturn:l!=="proxy4",security:l==="proxy5"}));if(a.useP2P){var y;const b=(y=e.uid)!==null&&y!==void 0?y:m.uid,C="glb:".concat(b.toString()),B=await EA(C),M=p.map(F=>({turnServerURL:F.address,tcpport:l==="proxy3"?void 0:F.tcpport||xi.tcpport,udpport:l==="proxy4"?void 0:F.udpport||xi.udpport,username:C,password:B,forceturn:l!=="proxy4",security:l==="proxy5"}));E.push(...M)}return e.turnServer={mode:"manual",servers:E},O.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(l)),g}async function V5(e,t,r,s,a){const l=Z("ACCOUNT_REGISTER").slice(0,Z("AJAX_REQUEST_CONCURRENT"));let u=[];u=t.proxyServer?l.map(m=>"https://".concat(t.proxyServer,"/ap/?url=").concat(m+"/api/v1")):l.map(m=>"https://".concat(m,"/api/v1"));const p=a==null?void 0:a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:u});try{const m=await async function(g,E,y,b,C){const B=Date.now(),M={sid:y.sid,opid:10,appid:y.appId,string_uid:E};let F=g[0];const q=await oc(()=>uc(F+"".concat(F.indexOf("?")===-1?"?":"&","action=stringuid"),{data:M,cancelToken:b,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(Y,re)=>{if(Y.code===0){if(Y.uid<=0||Y.uid>=Math.pow(2,32))throw O.error("Invalid Uint Uid ".concat(E," => ").concat(Y.uid),Y),st.reqUserAccount(M.sid,{lts:B,success:!1,serverAddr:F,stringUid:M.string_uid,uid:Y.uid,errorCode:$.INVALID_UINT_UID_FROM_STRING_UID,extend:M}),new me($.INVALID_UINT_UID_FROM_STRING_UID);return st.reqUserAccount(M.sid,{lts:B,success:!0,serverAddr:F,stringUid:M.string_uid,uid:Y.uid,errorCode:null,extend:M}),!1}const ce=Df(Y.code);return ce.retry&&(F=g[(re+1)%g.length]),st.reqUserAccount(M.sid,{lts:B,success:!1,serverAddr:F,stringUid:M.string_uid,uid:Y.uid,errorCode:ce.desc,extend:M}),ce.retry},(Y,re)=>Y.code!==$.OPERATION_ABORTED&&(st.reqUserAccount(M.sid,{lts:B,success:!1,serverAddr:F,stringUid:M.string_uid,uid:null,errorCode:Y.code,extend:M}),F=g[(re+1)%g.length],!0),C);if(q.code!==0){const Y=Df(q.code);throw new me($.UNEXPECTED_RESPONSE,Y.desc)}return q}(u,e,t,r,s);return a==null||a.recordJoinChannelService({status:"success",endTs:Date.now()},p),m.uid}catch(m){throw a==null||a.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[m]},p),m}}async function Wue(e,t,r){const s=Z("ACCOUNT_REGISTER");let a=[];a=t.proxyServer?s.map(l=>"https://".concat(t.proxyServer,"/ap/?url=").concat(l+"/api/v1")):s.map(l=>"https://".concat(l,"/api/v1"));try{return await U5({referenceList:a,asyncMapHandler:u=>async function(p,m,g,E){const y=Date.now(),b={sid:g.sid,opid:10,appid:g.appId,string_uid:m};try{const C=await uc(p+"".concat(p.indexOf("?")===-1?"?":"&","action=stringuid"),{data:b,cancelToken:E,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(C.code!==0){const B=Df(C.code);throw new me($.UNEXPECTED_RESPONSE,"preload sua error:".concat(B.desc),B)}if(C.uid<=0||C.uid>=Math.pow(2,32))throw new me($.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:y,url:p,req:b,uid:C.uid,elapse:Date.now()-y}}catch(C){throw C}}(u,e,t,r),closeFn:u=>u.code===$.OPERATION_ABORTED||u.code===$.UNEXPECTED_RESPONSE&&!u.data.retry})}catch(l){throw l}}async function Hue(e,t,r){const s=Z("CDS_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(m=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(m+"/api/v1"):"https://".concat(m,"/api/v1?action=config")),a=s.map(m=>function(g,E,y,b){const C=en(),B={flag:64,cipher_method:0,features:el(el(el(el(el({install_id:IA(),device:C.name,system:C.os,system_general:navigator.userAgent,vendor:E.appId,version:zo,cname:E.cname,session_id:E.sid,proxyServer:E.proxyServer,sdk_type:kue.WEB_RTC,browser_name:C.name,browser_version:C.version,user_agent:navigator.userAgent,channel_name:E.cname},E.stringUid&&{string_uid:E.stringUid}),E.uid&&{uid:E.uid+""}),C.os&&{os_name:C.os}),C.osVersion&&{os_version:C.osVersion}),{},{detail:""})};return oc(()=>uc(g,{data:B,timeout:1e3,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,M=>M.code!==$.OPERATION_ABORTED,b)}(m,e,t,r));let l=null,u=null,p={};try{l=await jf(a)}catch(m){if(m.code===$.OPERATION_ABORTED)throw m;u=m}if(a.forEach(m=>m.cancel()),st.reportApiInvoke(e.sid,{name:xr.REQUEST_CONFIG_DISTRIBUTE,options:{error:u,res:l}}).onSuccess(),l&&l.test_tags)try{p=function(m){if(!m.test_tags)return{};const g=m.test_tags,E=Object.keys(g),y={};return E.forEach(b=>{var C;const B=zi(C=b.slice(4)).call(C),M=JSON.parse(g[b]),F=M[1];y[B]={tag:M[0]||"",value:F}}),y}(l)}catch{}return p}async function B5(e,t){const r=Z("WEBCS_DOMAIN").concat(Z("WEBCS_DOMAIN_BACKUP_LIST")).map(s=>({url:"https://".concat(s,"/api/v2/transpond/webrtc?v=2"),areaCode:Tg(),serviceIds:[br.CHOOSE_SERVER,br.CLOUD_PROXY_FALLBACK]}));try{return await U5({referenceList:r,asyncMapHandler:a=>async function(l,u,p){let m,{url:g,areaCode:E,serviceIds:y}=l;const b=Date.now(),[C,B]=C1(u,E,y);let M=Tr.networkState;try{M&&Tr.networkState===Qs.OFFLINE&&Tr.onlineWaiter&&await Ye.race([Tr.onlineWaiter,ai(Rr.maxRetryTimeout)]),M=Tr.networkState;const{data:F,headers:q}=await uc(g,{data:C,cancelToken:p,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);m=q.http3==="1"?1:-1,(le=>{const ae=[];if(le.response_body.forEach(_e=>{const we=_e.buffer.code;if(_e.uri===23&&we===0&&!_e.buffer.edges_services)if(_e.buffer.flag===4194310)_e.buffer.edges_services=[];else{const Be={error:new me($.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:le.detail[502]}),flag:_e.buffer.flag};ae.push(Be)}if(we!==0){const Be=Df(we),Xe={error:new me($.CAN_NOT_GET_GATEWAY_SERVER,Be.desc,{desc:Be.desc,retry:Be.retry,csIp:le.detail[502]}),flag:_e.buffer.flag};_e.buffer.flag===4194310?O.warning(Xe.error.toString()):ae.push(Xe)}}),ae.length)throw new me($.CAN_NOT_GET_GATEWAY_SERVER,ae.map(_e=>"flag: ".concat(_e.flag,", message: ").concat(_e.error.message)).join(" | "),{retry:!!ae.find(_e=>_e.error.data.retry),csIp:le.detail[502],desc:[...new Set(ae.map(_e=>{var we;return _e==null||(we=_e.error)===null||we===void 0||(we=we.data)===null||we===void 0?void 0:we.desc}).filter(_e=>!!_e))]})})(F);const re=vg(F,br.CHOOSE_SERVER),ce=vg(F,br.CLOUD_PROXY_FALLBACK);return w1(re),{gatewayInfo:f1(re,g),proxyInfo:ce,opid:B,requestTime:b,url:g,isHttp3:m,elapse:Date.now()-b}}catch(F){throw F}}(a,e,t),closeFn:a=>a.code===$.OPERATION_ABORTED||a.code===$.CAN_NOT_GET_GATEWAY_SERVER&&!a.data.retry})}catch(s){throw s}}async function W5(e,t,r,s){const a=Z("PROXY_SERVER_TYPE3"),l=(C,B,M)=>{let F=M||a;return Array.isArray(F)&&(F=B%2==0?a[1]:a[0]),"https://".concat(F,"/ap/?url=").concat(C)};let u=null;const p=[],m=async()=>{const C=Z("WEBCS_DOMAIN").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map((F,q)=>{let Y;return Y=e.cloudProxyServer==="disabled"&&e.proxyServer?l("".concat(F,"/api/v2/transpond/webrtc?v=2"),q,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(F,"/api/v2/transpond/webrtc?v=2"):l("".concat(F,"/api/v2/transpond/webrtc?v=2"),q),{url:Y,areaCode:Tg(),serviceIds:[br.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?br.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?br.CLOUD_PROXY:br.CLOUD_PROXY_FALLBACK]}}),B=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(F=>F.url)}),M=await bg({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:F=>(O.debug("[".concat(e.clientId,"] Connect to choose_server:"),F.url),M5(F,e,t,r)),allFailedhandler:F=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:p});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},B),M},g=async()=>{if(await ai(1e3),u!==null)return u;const C=Z("WEBCS_DOMAIN_BACKUP_LIST").map((F,q)=>{let Y;return Y=e.cloudProxyServer==="disabled"&&e.proxyServer?l("".concat(F,"/api/v2/transpond/webrtc?v=2"),q,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(F,"/api/v2/transpond/webrtc?v=2"):l("".concat(F,"/api/v2/transpond/webrtc?v=2"),q),{url:Y,areaCode:Tg(),serviceIds:[br.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?br.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?br.CLOUD_PROXY:br.CLOUD_PROXY_FALLBACK]}}),B=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:C.map(F=>F.url)}),M=await bg({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:C,asyncMapHandler:F=>(O.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),F.url),M5(F,e,t,r)),allFailedhandler:F=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:p});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},B),M};let E,y,b;try{({gatewayInfo:E,proxyInfo:y,url:b}=await jf([m(),g()]))}catch(C){throw C[0]}if(p.length&&p.forEach(C=>C.cancel&&typeof C.cancel=="function"&&C.cancel()),!E||!y)throw new me($.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=b,e.cloudProxyServer!=="disabled"&&Array.isArray(a)&&b){const C=/^https?:\/\/(.+?)(\/.*)?$/.exec(b)[1];je(a).call(a,C)&&(e.proxyServer=C,O.setProxyServer(C),st.setProxyServer(C))}return u={gatewayInfo:E,proxyInfo:await h5(y,E.uid)},u}async function Gue(e,t,r){const s=Z("UAP_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(l=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(l+"/api/v1?action=uap"):"https://".concat(l,"/api/v1?action=uap")),a=s.map(l=>function(u,p,m,g){const E={command:"convergeAllocateEdge",sid:p.sid,appId:p.appId,token:p.token,ts:Date.now(),version:zo,cname:p.cname,uid:p.uid.toString(),requestId:b1,seq:b1};b1+=1;const y={service_name:"tele_channel",json_body:JSON.stringify(E)};return oc(async()=>{const b=await uc(u,{data:y,cancelToken:m,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(b.code!==0){const B=new me($.UNEXPECTED_RESPONSE,"cross channel ap error, code"+b.code,{retry:!0});throw O.error(B.toString()),B}const C=JSON.parse(b.json_body);if(C.code!==200){const B=new me($.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(C.code,", reason: ").concat(C.reason));throw O.error(B.toString()),B}if(!C.servers||C.servers.length===0){const B=new me($.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw O.error(B.toString()),B}return{vid:C.vid,workerToken:C.workerToken,addressList:(Z("CHANNEL_MEDIA_RELAY_SERVERS")||C.servers).map(B=>"wss://".concat(B.address.replace(/\./g,"-"),".").concat(Z("WORKER_DOMAIN"),":").concat(B.wss))}},void 0,b=>!!(b.code!==$.OPERATION_ABORTED&&b.code!==$.UNEXPECTED_RESPONSE||b.data&&b.data.retry),g)}(l,e,t,r));try{const l=await jf(a);return a.forEach(u=>u.cancel()),l}catch(l){throw l[0]}}async function zue(e,t,r){let s=null;const a=[],l=async u=>{const p=Z(u?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(m=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(m+"/api/v2/transpond/webrtc?v=2"):"https://".concat(m,"/api/v2/transpond/webrtc?v=2"));return u&&(await ai(1e3),s!==null)?s:await bg({fragementLength:Z("FRAGEMENT_LENGTH"),referenceList:p,asyncMapHandler:m=>(O.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(u?"backup":""," choose_server:"),m),function(g,E,y,b){const[C]=Bue(E,[br.CHOOSE_SERVER]);let B=Tr.networkState;return oc(async()=>{B&&Tr.networkState===Qs.OFFLINE&&Tr.onlineWaiter&&await Ye.race([Tr.onlineWaiter,ai(b&&b.maxRetryTimeout||Rr.maxRetryTimeout)]),B=Tr.networkState;const M=await uc(g,{data:C,cancelToken:y,headers:{"Content-Type":"multipart/form-data;"}},!0);return Vue(M,g)},()=>!1,M=>M.code!==$.OPERATION_ABORTED&&(M.code===$.UPDATE_TICKET_FAILED?M.data.retry:(O.warning("[".concat(E.clientId,"] update ticket network error, retry"),M),!0)),b)}(m,e,t,r)),allFailedhandler:m=>{throw m[0]},promisesCollector:a})};try{return s=await jf([l(!1),l(!0)]),a.length&&a.forEach(u=>u.cancel&&typeof u.cancel=="function"&&u.cancel()),s}catch(u){throw u[0]}}function H5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function A1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class Kue extends Zn{get isSuccess(){return!!this.configs}constructor(t,r){super(),z(this,"configs",void 0),z(this,"store",void 0),z(this,"joinInfo",void 0),z(this,"cancelToken",void 0),z(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),z(this,"interval",void 0),z(this,"mutex",void 0),z(this,"mutableParamsRead",!1),z(this,"configCache",{}),z(this,"limit_bitrate",void 0),this.mutex=new Ai("config-distribute",t),this.store=r}startGetConfigDistribute(t,r){this.joinInfo=t,this.cancelToken=r,this.interval&&this.stopGetConfigDistribute(),Z("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},Z("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,st.reportApiInvoke(null,{options:void 0,name:xr.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:sr.TRACER}).onSuccess(JSON.stringify(ac))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void O.debug("[config-distribute] get config distribute interrupted have no joininfo");let t;const r=await this.mutex.lock();try{t=await Hue(this.joinInfo,this.cancelToken,this.retryConfig),O.debug("[config-distribute] get config distribute",JSON.stringify(t));const s=function(a){var l;const u=th(l=Object.keys(a).filter(g=>/^webrtc_ng_global_parameter/.test(g))).call(l);for(let g=0;g<u.length;g++)for(let E=u.length-1;E>g;E--){const y=u[E],b=a[y].value;if(typeof b.__priority=="number"){const C=b.__priority,B=u[E-1],M=a[B].value;if(typeof M.__priority=="number"){if(!(C>M.__priority))continue;{const F=y;u[E]=u[E-1],u[E-1]=F}}else{const F=y;u[E]=u[E-1],u[E-1]=F}}}const p=Date.now();let m={};return u.forEach(g=>{const E=a[g].value.__expires;E&&E<=p||(m[g]=a[g])}),m}(t);this.cacheGlobalParameterConfig(s),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=s}catch(s){const a=new me($.NETWORK_RESPONSE_ERROR,s);O.warning("[config-distribute] ".concat(a.toString()))}finally{r()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(t){t5(t)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==t.id&&this.emit(gg.UPDATE_BITRATE_LIMIT,t):this.emit(gg.UPDATE_BITRATE_LIMIT,t))}getLowStreamConfigDistribute(){return this.limit_bitrate&&A1({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(t){try{const r={},s=Object.keys(t),a=[];s.forEach(l=>{const u=t[l].value;r[l]=u;const p=u.__id;if(p&&this.configCache[l]&&this.configCache[l].__id===p)return;const m=u.__type,g=t[l].value,E=t[l].tag;let y=0;m?m===AV.REALTIME&&(y=1):Object.keys(g).some(b=>Object.prototype.hasOwnProperty.call(kA,b)||!r1()&&Object.prototype.hasOwnProperty.call(Oy,b)?(y=1,!0):void 0),a.push({tag:E,isApplied:y,feature:l,params:JSON.stringify(u)})}),a.forEach(l=>{let{tag:u,feature:p,params:m,isApplied:g}=l;this.store.sessionId&&st.abTest(this.store.sessionId,{intSucc:1,isApplied:g,tag:u,feature:p,params:m,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=r}catch(r){O.debug("handleABTestConfigDistribute error",r)}}cacheGlobalParameterConfig(t){const r=function(a){const l={};return Object.keys(a).forEach(u=>{const p=a[u].value,m=p.__expires,g=p.__type;Object.keys(p).forEach(E=>{E==="__id"||E==="__type"||E==="__priority"||E==="__expires"||Object.prototype.hasOwnProperty.call(l,E)||(l[E]=A1(A1({value:p[E]},m&&{expires:m}),g&&{type:g}))})}),l}(t);try{var s;const a=(s=r.LIMIT_BITRATE)===null||s===void 0?void 0:s.value;delete r.LIMIT_BITRATE,a&&t5(a)&&this.handleBitrateLimit(a),this.limit_bitrate=a,this.handleGlobalParameterConfig(r),this.handleABTestConfigDistribute(t),function(p){try{const m=Date.now();Object.keys(p).forEach(g=>{const{value:E,type:y,expires:b}=p[g];b&&b<=m||((y===AV.REALTIME||Object.prototype.hasOwnProperty.call(kA,g))&&(ac[g]=E,Wn[g]=E,O.debug("Update realtime parameters from config distribute",g,E)),y||r1()||!Object.prototype.hasOwnProperty.call(Oy,g)||(ac[g]=E,Wn[g]=E,O.debug("Update gateway parameters from config distribute",g,E)))})}catch(m){O.error("Error update config immediately: ".concat(p),m.message)}}(r);const l=JSON.stringify(r),u=window.btoa(l);window.localStorage.setItem("websdk_ng_global_parameter",u),O.debug("Caching global parameters ".concat(l))}catch(a){O.error("Error caching global parameters:",a.message)}}handleGlobalParameterConfig(t){try{const r=Date.now();Object.keys(t).forEach(s=>{if(s==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(Wn,s)){const{value:a,expires:l}=t[s];if(l&&l<=r)return;(function(u,p){try{return typeof u=="object"&&typeof p=="object"&&JSON.stringify(u)===JSON.stringify(p)}catch{return!1}})(Wn[s],a)||(ac[s]=a,Wn[s]=a,this.emit(gg.UPDATE_CLIENT_ROLE_OPTIONS,a),O.debug("Updating client role options: ".concat(JSON.stringify(a))))}})}catch(r){O.error("Error handling global parameter config:",r.message)}}}class que extends Zn{constructor(){super(...arguments),z(this,"resultStorage",new Map)}setLocalAudioStats(t,r,s){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",t,this.checkAudioInputLevel(s,r)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",t,this.checkSendAudioBitrate(s,r))}setLocalVideoStats(t,r,s){this.record("SEND_VIDEO_BITRATE_TOO_LOW",t,this.checkSendVideoBitrate(s,r)),this.record("FRAMERATE_INPUT_TOO_LOW",t,this.checkFramerateInput(s,r)),this.record("FRAMERATE_SENT_TOO_LOW",t,this.checkFramerateSent(s))}setRemoteAudioStats(t,r){const s=t.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",s,this.checkAudioOutputLevel(r))}setRemoteVideoStats(t,r){const s=t.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",s,this.checkVideoDecode(r))}record(t,r,s){if(Z("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(t)||this.resultStorage.set(t,{result:[],isPrevNormal:!0});const a=this.resultStorage.get(t);if(a&&(a.result.push(s),a.result.length>=5)){var l;const u=je(l=a.result).call(l,!0);a.isPrevNormal&&!u&&this.emit("exception",G5[t],t,r),!a.isPrevNormal&&u&&this.emit("exception",G5[t]+2e3,t+"_RECOVER",r),a.isPrevNormal=u,a.result=[]}}checkAudioOutputLevel(t){return!(t.receiveBitrate>0&&t.receiveLevel===0)}checkAudioInputLevel(t,r){return r instanceof Or&&!r.isActive||!!r.muted||t.sendVolumeLevel!==0}checkFramerateInput(t,r){let s=null;r._encoderConfig&&r._encoderConfig.frameRate&&(s=Zs(r._encoderConfig.frameRate));const a=t.captureFrameRate;return!s||!a||!(s>10&&a<5||s<10&&s>=5&&a<=1)}checkFramerateSent(t){return!(t.captureFrameRate&&t.sendFrameRate&&t.captureFrameRate>5&&t.sendFrameRate<=1)}checkSendVideoBitrate(t,r){return!!r.muted||t.sendBitrate!==0}checkSendAudioBitrate(t,r){return r instanceof Or&&!r.isActive||!!r.muted||t.sendBitrate!==0}checkVideoDecode(t){return t.receiveBitrate===0||t.decodeFrameRate!==0}}const G5={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Oi=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(r.length>0){const s=r[r.length-1];return Math.round(performance.now()-s.startTime)}return 0}measureFromPublishStart(e,t){const r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(r.length>0){const s=r[r.length-1];return Math.round(performance.now()-s.startTime)}return 0}};function z5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function xh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class wg{constructor(t){z(this,"store",void 0),z(this,"onStatsException",void 0),z(this,"onUploadPublishDuration",void 0),z(this,"onStatsChanged",void 0),z(this,"onVideoCodecChanged",void 0),z(this,"localStats",new Map),z(this,"remoteStats",new Map),z(this,"updateStatsInterval",void 0),z(this,"trafficStats",void 0),z(this,"trafficStatsPeerList",[]),z(this,"uplinkStats",void 0),z(this,"exceptionMonitor",void 0),z(this,"p2pChannel",void 0),z(this,"scalabilityMode",Iy.L1T1),z(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=t,this.exceptionMonitor=new que,this.exceptionMonitor.on("exception",(r,s,a)=>{this.onStatsException&&this.onStatsException(r,s,a)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Ie.LocalAudioTrack)||xh({},FA)}getLocalVideoTrackStats(){return this.localStats.get(Ie.LocalVideoTrack)||xh({},VA)}getRemoteAudioTrackStats(t){const r=(l,u)=>{if(!this.trafficStats)return u;const p=this.trafficStats.peer_delay.find(m=>m.peer_uid===l);return p&&(u.publishDuration=p.B_ppad+(Date.now()-this.trafficStats.timestamp)),u},s={};if(t){var a;const l=(a=this.remoteStats.get(t))===null||a===void 0?void 0:a.audioStats;l&&(s[t]=r(t,l))}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{audioStats:p}]=l;p&&(s[u]=r(u,p))});return s}getRemoteNetworkQualityStats(t){const r={};if(t){var s;const a=(s=this.remoteStats.get(t))===null||s===void 0?void 0:s.networkStats;a&&(r[t]=a)}else Array.from(this.remoteStats.entries()).forEach(a=>{let[l,{networkStats:u}]=a;u&&(r[l]=u)});return r}getRemoteVideoTrackStats(t){const r=(l,u)=>{if(!this.trafficStats)return u;const p=this.trafficStats.peer_delay.find(m=>m.peer_uid===l);return p&&(u.publishDuration=p.B_ppvd+(Date.now()-this.trafficStats.timestamp)),u},s={};if(t){var a;const l=(a=this.remoteStats.get(t))===null||a===void 0?void 0:a.videoStats;l&&(s[t]=r(t,l))}else Array.from(this.remoteStats.entries()).forEach(l=>{let[u,{videoStats:p}]=l;p&&(s[u]=r(u,p))});return s}getRTCStats(){let t=0,r=0,s=0,a=0;const l=this.localStats.get(Ie.LocalAudioTrack);l&&(t+=l.sendBytes,r+=l.sendBitrate);const u=this.localStats.get(Ie.LocalVideoTrack);u&&(t+=u.sendBytes,r+=u.sendBitrate);const p=this.localStats.get(Ie.LocalVideoLowTrack);p&&(t+=p.sendBytes,r+=p.sendBitrate),this.remoteStats.forEach(g=>{let{audioStats:E,videoStats:y}=g;E&&(s+=E.receiveBytes,a+=E.receiveBitrate),y&&(s+=y.receiveBytes,a+=y.receiveBitrate)});let m=1;return this.trafficStats&&(m+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:m,SendBitrate:r,SendBytes:t,RecvBytes:s,RecvBitrate:a,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(t){this.localStats.set(t,void 0)}removeLocalStats(t){t?this.localStats.delete(t):this.localStats.clear()}addRemoteStats(t){this.remoteStats.set(t,{})}removeRemoteStats(t){t?this.remoteStats.delete(t):this.remoteStats.clear()}addP2PChannel(t){this.p2pChannel=t}updateTrafficStats(t){t.peer_delay=t.peer_delay.filter(r=>r.B_ppad!==void 0||r.B_ppvd!==void 0),t.peer_delay.filter(r=>this.trafficStatsPeerList.indexOf(r.peer_uid)===-1).forEach(r=>{var s;const a=(s=this.p2pChannel)===null||s===void 0?void 0:s.getRemoteMedia(r.peer_uid),l=a!=null&&a.videoSSRC?Oi.measureFromSubscribeStart(this.store.clientId,a.videoSSRC):0,u=a!=null&&a.audioSSRC?Oi.measureFromSubscribeStart(this.store.clientId,a.audioSSRC):0;r.B_ppad!==void 0&&r.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(r.peer_uid,r.B_ppad,r.B_ppvd,l>u?l:u),this.trafficStatsPeerList.push(r.peer_uid))}),this.trafficStats=t}updateUplinkStats(t){this.uplinkStats&&this.uplinkStats.B_fir!==t.B_fir&&O.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(t.B_fir)),this.uplinkStats=t}static isRemoteVideoFreeze(t,r,s){if(!t)return!1;const a=!!s&&r.framesDecodeFreezeTime>s.framesDecodeFreezeTime,l=!s||r.framesDecodeCount>s.framesDecodeCount;return a||!l}static isRemoteAudioFreeze(t){return!!t&&t._isFreeze()}isLocalVideoFreeze(t){return!(!t.inputFrame||!t.sentFrame)&&t.inputFrame.frameRate>5&&t.sentFrame.frameRate<3}updateLocalStats(t){Array.from(this.localStats.entries()).forEach(r=>{let[s,a]=r;switch(s){case Ie.LocalVideoTrack:case Ie.LocalVideoLowTrack:{const p=a,m=xh({},VA),g=t.getStats(),E=t.getLocalMedia(s);if(g){const y=g.videoSend.find(b=>b.ssrc===(E==null?void 0:E.ssrcs[0].ssrcId));if(y){const b=t.getLocalVideoSize(),C=t.getEncoderConfig(Ie.LocalVideoTrack);var l;(y.codec==="H264"||y.codec==="H265"||y.codec==="VP8"||y.codec==="VP9"||y.codec==="AV1X"||y.codec==="AV1")&&(m.codecType=y.codec,(p==null?void 0:p.codecType)!==y.codec&&((l=this.onVideoCodecChanged)===null||l===void 0||l.call(this,y.codec.toLocaleLowerCase()))),m.sendBytes=y.bytes,m.sendBitrate=p?8*Math.max(0,m.sendBytes-p.sendBytes):0,y.inputFrame?(m.captureFrameRate=y.inputFrame.frameRate,m.captureResolutionHeight=y.inputFrame.height,m.captureResolutionWidth=y.inputFrame.width):b&&(m.captureResolutionWidth=b.width,m.captureResolutionHeight=b.height),y.sentFrame?(m.sendFrameRate=y.sentFrame.frameRate,m.sendResolutionHeight=y.sentFrame.height,m.sendResolutionWidth=y.sentFrame.width):b&&(m.sendResolutionWidth=b.width,m.sendResolutionHeight=b.height),y.avgEncodeMs&&(m.encodeDelay=y.avgEncodeMs),C&&C.bitrateMax?m.targetSendBitrate=1e3*C.bitrateMax:y.targetBitrate&&(m.targetSendBitrate=y.targetBitrate),m.sendPackets=y.packets,m.sendPacketsLost=y.packetsLost,m.sendJitterMs=y.jitterMs,m.sendRttMs=y.rttMs,m.totalDuration=p?p.totalDuration+1:1,m.totalFreezeTime=p?p.totalFreezeTime:0,this.isLocalVideoFreeze(y)&&(m.totalFreezeTime+=1),y.scalabilityMode&&this.scalabilityMode!==y.scalabilityMode&&(O.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(y.scalabilityMode)),this.scalabilityMode=y.scalabilityMode)}this.trafficStats&&(m.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var u;this.localStats.set(s,m),((p==null?void 0:p.sendResolutionWidth)!==m.sendResolutionWidth||(p==null?void 0:p.sendResolutionHeight)!==m.sendResolutionHeight)&&((u=this.onStatsChanged)===null||u===void 0||u.call(this,"resolution",{width:m.sendResolutionWidth,height:m.sendResolutionHeight})),m&&E&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,E.track,m);break}case Ie.LocalAudioTrack:{const p=a,m=xh({},FA),g=t.getStats(),E=t.getLocalMedia(s);if(g){const y=g.audioSend.find(b=>b.ssrc===(E==null?void 0:E.ssrcs[0].ssrcId));if(y){if(y.codec!=="opus"&&y.codec!=="aac"&&y.codec!=="PCMU"&&y.codec!=="PCMA"&&y.codec!=="G722"||(m.codecType=y.codec),y.inputLevel)m.sendVolumeLevel=Math.round(32767*y.inputLevel);else{const b=t.getLocalAudioVolume();b&&(m.sendVolumeLevel=Math.round(32767*b))}m.sendBytes=y.bytes,m.sendPackets=y.packets,m.sendPacketsLost=y.packetsLost,m.sendJitterMs=y.jitterMs,m.sendRttMs=y.rttMs,m.sendBitrate=p?8*Math.max(0,m.sendBytes-p.sendBytes):0}}this.trafficStats&&(m.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Ie.LocalAudioTrack,m),m&&E&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,E.track,m);break}}})}updateRemoteStats(t){Array.from(this.remoteStats.entries()).forEach(r=>{var s,a;let[l,{videoStats:u,audioStats:p,videoPcStats:m}]=r;const g=p,E=u,y=m,b=xh({},FV),C=xh({},VV),B=xh({},Ide),{audioTrack:M,videoTrack:F,audioSSRC:q,videoSSRC:Y}=t.getRemoteMedia(l);let re;re=this.store.useP2P?t.getStats(!0):t.getStats();const ce=(s=re)===null||s===void 0?void 0:s.audioRecv.find(we=>we.ssrc===q),le=(a=re)===null||a===void 0?void 0:a.videoRecv.find(we=>we.ssrc===Y),ae=this.trafficStats&&this.trafficStats.peer_delay.find(we=>we.peer_uid===l);if(ce&&(ce.codec!=="opus"&&ce.codec!=="aac"&&ce.codec!=="PCMU"&&ce.codec!=="PCMA"&&ce.codec!=="G722"||(b.codecType=ce.codec),ce.outputLevel?b.receiveLevel=Math.round(32767*ce.outputLevel):M&&(b.receiveLevel=Math.round(32767*M.getVolumeLevel())),b.receiveBytes=ce.bytes,b.receivePackets=ce.packets,b.receivePacketsLost=ce.packetsLost,b.receivePacketsDiscarded=ce.packetsDiscarded,b.packetLossRate=b.receivePacketsLost/(b.receivePackets+b.receivePacketsLost),b.receiveBitrate=g?8*Math.max(0,b.receiveBytes-g.receiveBytes):0,b.totalDuration=g?g.totalDuration+1:1,b.totalFreezeTime=g?g.totalFreezeTime:0,b.freezeRate=b.totalFreezeTime/b.totalDuration,b.receiveDelay=ce.jitterBufferMs,b.totalDuration>10&&wg.isRemoteAudioFreeze(M)&&(b.totalFreezeTime+=1)),le){var _e;le.codec!=="H264"&&le.codec!=="H265"&&le.codec!=="VP8"&&le.codec!=="VP9"&&le.codec!=="AV1X"&&le.codec!=="AV1"||(C.codecType=le.codec),C.receiveBytes=le.bytes,C.receiveBitrate=E?8*Math.max(0,C.receiveBytes-E.receiveBytes):0,C.decodeFrameRate=le.decodeFrameRate<0?0:le.decodeFrameRate,C.renderFrameRate=le.decodeFrameRate<0?0:le.decodeFrameRate,le.outputFrame&&(C.renderFrameRate=le.outputFrame.frameRate),le.receivedFrame?(C.receiveFrameRate=le.receivedFrame.frameRate,C.receiveResolutionHeight=le.receivedFrame.height,C.receiveResolutionWidth=le.receivedFrame.width):F&&(C.receiveResolutionHeight=F._videoHeight||0,C.receiveResolutionWidth=F._videoWidth||0),le.framesRateFirefox!==void 0&&(C.receiveFrameRate=Math.round(le.framesRateFirefox)),C.receivePackets=le.packets,C.receivePacketsLost=le.packetsLost,C.packetLossRate=C.receivePacketsLost/(C.receivePackets+C.receivePacketsLost);const we=E?E.totalFreezeTime:0,Be=E?E.totalDuration:0;C.totalDuration=E?E.totalDuration+1:1,C.totalFreezeTime=(_e=le.totalFreezesDuration)!==null&&_e!==void 0?_e:we||0,C.receiveDelay=le.jitterBufferMs||0;const Xe=!!Y&&t.getRemoteVideoIsReady(Y);le.totalFreezesDuration===void 0&&F&&Xe&&wg.isRemoteVideoFreeze(F,le,y)&&(C.totalFreezeTime+=1),C.freezeRate=Math.max(0,Math.min((C.totalFreezeTime-we)/(C.totalDuration-Be),1))}ae&&(b.end2EndDelay=ae.B_ad,C.end2EndDelay=ae.B_vd,b.transportDelay=ae.B_ed,C.transportDelay=ae.B_ed,b.currentPacketLossRate=ae.B_ealr4/100,C.currentPacketLossRate=ae.B_evlr4/100,B.uplinkNetworkQuality=ae.B_punq?ae.B_punq:0,B.downlinkNetworkQuality=ae.B_pdnq?ae.B_pdnq:0),this.remoteStats.set(l,{audioStats:b,videoStats:C,videoPcStats:le,networkStats:B}),M&&this.exceptionMonitor.setRemoteAudioStats(M,b),F&&this.exceptionMonitor.setRemoteVideoStats(F,C)})}}class K5{constructor(){z(this,"destChannelMediaInfos",new Map),z(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(t){ZB(t),this.srcChannelMediaInfo=t}addDestChannelInfo(t){ZB(t),this.destChannelMediaInfos.set(t.channelName,t)}removeDestChannelInfo(t){$y(t),this.destChannelMediaInfos.delete(t)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function q5(e){if(!(e instanceof K5))return new me($.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfo();if(!t)return new me($.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(r.size===0)return new me($.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Vd{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(t,r){z(this,"uid",void 0),z(this,"_uintid",void 0),z(this,"_trust_in_room_",!0),z(this,"_trust_audio_enabled_state_",!0),z(this,"_trust_video_enabled_state_",!0),z(this,"_trust_audio_mute_state_",!0),z(this,"_trust_video_mute_state_",!0),z(this,"_audio_muted_",!1),z(this,"_video_muted_",!1),z(this,"_audio_enabled_",!0),z(this,"_video_enabled_",!0),z(this,"_audio_added_",!1),z(this,"_video_added_",!1),z(this,"_is_pre_created",!1),z(this,"_video_pre_subscribed",!1),z(this,"_audio_pre_subscribed",!1),z(this,"_trust_video_stream_added_state_",!0),z(this,"_trust_audio_stream_added_state_",!0),z(this,"_audioTrack",void 0),z(this,"_videoTrack",void 0),z(this,"_dataChannels",[]),z(this,"_audioSSRC",void 0),z(this,"_videoSSRC",void 0),z(this,"_audioOrtc",void 0),z(this,"_videoOrtc",void 0),z(this,"_cname",void 0),z(this,"_rtxSsrcId",void 0),z(this,"_videoMid",void 0),z(this,"_audioMid",void 0),this.uid=t,this._uintid=r}}function Y5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const Cg="9",X5=4e4;function J5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Vl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J5(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J5(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}var Uf=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(Uf||{});const lS=new Map;function Q5(e,t,r,s){let{scale:a}=e;if(a===0&&s===Uf.UP||a>=t.length-1&&s===Uf.DOWN)return e;let l=Vl(Vl({},e),{},{scale:s===Uf.DOWN?++a:--a});switch(r){case"maintain-framerate":l=Vl(Vl({},l),t[a].motion);break;case"maintain-resolution":l=Vl(Vl({},l),t[a].detail);break;case"balanced":l=Vl(Vl({},l),t[a].balanced)}return l}function Z5(e,t){if(t){const r={overUse:0,underUse:0,adaptationList:e6(t)};lS.set(e,r)}else lS.delete(e)}function e6(e){const t=Vl({},e),{bitrateMax:r,frameRate:s,scaleResolutionDownBy:a,bitrateMin:l}=t,{MIN_FRAME_RATE:u,MAX_THRESHOLD_FRAMERATE:p,MAX_SCALE:m,BITRATE_MIN_THRESHOLD:g,BITRATE_MAX_THRESHOLD:E,BWE_SCALE_UP_THRESHOLD:y,BWE_SCALE_DOWN_THRESHOLD:b,PERF_SCALE_DOWN_THRESHOLD:C,PERF_SCALE_UP_THRESHOLD:B,BALANCE_BITRATE_FACTOR:M,BALANCE_FRAMERATE_FACTOR:F,BALANCE_RESOLUTION_FACTOR:q,MOTION_RESOLUTION_FACTOR:Y,MOTION_BITRATE_FACTOR:re,DETAIL_FRAMERATE_FACTOR:ce,DETAIL_BITRATE_FACTOR:le}=DA,ae=Math.min(t.frameRate,p),_e=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(b,1)*r),bwe_up:r,fps_down:Math.round(Math.pow(C,1)*ae),fps_up:s},balanced:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:r,bitrateMin:l},motion:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:r,bitrateMin:l},detail:{scaleResolutionDownBy:1,frameRate:s,bitrateMax:r,bitrateMin:l}}];for(let we=1;we<=m;we++){const Be={bwe_up:Math.round(Math.pow(y,we)*r),bwe_down:Math.round(Math.pow(b,we+1)*r),fps_up:Math.round(Math.pow(B,we)*ae),fps_down:Math.round(Math.pow(C,we+1)*ae)},Xe={scaleResolutionDownBy:a/Math.pow(q,we),frameRate:Math.max(Math.round(Math.pow(F,we)*s),u),bitrateMax:Math.max(Math.round(Math.pow(M,we)*r),E),bitrateMin:Math.max(Math.round(Math.pow(M,we)*l),g)},jt={scaleResolutionDownBy:a/Math.pow(Y,we),frameRate:s,bitrateMax:Math.max(Math.round(Math.pow(re,we)*r),E),bitrateMin:Math.max(Math.round(Math.pow(re,we)*l),g)},kt={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(ce,we)*s),u),bitrateMax:Math.max(Math.round(Math.pow(le,we)*r),E),bitrateMin:Math.max(Math.round(Math.pow(le,we)*l),g)};_e.push({scale:we,threshold:Be,balanced:Xe,motion:jt,detail:kt})}return _e}function Yue(e,t,r,s,a,l){const u=lS.get(e)||{overUse:0,underUse:0,adaptationList:e6(a)},{adaptationList:p}=u;lS.set(e,u);const{OVERUSE_TIMES_THRESHOLD:m,UNDERUSE_TIMES_THRESHOLD:g}=DA,{scale:E}=s;let y,b;return typeof t=="number"&&t>0&&function(C,B,M,F){if(B>=M.length)return!1;let{threshold:{fps_down:q}}=M[B];return Z("FORCE_AG_HIGH_FRAMERATE")&&F==="maintain-framerate"&&(q=M[0].threshold.fps_down),C<q}(t,E,p,l)&&(u.overUse++,b=lg.CPU,u.overUse>m)||typeof r=="number"&&r>0&&function(C,B,M){if(B>=M.length)return!1;const{threshold:{bwe_down:F}}=M[B];return C<F}(r,E,p)&&(u.overUse++,b=lg.BANDWIDTH,u.overUse>m)?(u.overUse=0,u.underUse=0,y=Q5(s,p,l,Uf.DOWN),[y,b]):(typeof t=="number"&&t>0&&typeof r=="number"&&r>0&&function(C,B,M,F){if(B===0)return;let{threshold:{fps_up:q}}=M[B];return Z("FORCE_AG_HIGH_FRAMERATE")&&F==="maintain-framerate"&&(q=M[1].threshold.fps_up),C>q}(t,E,p,l)&&function(C,B,M){if(B===0)return;const{threshold:{bwe_up:F}}=M[B];return C>F}(r,E,p)&&(u.underUse++,u.underUse>g&&(u.overUse=0,u.underUse=0,y=Q5(s,p,l,Uf.UP),y.scale===0&&(b=lg.NONE))),[y,b])}function t6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function N1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t6(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t6(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function $ue(e){var t;return!!Z("ENABLE_AG_ADAPTATION")&&!!(e instanceof $A||je(t=e._hints).call(t,Tn.CUSTOM_TRACK))&&(!!Z("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(r){const s=en();if(s.os!==Ur.IOS||!s.osVersion)return!1;const a=s.osVersion.split(".");return Number(a[0])>=r}(14)&&XF(17,4,!0)||$F(14)&&JF(17,4,!0)))}const dS=new Map;function uS(e,t){const r=dS.get(e);if(r){const{timer:s}=r;window.clearTimeout(s),dS.delete(e)}t.qualityLimitationReason=lg.NONE,Z5(e)}function Xue(e,t){var r;let s;switch(t){case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoTrack:s=je(r=e._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalVideoLowTrack:s=gn.Low}return s}function I1(e){const t=tn();if(e.some(r=>r._bypassWebAudio))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!t.webAudioMediaStreamDest)throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function O1(e,t){I1(e);const r=t||new Or;return e.forEach(s=>r.addAudioTrack(s)),r}const Jue=!tn().supportUnifiedPlan||Z("CHROME_FORCE_PLAN_B")&&Pl();function hS(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;return Jue?(r={spec:t,store:e},Fl("PlanBConnection").create(r)):new tl(t,e)}function D1(e){return e&&(e.iceConnectionState==="disconnected"||e.iceConnectionState==="checking"||e.iceConnectionState==="failed")}function n6(e){try{if(e.iceServers)return!1;if(e.turnServer&&e.turnServer.mode!=="off"){if(og(e.turnServer.servers))return!1;if(Z("FORCE_TURN_TCP")||e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).some(t=>t.forceturn))return!0}return!1}catch{return!1}}var Jt;function r6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r6(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r6(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let tl=(Jt=class Hh extends r5{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var r;return je(r=Object.keys(Dy)).call(r,t)}))]}constructor(t,r){super(t,r),z(this,"id",An(5,"connection-")),z(this,"store",void 0),z(this,"peerConnection",void 0),z(this,"forceTurn",!1),z(this,"remoteSDP",void 0),z(this,"initialOffer",void 0),z(this,"transportEventReceiver",void 0),z(this,"statsFilter",void 0),z(this,"extension",{useXR:Z("USE_XR")}),z(this,"localCapabilities",void 0),z(this,"remoteCodecs",void 0),z(this,"localCandidateCount",0),z(this,"allCandidatesReceived",!1),z(this,"isPreallocation",!1),z(this,"preSSRCMap",new Map),z(this,"dataStreamChannelMap",new Map),z(this,"establishPromise",void 0),z(this,"recoveredDataChannelIds",[]),z(this,"currentDataChannelId",1),z(this,"supportAV1RtpSpec",!1),z(this,"mutex",void 0),z(this,"qualityLimitationReason",lg.NONE),z(this,"isFirstConnected",!1),this.store=r,this.forceTurn=n6(t),this.mutex=new Ai("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(Hh.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=NA(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,rr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(t){const r=this.preSSRCMap.get(t);if(r!==void 0){const s=this.peerConnection.getTransceivers().find(a=>a.mid===r);if(s)return{transceiver:s,track:s.receiver.track,id:r}}}async updateRemoteRTPCapabilities(t,r){if(this.remoteCodecs=r,!this.remoteSDP)return void O.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(t,r,this.store.codec)){const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}else O.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=Ud(s.sdp),l=await x5({filterRTX:!Z("USE_PUB_RTX")&&!Z("USE_SUB_RTX"),filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterVideoCodec:Z("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=iS(l),this.initialOffer=s,Z("ENABLE_SVC")&&this.store.codec=="av1"){const p=await async function(){try{const m=new RTCPeerConnection;m.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:Iy.L1T3}]});const g=await m.createOffer();if(!g.sdp)return void m.close();const E=Ps(g.sdp).mediaDescriptions[0];if(!E)return;const y=E.attributes.extmaps.find(b=>b.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return m.close(),y}catch{return}}();var t;p&&(this.supportAV1RtpSpec=!0,(t=l.send)===null||t===void 0||t.videoExtensions.push(p))}let u;return s.sdp&&C5(s.sdp)&&(u=er(l),(r=u).send&&(Pf(Ze.VIDEO,r.send.videoExtensions),Pf(Ze.AUDIO,r.send.audioExtensions)),r.recv&&(Pf(Ze.VIDEO,r.recv.videoExtensions),Pf(Ze.AUDIO,r.recv.audioExtensions)),r.sendrecv&&(Pf(Ze.VIDEO,r.sendrecv.videoExtensions),Pf(Ze.AUDIO,r.sendrecv.audioExtensions))),hc(hc({},a),{},{rtpCapabilities:u||l,offerSDP:s.sdp})}catch(s){throw new Se($.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}var r}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&C5(this.initialOffer.sdp)&&(r=t.rtpCapabilities,s=this.localCapabilities,r.send&&(tS(Ze.VIDEO,r.send.videoExtensions,s.send.videoExtensions),tS(Ze.AUDIO,r.send.audioExtensions,s.send.audioExtensions)),r.recv&&(tS(Ze.VIDEO,r.recv.videoExtensions,s.recv.videoExtensions),tS(Ze.AUDIO,r.recv.audioExtensions,s.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return er(this._localCapabilities)}get rtpCapabilities(){return er(this._rtpCapabilities)}get candidates(){return er(this._candidates)}get iceParameters(){return er(this._iceParameters)}get dtlsParameters(){return er(this._dtlsParameters)}constructor(g){let E=arguments.length>1&&arguments[1]!==void 0&&arguments[1];z(this,"sessionDesc",void 0),z(this,"_localCapabilities",void 0),z(this,"_rtpCapabilities",void 0),z(this,"_candidates",void 0),z(this,"_originCandidates",void 0),z(this,"_iceParameters",void 0),z(this,"_isUseExtmapAllowMixed",void 0),z(this,"_dtlsParameters",void 0),z(this,"setup",void 0),z(this,"currentMidIndex",void 0),z(this,"cname",void 0),z(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=E,g=er(g);const{iceParameters:y,dtlsParameters:b,candidates:C,rtpCapabilities:B,setup:M,localCapabilities:F,cname:q}=g;this._rtpCapabilities=B,this._candidates=C,this._originCandidates=er(C),this._iceParameters=y,this._dtlsParameters=b,this._localCapabilities=F,this.setup=M,this.cname=q,this.sessionDesc=this.updateRemoteRTPCapabilities(B),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(g){const E=this.candidates,y=this.dtlsParameters,b=this.iceParameters,C=this.rtpCapabilities.send;let B=this.sessionDesc.mediaDescriptions.length-1;for(let M=1;M<g;M++){const F=2*M+2e4,q=2*M+X5,{ssrcs:Y,ssrcGroups:re}=Sh([{ssrcId:F}],this.cname),{ssrcs:ce,ssrcGroups:le}=Sh([{ssrcId:q,rtx:Z("USE_SUB_RTX")?q+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:Cg,protos:["UDP","TLS","RTP","SAVPF"],fmts:C.videoCodecs.map(ae=>ae.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:b.iceUfrag,icePwd:b.icePwd,unrecognized:[],candidates:E,extmaps:C.videoExtensions,fingerprints:y.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:ce,ssrcGroups:le,rtcpFeedbackWildcards:[],payloads:C.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++B)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:Cg,protos:["UDP","TLS","RTP","SAVPF"],fmts:C.audioCodecs.map(ae=>ae.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:b.iceUfrag,icePwd:b.icePwd,unrecognized:[],candidates:E,extmaps:C.audioExtensions,fingerprints:y.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:Y,ssrcGroups:re,rtcpFeedbackWildcards:[],payloads:C.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++B)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Pd(this.sessionDesc)}send(g,E,y,b){const{ssrcs:C,ssrcGroups:B}=Sh(E,this.cname,Z("SYNC_GROUP")?y:void 0),M=this.findPreloadMediaDesc(C);if(M){if(rr()&&this.firefoxSsrcMidMap.set(C[0].ssrcId,M.attributes.mid),b&&(b.twcc||b.remb)){const F=this.sessionDesc.mediaDescriptions.indexOf(M);return this.sessionDesc.mediaDescriptions[F]=this.mungSendMediaDesc(M,b),{mid:M.attributes.mid,needExchangeSDP:!0}}return{mid:M.attributes.mid,needExchangeSDP:!1}}{const F=this.findAvailableMediaIndex(g,C);let q;return F===-1||F===1&&(vi()||function(){const Y=en();return!(Y.name!==cn.CHROME||!Y.osVersion)&&Number(Y.version)<=90}()||Z("ENABLE_ENCODED_TRANSFORM")&&Dl())||F===0&&Z("USE_SUB_RTX")||QF()?(q=this.createOrRecycleSendMedia(g,C,B,"sendonly",b),this.updateBundleMids()):(q=er(this.sessionDesc.mediaDescriptions[F]),q.attributes.direction="sendonly",q.attributes.ssrcs=C,q.attributes.ssrcGroups=B,this.sessionDesc.mediaDescriptions[F]=this.mungSendMediaDesc(q,b)),rr()&&this.firefoxSsrcMidMap.set(C[0].ssrcId,q.attributes.mid),{mid:q.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:g,needExchangeSDP:E}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:g.attributes.mid,needExchangeSDP:E}}batchSend(g){const E=g.map(C=>{let{kind:B,ssrcMsg:M,mslabel:F}=C;return this.send(B,M,F)}),y=[];let b=!1;return E.forEach(C=>{let{mid:B,needExchangeSDP:M}=C;M&&(b=!0),y.push(B)}),{mids:y,needExchangeSDP:b}}stopSending(g){const E=this.sessionDesc.mediaDescriptions.filter(y=>y.attributes.mid&&g.indexOf(y.attributes.mid)!==-1);if(E.length!==g.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");E.forEach(y=>{y.attributes.mid==="0"||rr()||QF()?y.attributes.ssrcs=[]:(y.attributes.ssrcs=[],y.attributes.direction="inactive",y.media.port="0")}),this.updateBundleMids()}mute(g){const E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===g);if(!E)throw new Error("mediaDescription not found with ".concat(g," in remote SDP when calling RemoteSDP.mute."));E.attributes.direction="inactive"}unmute(g){const E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===g);if(!E)throw new Error("mediaDescription not found with ".concat(g," in remote SDP when calling RemoteSDP.unmute."));E.attributes.direction="sendonly"}muteRemote(g){const E=this.sessionDesc.mediaDescriptions.filter(y=>je(g).call(g,y.attributes.mid||""));if(E.length!==g.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");E.forEach(y=>{y.attributes.direction="inactive"})}unmuteRemote(g){const E=this.sessionDesc.mediaDescriptions.filter(y=>je(g).call(g,y.attributes.mid||""));if(E.length!==g.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");E.forEach(y=>{y.attributes.direction="recvonly"})}receive(g,E,y,b){g.forEach((C,B)=>{this.createOrRecycleRecvMedia(C,[],"recvonly",E,y,b[B])}),this.updateBundleMids()}stopReceiving(g){const E=this.sessionDesc.mediaDescriptions.filter(y=>g.indexOf(y.attributes.mid)!==-1);if(E.length!==g.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");E.forEach(y=>{y.media.port="0",y.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(g){const E=this.sessionDesc||Ps((y=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(y?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var y;this._rtpCapabilities=g;const b=this.rtpCapabilities.send,C=this.localCapabilities.send;for(const B of E.mediaDescriptions){if(B.attributes.iceUfrag=this._iceParameters.iceUfrag,B.attributes.icePwd=this._iceParameters.icePwd,B.attributes.fingerprints=this._dtlsParameters.fingerprints,B.attributes.candidates=this._candidates,B.attributes.setup=this.setup,B.media.mediaType==="application"&&(B.attributes.sctpPort="5000"),B.media.mediaType==="video"){if(b.videoCodecs.length===0){const M=C.videoCodecs.filter(F=>{var q,Y;return(q=F.rtpMap)===null||q===void 0?void 0:je(Y=q.encodingName.toLowerCase()).call(Y,"vp8")})||[C.videoCodecs[0]];B.media.fmts=M.map(F=>F.payloadType.toString(10)),B.attributes.payloads=M,B.attributes.extmaps=[]}else if(B.media.fmts=b.videoCodecs.map(M=>M.payloadType.toString(10)),B.attributes.payloads=b.videoCodecs,B.attributes.extmaps=b.videoExtensions,Z("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:M,ssrcGroups:F}=Sh([{ssrcId:X5,rtx:Z("USE_SUB_RTX")?40001:void 0}],this.cname);B.attributes.ssrcs=M,B.attributes.ssrcGroups=F}}if(B.media.mediaType==="audio"){if(b.audioCodecs.length===0){const M=C.audioCodecs.filter(F=>{var q,Y;return(q=F.rtpMap)===null||q===void 0?void 0:je(Y=q.encodingName.toLowerCase()).call(Y,"opus")})||[C.audioCodecs[0]];B.media.fmts=M.map(F=>F.payloadType.toString(10)),B.attributes.payloads=M,B.attributes.extmaps=[]}else if(B.media.fmts=b.audioCodecs.map(M=>M.payloadType.toString(10)),B.attributes.payloads=b.audioCodecs,B.attributes.extmaps=b.audioExtensions,Lf(B),Z("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:M,ssrcGroups:F}=Sh([{ssrcId:2e4}],this.cname);B.attributes.ssrcs=M,B.attributes.ssrcGroups=F}}}return this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(g){const E=this._originCandidates.filter(b=>b.transport==="udp"),y=[];if(E.forEach(b=>{y.push($5($5({},b),{},{foundation:"tcpcandidate",priority:Number(b.priority)-1+"",transport:"tcp",port:Number(b.port)+90+""}))}),E.length!==0){switch(g){case Ii.TCP_RELAY:this._candidates=y;break;case Ii.UDP_TCP_RELAY:case Ii.RELAY:this._candidates=[...E,...y];break;default:this._candidates=E}for(const b of this.sessionDesc.mediaDescriptions)b.attributes.candidates=this.candidates}}restartICE(g){g=er(g),this._iceParameters=g,this.sessionDesc.mediaDescriptions.forEach(E=>{E.attributes.iceUfrag=g.iceUfrag,E.attributes.icePwd=g.icePwd})}predictReceivingMids(g){const E=[];for(let y=0;y<g;y++)E.push((this.currentMidIndex+y+1).toString(10));return E}findAvailableMediaIndex(g,E){return this.sessionDesc.mediaDescriptions.findIndex(y=>{const b=y.media.mediaType===g&&y.media.port!=="0"&&(y.attributes.direction==="sendonly"||y.attributes.direction==="sendrecv")&&y.attributes.ssrcs.length===0;if(rr()){if(b){const C=this.firefoxSsrcMidMap.get(E[0].ssrcId);return!(C||y.attributes.mid!=="0"&&y.attributes.mid!=="1")||!(!C||C!==y.attributes.mid)}return!1}return b})}createOrRecycleDataChannel(){for(const y of this.sessionDesc.mediaDescriptions)if(y.media.mediaType==="application")return{mediaDesc:y,needExchangeSDP:!1};this.currentMidIndex+=1;const g="".concat(this.currentMidIndex),E={media:{mediaType:"application",port:Cg,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(g),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(E),{mediaDesc:E,needExchangeSDP:!0}}createOrRecycleRecvMedia(g,E,y,b,C,B){const M=g._mediaStreamTrack.kind,F=this.rtpCapabilities.recv,q=Sg(M,F,this.localCapabilities.send,M===Ze.VIDEO?b:C),Y=M===Ze.VIDEO?F.videoExtensions:F.audioExtensions;this.currentMidIndex+=1;const re="".concat(this.currentMidIndex);let ce={media:{mediaType:M,port:Cg,protos:["UDP","TLS","RTP","SAVPF"],fmts:q.map(ae=>ae.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:Y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:E,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:q,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:y,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(re)}};ce=this.mungRecvMediaDsec(ce,g,B);const le=this.findFirstClosedMedia(M);if(le){const ae=this.sessionDesc.mediaDescriptions.indexOf(le);this.sessionDesc.mediaDescriptions[ae]=ce}else this.sessionDesc.mediaDescriptions.push(ce);return ce}updateRemoteCodec(g,E,y){const b=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(ce=>ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||"").filter(ce=>{var le;return je(le=Object.keys(Dy)).call(le,ce)}))],C=new Set(E);if(b.every(ce=>C.has(ce)))return O.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(E)),!1;const B=this._rtpCapabilities.recv.videoCodecs.filter(ce=>E.some(le=>{var ae;return je(ae=ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||"").call(ae,le)}));if(B.length===0)return O.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(b," codecs: ").concat(E)),!1;const M=[...new Set(B.map(ce=>ce.rtpMap&&ce.rtpMap.encodingName.toLowerCase()||""))];let F;if(O.debug("updateRemoteCodec, from ".concat(b," to ").concat(M)),g.length===0)F=this.sessionDesc.mediaDescriptions.filter(ce=>ce.media.mediaType==="video"&&ce.attributes.direction==="recvonly");else if(F=this.sessionDesc.mediaDescriptions.filter(ce=>ce.attributes.mid&&ce.media.mediaType==="video"&&je(g).call(g,ce.attributes.mid)&&ce.attributes.direction==="recvonly"),F.length!==g.length)return O.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(g,", codecs: ").concat(E)),!1;if(Z("USE_PUB_RTX")||Z("USE_SUB_RTX")){const ce=E1(B,this.rtpCapabilities.recv.videoCodecs);B.push(...ce)}this._rtpCapabilities.recv.videoCodecs=B;const q=this.localCapabilities.send,Y=this.rtpCapabilities.recv,re=Sg(Ze.VIDEO,Y,q,y);return F.forEach(ce=>{const le=re.map(ae=>ae.payloadType.toString(10));O.debug("updateRemoteCodec mid: ".concat(ce.attributes.mid,", from"),ce.attributes.payloads,"to",re),ce.attributes.payloads=re,ce.media.fmts=le}),!0}createOrRecycleSendMedia(g,E,y,b,C){const B=this.rtpCapabilities.send,M=g===Ze.VIDEO?B.videoCodecs:B.audioCodecs,F=g===Ze.VIDEO?B.videoExtensions:B.audioExtensions;this.currentMidIndex+=1;const q="".concat(this.currentMidIndex);let Y={media:{mediaType:g,port:Cg,protos:["UDP","TLS","RTP","SAVPF"],fmts:M.map(ce=>ce.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:F,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:E,ssrcGroups:y,rtcpFeedbackWildcards:[],payloads:M,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:b,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(q)}};Y=this.mungSendMediaDesc(Y,C);const re=this.findFirstClosedMedia(g);if(re){const ce=this.sessionDesc.mediaDescriptions.indexOf(re);this.sessionDesc.mediaDescriptions[ce]=Y}else this.sessionDesc.mediaDescriptions.push(Y);return Y}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(g=>g.media.port!=="0").map(g=>g.attributes.mid)}mungRecvMediaDsec(g,E,y){const b=er(g);return g1(b),kf(b,E),_1(b,E),y5(b),rS(b,y,this.localCapabilities.send),b}mungSendMediaDesc(g,E){const y=er(g);return rS(y,E,this.localCapabilities.recv),Lf(y),y}updateRecvMedia(g,E){const y=this.sessionDesc.mediaDescriptions.findIndex(b=>b.attributes.mid===g);if(y!==-1){const b=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[y],E);this.sessionDesc.mediaDescriptions[y]=b}}bumpMid(g){this.currentMidIndex+=g}findFirstClosedMedia(g){return this.sessionDesc.mediaDescriptions.find(E=>rr()?E.media.port==="0"&&E.media.mediaType===g:E.media.port==="0")}findPreloadMediaDesc(g){return this.sessionDesc.mediaDescriptions.find(E=>{var y;return((y=E.attributes)===null||y===void 0||(y=y.ssrcs[0])===null||y===void 0?void 0:y.ssrcId)===g[0].ssrcId})}getSSRC(g){var E;return(E=this.sessionDesc.mediaDescriptions.find(y=>y.attributes.mid===g))===null||E===void 0?void 0:E.attributes.ssrcs}}(hc(hc({},t),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),t.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const a=this.remoteSDP.toString(),l=b5(this.initialOffer.sdp,this.extension),u=this.logSDPExchange(l||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:l}),u==null||u(a),await this.peerConnection.setRemoteDescription({type:"answer",sdp:a});const p=this.peerConnection.getTransceivers()[0];if(p!=null&&p.receiver&&this.tryBindTransportEvents(p.receiver),Z("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(Z("PRELOAD_MEDIA_COUNT"));const g=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const E=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(E)}const{preSSRCs:m}=t;if(Array.isArray(m)&&m.length>0){const{mids:g}=this.remoteSDP.batchSend(m.map(E=>({kind:E.kind,ssrcMsg:[{ssrcId:E.ssrcId,rtx:E.rtx}],mslabel:E.mslabel})));g.forEach((E,y)=>{this.preSSRCMap.set(m[y].ssrcId,E)}),await xg(this.peerConnection,this.remoteSDP,this.extension),O.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(a){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(a.toString()))}var r,s}async updateRemoteConnect(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:r}=t;this.remoteSDP.updateRemoteRTPCapabilities(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:s}=t;if(Array.isArray(s)&&s.length>0){const{mids:a}=this.remoteSDP.batchSend(s.map(l=>Object.assign({},{kind:l.kind,ssrcMsg:[{ssrcId:l.ssrcId,rtx:l.rtx}],mslabel:l.mslabel})));a.forEach((l,u)=>{this.preSSRCMap.set(s[u].ssrcId,l)})}await xg(this.peerConnection,this.remoteSDP,this.extension),O.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(r.toString()))}}send(t,r,s){var a=this;return Go(function*(){const l=yield Zt(a.mutex.lock("From P2PConnection.send"));try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=[],p=eS();t.forEach(F=>{const q=a.peerConnection.addTransceiver(F._mediaStreamTrack,hc({direction:"sendonly"},F.trackMediaType==="video"&&a.supportAV1RtpSpec&&p?{sendEncodings:[{scalabilityMode:p}]}:{}));u.push(q),F._updateRtpTransceiver(q)}),rr()&&Z("SIMULCAST")===!0&&(yield Zt(a.applySimulcastForFirefox(u,t)));const m=yield Zt(a.peerConnection.createOffer()),g=a.remoteSDP.predictReceivingMids(t.length),E=a.mungSendOfferSDP(m.sdp,t,g),y=Ps(E),b=g.map(F=>{const q=y.mediaDescriptions.find(Y=>Y.attributes.mid===F);if(!q)throw new Error("Cannot extract ssrc from mediaDescription.");return _5(q,Z("USE_PUB_RTX"))});let C;try{C=yield b}catch(F){C=[],a.remoteSDP.receive(t,r,s,C);const q=a.remoteSDP.toString();throw yield Zt(a.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield Zt(a.peerConnection.setRemoteDescription({type:"answer",sdp:q})),yield Zt(a.stopSending(g,!0)),F}a.remoteSDP.receive(t,r,s,C);const B=a.remoteSDP.toString(),M=a.logSDPExchange(E,"offer","local","send");return yield Zt(a.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield Zt(a.applySimulcastEncodings(u,t)),yield Zt(a.applySendEncodings(u,t)),M==null||M(B),yield Zt(a.peerConnection.setRemoteDescription({type:"answer",sdp:B})),u.map((F,q)=>{const Y=g[q];return{localSSRC:b[q],id:Y,transceiver:F}})}catch(u){throw u instanceof Se?u:new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async createDataChannels(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(t);if(s&&s.readyState==="open")O.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const l=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof l!="number")throw new Error("create DataChannel error, because cannot get dc id");s=this.peerConnection.createDataChannel("datastream-channel",{id:l,negotiated:!0,ordered:!1,maxRetransmits:Z("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(t,s)}r.forEach(l=>{l._updateOriginDataChannel(s)});const{needExchangeSDP:a}=this.remoteSDP.sendDataChannel();if(a){const l=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:l});const u=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(u),O.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else O.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(s){throw s instanceof Se?s:new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(t){try{const r=this.dataStreamChannelMap.get(t);return r&&(r.id&&this.recoveredDataChannelIds.push(r.id),r.close()),void this.dataStreamChannelMap.delete(t)}catch(r){throw r instanceof Se?r:new Se($.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(r.toString()))}}async stopSending(t,r){const s=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const a=this.peerConnection.getTransceivers().filter(m=>t.indexOf(m.mid)!==-1);if(a.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");a.map(m=>{var g;uS(this.id+m.mid,this),m.direction="inactive",(g=m.stop)===null||g===void 0||g.call(m)});const l=await this.peerConnection.createOffer(),u=this.logSDPExchange(l.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(t);const p=this.remoteSDP.toString();u==null||u(p),await this.peerConnection.setRemoteDescription({type:"answer",sdp:p})}catch(a){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(a.toString()))}finally{s&&s()}}async receive(t,r,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(t,r,s,a);u&&(await xg(this.peerConnection,this.remoteSDP,this.extension),O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP.")));const p=this.peerConnection.getTransceivers().find(m=>m.mid===l);if(!p)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,id:l,transceiver:p}}catch(l){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:s}=this.remoteSDP.batchSend(t);return s&&(await xg(this.peerConnection,this.remoteSDP,this.extension),O.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),r.map(a=>{const l=this.peerConnection.getTransceivers().find(u=>u.mid===a);if(!l)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:l.receiver.track,id:a,transceiver:l}})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");t.forEach(l=>{Array.from(this.preSSRCMap.entries()).some(u=>{let[p,m]=u;if(m===l)return this.preSSRCMap.delete(p),!0})}),this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.mute(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(t," before remote SDP created."));this.remoteSDP.unmute(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(u=>u.mid&&t.indexOf(u.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(u=>{u.direction="inactive"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(t);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(u=>u.mid&&t.indexOf(u.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(u,p)=>{u.direction="sendonly"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(t),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(t,this.remoteCodecs,this.store.codec);const l=this.remoteSDP.toString();a==null||a(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Go(function*(){const s=yield Zt(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const a=tn().supportPCSetConfiguration,l=Z("FORCE_TURN_TCP")||r.forceTurn;if(t===Ii.RELAY&&!a)return;if(a&&!l){const y=t===Ii.RELAY?"relay":"all",b=r.peerConnection.getConfiguration();b.iceTransportPolicy!==y&&(O.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(b.iceTransportPolicy,"] to [").concat(y,"]")),b.iceTransportPolicy=y,r.peerConnection.setConfiguration(b))}r.remoteSDP.updateCandidates(t);const u=yield Zt(r.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const p=Ud(u.sdp),{remoteIceParameters:m}=yield p.iceParameters;r.remoteSDP.restartICE(m);const g=r.remoteSDP.toString(),E=r.logSDPExchange(u.sdp||"","offer","local","restartICE");r.store.descriptionStart(),yield Zt(r.peerConnection.setLocalDescription(u)),E==null||E(g),yield Zt(r.peerConnection.setRemoteDescription({type:"answer",sdp:g}))}catch(a){O.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),a)}finally{s()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const t=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(Ii.TCP_RELAY),await xg(this.peerConnection,this.remoteSDP,this.extension)}catch(r){O.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),r)}finally{t()}}close(){var t;this.peerConnection.getTransceivers().forEach(r=>{uS(this.id+r.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return hc(hc({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);const l=this.remoteSDP.toString(),u=this.logSDPExchange(a,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),u==null||u(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new Se($.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(t,r){const s=this.peerConnection.getTransceivers().filter(a=>a.mid===t);s.length===1&&(this.isVP8Simulcast(r)?rr()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const s=this.peerConnection.getTransceivers().find(a=>a.mid===r);s&&await s.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const r=t[0].transport.iceTransport,{local:s,remote:a}=r.getSelectedCandidatePair();return{local:hc(hc({},qc),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:hc(hc({},qc),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=t=>{if(t&&(t.errorCode||t.errorText)){var r;const s="code: ".concat(t.errorCode,", message: ").concat(t.errorText),a=t.port?"local: ".concat(t.port):"";O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(s,"), url: ").concat(t.url||"",", host_candidate:").concat(a)),(r=this.onICECandidateError)===null||r===void 0||r.call(this,s)}},this.peerConnection.onicegatheringstatechange=t=>{t&&t.target&&"iceGatheringState"in t.target&&O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(t.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[]};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&(og(t.turnServer.servers)?r.iceServers=t.turnServer.servers:Z("NEW_TURN_MODE")&&r.iceServers?(Z("USE_TURN_SERVER_OF_GATEWAY")?t.turnServer.serversFromGateway&&r.iceServers.push(...Hh.newTurnServerConfigToIceServers(t.turnServer.serversFromGateway)):r.iceServers.push(...Hh.newTurnServerConfigToIceServers(t.turnServer.servers)),Z("NEW_FORCE_TURN")&&(r.iceTransportPolicy="relay")):t.turnServer.mode!=="off"&&(r.iceServers&&r.iceServers.push(...Hh.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...Hh.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),Z("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),Z("ENABLE_ENCODED_TRANSFORM")&&tn().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(Md(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Z("FORCE_TURN_TCP")&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}static newTurnServerConfigToIceServers(t){const r=[];return t.forEach(s=>{const a=Z("NEW_TURN_MODE");a===1?r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=udp")}):a===2?r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=tcp")}):a===3?r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(Md(s.turnServerURL),":443?transport=tcp")}):a===4&&(r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=udp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":3478?transport=tcp")}),r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(Md(s.turnServerURL),":443?transport=tcp")}))}),r}tryBindTransportEvents(t){const r=t.transport;if(r){this.transportEventReceiver=t,r.onstatechange=()=>{var a;r!=null&&r.state&&((a=this.onDTLSTransportStateChange)===null||a===void 0||a.call(this,r.state))},r.onerror=a=>{var l;(l=this.onDTLSTransportError)===null||l===void 0||l.call(this,"error"in a?a.error:a)};const s=r.iceTransport;s&&(s.onstatechange=()=>{const a=r==null?void 0:r.iceTransport.state;var l;a&&((l=this.onICETransportStateChange)===null||l===void 0||l.call(this,a))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:a,remote:l}=s.getSelectedCandidatePair();O.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:a.type,protocol:a.protocol}),", remote ").concat(JSON.stringify({candidateType:l.type,protocol:l.protocol,address:l.address,port:l.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var s,a;if(r||(r=this.peerConnection.getSenders().find(F=>F.track===t._mediaStreamTrack)),!r)return O.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return O.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!tn().supportSetRtpSenderParameters)return O.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const l={},u={};switch(t._optimizationMode){case"motion":l.degradationPreference="maintain-framerate";break;case"detail":l.degradationPreference="maintain-resolution";break;case"balanced":l.degradationPreference="balanced"}const p=function(M,F){return M.getTransceivers().find(q=>q.sender.track===F||q.receiver.track===F)}(this.peerConnection,t._mediaStreamTrack),m=Lde(t);if($ue(t)&&p&&r&&m&&this.getLocalVideoStats&&je(s=["vp8","vp9"]).call(s,this.store.codec)){var g;const M=l.degradationPreference||(je(g=t._hints).call(g,Tn.CUSTOM_TRACK)?Z("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(F,q,Y,re,ce,le){if(uS(F,Y),ce(q),re!=="balanced"&&re!=="maintain-framerate"&&re!=="maintain-resolution")return;let ae=-1;Z5(F,q);const _e=window.setInterval(()=>{const Be=dS.get(F);if(!Z("ENABLE_AG_ADAPTATION")||!Be)return uS(F,Y),void ce(q);const Xe=le();if(Xe.sendPackets>0&&Xe.OutgoingAvailableBandwidth>0){if(ae===-1)return void(ae=Date.now());if(Date.now()-ae<1e3)return;const jt=Xe.sendFrameRate,kt=Xe.OutgoingAvailableBandwidth,[Tt,jn]=Yue(F,jt,kt,Be.adaptationConfig,q,re);jn&&(Y.qualityLimitationReason=jn),Tt&&Be.adaptationConfig.scale!==Tt.scale&&(O.debug("[".concat(F,"] applyAdaptation: ").concat(Y.qualityLimitationReason,`
           sendFps `).concat(jt,", bwe ").concat(kt,", switch from ").concat(Be.adaptationConfig.scale," to ").concat(Tt.scale," ")),Be.adaptationConfig=N1(N1({},Be.adaptationConfig),Tt),ce(Tt))}},Z("CHECK_LOCAL_STATS_INTERVAL")),we=N1({},q);dS.set(F,{timer:_e,adaptationConfig:we,originConfig:q,adaptationFunc:ce}),O.debug("[".concat(F,"] start adaptation, originConfig: ").concat(JSON.stringify(q),", degradationPreference: ").concat(re))})(this.id+p.mid,m,this,M,F=>{r&&this.updateAdaptation(r,F)},this.getLocalVideoStats.bind(this))}if(t._encoderConfig){var E;const{bitrateMax:M,frameRate:F,scaleResolutionDownBy:q}=t._encoderConfig;M&&(u.maxBitrate=1e3*M),(je(E=t._hints).call(E,Tn.LOW_STREAM)||t.isUseScaleResolutionDownBy)&&(F&&(u.maxFramerate=Zs(F)),q&&q>=1&&(u.scaleResolutionDownBy=q))}const{maxFramerate:y}=Z("ENCODER_CONFIG_LIMIT");if(y&&typeof y=="number"&&(u.maxFramerate=u.maxFramerate?Math.min(u.maxFramerate,y):y),Z("DSCP_TYPE")&&Pl()){var b;const M=Z("DSCP_TYPE");je(b=["very-low","low","medium","high"]).call(b,M)&&(u.networkPriority=M)}const C=r.getParameters(),B=(a=C.encodings)===null||a===void 0?void 0:a[0];rr()&&!B&&(l.encodings=[u]),B&&Object.assign(B,u),Object.assign(C,l),O.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(C.encodings))),await r.setParameters(C),await async function(M,F,q){try{var Y;if(!tn().supportSetRtpSenderParameters||!function(_e){return _e==="vp9"||_e==="av1"}(M)||!Z("ENABLE_SVC"))return;const re={},ce={},le=F.getParameters(),ae=(Y=le.encodings)===null||Y===void 0?void 0:Y[0];ce.scalabilityMode=eS(q),ae&&Object.assign(ae,ce),Object.assign(le,re),await F.setParameters(le),O.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(le.encodings)))}catch(re){O.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",re)}}(this.store.codec,r,Z("SVC_MODE"))}async updateAdaptation(t,r){var s,a;if(!t)return O.debug("[updateAdaptation] no rtpSender found");if(!tn().supportSetRtpSenderParameters)return O.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const l={},{bitrateMax:u,frameRate:p,scaleResolutionDownBy:m}=r;u&&(l.maxBitrate=1e3*u),p&&(l.maxFramerate=Zs(p)),m&&m>=1&&je(s=["vp8","vp9"]).call(s,this.store.codec)&&(l.scaleResolutionDownBy=m);const g=t.getParameters(),E=(a=g.encodings)===null||a===void 0?void 0:a[0];E&&Object.assign(E,l),Object.assign(g,{});try{await t.setParameters(g),O.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(g.encodings)))}catch(y){!("transport"in t)||t.transport&&t.transport.state==="connected"?this.peerConnectionState!=="connected"?O.debug("[updateAdaptation] peerConnection not connected}"):O.debug("[updateAdaptation] updateRtpSenderEncodings failed",y):O.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(t,r){try{if(!tn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let s=0;s<t.length;s++){const a=t[s],l=r[s];l instanceof Un&&!this.isVP8Simulcast(l)&&await this.updateRtpSenderEncodings(l,a.sender)}}catch{O.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,s){const a=Ps(t);return r.forEach((l,u)=>{const p=s[u],m=a.mediaDescriptions.find(g=>g.attributes.mid===p);m&&(kf(m,l),S5(m,l,this.store.codec))}),Pd(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,t,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let m=0;m<t.length;m++){var s,a,l,u,p;const g=t[m],E=r[m];if(E instanceof Un&&!je(s=E._hints).call(s,Tn.LOW_STREAM)&&(a=E._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=E._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=E._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=E._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const y={},b={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};y.encodings=[{rid:"m",active:!0,maxBitrate:b.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:b.high}];const C=g.sender.getParameters();await g.sender.setParameters(Object.assign(C,y))}}}async applySimulcastEncodings(t,r){if(!rr()&&t.length===r.length)for(let s=0;s<t.length;s++){const a=r[s];if(a instanceof Un&&this.isVP8Simulcast(a)){const l=t[s],u={},p={high:1e3*(a._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const m=l.sender.getParameters();await l.sender.setParameters(Object.assign(m,u))}}}isVP8Simulcast(t){var r,s,a,l,u;return!!(t instanceof Un&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!je(r=t._hints).call(r,Tn.LOW_STREAM)&&(s=t._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((a=t._encoderConfig)===null||a===void 0?void 0:a.bitrateMax)>200&&(l=t._scalabilityMode)!==null&&l!==void 0&&l.numSpatialLayers&&((u=t._scalabilityMode)===null||u===void 0?void 0:u.numSpatialLayers)>1)}logSDPExchange(t,r,s,a){if(Z("SDP_LOGGING"))return O.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(r," SDP during P2PConnection.").concat(a,`
`),t),r==="offer"?l=>{this.logSDPExchange(l,"answer",s==="local"?"remote":"local",a)}:void 0}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r&&r.length!==0?r[0].ssrcId:void 0}setConfiguration(t){if(tn().supportPCSetConfiguration){const r=Hh.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}},it(Jt.prototype,"updateRemoteRTPCapabilities",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"updateRemoteRTPCapabilities"),Jt.prototype),it(Jt.prototype,"connect",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"connect"),Jt.prototype),it(Jt.prototype,"updateRemoteConnect",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"updateRemoteConnect"),Jt.prototype),it(Jt.prototype,"createDataChannels",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"createDataChannels"),Jt.prototype),it(Jt.prototype,"receive",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"receive"),Jt.prototype),it(Jt.prototype,"batchReceive",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"batchReceive"),Jt.prototype),it(Jt.prototype,"stopReceiving",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"stopReceiving"),Jt.prototype),it(Jt.prototype,"muteRemote",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"muteRemote"),Jt.prototype),it(Jt.prototype,"unmuteRemote",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"unmuteRemote"),Jt.prototype),it(Jt.prototype,"muteLocal",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"muteLocal"),Jt.prototype),it(Jt.prototype,"unmuteLocal",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"unmuteLocal"),Jt.prototype),it(Jt.prototype,"close",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"close"),Jt.prototype),it(Jt.prototype,"updateEncoderConfig",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"updateEncoderConfig"),Jt.prototype),it(Jt.prototype,"updateSendParameters",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"updateSendParameters"),Jt.prototype),it(Jt.prototype,"replaceTrack",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"replaceTrack"),Jt.prototype),it(Jt.prototype,"updateAdaptation",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"updateAdaptation"),Jt.prototype),it(Jt.prototype,"getRemoteSSRC",[vs],Object.getOwnPropertyDescriptor(Jt.prototype,"getRemoteSSRC"),Jt.prototype),Jt);function vs(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const a=this.mutex,l=await a.lock("From P2PConnection.".concat(t));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},r}function P1(e,t){let r=document.createElement("video"),s=document.createElement("canvas");r.setAttribute("style","display:none"),s.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),s.width=Zs(t.width),s.height=Zs(t.height);const a=Zs(t.framerate||15);document.body.append(r),document.body.append(s);let l=e._mediaStreamTrack;r.srcObject=new MediaStream([l]),r.play();const u=s.getContext("2d");if(!u)throw new me($.UNEXPECTED_ERROR,"can not get canvas context");const p=tn(),m=s.captureStream(p.supportRequestFrame?0:a).getVideoTracks()[0];m.canvas||(m.canvas=s),s.startCapture=()=>{if(!r)return s.stopCapture&&s.stopCapture();if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){const E=r.videoWidth,y=r.videoHeight/E,b=s.width*y;Math.abs(b-s.height)>=2&&(O.debug("adjust low stream resolution","".concat(s.width,"x").concat(s.height," -> ").concat(s.width,"x").concat(b)),s.height=b)}u.drawImage(r,0,0,s.width,s.height),m.requestFrame&&m.requestFrame(),l!==e._mediaStreamTrack&&(l=e._mediaStreamTrack,r.srcObject=new MediaStream([l]))},s.stopCapture=HA(()=>s.startCapture&&s.startCapture(),a);const g=m.stop;return m.stop=()=>{g.call(m),r&&(r.remove(),r.srcObject=null,r=null),s&&(s.width=0,s.remove(),s.stopCapture&&s.stopCapture(),s.startCapture=void 0,s.stopCapture=void 0,s=null),O.debug("clean low stream renderer")},m}var Ia=function(e){return e[e.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",e[e.Video_Send_Freeze=2082]="Video_Send_Freeze",e[e.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",e[e.Video_Recv_Freeze=2084]="Video_Recv_Freeze",e[e.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",e[e.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",e[e.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",e[e.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",e[e.Video_Send_Type=2225]="Video_Send_Type",e}(Ia||{}),Rt=function(e){return e[e.Video_Send_Retransmit=2062]="Video_Send_Retransmit",e[e.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",e[e.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",e[e.Video_Send_Transmit=2066]="Video_Send_Transmit",e[e.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",e[e.Video_Capture_Height=2033]="Video_Capture_Height",e[e.Video_Capture_Width=2035]="Video_Capture_Width",e[e.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",e[e.Video_Send_Low_Height=2073]="Video_Send_Low_Height",e[e.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",e[e.Video_Send_Low_Width=2077]="Video_Send_Low_Width",e[e.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",e[e.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",e[e.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",e[e.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",e[e.Video_Send_Width=2003]="Video_Send_Width",e[e.Video_Send_Height=2004]="Video_Send_Height",e[e.Video_Send_Disabled=2095]="Video_Send_Disabled",e[e.Video_Send_Adaptation=2032]="Video_Send_Adaptation",e[e.Video_Send_Player_Status=2128]="Video_Send_Player_Status",e[e.Video_Send_Nacks=2009]="Video_Send_Nacks",e[e.Video_Send_Plis=2010]="Video_Send_Plis",e[e.Video_Send_Firs=2011]="Video_Send_Firs",e[e.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",e[e.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",e[e.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",e[e.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",e[e.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",e[e.Video_Send_Bitrate=2012]="Video_Send_Bitrate",e[e.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",e[e.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",e[e.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",e[e.Audio_Send_Level=2038]="Audio_Send_Level",e[e.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",e[e.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",e[e.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",e[e.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",e[e.Audio_Send_Freeze=2081]="Audio_Send_Freeze",e[e.Audio_Send_Disabled=2096]="Audio_Send_Disabled",e[e.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",e[e.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",e[e.Video_Recv_Height=2019]="Video_Recv_Height",e[e.Video_Recv_Width=2018]="Video_Recv_Width",e[e.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",e[e.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",e[e.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",e[e.Video_Recv_Nacks=2026]="Video_Recv_Nacks",e[e.Video_Recv_Plis=2027]="Video_Recv_Plis",e[e.Video_Recv_Firs=2028]="Video_Recv_Firs",e[e.Video_Recv_Disabled=2101]="Video_Recv_Disabled",e[e.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",e[e.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",e[e.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",e[e.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",e[e.Audio_Render_Level=2043]="Audio_Render_Level",e[e.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",e[e.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",e[e.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",e[e.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",e[e.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",e[e.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",e[e.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",e[e.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",e[e.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",e[e.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",e[e.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",e[e.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",e}(Rt||{}),di=function(e){return e[e.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",e[e.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",e[e.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",e[e.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",e[e.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",e[e.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",e[e.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",e[e.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",e[e.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",e[e.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",e[e.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",e[e.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",e[e.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",e[e.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",e[e.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",e[e.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",e[e.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",e[e.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",e[e.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",e[e.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",e[e.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",e}(di||{}),ys=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e[e.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",e}(ys||{}),pS=function(e){return e[e.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",e}(pS||{});const Th=1e3,fS=6,Rg=3,Que=Math.max(fS,Rg);function mt(e,t,r){r!=null&&Number.isFinite(r)&&(e[t]=Math.round(Math.max(0,r)))}function i6(e){const t={[ys.CONN_TYPE]:0,[ys.RTT]:e.rtt,[ys.STATS_UPDATE_INTERVAL]:e.updateInterval?Math.round(Math.max(0,e.updateInterval)):void 0};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const r=e.selectedCandidatePair.localCandidate.relayProtocol;r==="udp"&&(t[ys.CONN_TYPE]=1),r==="tcp"&&(t[ys.CONN_TYPE]=3),r==="tls"&&(t[ys.CONN_TYPE]=4);break}case"srflx":t[ys.CONN_TYPE]=2;break;case"unknown":t[ys.CONN_TYPE]=5;break;default:t[ys.CONN_TYPE]=0}return t}function s6(e){let t=0;switch(e){case"none":t=0;break;case"cpu":t=1;break;case"bandwidth":t=2;break;case"other":t=3}return t}class o6 extends Zn{constructor(t){super(),z(this,"store",void 0),z(this,"uploadWRTCStatsTimer",void 0),z(this,"uploadOutboundDenoiserStatsTimer",void 0),z(this,"uploadExtStatsTimer",void 0),z(this,"uploadExtUsageStatsTimer",void 0),z(this,"uploadInboundExtStatsTimer",void 0),z(this,"requestStats",void 0),z(this,"requestTransportStats",void 0),z(this,"requestLocalMedia",void 0),z(this,"requestRemoteMedia",void 0),z(this,"requestAllTracks",void 0),z(this,"requestVideoIsReady",void 0),z(this,"requestUploadStats",void 0),z(this,"requestUpload",void 0),z(this,"uploadOutboundStarted",!1),z(this,"uploadInboundStarted",!1),z(this,"uploadTransportStarted",!1),z(this,"uploadBaseStatsStarted",!1),z(this,"uploadExtensionUsageStarted",!1),z(this,"lastRecvStats",void 0),z(this,"lastSendStats",void 0),z(this,"lastRefRecvStats",void 0),z(this,"lastRefSendStats",void 0),z(this,"lastNormalRecvStats",void 0),z(this,"lastNormalSendStats",void 0),z(this,"needUploadRenderFreezeTime",!0),z(this,"lastUploadCompensateTime",-1),z(this,"uploadCompensateDeltaTime",0),this.store=t}uploadWRTCStats(t){if(!this.requestStats||!this.requestUploadStats)return;const r=t%Rg==0,s=t%fS==0;let a,l;if(this.uploadTransportStarted&&(a=this.requestStats(),this.store.useP2P&&(l=this.requestStats(!0))),!a&&this.uploadOutboundStarted&&(a=this.requestStats()),!l&&this.uploadInboundStarted&&(l=this.requestStats(!0)),a||l){var u;const p={};if(this.uploadTransportStarted&&a){const g=this.getTransportStats(a,l,r);g&&(p.misc=[g])}if(this.uploadOutboundStarted&&a){const g=this.getOutboundStats(a,s?this.lastNormalSendStats:void 0,r?this.lastRefSendStats:void 0,this.lastSendStats);g&&(p.outbound=[g])}if(this.uploadInboundStarted&&l){this.uploadCompensateStats(t);const g=this.getInboundStats(l,s?this.lastNormalRecvStats:void 0,r?this.lastRefRecvStats:void 0,this.lastRecvStats);g&&(p.inbound=g)}const m=(u=this.requestTransportStats)===null||u===void 0?void 0:u.call(this).connectState;m&&(Array.isArray(p.misc)?p.misc[0]&&p.misc[0].addition&&(p.misc[0].addition[pS.RTC_PEER_CONNECTION_STATE]=AA[m]):p.misc=[{addition:{[pS.RTC_PEER_CONNECTION_STATE]:AA[m]}}]),this.requestUploadStats(p)}this.lastRecvStats=l,this.lastSendStats=a,s&&(this.lastNormalRecvStats=l,this.lastNormalSendStats=a),r&&(this.lastRefRecvStats=l,this.lastRefSendStats=a)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let t=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var r,s;const a=(r=this.requestTransportStats)===null||r===void 0?void 0:r.call(this);return void(a&&((s=this.requestUploadStats)===null||s===void 0||s.call(this,{misc:[{addition:{[pS.RTC_PEER_CONNECTION_STATE]:AA[a.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(t),++t===Que+1&&(t=1)},Th)}uploadCompensateStats(t){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const r=t%Rg==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!r)return;if(this.lastUploadCompensateTime===-1)return void(this.lastUploadCompensateTime=Date.now());const s=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=s,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const a=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*a;const l=this.requestStats(!0);new Array(a).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const u={};if(this.uploadInboundStarted&&l){const p=this.requestRemoteMedia()||[],m=[];p.forEach(g=>{let[E,y]=g;const b={peer:E.uid};if(E._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(E._videoSSRC)&&y.has(Ze.VIDEO)&&E.videoTrack){const C=function(B,M,F){if(!M.videoRecv.find(Y=>Y.ssrc===B))return;const q={};if(F&&F._player){const Y=F._player,{renderFreezeAccTime2:re,videoElementStatus:ce}=Y;if(Xc.visibility==="visible"&&ce===Li.PLAYING&&tn().supportRequestVideoFrameCallback){const le=Math.min(6e3,re);Y.renderFreezeAccTime2=Math.max(0,re-le),mt(q,Ia.Video_Render_Freeze_Time_Render2,le),Z("USE_NEW_RENDER_FREEZE_TIME")&&mt(q,Ia.Video_Render_Freeze_Time_Render,le)}}return q}(E._videoSSRC,l,E.videoTrack);C&&(b.video=C)}b.video&&m.push(b)}),m.length>0&&(u.inbound=m,this.requestUploadStats(u))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(t,r,s){if(!this.requestStats)return;if(!s)return t.rtt==null?void 0:{addition:{[ys.RTT]:t.rtt,[ys.CONN_TYPE]:void 0,[ys.STATS_UPDATE_INTERVAL]:t.updateInterval||void 0}};const a=i6(t);if(this.store.useP2P){if(r){const l=i6(r);a[ys.CONN_TYPE]+=l[ys.CONN_TYPE]<<3}a[ys.CONN_TYPE]+=110}else a[ys.CONN_TYPE]+=100;return{addition:a}}getOutboundStats(t,r,s,a){if(!this.requestUploadStats||!this.requestLocalMedia)return;const l=this.requestLocalMedia();if(!l||l.length===0)return;let u,p,m;return l.forEach(g=>{let[E,{track:y,ssrcs:b}]=g;switch(E){case Ie.LocalVideoLowTrack:case Ie.LocalVideoTrack:if(E===Ie.LocalVideoTrack){const C=function(F,q,Y,re,ce,le){const ae=q.videoSend.find(jt=>jt.ssrc===F);if(!ae)return;const _e={},{sentFrame:we,inputFrame:Be}=ae;if(re&&(mt(_e,Ia.Video_Send_Qp_Sum,ae.qpSumPerFrame),Be&&we)){var Xe;const jt=Be.frameRate,kt=we.frameRate;_e[Ia.Video_Send_Freeze]=function(Tt,jn){let bn=!0;return bn=!(Tt<=5)&&(Tt<=10?jn<3:Tt<=20?jn<4:jn<5),bn}(jt,kt)?1:0,_e[Ia.Video_Send_Type]=Y.__className__==="CameraVideoTrack"?0:je(Xe=Y._hints).call(Xe,Tn.SCREEN_TRACK)?1:2}if(ce){switch(we&&(mt(_e,Rt.Video_Send_Height,we.height),mt(_e,Rt.Video_Send_Width,we.width),mt(_e,Rt.Video_Send_Frame_Rate,we.frameRate)),_e[Rt.Video_Send_Disabled]=Y._originMediaStreamTrack&&!Y._originMediaStreamTrack.enabled||Y._mediaStreamTrack&&!Y._mediaStreamTrack.enabled?1:0,ae.adaptionChangeReason){case"none":_e[Rt.Video_Send_Adaptation]=0;break;case"cpu":_e[Rt.Video_Send_Adaptation]=1;break;case"bandwidth":_e[Rt.Video_Send_Adaptation]=2;break;case"other":_e[Rt.Video_Send_Adaptation]=3}let jt=0;ae.adaptionChangeReason&&(jt+=s6(ae.adaptionChangeReason)),q.qualityLimitationReason&&(jt+=s6(q.qualityLimitationReason)<<3),_e[Rt.Video_Send_Adaptation]=jt,_e[Rt.Video_Send_Player_Status]=BA[Y._player?Y._player.videoElementStatus:"uninit"],mt(_e,Rt.Video_Send_Nacks,ae.nacksCount),mt(_e,Rt.Video_Send_Plis,ae.plisCount),mt(_e,Rt.Video_Send_Firs,ae.firsCount),mt(_e,Rt.Video_Send_Avg_Encode,ae.avgEncodeMs),mt(_e,Rt.Video_Send_Huge_Frame_Sent,ae.hugeFramesSent),mt(_e,Rt.Video_Send_Bytes_Retransmit,ae.retransmittedBytesSent),mt(_e,Rt.Video_Send_Packages_Retransmit,ae.retransmittedPacketsSent),mt(_e,Rt.Video_Send_Key_Frames_Encoded,ae.keyFramesEncoded);const kt=ce.videoSend.find(Tt=>Tt.ssrc===F);if(kt){let Tt=Th*Rg;kt.timestamp&&ae.timestamp&&(Tt=ae.timestamp-kt.timestamp),kt.packets!=null&&ae.packets!=null&&mt(_e,Rt.Video_Send_Package_Rate,1e3*(ae.packets-kt.packets)/Tt),ae.packetsLost!=null&&kt.packetsLost!=null&&mt(_e,Rt.Video_Send_Package_Lost,ae.packetsLost-kt.packetsLost),kt.bytes!=null&&ae.bytes!=null&&mt(_e,Rt.Video_Send_Bitrate,8*(ae.bytes-kt.bytes)/Tt)}}return _e}(b[0].ssrcId,t,y,r,s),B=y&&function(F,q,Y,re){const ce=q.videoSend.find(ae=>ae.ssrc===F);if(!ce)return null;const le={};if(re){const ae=ce.inputFrame,_e=ae&&ae.height||Y.videoHeight||0,we=ae&&ae.width||Y.videoWidth||0,Be=ae&&ae.frameRate||0;mt(le,Rt.Video_Capture_Height,_e),mt(le,Rt.Video_Capture_Width,we),mt(le,Rt.Video_Capture_Frame_Rate,Be)}return le}(b[0].ssrcId,t,y,!!s),M=function(F,q){const Y={};return q&&(mt(Y,Rt.Video_Send_Retransmit,F.bitrate.retransmit),mt(Y,Rt.Video_Send_Target_Encoded,F.bitrate.targetEncoded),mt(Y,Rt.Video_Send_Actual_Encoded,F.bitrate.actualEncoded),mt(Y,Rt.Video_Send_Transmit,F.bitrate.transmit),mt(Y,Rt.Video_Send_Bandwidth,F.sendBandwidth)),Y}(t,!!s);p=Object.assign({},C,B,M)}else m=function(C,B,M,F,q){const Y=B.videoSend.find(ce=>ce.ssrc===C);if(!Y)return;const re={};if(F){const ce=Y.sentFrame;ce&&(mt(re,Rt.Video_Send_Low_Height,ce.height),mt(re,Rt.Video_Send_Low_Width,ce.width),mt(re,Rt.Video_Send_Low_Frame_Rate,ce.frameRate));const le=F.videoSend.find(ae=>ae.ssrc===C);if(le){let ae=Th*fS;le.timestamp&&Y.timestamp&&(ae=Y.timestamp-le.timestamp),le.packets!=null&&Y.packets!=null&&mt(re,Rt.Video_Send_Low_Package_Rate,1e3*(Y.packets-le.packets)/ae),Y.packetsLost!=null&&le.packetsLost!=null&&mt(re,Rt.Video_Send_Low_Package_Lost,Y.packetsLost-le.packetsLost),le.bytes!=null&&Y.bytes!=null&&mt(re,Rt.Video_Send_Low_Bitrate,8*(Y.bytes-le.bytes)/ae)}}return re}(b[0].ssrcId,t,0,s);break;case Ie.LocalAudioTrack:u=y&&function(C,B,M,F,q,Y){const re=B.audioSend.find(le=>le.ssrc===C);if(!re)return;const ce={};if(q){ce[Rt.Audio_Send_Disabled]=M._originMediaStreamTrack&&!M._originMediaStreamTrack.enabled||M._mediaStreamTrack&&!M._mediaStreamTrack.enabled?1:0;const le=100*M._source.getAccurateVolumeLevel(),ae=re.inputLevel;if(ae!=null){const we=Math.ceil(50*Math.log10(100*ae+1));mt(ce,Rt.Audio_Send_Level,we)}mt(ce,Rt.Audio_Capture_PCM_Level,le),mt(ce,Rt.Audio_Send_AEC_Return_Loss,re.aecReturnLoss),mt(ce,Rt.Audio_Send_AEC_Return_Loss_Enhancement,re.aecReturnLossEnhancement),mt(ce,Rt.Audio_Send_Bytes_Retransmit,re.retransmittedBytesSent),mt(ce,Rt.Audio_Send_Packages_Retransmit,re.retransmittedPacketsSent),ce[Rt.Audio_Send_Freeze]=0;const _e=q.audioSend.find(we=>we.ssrc===C);if(_e){let we=Th*fS;_e.timestamp&&re.timestamp&&(we=re.timestamp-_e.timestamp),_e.bytes!=null&&re.bytes!=null&&mt(ce,Rt.Audio_Send_Bitrate,8*(re.bytes-_e.bytes)/we),_e.packets!=null&&re.packets!=null&&mt(ce,Rt.Audio_Send_Package_Rate,1e3*(re.packets-_e.packets)/we)}}return ce}(b[0].ssrcId,t,y,0,s)}}),{high:p,low:m,audio:u}}getInboundStats(t,r,s,a){if(!this.requestRemoteMedia)return;const l=this.requestRemoteMedia()||[],u=[];return l.forEach(p=>{let[m,g]=p;const E={peer:m.uid};if(g.has(Ze.VIDEO)&&m.videoTrack){const y=m._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(m._videoSSRC)||!1,b=m.videoTrack?function(C,B,M,F,q,Y,re,ce){const le=B.videoRecv.find(Tt=>Tt.ssrc===C);if(!le)return;const ae={},{receivedFrame:_e,outputFrame:we,decodeFrameRate:Be}=le;mt(ae,di.Video_Render_Frame_Rate_Decode,Be),le.framesRateFirefox&&mt(ae,di.Video_Recv_Frame_Rate,le.framesRateFirefox),_e&&mt(ae,di.Video_Recv_Frame_Rate,_e.frameRate),mt(ae,di.Video_Recv_Frame_Dropped,le.framesDroppedCount),mt(ae,di.Video_Recv_Bytes_Retransmit,le.retransmittedBytesReceived),mt(ae,di.Video_Recv_Packages_Retransmit,le.retransmittedPacketsReceived),mt(ae,di.Video_Recv_Packages_Discarded,le.packetsDiscarded),mt(ae,di.Video_Recv_Avg_Decode,le.avgDecodeMs),mt(ae,di.Video_Recv_Avg_Processing_Delay,le.avgProcessingDelayMs),mt(ae,di.Video_Recv_Avg_Assembly_Time,le.avgFramesAssembledFromMultiplePacketsMs),mt(ae,di.Video_Recv_Avg_Inter_Frame_Delay,le.avgInterFrameDelayMs),mt(ae,di.Video_Recv_Key_Frames_Decoded,le.keyFramesDecoded);const Xe=ce&&ce.videoRecv.find(Tt=>Tt.ssrc===C);if(Xe){const Tt=B.timestamp-ce.timestamp||Th;le.packetsLost!=null&&Xe.packetsLost!=null&&mt(ae,di.Video_Recv_Package_Lost,le.packetsLost-Xe.packetsLost),Xe.bytes!=null&&le.bytes!=null&&mt(ae,di.Video_Recv_Bitrate,8*(le.bytes-Xe.bytes)/Tt),Xe.packets!=null&&le.packets!=null&&mt(ae,di.Video_Recv_Package_Rate,1e3*(le.packets-Xe.packets)/Tt)}const jt=Y&&Y.videoRecv.find(Tt=>Tt.ssrc===C);if(jt&&(mt(ae,Ia.Video_Recv_Qp_Sum,le.qpSumPerFrame),ae[Ia.Video_Recv_Freeze]=F&&wg.isRemoteVideoFreeze(M,le,jt)?1:0),re){var kt;const Tt=re.videoRecv.find(bn=>bn.ssrc===C);_e?(mt(ae,Rt.Video_Recv_Height,_e.height),mt(ae,Rt.Video_Recv_Width,_e.width)):M&&(mt(ae,Rt.Video_Recv_Height,M._videoHeight||0),mt(ae,Rt.Video_Recv_Width,M._videoWidth||0)),we&&mt(ae,Rt.Video_Recv_Frame_Rate_Output,we.frameRate);const jn=(kt=M._player)===null||kt===void 0?void 0:kt.rendFrameRate.toFixed(0);if(jn&&mt(ae,Rt.Video_Render_Frame_Rate_Render,+jn),mt(ae,Rt.Video_Recv_Jitter_Buffer,le.jitterBufferMs),mt(ae,Rt.Video_Recv_Current_Delay,le.currentDelayMs),mt(ae,Rt.Video_Recv_Firs,le.firsCount),mt(ae,Rt.Video_Recv_Nacks,le.nacksCount),mt(ae,Rt.Video_Recv_Plis,le.plisCount),M){ae[Rt.Video_Recv_Disabled]=M._originMediaStreamTrack.enabled&&M._mediaStreamTrack.enabled?0:1;const bn=M._player;if(bn){const{freezeTimeCounterList:xs,renderFreezeAccTime:Ce,renderFreezeAccTime2:ke,videoElementStatus:nt}=bn;if(xs&&xs.length>0&&mt(ae,Ia.Video_Render_Freeze_Time,xs.splice(0,1)[0]),q&&Xc.visibility==="visible"&&nt===Li.PLAYING&&tn().supportRequestVideoFrameCallback){const Re=Math.min(6e3,ke);bn.renderFreezeAccTime2=Math.max(0,ke-Re),mt(ae,Ia.Video_Render_Freeze_Time_Render2,Re);const D=Math.min(6e3,Ce);bn.renderFreezeAccTime=Math.max(0,Ce-D),mt(ae,Ia.Video_Render_Freeze_Time_Render,Z("USE_NEW_RENDER_FREEZE_TIME")?Re:D)}if(typeof le.totalFreezesDuration=="number"){const Re=Tt&&Tt.totalFreezesDuration?le.totalFreezesDuration-Tt.totalFreezesDuration:le.totalFreezesDuration;mt(ae,Rt.Video_Render_Freeze_Duration,1e3*Re)}}}if(ae[Rt.Video_Recv_Player_Status]=BA[M._player?M._player.videoElementStatus:"uninit"],Tt&&le.totalInterFrameDelay!==void 0&&le.totalSquaredInterFrameDelay!==void 0&&Tt.totalInterFrameDelay!==void 0&&Tt.totalSquaredInterFrameDelay!==void 0){const bn=le.totalInterFrameDelay-Tt.totalInterFrameDelay,xs=le.totalSquaredInterFrameDelay-Tt.totalSquaredInterFrameDelay,Ce=le.framesDecodeCount-Tt.framesDecodeCount,ke=bn/Ce*1e3,nt=Math.round(1e3*Math.sqrt((xs-Math.pow(bn,2)/Ce)/Ce));!isNaN(nt)&&ke+nt>Math.max(3*ke,ke+150)&&(ae[Rt.Video_Recv_I_Frame_Delay]=nt)}}return ae}(m._videoSSRC,t,m.videoTrack,y===!0,this.needUploadRenderFreezeTime,r,s,a):void 0;b&&(E.video=b)}if(g.has(Ze.AUDIO)&&m.audioTrack){const y=m.audioTrack?function(b,C,B,M,F,q){const Y=C.audioRecv.find(ae=>ae.ssrc===b);if(!Y)return;const re={};mt(re,di.Audio_Recv_Jitter,Y.jitterMs),mt(re,di.Audio_Recv_Bytes_Retransmit,Y.retransmittedBytesReceived),mt(re,di.Audio_Recv_Packages_Retransmit,Y.retransmittedPacketsReceived),mt(re,di.Audio_Recv_Packages_Discarded,Y.packetsDiscarded),mt(re,di.Audio_Recv_Avg_Processing_Delay,Y.avgProcessingDelayMs);const ce=q&&q.audioRecv.find(ae=>ae.ssrc===b);if(ce){const ae=Th;Y.packets!=null&&ce.packets!=null&&mt(re,di.Audio_Recv_Package_Rate,1e3*(Y.packets-ce.packets)/ae),Y.packetsLost!=null&&ce.packetsLost!=null&&mt(re,di.Audio_Recv_Package_Lost,Y.packetsLost-ce.packetsLost)}if(M){const{receivedFrames:ae,droppedFrames:_e}=Y;ae!=null&&_e!=null&&(re[Ia.Audio_Recv_Freeze]=(le=ae)===0||100*_e/le>20?1:0)}var le;if(F){const ae=100*B._source.getAccurateVolumeLevel(),_e=Y.outputLevel;if(_e!=null){const Be=Math.ceil(50*Math.log10(100*_e+1));mt(re,Rt.Audio_Render_Level,Be)}mt(re,Rt.Audio_Recv_PCM_Level,ae),B&&(re[Rt.Audio_Recv_Disabled]=B._originMediaStreamTrack.enabled&&B._mediaStreamTrack.enabled?0:1),mt(re,Rt.Audio_Recv_Jitter_Buffer,Y.jitterBufferMs),mt(re,Rt.Audio_Recv_Current_Delay,Y.jitterBufferMs),re[Rt.Audio_Recv_Player_Status]=BA[Es.getPlayerState(B.getTrackId())];const we=F.audioRecv.find(Be=>Be.ssrc===b);if(we){we.bytes!=null&&Y.bytes!=null&&mt(re,Rt.Audio_Recv_Bitrate,8*(Y.bytes-we.bytes)/(Th*Rg));const Be=Y.concealedSamples-we.concealedSamples;Be>0&&mt(re,Rt.Audio_Recv_Concealed_Samples,Be);const Xe=Y.totalSamplesReceived-we.totalSamplesReceived;Xe>0&&mt(re,Rt.Audio_Recv_Total_Samples_Received,Xe);const jt=Y.freezeSamples80-we.freezeSamples80;jt>0&&mt(re,Rt.Audio_Render_Freeze_Samples_80ms,jt);const kt=Y.freezeSamples200-we.freezeSamples200;kt>0&&mt(re,Rt.Audio_Render_Freeze_Samples_200ms,kt);const Tt=Y.freezeMs80-we.freezeMs80;mt(re,Rt.Audio_Render_Freeze_Time_80ms,Tt<0?0:Tt);const jn=Y.freezeMs200-we.freezeMs200;mt(re,Rt.Audio_Render_Freeze_Time_200ms,jn<0?0:jn)}}return re}(m._audioSSRC,t,m.audioTrack,r,s,a):void 0;y&&(E.audio=y)}(E.video||E.audio)&&u.push(E)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,u}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const t=(this.requestAllTracks()||[]).find(r=>r instanceof pg);if(t&&t._external.getDenoiserStats){const r=t._external.getDenoiserStats();r&&this.requestUpload(mg.DENOISER_STATS,r)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(t=>{t.getProcessorStats().forEach(r=>{this.requestUpload&&this.requestUpload(r.type,r.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(t=>{let[r,s]=t;s.has(Ze.VIDEO)&&r.videoTrack&&r.videoTrack.getProcessorStats().forEach(a=>{this.requestUpload&&this.requestUpload(a.type,a.stats)}),s.has(Ze.AUDIO)&&r.audioTrack&&r.audioTrack.getProcessorStats().forEach(a=>{this.requestUpload&&this.requestUpload(a.type,a.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const t=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const r=Date.now(),s={connectionInterval:Z("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:r};let a=[];const l=this.requestAllTracks&&this.requestAllTracks()||[];for(const g of l)!g.muted&&g.enabled&&(a=a.concat(await g.getProcessorUsage()));const u=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[g,E]of u)E.has(Ze.VIDEO)&&g.videoTrack&&(a=a.concat(await g.videoTrack.getProcessorUsage())),E.has(Ze.AUDIO)&&g.audioTrack&&(a=a.concat(await g.audioTrack.getProcessorUsage()));if(a.length===0)return;s.details=function(g,E){const y={};for(const{id:M,value:F,level:q,direction:Y}of g){var b;const re=(b=E.get(M))!==null&&b!==void 0?b:0,ce=F===2?re+Z("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:re;var C,B;E.set(M,ce),y[M]?(F===2&&(y[M].value=F),q>y[M].level&&(y[M].level=q),Y==="remote"&&(y[M].remoteUidCount+=1),y[M].totalTs=(C=E.get(M))!==null&&C!==void 0?C:0):y[M]={value:F,level:q,remoteUidCount:Y==="local"?0:1,totalTs:(B=E.get(M))!==null&&B!==void 0?B:0}}return Object.keys(y).map(M=>{const{level:F,value:q,totalTs:Y}=y[M];return{id:M,level:F,value:q,totalTs:Y}})}(a,t);const p=Date.now(),m=p>r?p:r+1;this.requestUpload&&this.requestUpload(mg.EXTENSION_USAGE_STATS,{usageStats:s,sendTs:m})},Z("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const Zue=Z("ICE_RESTART_INTERVAL");let mS=new Map,Ff=new Map,Bd=[Ii.UDP_TCP_RELAY,Ii.TCP_RELAY,Ii.RELAY],k1=Z("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&tn().supportPCSetConfiguration;function a6(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=mS.get(e.id);r&&(window.clearTimeout(r),mS.delete(e.id));const s=Ff.get(e.id);t&&s&&s.index===Bd.length-1&&(O.debug("[".concat(e.id,"] reset ICE restart policy")),Ff.delete(e.id))}function c6(e,t,r){if(mS.size===0&&Ff.size===0&&(Array.isArray(Z("RESTART_SEQUENCE"))&&Z("RESTART_SEQUENCE").length>0&&!function(p,m){if(p.length!==m.length)return!1;for(let g=0;g<p.length;g+=1){const E=p[g];if(p.filter(y=>y===E).length!==m.filter(y=>y===E).length)return!1}return!0}(Bd,Z("RESTART_SEQUENCE"))&&(Bd=Z("RESTART_SEQUENCE").filter(p=>{var m;if(je(m=Object.values(Ii)).call(m,p))return!0}),O.debug("use reconnection policy from config distribution, queues: ".concat(Bd.join(" => ")))),k1=Z("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&tn().supportPCSetConfiguration),Bd.length===0)return void r();let s,{index:a=0,type:l}=Ff.get(e.id)||{};if(k1&&l===Ii.RELAY)return void r();let u=l&&a>=Bd.length-1;if(k1)l=Ii.RELAY;else{if(u)return void r();l?(a++,l=Bd[a]):(l=Bd[0],a=0)}O.debug("[".concat(e.id,"] choose ICE restart policy: ").concat(l,", index: ").concat(a)),t(l),Ff.set(e.id,{index:a,type:l}),s=window.setTimeout(()=>c6(e,t,r),Zue),mS.set(e.id,s)}var Wt;function l6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function nl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l6(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l6(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function d6(e){var t,r,s,a=2;for(typeof Symbol<"u"&&(r=tA,s=Symbol.iterator);a--;){if(r&&(t=e[r])!=null)return t.call(e);if(s&&(t=e[s])!=null)return new gS(t.call(e));r="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function gS(e){function t(r){if(Object(r)!==r)return Ye.reject(new TypeError(r+" is not an object."));var s=r.done;return Ye.resolve(r.value).then(function(a){return{value:a,done:s}})}return gS=function(r){this.s=r,this.n=r.next},gS.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var s=this.s.return;return s===void 0?Ye.resolve({value:r,done:!0}):t(s.apply(this.s,arguments))},throw:function(r){var s=this.s.return;return s===void 0?Ye.reject(r):t(s.apply(this.s,arguments))}},new gS(e)}let Ag=(Wt=class extends Zn{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(ht.StateChange,t,this._state)}constructor(e,t){super(),z(this,"isPlanB",void 0),z(this,"store",void 0),z(this,"statsUploader",void 0),z(this,"connection",void 0),z(this,"localTrackMap",new Map),z(this,"remoteUserMap",new Map),z(this,"localDataChannels",[]),z(this,"remoteDataChannelMap",new Map),z(this,"pendingLocalTracks",[]),z(this,"pendingRemoteTracks",[]),z(this,"pendingLocalDataChannels",[]),z(this,"pendingRemoteDataChannels",[]),z(this,"statsCollector",void 0),z(this,"shouldForwardP2PCreation",void 0),z(this,"iceFailedCount",0),z(this,"dtlsFailedCount",0),z(this,"mutex",void 0),z(this,"_state",pn.Disconnected),z(this,"_pcStatsUploadType",Z("NEW_ICE_RESTART")?Ul.FIRST_CONNECTION:Ul.OLD_FIRST_CONNECTION),z(this,"_isStartRestartIce",!1),z(this,"_restartTimer",void 0),z(this,"_isTryConnecting",!1),z(this,"_iceError",null),z(this,"_forceTurn",!1),z(this,"_isWaitPcToRePub",!1),z(this,"handleMuteLocalTrack",async(r,s,a)=>{const l=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==pn.Connected)return void a(new Se($.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const u=this.filterTobeMutedTracks(r);if(u.length===0)return void s();const p=u.find(g=>g[0]==="videoLowTrack");p&&p[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(u.map(g=>{let[,{id:E}]=g;return E}));const m=this.createMuteMessage(u);await Cn(this,ht.RequestMuteLocal,m),s()}catch(u){a(u)}finally{l()}}),z(this,"handleUnmuteLocalTrack",async(r,s,a)=>{const l=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==pn.Connected)return void a(new Se($.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const u=this.filterTobeUnmutedTracks(r);if(u.length===0)return void s();const p=u.find(g=>g[0]==="videoLowTrack");if(p){const g=p[1];if(g.track._originMediaStreamTrack.stop(),!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&tn().supportDualStreamEncoding){const E=r._mediaStreamTrack.clone();g.track._mediaStreamTrack=E,g.track._originMediaStreamTrack=E}else{const E=P1(r,ag(this,ht.RequestLowStreamParameter));g.track._mediaStreamTrack=E,g.track._originMediaStreamTrack=E}await new Ye((E,y)=>{this.handleReplaceTrack(g.track,E,y,!0)})}await this.connection.unmuteLocal(u.map(g=>{let[,{id:E}]=g;return E}));const m=this.createUnmuteMessage(u);await Cn(this,ht.RequestUnmuteLocal,m),s()}catch(u){a(u)}finally{l()}}),z(this,"handleUpdateVideoEncoder",async(r,s,a,l)=>{let u;l||(u=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const m=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.connection||!m||m.track!==r||this.state!==pn.Connected)return void s();const{id:g,track:E}=m;await this.connection.updateSendParameters(g,E),await this.connection.updateEncoderConfig(g,E),this.emit(ht.UpdateVideoEncoder,E),s()}catch(m){a(m)}finally{var p;(p=u)===null||p===void 0||p()}}),z(this,"handleUpdateVideoSendParameters",async(r,s,a)=>{const l=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const u=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.connection||!u||u.track!==r||this.state!==pn.Connected)return void s();const{id:p,track:m}=u;await this.connection.updateSendParameters(p,m),s()}catch(u){a(u)}finally{l()}}),z(this,"handleReplaceMixingTrack",async(r,s,a,l)=>{if(!this.connection||this.state!==pn.Connected)return void s();const u=O1([r]);let p;O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(u.getTrackId(),"]")),typeof l=="boolean"&&l||(p=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(r,u),s()}catch(g){a(g)}finally{var m;(m=p)===null||m===void 0||m()}}),z(this,"handleReplaceTrack",async(r,s,a,l)=>{let u;O.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof l=="boolean"&&l||(u=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var p;const g=Array.from(this.localTrackMap.entries()).find(E=>{let[,{track:y}]=E;return r===y});if(!this.connection||!g||this.state!==pn.Connected)return void s();if(await((p=this.connection)===null||p===void 0?void 0:p.replaceTrack(r,g[1].id)),this.isPlanB){const E=g[1];E.id=r._mediaStreamTrack.id,this.localTrackMap.set(g[0],E)}if(g[0]===Ie.LocalVideoTrack&&!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&tn().supportDualStreamEncoding){const E=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(E){const y=r._mediaStreamTrack.clone();E.track._originMediaStreamTrack.stop(),E.track._mediaStreamTrack=y,E.track._originMediaStreamTrack=y,await new Ye((b,C)=>{this.handleReplaceTrack(E.track,b,C,!0)})}}s()}catch(g){a(g)}finally{var m;(m=u)===null||m===void 0||m()}}),z(this,"handleGetRTCStats",r=>{r(this.statsCollector.getRTCStats())}),z(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),z(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),z(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),z(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new o6(this.store),this.bindStatsUploaderEvents(),this.mutex=new Ai("P2PChannel-mutex",this.store.clientId),this.isPlanB=!tn().supportUnifiedPlan||Z("CHROME_FORCE_PLAN_B")&&Pl(),this.shouldForwardP2PCreation=Z("FORWARD_P2P_CREATION")&&tn().supportPCSetConfiguration&&fA(),this.shouldForwardP2PCreation&&(this.connection=hS(this.store),this.emit(ht.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(e){var t;this.state=pn.New,this._forceTurn=n6(e),O.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const r=this.shouldForwardP2PCreation&&((t=this.connection)===null||t===void 0?void 0:t.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!r||(r&&this.connection&&(O.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=hS(this.store,e),this.emit(ht.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new Se($.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=Z("NEW_ICE_RESTART")?Ul.FIRST_CONNECTION:Ul.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new Se($.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");Z("ENABLE_PREALLOC_PC")&&this.state===pn.Connected?await this.connection.updateRemoteConnect(e):(this.store.peerConnectionStart(),await this.connection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=pn.Connected)}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter(a=>{var l;let[u]=a;return je(l=[Ie.LocalVideoLowTrack,Ie.LocalVideoTrack]).call(l,u)}),r=t.map(a=>{let[,{id:l}]=a;return l}),s=t.map(a=>{let[l]=a;return l});if(this.connection instanceof tl){if(st.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(s),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!je(e).call(e,this.store.codec)){const a=["vp9","vp8","h264"].find(l=>je(e).call(e,l));a&&(this.store.codec=a,O.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(a,".")))}this.connection.updateRemoteRTPCapabilities(r,e)}}async getEstablishParams(){var e;if(this.connection instanceof tl&&this.connection.peerConnectionState!=="closed"&&je(e=[pn.New,pn.Connected]).call(e,this.state))return this.connection.establishPromise}async publishDataChannel(e){if(!this.connection||this.state!==pn.Connected){if(this.state===pn.Disconnected)throw new Se($.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach(r=>{var s;je(s=this.pendingLocalDataChannels).call(s,r)||this.pendingLocalDataChannels.push(r)}),[]}const t=this.filterTobePublishedDataChannels(e);return t.length===0?[]:(t.forEach(r=>{const s=Date.now();this.store.publish(r.id.toString(),"datachannel",s)}),await this.connection.createDataChannels(this.store.uid,t),t.forEach(r=>{this.localDataChannels.push(r);const s=Date.now();this.store.publish(r.id+"","datachannel",void 0,s)}),e.map(r=>({streamId:r.id,ordered:r.ordered,maxRetransmits:r.maxRetransmits,metadata:r.metadata,channelId:r._originDataChannelId})))}publish(e,t,r){var s=this;return Go(function*(){const a=yield Zt(s.mutex.lock("From P2PChannel.publish"));try{var l;const u=s.connection&&je(l=["disconnected","failed"]).call(l,s.connection.peerConnectionState);if(!s.connection||s.state!==pn.Connected||u){if(s.state===pn.Disconnected)throw new Se($.UNEXPECTED_ERROR,"PeerConnection already disconnected.");s.throwIfTrackTypeNotMatch(e);const m=e.filter(g=>s.pendingLocalTracks.indexOf(g)===-1);return s.pendingLocalTracks=s.pendingLocalTracks.concat(m),void(u&&(s._isWaitPcToRePub=!0))}s.store.pubId=s.store.pubId+1,Oi.markPublishStart(s.store.clientId,s.store.pubId);const p=s.filterTobePublishedTracks(e,t,r);if(p.length===0)return void(yield Zt(s.tryToUnmuteAudio(e)));yield*hy(d6(s.doPublish(s.connection,p)))}finally{a()}})()}doPublish(e,t){var r=this;return Go(function*(){t.forEach(b=>{let{track:C,type:B}=b;const M=Date.now();r.store.publish(C.getTrackId(),B===Ie.LocalAudioTrack?"audio":"video",M)}),r.bindLocalTrackEvents(t);const s=t.map(b=>{let{track:C}=b;return C}),a=yield Zt(e.send(s,r.store.codec,r.store.audioCodec)),l=(yield Zt(a.next())).value,u=r.createGatewayPublishMessage(t,l);let p;try{p=yield u}catch(b){throw a.throw(b),(b==null?void 0:b.code)===$.WS_ABORT&&t.forEach(C=>{let{track:B}=C;r.pendingLocalTracks.indexOf(B)===-1&&r.pendingLocalTracks.push(B)}),r.unbindLocalTrackEvents(t),b}const m=r.mapPubResToRemoteConfig(u,p,s),g=(yield Zt(a.next(m))).value;if(r.state===pn.Disconnected)throw new Se($.UNEXPECTED_ERROR,"PeerConnection already disconnected.");Z("ENABLE_VIDEO_SEI");const E=Z("ENABLE_ENCODED_TRANSFORM"),y=Z("ENABLE_AUDIO_METADATA");s.forEach(async b=>{const C=b.getRTCRtpTransceiver();if(!C||!E)return;const{interceptLocalVideoFrame:B,interceptLocalAudioFrame:M}=sS();b.trackMediaType===Ze.VIDEO?await B(C.sender,b):b.trackMediaType===Ze.AUDIO&&await M(C.sender,{metadata:y?()=>{const F=b.metadata.shift();return F&&F.value}:void 0})}),t.forEach(b=>{let{type:C}=b;r.statsCollector.addLocalStats(C)}),r.assignLocalTracks(t,g),r.statsUploader.startUploadOutboundStats(),t.forEach(b=>{let{track:C,type:B}=b;const M=Date.now();r.store.publish(C.getTrackId(),B===Ie.LocalAudioTrack?"audio":"video",void 0,M)})})()}async updateVideoStreamParameter(e,t){const r=this.localTrackMap.get(t);if(!r||!this.connection)return;if(!(r.track instanceof Un))return O.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:s}=r,a=function(l,u){const p={};return l.height&&l.width&&(p.scaleResolutionDownBy=m1(l,u)),p.maxFramerate=l.framerate?Zs(l.framerate):void 0,p.maxBitrate=l.bitrate?1e3*l.bitrate:void 0,p}(e,s);if(s._encoderConfig||(s._encoderConfig={}),t!==Ie.LocalVideoLowTrack||!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&tn().supportDualStreamEncoding)a.scaleResolutionDownBy!=null&&(s._encoderConfig.scaleResolutionDownBy=a.scaleResolutionDownBy);else{const l=s._originMediaStreamTrack;if(!l.canvas)return O.warn("[".concat(s.getTrackId(),"] no canvas on track"));(function(u,p){const m=u.canvas;p.width&&(m.width=Zs(p.width)),p.height&&(m.height=Zs(p.height)),p.framerate&&(m.stopCapture&&m.stopCapture(),m.stopCapture=HA(()=>{!m.startCapture&&m.stopCapture&&m.stopCapture(),m.startCapture&&m.startCapture()},Zs(p.framerate)))})(l,e)}a.maxBitrate!=null&&(s._encoderConfig.bitrateMax=a.maxBitrate/1e3),a.maxFramerate!=null&&(s._encoderConfig.frameRate&&typeof s._encoderConfig.frameRate=="object"?s._encoderConfig.frameRate.max=a.maxFramerate:s._encoderConfig.frameRate={max:a.maxFramerate}),O.debug("[".concat(s.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(s._encoderConfig))),await this.connection.updateRtpSenderEncodings(s)}publishLowStream(e){var t=this;return Go(function*(){if(!t.connection||t.state!==pn.Connected)return;const r=yield Zt(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const a=t.localTrackMap.get(Ie.LocalVideoTrack);if(!a)throw new Se($.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(Ie.LocalVideoLowTrack))throw new Se($.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const l=[{track:t.getLowVideoTrack(a.track,e),type:Ie.LocalVideoLowTrack}];if(yield*hy(d6(t.doPublish(t.connection,l))),a.track.muted||!a.track.enabled){var s;const u=(s=t.localTrackMap.get(Ie.LocalVideoLowTrack))===null||s===void 0?void 0:s.id;u!==void 0&&(yield Zt(t.connection.muteLocal([u])))}}finally{r()}})()}async republish(){this.pendingLocalTracks.length>0&&(O.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Si(this,ht.RequestRePublish,this.pendingLocalTracks),this.emit(ht.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(O.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Si(this,ht.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(e){for(let t=this.pendingRemoteTracks.length-1;t>=0;t--){const{user:r,kind:s}=this.pendingRemoteTracks[t];(s!==Ze.AUDIO||r._audio_added_&&r._audioSSRC)&&(s!==Ze.VIDEO||r._video_added_&&r._videoSSRC)||this.pendingRemoteTracks.splice(t,1)}if(e)await Si(this,ht.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:t,kind:r}of this.pendingRemoteTracks)await this.subscribe(t,r,r===Ze.VIDEO?t._videoSSRC:t._audioSSRC);this.pendingRemoteTracks.forEach(t=>{let{user:r}=t;this.emit(ht.MediaReconnectEnd,r.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==pn.Connected)return void e.forEach(s=>{const a=this.pendingLocalTracks.indexOf(s);a!==-1&&this.pendingLocalTracks.splice(a,1)});const t=this.filterTobeUnpublishedTracks(e);if(t.length===0)return;const r=t.find(s=>s[0]==="videoLowTrack");return r&&r[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==pn.Connected)return void e.forEach(r=>{const s=this.pendingLocalDataChannels.indexOf(r);s!==-1&&this.pendingLocalDataChannels.splice(s,1)});const t=this.filterTobeUnpublishedDataChannels(e);return t.length!==0?(t.forEach(r=>{const s=this.localDataChannels.indexOf(r);s!==-1&&this.localDataChannels.splice(s,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),t.map(r=>r.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==pn.Connected)return;const e=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(!e)return;e.track.close();const t=[[Ie.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const r=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map(s=>{let[,{id:a}]=s;return a})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(s=>{let[a,{track:l}]=s;return{type:a,track:l}})),t.forEach(s=>{let[a]=s;this.statsCollector.removeLocalStats(a)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),r}async subscribeDataChannel(e,t){if(!this.connection||this.state!==pn.Connected)throw new Se($.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const r=t.filter(s=>{var a;return!((a=this.remoteDataChannelMap.get(e))!==null&&a!==void 0&&a.get(s.id))});if(r.length!==0)return await this.connection.createDataChannels(e.uid,r),r.forEach(s=>{var a;this.remoteDataChannelMap.has(e)?(a=this.remoteDataChannelMap.get(e))===null||a===void 0||a.set(s.id,s):this.remoteDataChannelMap.set(e,new Map([[s.id,s]]));const l=this.pendingRemoteDataChannels.findIndex(u=>{let{user:p,id:m}=u;return p.uid===e.uid&&m===s.id});l!==-1&&this.pendingRemoteDataChannels.splice(l,1)}),r.map(s=>s.id)}async subscribe(e,t,r,s,a){var l;if(!this.connection||this.state!==pn.Connected)throw new Se($.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((l=this.remoteUserMap.get(e))!==null&&l!==void 0&&l.has(t))return;let u,p,m;const g=this.connection.getPreMedia(r);if(g)O.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(r,", no need to send sub to gateway.")),m=g.transceiver,u=g.track,p=g.id;else if(a){const b=a.find(B=>{let{stream_type:M}=B;return M===t});if(!b)throw new Se($.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const C=await this.connection.receive(t,b.ssrcs,String(e._uintid),b.attributes);this.connection instanceof tl&&(m=C.transceiver),u=C.track,p=C.id}else{const b=await this.connection.receive(t,[{ssrcId:r,rtx:s}],String(e._uintid),void 0);this.connection instanceof tl&&(m=b.transceiver),u=b.track,p=b.id}if(t===Ze.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(u):(e._audioTrack=new Cf(u,e.uid,e._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),m&&e._audioTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(u):(e._videoTrack=new wf(u,e.uid,e._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),m&&e._videoTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(e,e._videoTrack)),m&&Z("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:b,interceptRemoteAudioFrame:C}=sS();t==Ze.VIDEO?await b(m.receiver,{onSei:Z("ENABLE_VIDEO_SEI")&&(B=>{var M;return(M=e._videoTrack)===null||M===void 0?void 0:M._onSei(B)})}):t==Ze.AUDIO&&await C(m.receiver,{enableTopn:!!Z("ENABLE_AUDIO_TOPN"),enableMetadata:!!Z("ENABLE_AUDIO_METADATA"),onMetadata:B=>{this.safeEmit(ht.AudioMetadata,B)}})}const E=this.remoteUserMap.get(e);E?E.set(t,p):this.remoteUserMap.set(e,new Map([[t,p]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const y=this.pendingRemoteTracks.findIndex(b=>{let{user:C,kind:B}=b;return C.uid===e.uid&&t===B});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(ht.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==pn.Connected)throw new Se($.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(a=>{var l;let{user:u,mediaType:p}=a;return!((l=this.remoteUserMap.get(u))!==null&&l!==void 0&&l.has(p))});const t=[],r=new Map;e.forEach(a=>{if(!this.connection)return;const l=this.connection.getPreMedia(a.ssrcId);l?r.set(a.ssrcId,l):t.push(a)});const s=await this.connection.batchReceive(t.map(a=>{let{user:l,mediaType:u,ssrcId:p,rtxSsrcId:m}=a;return{kind:u,ssrcMsg:[{ssrcId:p,rtx:m}],mslabel:String(l._uintid)}}));t.forEach((a,l)=>{r.set(a.ssrcId,s[l])});for(const{user:a,mediaType:l,ssrcId:u}of e){const p=r.get(u);if(!p)return void O.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(a.uid," subscribe data,").concat(l,", ").concat(u));const{track:m,id:g,transceiver:E}=p;if(E&&Z("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:C,interceptRemoteAudioFrame:B}=sS();l==Ze.VIDEO?await C(E.receiver,{onSei:Z("ENABLE_VIDEO_SEI")&&(M=>{var F;return(F=a._videoTrack)===null||F===void 0?void 0:F._onSei(M)})}):l==Ze.AUDIO&&await B(E.receiver,{enableTopn:!!Z("ENABLE_AUDIO_TOPN"),enableMetadata:!!Z("ENABLE_AUDIO_METADATA"),onMetadata:M=>{this.safeEmit(ht.AudioMetadata,M)}})}if(l===Ze.AUDIO?(a._audioTrack?a._audioTrack._updateOriginMediaStreamTrack(m):(a._audioTrack=new Cf(m,a.uid,a._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(a._audioTrack.getTrackId()))),E&&a._audioTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(a,a._audioTrack)):(a._videoTrack?a._videoTrack._updateOriginMediaStreamTrack(m):(a._videoTrack=new wf(m,a.uid,a._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(a._videoTrack.getTrackId()))),E&&a._videoTrack._updateRtpTransceiver(E),this.bindRemoteTrackEvents(a,a._videoTrack)),Z("ENABLE_VIDEO_SEI")&&E){const{interceptRemoteVideoFrame:C,interceptRemoteAudioFrame:B}=sS();l==Ze.VIDEO?await C(E.receiver,{onSei:M=>{var F;(F=a._videoTrack)===null||F===void 0||F._onSei(M)}}):l==Ze.AUDIO&&await B(E.receiver)}const y=this.remoteUserMap.get(a);y?y.set(l,g):this.remoteUserMap.set(a,new Map([[l,g]])),this.statsCollector.addRemoteStats(a.uid),this.statsUploader.startUploadInboundStats();const b=this.pendingRemoteTracks.findIndex(C=>{let{user:B,kind:M}=C;return B.uid===a.uid&&l===M});b!==-1&&(this.pendingRemoteTracks.splice(b,1),this.emit(ht.MediaReconnectEnd,a.uid))}}async unsubscribe(e,t,r){const s=this.pendingRemoteTracks.filter(u=>{let{user:p,kind:m}=u;return t!==void 0?p.uid===e.uid&&t===m:p.uid===e.uid});if(s.forEach(u=>{const p=this.pendingRemoteTracks.indexOf(u);this.pendingRemoteTracks.splice(p,1)}),this.connection&&this.state===pn.Connected||r||s.forEach(u=>{let{kind:p}=u;var m;if(p===Ze.AUDIO)(m=e._audioTrack)===null||m===void 0||m._destroy(),e._audioTrack=void 0;else if(p===Ze.VIDEO){var g;(g=e._videoTrack)===null||g===void 0||g._destroy(),e._videoTrack=void 0}}),!this.connection||this.state!==pn.Connected)return;const a=this.filterTobeUnSubscribedTracks(e,t);if(a.length===0)return;await this.connection.stopReceiving(a.map(u=>{let[,{id:p}]=u;return p}));const l=this.createUnsubscribeMessage(a);return this.withdrawRemoteTracks(a),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),a.forEach(u=>{let[p,{kind:m}]=u;var g,E;if(m===Ze.VIDEO&&p._videoSSRC&&((g=this.connection)===null||g===void 0||g.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),m===Ze.VIDEO)this.unbindRemoteTrackEvents(p._videoTrack),r||((E=p._videoTrack)===null||E===void 0||E._destroy(),p._videoTrack=void 0);else if(m===Ze.AUDIO){var y;this.unbindRemoteTrackEvents(p._audioTrack),!r&&((y=p._audioTrack)===null||y===void 0||y._destroy(),p._audioTrack=void 0)}}),l}async unsubscribeDataChannel(e,t){if(t.forEach(a=>{const l=this.pendingRemoteDataChannels.findIndex(u=>u.id===a.id);l!==-1&&this.pendingRemoteDataChannels.splice(l,1)}),!this.connection)return;const r=this.filterTobeUnSubscribedDataChannels(e,t);if(r.length===0)return;t.forEach(a=>{a._close()});const s=this.remoteDataChannelMap.get(e);return r.forEach(a=>{s&&s.delete(a.id)}),s&&s.size===0&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),r.map(a=>a.id)}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:a,mediaType:l}of e){const u=this.pendingRemoteTracks.filter(p=>{let{user:m,kind:g}=p;return l!==void 0?m.uid===a.uid&&l===g:m.uid===a.uid});u.forEach(p=>{const m=this.pendingRemoteTracks.indexOf(p);this.pendingRemoteTracks.splice(m,1)}),t=t.concat(u)}if(!this.connection||this.state!==pn.Connected)return void t.forEach(a=>{let{user:l,kind:u}=a;var p;if(u===Ze.AUDIO)(p=l._audioTrack)===null||p===void 0||p._destroy(),l._audioTrack=void 0;else if(u===Ze.VIDEO){var m;(m=l._videoTrack)===null||m===void 0||m._destroy(),l._videoTrack=void 0}});const r=ma(e).call(e,(a,l)=>{let{user:u,mediaType:p}=l;const m=this.filterTobeUnSubscribedTracks(u,p);return a.concat(m)},[]);if(r.length===0)return;await this.connection.stopReceiving(r.map(a=>{let[,{id:l}]=a;return l}));const s=this.createUnsubscribeAllMessage(r);return this.withdrawRemoteTracks(r),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),r.forEach(a=>{let[l,{kind:u}]=a;var p,m;if(u===Ze.VIDEO&&l._videoSSRC&&((p=this.connection)===null||p===void 0||p.setStatsRemoteVideoIsReady(l._videoSSRC,!1)),u===Ze.VIDEO)this.unbindRemoteTrackEvents(l._videoTrack),(m=l._videoTrack)===null||m===void 0||m._destroy(),l._videoTrack=void 0;else if(u===Ze.AUDIO){var g;this.unbindRemoteTrackEvents(l._audioTrack),(g=l._audioTrack)===null||g===void 0||g._destroy(),l._audioTrack=void 0}}),s}isPreSubScribe(e){return!this.connection||this.state!==pn.Connected?!1:!!this.connection.getPreMedia(e)}async muteRemote(e,t){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void O.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(t))return void O.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const s=t===Ze.VIDEO?e._videoSSRC:e._audioSSRC;s!==void 0&&this.connection.setStatsRemoteVideoIsReady(s,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void O.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(t)||O.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."))}addAudioMetadata(e){const t=this.localTrackMap.get(Ie.LocalAudioTrack),r=t&&t.track;r&&r.metadata.push(e)}getAllTracks(e){const t=this.localTrackMap.get(Ie.LocalAudioTrack);if((t==null?void 0:t.track)instanceof Or){const r=t.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[a]=s;return a!==Ie.LocalAudioTrack}).filter(s=>{let[a]=s;return!(e&&a===Ie.LocalVideoLowTrack)}).map(s=>{let[,{track:a}]=s;return a}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[s]=r;return!(e&&s===Ie.LocalVideoLowTrack)}).map(r=>{let[,{track:s}]=r;return s})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,r,s,a){if(e){const u=this.localTrackMap.get(Ie.LocalAudioTrack),p=s?this.localTrackMap.get(Ie.LocalVideoLowTrack):this.localTrackMap.get(Ie.LocalVideoTrack);st.publish(this.store.sessionId,{eventElapse:Oi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:u==null?void 0:u.track.getTrackLabel(),videoName:p==null?void 0:p.track.getTrackLabel(),screenshare:(p==null?void 0:p.track._hints.indexOf(Tn.SCREEN_TRACK))!==-1,audio:!!u,video:!!p,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:a})}else{var l;r||(r=[]);const u=r.find(m=>m instanceof dr),p=s?(l=this.localTrackMap.get(Ie.LocalVideoTrack))===null||l===void 0?void 0:l.track:r.find(m=>m instanceof Un);st.publish(this.store.sessionId,{eventElapse:Oi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:u==null?void 0:u.getTrackLabel(),videoName:p==null?void 0:p.getTrackLabel(),screenshare:(p==null?void 0:p._hints.indexOf(Tn.SCREEN_TRACK))!==-1,audio:!!u,video:!!p,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:a})}}reportSubscribeEvent(e,t,r,s){const a=s===Ze.VIDEO?r._videoSSRC:r._audioSSRC;a&&st.subscribe(this.store.sessionId,{succ:e,ec:t,video:s===Ze.VIDEO,audio:s===Ze.AUDIO,peerid:r.uid,subscribeRequestid:a,p2pid:this.store.p2pId,eventElapse:Oi.measureFromSubscribeStart(this.store.clientId,a),preSsrc:this.isPreSubScribe(a)})}reset(){O.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Ai("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=hS(this.store),this.emit(ht.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(Ie.LocalAudioTrack);if((e==null?void 0:e.track)instanceof Or){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(r=>{t.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=pn.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return((t=this.connection)===null||t===void 0?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(Ie.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(Ie.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof Un||t&&t.track instanceof dr?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t;const r=Array.from(_o(t=this.remoteUserMap).call(t)).find(s=>s.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[s]=r;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(Ie.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=th(e).call(e,(r,s)=>r.level-s.level),e}async disconnectForReconnect(){this.connection&&(O.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=pn.Reconnecting,Z("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var r;t._videoTrack&&t._videoTrack._player&&((r=t._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=hS(this.store),this.emit(ht.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[r,{track:s}]=e;switch(r){case Ie.LocalVideoTrack:je(t=s._hints).call(t,Tn.LOW_STREAM)?s.close():this.pendingLocalTracks.push(s);break;case Ie.LocalAudioTrack:s instanceof Or?this.pendingLocalTracks=this.pendingLocalTracks.concat(s.trackList):this.pendingLocalTracks.push(s);case Ie.LocalVideoLowTrack:}}),this.emit(ht.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;Array.from(_o(r).call(r)).forEach(s=>{this.setPendingRemoteMedia(t,s)}),this.emit(ht.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(e=>{this.pendingLocalDataChannels.push(e)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(e=>{let[t,r]=e;Array.from(_o(r).call(r)).forEach(s=>{this.setPendingRemoteDataChannel(t,s)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),O.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(const r of this.pendingRemoteDataChannels){const{user:s,id:a}=r;if((e instanceof Vd?e.uid:e)===s.uid&&a===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const r of this.pendingRemoteTracks){const{user:s,kind:a}=r;if((e instanceof Vd?e.uid:e)===s.uid&&t===a)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return Go(function*(){if(!t.connection||t.state!==pn.Connected)return;const r=yield Zt(t.mutex.lock("From P2PChannel.restartICE"));let s;try{s=yield Zt(t.connection.restartICE(e));const l=yield Zt(s.next());if(l.done)return;const u=l.value,p=yield u;switch(D1(t.connection)&&t.reportPCStats(Date.now(),!1,t._pcStatsUploadType),e){case Ii.UDP_TCP_RELAY:t._pcStatsUploadType=Ul.UDP_TCP_RESTART;break;case Ii.TCP_RELAY:t._pcStatsUploadType=Ul.TCP_RESTART;break;case Ii.RELAY:t._pcStatsUploadType=Ul.RELAY_RESTART;break;default:t._pcStatsUploadType=Ul.OLD_RESTART}t._isTryConnecting=!0,s.next(p)}catch(l){var a;(a=s)===null||a===void 0||a.throw(l)}finally{r()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(Ie.LocalVideoTrack),r=this.localTrackMap.get(Ie.LocalAudioTrack),s=e.videoSend.find(C=>C.ssrc===(t==null?void 0:t.ssrcs[0].ssrcId)),a=e.audioSend.find(C=>C.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId));if(!s||!a)return 1;const l=mo(this,ht.NeedSignalRTT),u=s?s.rttMs:void 0,p=a?a.rttMs:void 0,m=u&&p?(u+p)/2:u||p,g=(m&&l?(m+l)/2:m||l)||0,E=100*e.sendPacketLossRate*.7/50+.3*g/1500,y=E<.17?1:E<.36?2:E<.59?3:E<.1?4:5,b=t==null?void 0:t.track;if(b&&b._encoderConfig&&b._hints.indexOf(Tn.SCREEN_TRACK)===-1){const C=b._encoderConfig.bitrateMax,B=e.bitrate.actualEncoded;if(C&&B){const M=(1e3*C-B)/(1e3*C);return YB[M<.15?0:M<.3?1:M<.45?2:M<.6?3:4][y]}}return y}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[s]=r;const a=s._audioSSRC,l=s._videoSSRC,u=e.audioRecv.find(B=>B.ssrc===a),p=e.videoRecv.find(B=>B.ssrc===l);if(!u&&!p)return void(t+=1);const m=mo(this,ht.NeedSignalRTT),g=e.rtt,E=(g&&m?(g+m)/2:g||m)||0,y=u?u.jitterMs:void 0,b=e.recvPacketLossRate;let C=.7*b*100/50+.3*E/1500;y&&(C=.6*b*100/50+.2*E/1500+.2*y/400),t+=C<.1?1:C<.17?2:C<.36?3:C<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new Ye((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}async replaceTrack(e,t){var r;if(O.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(t.getTrackId(),"]")),!this.connection||this.state!==pn.Connected)return;const s=Array.from(this.localTrackMap.entries()).find(l=>{let[,{track:u}]=l;return e===u});if(!s)return;const a=s[0];if(e!==t&&(this.unbindLocalTrackEvents([{track:e,type:a}]),this.bindLocalTrackEvents([{track:t,type:a}]),s[1].track=t),await((r=this.connection)===null||r===void 0?void 0:r.replaceTrack(t,s[1].id)),this.isPlanB){const l=s[1];l.id=t._mediaStreamTrack.id,this.localTrackMap.set(a,l)}if(a===Ie.LocalVideoTrack&&!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&tn().supportDualStreamEncoding){const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(l){const u=e._mediaStreamTrack.clone();l.track._originMediaStreamTrack.stop(),l.track._mediaStreamTrack=u,l.track._originMediaStreamTrack=u,await new Ye((p,m)=>{this.handleReplaceTrack(l.track,p,m,!0)})}}}filterTobePublishedTracks(e,t,r){const s=[],a=this.getAllTracks();e=hf(e=e.filter(m=>a.indexOf(m)===-1));let l,u=!1;const p=this.localTrackMap.get(Ie.LocalAudioTrack);for(const m of e){if(m instanceof Un&&(this.localTrackMap.has(Ie.LocalVideoTrack)||u?new Se($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:m,type:Ie.LocalVideoTrack}),u=!0),t)){const g=this.getLowVideoTrack(m,r);s.push({track:g,type:Ie.LocalVideoLowTrack})}if(m instanceof dr)if(p){const g=p.track;if(g instanceof Or)I1([m]),g.addAudioTrack(m),this.bindLocalAudioTrackEvents(m,!0);else{const E=O1([g,m]);O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(E.getTrackId(),"]")),this.replaceTrack(g,E)}}else l instanceof Or?(I1([m]),l.addAudioTrack(m)):l||!m._useAudioElement&&tn().webAudioMediaStreamDest&&!m._bypassWebAudio?l=O1(l?[m,l]:[m]):l=m}return l&&(O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(l.getTrackId(),"]")),s.push({track:l,type:Ie.LocalAudioTrack})),s}filterTobeUnpublishedTracks(e){const t=[],r=this.getAllTracks();e=hf(e=e.filter(s=>r.indexOf(s)!==-1));for(const s of e){if(s instanceof dr){const a=this.localTrackMap.get(Ie.LocalAudioTrack);if(!a)continue;a.track instanceof Or?(a.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),a.track.trackList.length===0&&(t.push([Ie.LocalAudioTrack,a]),a.track.close())):t.push([Ie.LocalAudioTrack,a])}if(s instanceof Un){const a=this.localTrackMap.get(Ie.LocalVideoTrack);if(!a)continue;t.push([Ie.LocalVideoTrack,a]);const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);l&&t.push([Ie.LocalVideoLowTrack,l])}}return t}filterTobePublishedDataChannels(e){return e=(e=hf(e)).filter(t=>this.localDataChannels.findIndex(r=>r.id===t.id)===-1)}filterTobeUnpublishedDataChannels(e){return e=(e=(e=hf(e)).filter(t=>this.localDataChannels.indexOf(t)!==-1)).filter(t=>t._originDataChannel)}bindLocalTrackEvents(e){e.forEach(t=>{let{track:r,type:s}=t;switch(s){case Ie.LocalVideoTrack:r.addListener(rt.GET_STATS,this.handleGetLocalVideoStats),r.addListener(rt.GET_RTC_STATS,this.handleGetRTCStats),r.addListener(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(rt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(rt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case Ie.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof Or?e.trackList.forEach(r=>{r.addListener(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(rt.GET_STATS,this.handleGetLocalAudioStats),r.addListener(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(rt.GET_STATS,this.handleGetLocalAudioStats),e.addListener(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||(e.addListener(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(rt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[r,{track:s}]=t;return{track:s,type:r}})),e.forEach(t=>{let{track:r,type:s}=t;switch(s){case Ie.LocalVideoTrack:r.off(rt.GET_STATS,this.handleGetLocalVideoStats),r.off(rt.GET_RTC_STATS,this.handleGetRTCStats),r.off(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(rt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(rt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case Ie.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Or?e.trackList.forEach(t=>{t.off(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(rt.GET_STATS,this.handleGetLocalAudioStats),t.off(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(rt.GET_STATS,this.handleGetLocalAudioStats),e.off(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(rt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof wf&&t.addListener(rt.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),t instanceof Cf&&t.addListener(rt.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(rt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;r.has(Ze.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),r.has(Ze.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((r,s)=>{var a;let l,u,{track:p,type:m}=r;switch(m){case Ie.LocalAudioTrack:l=gn.Audio,u={dtx:p instanceof pg&&p._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Ie.LocalVideoTrack:l=je(a=p._hints).call(a,Tn.SCREEN_TRACK)?gn.Screen:gn.High,u=nl(nl({},d5(p)),{},{codec:this.store.codec,svc_mode:eS()});break;case Ie.LocalVideoLowTrack:l=gn.Low,u=nl(nl({},d5(p)),{},{codec:this.store.codec,svc_mode:eS()})}return{stream_type:l,attributes:u,ssrcs:t[s]}})}createGatewayUnpublishMessage(e){return e.map(t=>{var r;let s,[a,{track:l,ssrcs:u,id:p}]=t;switch(a){case Ie.LocalVideoTrack:s=je(r=l._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoLowTrack:s=gn.Low}return{stream_type:s,ssrcs:u,mid:p}})}assignLocalTracks(e,t){e.forEach((r,s)=>{let{track:a,type:l}=r;this.localTrackMap.set(l,{track:a,id:t[s].id,ssrcs:t[s].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[r]=t;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(ht.PeerConnectionStateChange,t),t==="connecting"&&e instanceof tl&&!rr()&&Z("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{t==="connecting"&&e.extendCandidate()},Z("FIRST_TCP_CANDIDATE_INTERVAL")),t!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),t==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),e instanceof tl&&a6(e,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=Ul.DISCONNECTED_OR_FAILED,mo(this,ht.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const r=this.pendingLocalTracks.map(a=>a.getTrackId()),s=this.pendingLocalDataChannels.map(a=>"dc_".concat(a.id));st.reportApiInvoke(this.store.sessionId,{name:xr.REPUB_AFTER_PC_CONNECTED,options:r.concat(s),tag:sr.TRACER}).onSuccess(),this.republish()}if(Z("NEW_ICE_RESTART")&&e instanceof tl&&!rr()&&!this._forceTurn){if(je(i5).call(i5,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const r=a=>{D1(e)&&(O.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(a)),mo(this,ht.QueryClientConnectionState)==="CONNECTED"&&this.emit(ht.RequestRestartICE,a))},s=()=>{D1(e)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),O.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(ht.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{c6(e,r,s)},800))}}else{if(t==="disconnected"&&e.iceConnectionState==="disconnected")return setTimeout(()=>{e.iceConnectionState==="disconnected"&&Z("ICE_RESTART")&&mo(this,ht.QueryClientConnectionState)==="CONNECTED"&&this.emit(ht.RequestRestartICE)},800),void setTimeout(()=>{e.peerConnectionState==="disconnected"&&(O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(ht.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);t==="failed"&&(O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(ht.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=t=>{t!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(t,")")),st.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:t,tag:sr.TRACER}).onSuccess(),this.emit(ht.IceConnectionStateChange,t)},e.onICETransportStateChange=t=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(t,")"))},e.onDTLSTransportStateChange=t=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(t,")"))},e.onDTLSTransportError=t=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(t,")"))},e.onFirstAudioDecoded=t=>{var r;const s=Array.from(_o(r=this.remoteUserMap).call(r)).find(l=>l._audioSSRC===t);var a;s&&(this.store.subscribe(s.uid,"audio",void 0,void 0,void 0,Date.now()),(a=s.audioTrack)===null||a===void 0||a.emit(yf.FIRST_FRAME_DECODED),st.firstRemoteFrame(this.store.sessionId,Fr.FIRST_AUDIO_DECODE,qn.FIRST_AUDIO_DECODE,{peer:s._uintid,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=t=>{var r;const s=Array.from(_o(r=this.remoteUserMap).call(r)).find(a=>a._audioSSRC===t);s&&st.firstRemoteFrame(this.store.sessionId,Fr.FIRST_AUDIO_RECEIVED,qn.FIRST_AUDIO_RECEIVED,{peer:s._uintid,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(t,r,s)=>{this.reportVideoFirstFrameDecoded(t,r,s)},e.onFirstVideoReceived=t=>{var r;const s=Array.from(_o(r=this.remoteUserMap).call(r)).find(a=>a._videoSSRC===t);s&&st.firstRemoteFrame(this.store.sessionId,Fr.FIRST_VIDEO_RECEIVED,qn.FIRST_VIDEO_RECEIVED,{peer:s._uintid,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(t,r)=>{const s=t.candidateType==="relay",a=r.candidateType==="relay";r.candidateType!=="unknown"&&s===a||this.emit(ht.ConnectionTypeChange,s),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(jd(r))," -> ").concat(JSON.stringify(jd(t)),")"))},e.onSelectedRemoteCandidateChanged=(t,r)=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(jd(r))," -> ").concat(JSON.stringify(jd(t)),")"))},e.onFirstVideoDecodedTimeout=t=>{this.reportVideoFirstFrameDecoded(t,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const t=this.statsCollector.getLocalVideoTrackStats(),r=this.statsCollector.getRTCStats();return nl(nl({},t),r)},e.onICECandidateError=t=>{this._iceError=t}}resetConnection(e){e instanceof tl&&function(t){Ff.delete(t.id),a6(t)}(e),e.close(),this.emit(ht.PeerConnectionStateChange,"closed"),function(t){t.onConnectionStateChange=void 0,t.onICEConnectionStateChange=void 0,t.onICETransportStateChange=void 0,t.onDTLSTransportStateChange=void 0,t.onDTLSTransportError=void 0,t.onFirstAudioDecoded=void 0,t.onFirstAudioReceived=void 0,t.onFirstVideoDecoded=void 0,t.onFirstVideoReceived=void 0,t.onSelectedLocalCandidateChanged=void 0,t.onSelectedRemoteCandidateChanged=void 0,t.onFirstVideoDecodedTimeout=void 0,t.getLocalVideoStats=void 0}(e),this._isWaitPcToRePub=!1}filterTobeMutedTracks(e){const t=[];if(this.getAllTracks().indexOf(e)===-1)return t;const r=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof dr&&(r==null?void 0:r.track)instanceof Or)return r.track.isActive||t.push([Ie.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(a=>{let[,{track:l}]=a;return e===l});if(s&&(t.push(s),s[0]===Ie.LocalVideoTrack)){const a=this.localTrackMap.get(Ie.LocalVideoLowTrack);a&&t.push([Ie.LocalVideoLowTrack,a])}return t}filterTobeUnmutedTracks(e){const t=[],r=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof dr&&(r==null?void 0:r.track)instanceof Or)return r.track.isActive&&t.push([Ie.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(a=>{let[,{track:l}]=a;return e===l});if(s)if(s[0]===Ie.LocalVideoTrack){t.push(s);const a=this.localTrackMap.get(Ie.LocalVideoLowTrack);a&&t.push([Ie.LocalVideoLowTrack,a])}else t.push(s);return t}createMuteMessage(e){return e.map(t=>{var r;let s,[a,{track:l,ssrcs:u,id:p}]=t;switch(a){case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoTrack:s=je(r=l._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalVideoLowTrack:s=gn.Low}return{stream_type:s,ssrcs:u,mid:p}})}createUnmuteMessage(e){return e.map(t=>{var r;let s,[a,{track:l,ssrcs:u,id:p}]=t;switch(a){case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoTrack:s=je(r=l._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalVideoLowTrack:s=gn.Low}return{stream_type:s,ssrcs:u,mid:p}})}filterTobeUnSubscribedTracks(e,t){const r=[],s=this.remoteUserMap.get(e);if(!s)return r;if(t){const a=s.get(t);if(!a)return r;r.push([e,{kind:t,id:a}])}else Array.from(s.entries()).forEach(a=>{let[l,u]=a;r.push([e,{kind:l,id:u}])});return r}filterTobeUnSubscribedDataChannels(e,t){const r=[];return t.forEach(s=>{var a;(a=this.remoteDataChannelMap.get(e))!==null&&a!==void 0&&a.has(s.id)&&r.push(s)}),r}createUnsubscribeMessage(e){const t=[];return e.forEach(r=>{let[s,{kind:a,id:l}]=r;switch(a){case Ze.VIDEO:return void(s._videoSSRC&&t.push({stream_type:Ze.VIDEO,ssrcId:s._videoSSRC}));case Ze.AUDIO:return void(s._audioSSRC&&t.push({stream_type:Ze.AUDIO,ssrcId:s._audioSSRC}))}}),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach(r=>{let[s,{kind:a}]=r;if(t.has(s)){let l=t.get(s);a===Ze.VIDEO?l|=Vr.Video:l|=Vr.Audio,t.set(s,l)}else a===Ze.VIDEO?t.set(s,Vr.Video):t.set(s,Vr.Audio)}),{users:Array.from(t.entries()).map(r=>{let[s,a]=r;return{stream_id:s.uid,stream_type:a}})}}withdrawRemoteTracks(e){e.forEach(t=>{let[r,{kind:s}]=t;const a=this.remoteUserMap.get(r);a&&(a.delete(s),Array.from(a.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(Ie.LocalVideoTrack),r=this.localTrackMap.get(Ie.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new Ye((s,a)=>{this.handleUpdateVideoEncoder(t.track,s,a,!0)})),r&&e.low_stream_uplink&&(await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new Ye((s,a)=>{this.handleUpdateVideoEncoder(r.track,s,a,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,t,r){return e.map((s,a)=>{var l;let{stream_type:u}=s;const p=(l=t.find(m=>{let{stream_type:g}=m;return u===g}))===null||l===void 0?void 0:l.attributes;if(p&&Z("DISABLE_SCREEN_SHARE_REMB")){const m=r[a]._hints;(je(m).call(m,Tn.SCREEN_TRACK)||je(m).call(m,Tn.SCREEN_LOW_TRACK))&&(p.remb=!1,O.debug("disable remb for screen share, hints:",m))}return p})}async tryToUnmuteAudio(e){for(let r=0;r<e.length;r++)if(e[r]instanceof dr){var t;const s=this.filterTobeUnmutedTracks(e[r]);if(s.length===0)continue;await((t=this.connection)===null||t===void 0?void 0:t.unmuteLocal(s.map(l=>{let[,{id:u}]=l;return u})));const a=this.createUnmuteMessage(s);return void await Cn(this,ht.RequestUnmuteLocal,a)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!((t=this.connection)===null||t===void 0||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(ht.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(ht.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var e;return{connectState:((e=this.connection)===null||e===void 0?void 0:e.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await ai(TA(this.dtlsFailedCount,Rr)),this.emit(ht.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await Si(this,ht.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(ht.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Ie.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Un)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof Un).length>1)throw new Se($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof dr).length>1&&(e.some(t=>t instanceof dr&&t._bypassWebAudio)||!tn().webAudioMediaStreamDest))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof Un&&this.pendingLocalTracks.some(r=>r instanceof Un))throw new Se($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof dr&&this.pendingLocalTracks.some(r=>r instanceof dr)&&(!tn().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof dr&&r._bypassWebAudio)))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){var r;const s=!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&tn().supportDualStreamEncoding,a=nl(nl({},{width:160,height:120,framerate:15,bitrate:50}),t);let l;l=s?e._mediaStreamTrack.clone():P1(e,a);const u=An(8,"track-low-"),p=new Un(l,nl(nl({},s&&{scaleResolutionDownBy:m1(a,e)}),{},{frameRate:a.framerate,bitrateMax:a.bitrate,bitrateMin:a.bitrate}),void 0,void 0,u);return p.on(fh.TRANSCEIVER_UPDATED,m=>{e._updateRtpTransceiver(m,Ef.LOW_STREAM)}),p._hints.push(Tn.LOW_STREAM),je(r=e._hints).call(r,Tn.SCREEN_TRACK)&&p._hints.push(Tn.SCREEN_LOW_TRACK),e.on("sei-to-send",m=>{p.emit("sei-to-send",m)}),e.addListener(rt.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof tl){var a,l,u,p;const m=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:g,dtlsTransportState:E,peerConnectionState:y}=this.connection,{local:b,remote:C}=await this.connection.getSelectedCandidatePair();st.pcStats(this.store.sessionId,{startTime:m,eventElapse:e-m||0,iceconnectionsate:g,dtlsstate:E,connectionstate:y,intSucc:t?1:2,error:this._iceError||s||"",selectedLocalCandidateProtocol:(a=b==null?void 0:b.protocol)!==null&&a!==void 0?a:"",selectedLocalCandidateType:(l=b.candidateType)!==null&&l!==void 0?l:"",selectedLocalCandidateAddress:"".concat(b.address,":").concat(b.port),selectedRemoteCandidateProtocol:(u=C.protocol)!==null&&u!==void 0?u:"",selectedRemoteCandidateType:(p=C.candidateType)!==null&&p!==void 0?p:"",selectedRemoteCandidateAddress:"".concat(C.address,":").concat(C.port),restartCnt:r,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(e,t,r,s){var a;const l=Array.from(_o(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===e);if(l){s||this.store.subscribe(l.uid,"video",void 0,void 0,void 0,void 0,Date.now());const u=this.store.keyMetrics,p=u.subscribe.find(m=>m.userId===l.uid&&m.type==="video");st.firstRemoteVideoDecode(this.store.sessionId,Fr.FIRST_VIDEO_DECODE,qn.FIRST_VIDEO_DECODE,{peer:l._uintid,videowidth:t,videoheight:r,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:u.requestAPEnd||0,apStart:u.requestAPStart||0,joinGwEnd:u.joinGatewayEnd||0,joinGwStart:u.joinGatewayStart||0,pcEnd:u.peerConnectionEnd||0,pcStart:u.peerConnectionStart||0,subscriberEnd:(p==null?void 0:p.subscribeEnd)||0,subscriberStart:(p==null?void 0:p.subscribeStart)||0,videoAddNotify:(p==null?void 0:p.streamAdded)||0,state:s?1:0,firstFrame:(p==null?void 0:p.firstFrame)||0})}}async remoteMediaSsrcChanged(e,t,r){if(!this.connection)return!1;const s=this.remoteUserMap.get(e);if(!s)return!1;const a=s.get(t);if(!a)return!1;const l=await this.connection.getRemoteSSRC(a);return l!==void 0&&l!==r}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:r}]=e;t===Ie.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,Ef.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},it(Wt.prototype,"startP2PConnection",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"startP2PConnection"),Wt.prototype),it(Wt.prototype,"connect",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"connect"),Wt.prototype),it(Wt.prototype,"updateRemoteRTPCapabilities",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateRemoteRTPCapabilities"),Wt.prototype),it(Wt.prototype,"publishDataChannel",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"publishDataChannel"),Wt.prototype),it(Wt.prototype,"unpublish",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unpublish"),Wt.prototype),it(Wt.prototype,"unpublishDataChannel",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unpublishDataChannel"),Wt.prototype),it(Wt.prototype,"unpublishLowStream",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unpublishLowStream"),Wt.prototype),it(Wt.prototype,"subscribeDataChannel",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"subscribeDataChannel"),Wt.prototype),it(Wt.prototype,"subscribe",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"subscribe"),Wt.prototype),it(Wt.prototype,"massSubscribe",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"massSubscribe"),Wt.prototype),it(Wt.prototype,"unsubscribe",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unsubscribe"),Wt.prototype),it(Wt.prototype,"unsubscribeDataChannel",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unsubscribeDataChannel"),Wt.prototype),it(Wt.prototype,"massUnsubscribe",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"massUnsubscribe"),Wt.prototype),it(Wt.prototype,"muteRemote",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"muteRemote"),Wt.prototype),it(Wt.prototype,"unmuteRemote",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"unmuteRemote"),Wt.prototype),it(Wt.prototype,"hasRemoteMediaWithLock",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"hasRemoteMediaWithLock"),Wt.prototype),it(Wt.prototype,"disconnectForReconnect",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"disconnectForReconnect"),Wt.prototype),it(Wt.prototype,"updateBitrateLimit",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"updateBitrateLimit"),Wt.prototype),it(Wt.prototype,"remoteMediaSsrcChanged",[qi],Object.getOwnPropertyDescriptor(Wt.prototype,"remoteMediaSsrcChanged"),Wt.prototype),Wt);function qi(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const a=this.mutex,l=await a.lock("From P2PChannel.".concat(t));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},r}function u6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function h6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u6(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u6(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const ehe=Date.now(),the=20,L1=new Map,_S=new Map;async function p6(e){const t=L1.get(e),r=Array.isArray(t)&&t[t.length-1],s=_S.get(e);if(!r)return void(s.isSyncing=!1);const a={uid:r.uid,payload:r.payload};s.firstRecvTs===0&&(s.firstRecvTs=r.recvTs,s.firstSendTs=r.sendTs);const l=r.sendTs-s.firstSendTs,u=l-(Date.now()-s.firstRecvTs);u>0&&(s.firstRecvTs=Date.now()-l);let p=r.mediaDelay+u;p<=0?(t.pop(),f6(r.context,a),p=0):p=Math.min(p,the),setTimeout(()=>t.length&&p6(e),p)}function f6(e,t){e.safeEmit(Ht.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function nhe(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return f6(r,{uid:e.uid,payload:e.payload});const s="".concat(r.id,"-").concat(e.uid),a=L1.get(s)||[],l=a.findIndex(g=>e.sendTs>=g.sendTs),u=h6(h6({},e),{},{context:r,mediaDelay:t,recvTs:Date.now()});l===-1?a.push(u):a.splice(l,0,u),L1.set(s,a);let p=!1;var m;_S.has(s)?p=!((m=_S.get(s))===null||m===void 0||!m.isSyncing):_S.set(s,{isSyncing:p,firstRecvTs:0,firstSendTs:0}),p||p6(s)}const rhe=en().name;function m6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function g6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m6(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m6(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const Vf="websdk_ng_cache_parameter",ihe=Z("MAX_PRELOAD_ASYNC_LENGTH"),she=1e4,bh=new Map,wh=[];let M1=null,j1=0,U1=0;const ES=new Map,ohe=function(e,t){const r=[];let s=0;const a=async()=>{const l=r.shift();l&&await l(),r.length>0&&s<t?a():s--};return async function(){for(var l=arguments.length,u=new Array(l),p=0;p<l;p++)u[p]=arguments[p];return new Ye(async(m,g)=>{r.push(async()=>{try{const E=await e(...u);m(E)}catch(E){g(E)}}),s<t&&(s++,a())})}}(_6,ihe),F1=_s.CancelToken.source();async function _6(e,t,r,s,a,l){try{if(!Z("ENABLE_PRELOAD"))return;if(!tn().supportWebCrypto)return void Od(()=>{O.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!r&&r!==null)throw new Se($.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&oi(r,"token",1,2047),oi(e,"appid",1,2047),$y(t),s&&Xy(s);const u=hh();O.debug("preload channel ".concat(t,", uid is ").concat(s));const p={appId:e,cname:t,token:r||e,uid:typeof s!="string"?s:null,sid:u,proxyServer:a};let m,g;typeof s=="string"?(p.stringUid=s,[g,m]=await Ye.all([Wue(s,{sid:u,appId:e},F1.token),B5(g6(g6({},p),{},{token:r||e,uid:0}),F1.token)]),p.uid=g.uid,m.gatewayInfo.uid=p.uid,m.gatewayInfo.res.uid=p.uid):(l&&(p.stringUid=l),m=await B5(p,F1.token));const E={sid:u,appId:e,cname:t,token:r||e,uid:p.stringUid||s,intUid:p.uid||m.gatewayInfo.uid,stringUid:p.stringUid,ts:Date.now(),sua:g,ap:m};await async function(y){let b;try{y.uid&&v6({appId:y.appId,cname:y.cname,token:y.token,uid:y.uid,stringUid:y.stringUid});const C=T6(y),B=await async function(F,q){try{const Y=await window.crypto.subtle.importKey("raw",dV(q),"AES-GCM",!1,["encrypt"]),re=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},Y,uh(window.btoa(JSON.stringify(F))));return Dd(new Uint8Array(re))}catch{return}}(y,y.token||y.appId);if(!B)return;b=x6(Vf);const M=b?JSON.parse(b):[];M.push({[C]:B}),M.length>Z("AP_CACHE_NUM")&&M.shift(),vS(Vf,JSON.stringify(M))}catch(C){O.warn("Error caching server parameters:",C.message),vS(Vf,"")}}(E),j1++}catch(u){throw U1++,function(p){M1||(M1=window.setTimeout(()=>{let g="";ES.forEach((E,y)=>{g+="".concat(y,": ").concat(E," ;")}),st.reportApiInvoke(null,{name:xr.PRELOAD,options:{success:j1,failed:U1,err:g}}).onError(p),j1=0,U1=0,ES.clear(),M1=null},she));const m=ES.get(p.code)||0;ES.set(p.code,m+1)}(u),u}}async function E6(e){try{if(Z("AP_REQUEST_DETAIL")||Z("ENABLE_ROLE_SELECT_EDGE"))return;const t=v6(e);if(!t||e.cloudProxyServer!=="disabled")return;const r=await async function(s,a){try{const l=await window.crypto.subtle.importKey("raw",dV(a),"AES-GCM",!1,["decrypt"]),u=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},l,uh(s));return JSON.parse(window.atob(Dd(new Uint8Array(u))))}catch{return}}(t,e.token||e.appId);if(!r||!function(s,a){return s.cname===a.cname&&s.appId===a.appId&&s.token===a.token?a.stringUid?s.stringUid===a.stringUid:typeof a.uid=="number"?s.uid===a.uid:s.uid==a.uid:!1}(r,e))return;if(r&&Date.now()-r.ts<Z("AP_CACHE_LIFETIME"))return r}catch(t){O.warn("Error get preloadInfo",t.message)}}function v6(e){let t;try{if(t=x6(Vf),!t)return;const r=JSON.parse(t),s=T6(e),a=function(u,p){for(let m=u.length-1;m>=0;m--)if(p(u[m]))return m;return-1}(r,u=>s in u);if(a===-1)return;const l=r.splice(a,1)[0];return vS(Vf,JSON.stringify(r)),l[s]}catch(r){O.warn("Error delete preload info: ".concat(t),r.message),vS(Vf,"")}}function V1(e){if(e){let t=bh.get(e);t&&(window.clearTimeout(t),t=null,bh.delete(e)),je(wh).call(wh,e)||e.cloudProxyServer!=="disabled"||wh.push(e)}if(bh.size<Z("AP_CACHE_NUM")&&wh.length>0){const t=wh.shift();bh.set(t,window.setTimeout(async()=>{const{appId:r,cname:s,token:a,stringUid:l,uid:u,proxyServer:p}=t;try{await ohe(r,s,a,u,p,l),bh.has(t)&&V1(t)}catch(m){O.warn("update preload failed",m.message),y6(t)}},Z("AP_UPDATE_INTERVAL")))}}function y6(e){const t=wh.indexOf(e);t!==-1&&wh.splice(t,1);let r=bh.get(e);r&&(window.clearTimeout(r),r=null,bh.delete(e),V1())}function S6(e,t){const r=e.sua,s=e.ap;t&&r&&st.reqUserAccount(e.sid,{lts:r.requestTime,elapse:r.elapse,success:!0,serverAddr:r.url,stringUid:t,uid:e.intUid,errorCode:null,extend:r.req}),st.reportResourceTiming(e.ap.url,e.sid),st.joinWebProxyAP(e.sid,{lts:s.requestTime,elapse:s.elapse,sucess:1,apServerAddr:s.url,turnServerAddrList:s.proxyInfo.addresses.map(a=>a.ip).join(","),eventType:"disabled",unilbsServerIds:[br.CHOOSE_SERVER,br.CLOUD_PROXY_FALLBACK].toString()}),st.joinChooseServer(e.sid,{lts:s.requestTime,elapse:s.elapse,succ:!0,csAddr:s.url,opid:s.opid,serverList:s.gatewayInfo.gatewayAddrs.map(a=>a.address),ec:null,cid:s.gatewayInfo.cid.toString(),uid:s.gatewayInfo.uid.toString(),csIp:s.gatewayInfo.csIp,unilbsServerIds:[br.CHOOSE_SERVER].toString(),isHttp3:s.isHttp3})}function x6(e){return window.atob(window.localStorage.getItem(e)||"")}function vS(e,t){window.localStorage.setItem(e,window.btoa(t))}function T6(e){let t="".concat(e.appId,"_").concat(e.cname);return typeof e.uid=="string"&&(t+="_s_".concat(e.uid)),typeof e.uid=="number"&&(t+="_".concat(e.uid)),e.token&&(t+="_".concat(e.token)),_V(t)}function ahe(e){let t=function(){const r=dhe.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(r,s){let a=r.appId;a!==void 0&&(wr(s,10),Wd(s,a));let l=r.cid;l!==void 0&&(wr(s,16),wr(s,l));let u=r.cname;u!==void 0&&(wr(s,26),Wd(s,u));let p=r.deviceId;p!==void 0&&(wr(s,34),Wd(s,p));let m=r.elapse;m!==void 0&&(wr(s,40),Hd(s,m));let g=r.fileSize;g!==void 0&&(wr(s,48),Hd(s,Bf(g)));let E=r.height;E!==void 0&&(wr(s,56),Hd(s,Bf(E)));let y=r.jpg;y!==void 0&&(wr(s,66),wr(s,y.length),w6(s,y));let b=r.networkType;b!==void 0&&(wr(s,72),Hd(s,Bf(b)));let C=r.osType;C!==void 0&&(wr(s,80),Hd(s,Bf(C)));let B=r.requestId;B!==void 0&&(wr(s,90),Wd(s,B));let M=r.sdkVersion;M!==void 0&&(wr(s,98),Wd(s,M));let F=r.sequence;F!==void 0&&(wr(s,104),Hd(s,Bf(F)));let q=r.sid;q!==void 0&&(wr(s,114),Wd(s,q));let Y=r.timestamp;Y!==void 0&&(wr(s,120),Hd(s,Y));let re=r.uid;re!==void 0&&(wr(s,128),wr(s,re));let ce=r.vid;ce!==void 0&&(wr(s,136),wr(s,ce));let le=r.width;le!==void 0&&(wr(s,144),Hd(s,Bf(le)));let ae=r.service;ae!==void 0&&(wr(s,152),wr(s,ae));let _e=r.callbackData;_e!==void 0&&(wr(s,162),wr(s,_e.length),w6(s,_e));let we=r.ticket;we!==void 0&&(wr(s,170),Wd(s,we));let Be=r.vendorConfigs;Be!==void 0&&(wr(s,178),Wd(s,Be))}(e,t),function(r){let s=r.bytes,a=r.limit;return s.length===a?s:s.subarray(0,a)}(t)}function che(e){return function(r){let s={};e:for(;!uhe(r);){let a=Ng(r);switch(a>>>3){case 0:break e;case 1:s.code=Ng(r);break;case 2:s.msg=C6(r,Ng(r));break;case 3:s.requestId=C6(r,Ng(r));break;case 4:s.timestamp=hhe(r,!1);break;default:lhe(r,7&a)}}return s}({bytes:t=e,offset:0,limit:t.length});var t}function lhe(e,t){switch(t){case 0:for(;128&Oa(e););break;case 2:B1(e,Ng(e));break;case 5:B1(e,4);break;case 1:B1(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function Bf(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let dhe=[];function B1(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function uhe(e){return e.offset>=e.limit}function yS(e,t){let r=e.bytes,s=e.offset,a=e.limit,l=s+t;if(l>r.length){let u=new Uint8Array(2*l);u.set(r),e.bytes=u}return e.offset=l,l>a&&(e.limit=l),s}function b6(e,t){let r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function w6(e,t){let r=yS(e,t.length);e.bytes.set(t,r)}function C6(e,t){let r=b6(e,t),s=String.fromCharCode,a=e.bytes,l="",u="";for(let p=0;p<t;p++){let m,g,E,y,b=a[p+r];128&b?(224&b)==192?p+1>=t?u+=l:(m=a[p+r+1],(192&m)!=128?u+=l:(y=(31&b)<<6|63&m,y<128?u+=l:(u+=s(y),p++))):(240&b)==224?p+2>=t?u+=l:(m=a[p+r+1],g=a[p+r+2],(49344&(m|g<<8))!=32896?u+=l:(y=(15&b)<<12|(63&m)<<6|63&g,y<2048||y>=55296&&y<=57343?u+=l:(u+=s(y),p+=2))):(248&b)==240?p+3>=t?u+=l:(m=a[p+r+1],g=a[p+r+2],E=a[p+r+3],(12632256&(m|g<<8|E<<16))!=8421504?u+=l:(y=(7&b)<<18|(63&m)<<12|(63&g)<<6|63&E,y<65536||y>1114111?u+=l:(y-=65536,u+=s(55296+(y>>10),56320+(1023&y)),p+=3))):u+=l:u+=s(b)}return u}function Wd(e,t){let r=t.length,s=0;for(let u=0;u<r;u++){let p=t.charCodeAt(u);p>=55296&&p<=56319&&u+1<r&&(p=(p<<10)+t.charCodeAt(++u)-56613888),s+=p<128?1:p<2048?2:p<65536?3:4}wr(e,s);let a=yS(e,s),l=e.bytes;for(let u=0;u<r;u++){let p=t.charCodeAt(u);p>=55296&&p<=56319&&u+1<r&&(p=(p<<10)+t.charCodeAt(++u)-56613888),p<128?l[a++]=p:(p<2048?l[a++]=p>>6&31|192:(p<65536?l[a++]=p>>12&15|224:(l[a++]=p>>18&7|240,l[a++]=p>>12&63|128),l[a++]=p>>6&63|128),l[a++]=63&p|128)}}function Oa(e){return e.bytes[b6(e,1)]}function R6(e,t){let r=yS(e,1);e.bytes[r]=t}function Ng(e){let t,r=0,s=0;do t=Oa(e),r<32&&(s|=(127&t)<<r),r+=7;while(128&t);return s}function wr(e,t){for(t>>>=0;t>=128;)R6(e,127&t|128),t>>>=7;R6(e,t)}function hhe(e,t){let r,s=0,a=0,l=0;return r=Oa(e),s=127&r,128&r&&(r=Oa(e),s|=(127&r)<<7,128&r&&(r=Oa(e),s|=(127&r)<<14,128&r&&(r=Oa(e),s|=(127&r)<<21,128&r&&(r=Oa(e),a=127&r,128&r&&(r=Oa(e),a|=(127&r)<<7,128&r&&(r=Oa(e),a|=(127&r)<<14,128&r&&(r=Oa(e),a|=(127&r)<<21,128&r&&(r=Oa(e),l=127&r,128&r&&(r=Oa(e),l|=(127&r)<<7))))))))),{low:s|a<<28,high:a>>>4|l<<24,unsigned:t}}function Hd(e,t){let r=t.low>>>0,s=(t.low>>>28|t.high<<4)>>>0,a=t.high>>>24,l=a===0?s===0?r<16384?r<128?1:2:r<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:a<128?9:10,u=yS(e,l),p=e.bytes;switch(l){case 10:p[u+9]=a>>>7&1;case 9:p[u+8]=l!==9?128|a:127&a;case 8:p[u+7]=l!==8?s>>>21|128:s>>>21&127;case 7:p[u+6]=l!==7?s>>>14|128:s>>>14&127;case 6:p[u+5]=l!==6?s>>>7|128:s>>>7&127;case 5:p[u+4]=l!==5?128|s:127&s;case 4:p[u+3]=l!==4?r>>>21|128:r>>>21&127;case 3:p[u+2]=l!==3?r>>>14|128:r>>>14&127;case 2:p[u+1]=l!==2?r>>>7|128:r>>>7&127;case 1:p[u]=l!==1?128|r:127&r}}const A6={},N6={},SS=4294967296,I6=SS*SS,O6=I6/2,W1=P6(0,!0),D6=P6(0),phe=Wf(0,-2147483648,!1),fhe=Wf(-1,2147483647,!1),mhe=Wf(-1,-1,!0);function P6(e,t){let r,s,a;return t?(a=0<=(e>>>=0)&&e<256)&&(s=N6[e],s)?s:(r=Wf(e,0,!0),a&&(N6[e]=r),r):(a=-128<=(e|=0)&&e<128)&&(s=A6[e],s)?s:(r=Wf(e,e<0?-1:0,!1),a&&(A6[e]=r),r)}function Wf(e,t,r){return{low:0|e,high:0|t,unsigned:!!r}}function k6(e,t){if(isNaN(e))return t?W1:D6;if(t){if(e<0)return W1;if(e>=I6)return mhe}else{if(e<=-O6)return phe;if(e+1>=O6)return fhe}return e<0?t?W1:D6:Wf(e%SS|0,e/SS|0,t)}function L6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}class H1 extends Zn{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const r=this._connectionState;this._connectionState=t,this.emit(dc.CONNECTION_STATE_CHANGE,t,r)}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(t){var r;super(),z(this,"name","AgoraRTCImageModeration"),z(this,"_connectionState",Yo.CONNECTING),z(this,"_sequence",0),z(this,"_moderationStartTime",void 0),z(this,"_workerConnection",void 0),z(this,"_workerMessageLengthLimit",void 0),z(this,"_qualityRatio",void 0),z(this,"_connectInfo",void 0),z(this,"_cancelTokenSource",_s.CancelToken.source()),z(this,"_retryConfig",void 0),z(this,"_moderationInterval",void 0),z(this,"_moderationTimer",null),z(this,"_moderationMode",1),z(this,"_quality",1),z(this,"_qualityTimer",null),z(this,"_ticket",void 0),z(this,"_moderationIntervalMinimum",void 0),z(this,"_uploadFailedNum",0),z(this,"_uploadNum",0),z(this,"_uploadTimer",null),z(this,"_extraInfo",void 0),z(this,"_vendor",""),z(this,"_encoder",new TextEncoder),z(this,"_moderationId",void 0),z(this,"inspectImage",()=>{if(this.connectionState!==Yo.CONNECTED)throw new me($.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Yo.CONNECTED?this.requestToInspectImage():O.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=An(5,"image-moderation-"),this._workerMessageLengthLimit=Z("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=Z("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),this._qualityRatio=Z("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new Eg("worker-"+this._moderationId,Rr),this.on(dc.STATE_CHANGE,(s,a)=>{O.debug("[".concat(this._moderationId,"] Moderation operation :").concat(If[s]," ").concat(a||""))}),this.handleWorkerEvents()}async init(t,r){this.emit(dc.STATE_CHANGE,If.CONNECT_AP),this._connectInfo=t;const s=this._cancelTokenSource.token;return this._retryConfig=r,new Ye((a,l)=>{this.on(dc.CONNECTION_STATE_CHANGE,(u,p)=>{u===Yo.CONNECTED&&a()}),this.requestAP(t,s,r).then(u=>{this.connectWorker(u)}).catch(u=>{l(u)})})}updateConfig(t){var r;this._moderationInterval=(r=t.interval)!==null&&r!==void 0?r:1e3,t.extraInfo&&(this._extraInfo=this._encoder.encode(t.extraInfo)),t.vendor&&(this._vendor=t.vendor),O.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(t))),this.connectionState===Yo.CONNECTED&&this.inspectImage()}async requestAP(t,r,s){const a=Z("WEBCS_DOMAIN").map(m=>"https://".concat(m,"/api/v1")),l=await function(m,g,E,y){let{appId:b,areaCode:C,cname:B,sid:M,token:F,uid:q}=g;Mf++;const Y="moderation_plugin",re={service_name:Y,json_body:JSON.stringify({appId:b,areaCode:C,cname:B,command:"allocateEdge",requestId:Mf,seq:Mf,sid:M,appToken:F,ts:Date.now(),uid:q+""})};let ce,le,ae=m[0];return oc(async()=>{ce=Date.now();const _e=await uc(ae,{data:re,cancelToken:E,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(le=Date.now()-ce,_e.code!==0){const Xe=new me($.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+_e.code,{retry:!0,responseTime:le});throw O.error(Xe.toString()),Xe}const we=JSON.parse(_e.json_body);if(we.code!==200){const Xe=new me($.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(we.code,", reason: ").concat(we.reason),{code:we.code,responseTime:le});throw O.error(Xe.toString()),Xe}if(!we.servers||!Array.isArray(we.servers)||we.servers.length===0){const Xe=new me($.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:we.code,responseTime:le});throw O.error(Xe.toString()),Xe}if(!we.servers.some(Xe=>!!Xe.wss)){const Xe=new me($.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:we.code,responseTime:le});throw O.error(Xe.toString()),Xe}const Be=Z("IMAGE_MODERATION_WORKER_HOST");return{addressList:we.servers.map(Xe=>{let{address:jt,wss:kt}=Xe;if(jt&&kt)return"wss://".concat(jt.replace(/\./g,"-"),".").concat(Be,":").concat(kt,"/moderation")}).filter(Xe=>!!Xe),workerToken:we.workerToken,vid:we.vid,ticket:we.appTicket,responseTime:le}},(_e,we)=>(st.apworkerEvent(M,{success:!0,sc:200,serviceName:Y,responseDetail:JSON.stringify(_e.addressList),firstSuccess:we===0,responseTime:le,serverIp:m[we%m.length]}),!1),(_e,we)=>(st.apworkerEvent(M,{success:!1,sc:_e.data&&_e.data.code||200,serviceName:Y,responseTime:le,serverIp:m[we%m.length]}),!!(_e.code!==$.OPERATION_ABORTED&&_e.code!==$.UNEXPECTED_RESPONSE||_e.data&&_e.data.retry)&&(ae=m[(we+1)%m.length],!0)),y)}(a,t,r,s);this.emit(dc.STATE_CHANGE,If.AP_CONNECTED);const{addressList:u,ticket:p}=l;return this._ticket=p,u}async connectWorker(t){this.emit(dc.STATE_CHANGE,If.CONNECT_WORKER),await this._workerConnection.init(t,1e4)}handleWorkerEvents(){this._workerConnection.on(Pt.CONNECTED,async()=>{this.emit(dc.STATE_CHANGE,If.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Yo.CONNECTED}),this._workerConnection.on(Pt.CLOSED,()=>{this.connectionState=Yo.CLOSED}),this._workerConnection.on(Pt.FAILED,()=>{this.connectionState=Yo.CLOSED}),this._workerConnection.on(Pt.RECONNECTING,()=>{this.connectionState=this.connectionState===Yo.CONNECTED?Yo.RECONNECTING:Yo.CONNECTING}),this._workerConnection.on(Pt.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const r=che(new Uint8Array(t.data));Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&O.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),this._uploadNum++,r.code===void 0||r.code===0||(this._uploadFailedNum++,O.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{st.reportApiInvoke(this._connectInfo.sid||null,{name:xr.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,r.code],tag:sr.TRACER}).onError(new me($.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),this._uploadTimer=null},Z("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else O.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(Pt.WILL_RECONNECT,(t,r,s)=>{t==="recover"&&s(t),s("tryNext")}),this._workerConnection.on(Pt.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}static intToLong(t){return{low:t|=0,high:t>>31,unsigned:t>=0}}async requestToInspectImage(){const t=mo(this,dc.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void(Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&O.debug("Only the track being played can be inspected"));this._sequence++;const s=await this.generateRequestData(t,r);this._workerConnection.sendMessage(s,!0,!0)}else Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&O.debug("Only the track being published can be inspected")}async generateRequestData(t,r){let{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m}=r;const g=Date.now(),E=await t.getCurrentFrameImage("image/jpeg",this.quality),y=await o3(E,s,a),b=this._sequence+"-"+l+"-"+m+"-"+g+"-"+An(12,""),C={appId:s,cid:l,cname:a,deviceId:"",elapse:H1.intToLong(Number(g-this._moderationStartTime)),fileSize:E.buffer.byteLength,height:E.height,width:E.width,jpg:y,networkType:6,osType:7,requestId:b,sdkVersion:"4.23.4",sequence:this._sequence,sid:p,timestamp:k6(g),uid:m,vid:u,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete C.callbackData;const B=ahe(C);if(B.byteLength<this._workerMessageLengthLimit){if(Z("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const M=function(F){for(var q=1;q<arguments.length;q++){var Y=arguments[q]!=null?arguments[q]:{};q%2?L6(Object(Y),!0).forEach(function(re){z(F,re,Y[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(Y)):L6(Object(Y)).forEach(function(re){Object.defineProperty(F,re,Object.getOwnPropertyDescriptor(Y,re))})}return F}({},C);delete M.jpg,O.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(M))}return B}{const M=this.quality*this._qualityRatio;return this.quality=M,await this.generateRequestData(t,{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=_s.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Yo.CLOSED,this.emit(dc.STATE_CHANGE,If.CLOSED)}}function M6(e){if(xn(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new me($.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new me($.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const ghe={name:"ImageModeration",create:function(e){let{config:t}=e;return M6(t),new H1(t)}};var j6,U6,F6,V6,B6,W6,H6,G6,z6,K6,q6,Y6,$6,X6,J6,Q6,Z6,e8,t8,n8,r8,i8,s8,o8,a8,c8,l8,d8,u8,h8,p8,f8,m8,g8,_8,E8,v8,y8,S8,x8,T8,$e;function b8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b8(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b8(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}Ai.setLogger(O);let _he=(j6=_t(),U6=_t({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof xf))return[t];t=[t]}return t.map(r=>r?Object(r).toString():"null")}}),F6=_t({argsMap:(e,t)=>(t||(t=[]),Array.isArray(t)||t.trackMediaType!==Sf.DATA?(Array.isArray(t)||(t=[t]),t.map(r=>r.getTrackId())):[t.getChannelId()])}),V6=_t({argsMap:(e,t,r,s)=>[typeof t=="object"?t.uid:t,r,s]}),B6=_t({argsMap:(e,t,r)=>[t,r]}),W6=_t({argsMap:(e,t)=>t.map(r=>{let{user:s,mediaType:a}=r;return[s==null?void 0:s.uid,a]})}),H6=_t({argsMap:(e,t,r,s)=>[typeof t=="object"?t.uid:t,r,s]}),G6=_t({argsMap:(e,t)=>t.map(r=>{let{user:s,mediaType:a}=r;return{uid:s==null?void 0:s.uid,mediaType:a}})}),z6=_t(),K6=_t(),q6=_t(),Y6=_t(),$6=_t(),X6=_t(),J6=_t(),Q6=_t(),Z6=_t(),e8=_t(),t8=_t(),n8=_t(),r8=_t(),i8=_t(),s8=_t(),o8=_t({argsMap:(e,t)=>[t]}),a8=_t(),c8=_t(),l8=_t(),d8=_t(),u8=_t(),h8=_t(),p8=_t(),f8=_t(),m8=_t({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),g8=_t(),_8=_t(),E8=_t(),v8=_t(),y8=_t(),S8=_t(),x8=_t({reportResult:!0}),T8=_t(),$e=class extends Zn{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return((e=this._config)===null||e===void 0?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e,t){let r;if(super(),z(this,"store",void 0),z(this,"_uid",void 0),z(this,"_channelName",void 0),z(this,"_uintUid",void 0),z(this,"_users",[]),z(this,"_config",void 0),z(this,"_clientId",void 0),z(this,"_appId",void 0),z(this,"_sessionId",null),z(this,"_key",void 0),z(this,"_rtmConfig",{}),z(this,"_joinInfo",void 0),z(this,"_gateway",void 0),z(this,"_statsCollector",void 0),z(this,"_configDistribute",void 0),z(this,"_leaveMutex",void 0),z(this,"_publishMutex",void 0),z(this,"_renewTokenMutex",void 0),z(this,"_subscribeMutex",void 0),z(this,"_encryptionMode","none"),z(this,"_encryptionSecret",null),z(this,"_encryptionSalt",null),z(this,"_encryptDataStream",!1),z(this,"_encryptDataStreamKey",null),z(this,"_encryptDataStreamIv",null),z(this,"_proxyServer",void 0),z(this,"_turnServer",{servers:[],mode:"auto"}),z(this,"_cloudProxyServerMode","disabled"),z(this,"_isDualStreamEnabled",!1),z(this,"_defaultStreamFallbackType",void 0),z(this,"_lowStreamParameter",void 0),z(this,"_streamFallbackTypeCacheMap",new Map),z(this,"_remoteStreamTypeCacheMap",new Map),z(this,"_axiosCancelSource",_s.CancelToken.source()),z(this,"_audioVolumeIndicationInterval",void 0),z(this,"_networkQualityInterval",void 0),z(this,"_userOfflineTimeout",void 0),z(this,"_streamRemovedTimeout",void 0),z(this,"_liveTranscodeStreamingClient",void 0),z(this,"_liveRawStreamingClient",void 0),z(this,"_channelMediaRelayClient",void 0),z(this,"_networkQualitySensitivity","normal"),z(this,"_p2pChannel",void 0),z(this,"_useLocalAccessPoint",!1),z(this,"_setLocalAPVersion",void 0),z(this,"_joinAndNotLeaveYet",!1),z(this,"_numberOfJoinCount",0),z(this,"_remoteDefaultVideoStreamType",void 0),z(this,"_inspect",void 0),z(this,"_moderation",void 0),z(this,"_license",void 0),z(this,"_pendingPublishedUsers",[]),z(this,"ntpAlignErrorCount",0),z(this,"remoteInboundOffset",0),z(this,"_peerConnectionState",void 0),z(this,"_handleLocalTrackEnable",(a,l,u)=>{this.publish(a,!1).then(l).catch(u)}),z(this,"_handleLocalTrackDisable",(a,l,u)=>{this.unpublish(a).then(l).catch(u)}),z(this,"_handleUserOnline",a=>{if(Z("BLOCK_LOCAL_CLIENT")&&yh(a.uid,this.channelName))return void O.debug("[".concat(a.uid,"] will be ignored in local"));this.isStringUID&&typeof a.uid!="string"&&O.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const l=this._users.find(u=>u.uid===a.uid);if(l)l._trust_in_room_=!0,l._is_pre_created&&(l._is_pre_created=!1,this.safeEmit(Ht.USER_JOINED,l));else{const u=new Vd(a.uid,a.uint_id||a.uid);this._users.push(u),O.debug("[".concat(this._clientId,"] user online"),a.uid),this.safeEmit(Ht.USER_JOINED,u)}}),z(this,"_handleUserOffline",a=>{if(Z("BLOCK_LOCAL_CLIENT")&&yh(a.uid,this.channelName))return;const l=this._users.find(u=>u.uid===a.uid);l&&(this._handleRemoveStream(a),this._handleRemoveDataChannels(a),l._audio_pre_subscribed||l._video_pre_subscribed?l._is_pre_created=!0:wy(this._users,l),this._remoteStreamTypeCacheMap.delete(l.uid),this._streamFallbackTypeCacheMap.delete(l.uid),O.debug("[".concat(this._clientId,"] user offline"),a.uid,"reason:",a.reason),this.safeEmit(Ht.USER_LEAVED,l,a.reason))}),z(this,"_handleAddAudioOrVideoStream",(a,l,u,p,m,g,E)=>{if(Z("BLOCK_LOCAL_CLIENT")&&yh(l,this.channelName))return;const y=this._users.find(C=>C.uid===l);if(!y)return void O.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));O.debug("[".concat(this._clientId,"] stream added with uid ").concat(l,", type ").concat(a)),this.store.subscribe(y.uid,a,void 0,void 0,void 0,Date.now());const b=a==="audio"?y.hasAudio:y.hasVideo;y._uintid||(y._uintid=m||l),a==="audio"?y._trust_audio_stream_added_state_=!0:y._trust_video_stream_added_state_=!0,a==="audio"?(y._audio_added_=!0,u!==void 0&&(y._audioSSRC=u),p!==void 0&&(y._cname=p),g&&(y._audioOrtc=g)):(y._video_added_=!0,u!==void 0&&(y._videoSSRC=u),p!==void 0&&(y._cname=p),E!==void 0&&(y._rtxSsrcId=E),g&&(y._videoOrtc=g)),(a==="audio"?y.hasAudio:y.hasVideo)&&!b&&(O.info("[".concat(this._clientId,"] remote user ").concat(y.uid," published ").concat(a)),this.safeEmit(Ht.USER_PUBLISHED,y,a)),a==="video"?st.onGatewayStream(this._sessionId,Fr.ON_ADD_VIDEO_STREAM,qn.ON_ADD_VIDEO_STREAM,{peer:m||l,ssrc:y._videoSSRC}):st.onGatewayStream(this._sessionId,Fr.ON_ADD_AUDIO_STREAM,qn.ON_ADD_AUDIO_STREAM,{peer:m||l,ssrc:y._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(y,a,u).then(C=>{if(C&&(O.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(y.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Ag))return this._p2pChannel.unsubscribe(y,a,!0).then(()=>this._subscribe(y,a,!0).catch(B=>{O.error("[".concat(this._clientId,"] resubscribe error"),B.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(y,a)&&(O.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(y.uid," after reconnect.")),this._subscribe(y,a,!0).catch(C=>{O.error("[".concat(this._clientId,"] resubscribe error"),C.toString())}))}),z(this,"_handleRemoveStream",a=>{if(Z("BLOCK_LOCAL_CLIENT")&&yh(a.uid,this.channelName))return;const l=this._users.find(p=>p.uid===a.uid);if(!l)return void O.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));O.debug("[".concat(this._clientId,"] stream removed with uid ").concat(a.uid));let u=()=>{};l.hasAudio&&l.hasVideo?u=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished audio track")),this.safeEmit(Ht.USER_UNPUBLISHED,l,"audio"),O.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished video track")),this.safeEmit(Ht.USER_UNPUBLISHED,l,"video")}:l.hasVideo?u=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished video track")),this.safeEmit(Ht.USER_UNPUBLISHED,l,"video")}:l.hasAudio&&(u=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(l.uid," unpublished audio track")),this.safeEmit(Ht.USER_UNPUBLISHED,l,"audio")}),l._video_pre_subscribed||l._audio_pre_subscribed||(l._trust_audio_stream_added_state_=!0,l._trust_video_stream_added_state_=!0,l._audio_added_=!1,l._video_added_=!1,this._p2pChannel instanceof Ag&&this._p2pChannel.unsubscribe(l).then(p=>{if(p)return this._gateway.unsubscribe(p,l.uid)}),l._audioSSRC=void 0,l._videoSSRC=void 0,l._audioOrtc=void 0,l._videoOrtc=void 0,l._rtxSsrcId=void 0),st.onGatewayStream(this._sessionId,Fr.ON_REMOVE_STREAM,qn.ON_REMOVE_STREAM,{peer:a.uint_id||a.uid}),u()}),z(this,"_handleSetStreamLocalEnable",(a,l,u)=>{if(Z("BLOCK_LOCAL_CLIENT")&&yh(l,this.channelName))return;const p=this._users.find(E=>E.uid===l);if(!p)return void O.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));O.debug("[".concat(this._clientId,"] local ").concat(a," ").concat(u?"enabled":"disabled"," with uid ").concat(l));const m=a==="audio"?p.hasAudio:p.hasVideo;if(a==="audio"){p._trust_audio_enabled_state_=!0;const E=p._audio_enabled_;if(p._audio_enabled_=u,p._audio_enabled_===E)return;{const y=p._audio_enabled_?"enable-local-audio":"disable-local-audio";O.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(l,", msg: ").concat(y)),this.safeEmit(Ht.USER_INFO_UPDATED,l,y)}}else{p._trust_video_enabled_state_=!0;const E=p._video_enabled_;if(p._video_enabled_=u,p._video_enabled_===E)return;{const y=p._video_enabled_?"enable-local-video":"disable-local-video";O.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(l,", msg: ").concat(y)),this.safeEmit(Ht.USER_INFO_UPDATED,l,y)}}const g=a==="audio"?p.hasAudio:p.hasVideo;return m!==g?!m&&g?(O.info("[".concat(this._clientId,"] remote user ").concat(l," published ").concat(a)),void this.safeEmit(Ht.USER_PUBLISHED,p,a)):(a==="video"&&p._videoTrack&&p._videoTrack._destroy(),a==="audio"&&p._audioTrack,this._p2pChannel.muteRemote(p,a),O.info("[".concat(this._clientId,"] remote user ").concat(l," unpublished ").concat(a)),void this.safeEmit(Ht.USER_UNPUBLISHED,p,a)):void 0}),z(this,"_handleMuteStream",(a,l,u)=>{if(Z("BLOCK_LOCAL_CLIENT")&&yh(a,this.channelName))return;O.debug("[".concat(this._clientId,"] receive mute message"),a,l,u);const p=this._users.find(E=>E.uid===a);if(!p)return void O.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(a));const m=l==="audio"?p.hasAudio:p.hasVideo;if(l==="audio"){p._trust_audio_mute_state_=!0;const E=p._audio_muted_;if(p._audio_muted_=u,p._audio_muted_===E)return;{const y=p._audio_muted_?"mute-audio":"unmute-audio";O.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(y)),this.safeEmit(Ht.USER_INFO_UPDATED,a,y)}}else{p._trust_video_mute_state_=!0;const E=p._video_muted_;if(p._video_muted_=u,p._video_muted_===E)return;{const y=p._video_muted_?"mute-video":"unmute-video";O.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(a,", msg: ").concat(y)),this.safeEmit(Ht.USER_INFO_UPDATED,a,y)}}const g=l==="audio"?p.hasAudio:p.hasVideo;if(m!==g){if(!m&&g)return(l==="audio"?p._audioSSRC:p._videoSSRC)?(O.info("[".concat(this._clientId,"] remote user ").concat(a," published ").concat(l)),void this.safeEmit(Ht.USER_PUBLISHED,p,l)):void O.warning("[".concat(this._clientId,"] remote user ").concat(a," receive ").concat(l," unmute message  before add stream message, ").concat(l," SSRC doesn't exist yet."));l==="video"&&p._videoTrack&&!p._video_pre_subscribed&&p._videoTrack._destroy(),l==="audio"&&p._audioTrack,this._p2pChannel.muteRemote(p,l),O.info("[".concat(this._clientId,"] remote user ").concat(a," unpublished ").concat(l)),this.safeEmit(Ht.USER_UNPUBLISHED,p,l)}}),z(this,"_handleP2PLost",async a=>{O.debug("[".concat(this._clientId,"] receive p2p lost"),a),parseInt(a.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():O.warning("[".concat(this._clientId,"] P2PLost stream not found"),a)}),z(this,"_handleTokenWillExpire",()=>{O.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Ht.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),z(this,"_handleBeforeUnload",a=>{a.type==="beforeunload"&&a.returnValue!==void 0&&a.returnValue!==""||(this.leave(),O.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),z(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Ht.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const a={downlinkNetworkQuality:0,uplinkNetworkQuality:0};a.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),a.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Ht.NETWORK_QUALITY,a)}),z(this,"_handleP2PAddAudioOrVideoStream",(a,l,u,p)=>{const m=this._users.find(E=>E.uid===l);if(!m)return void O.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));O.debug("[".concat(this._clientId,"] stream added with uid ").concat(l,", type ").concat(a)),this.store.subscribe(m.uid,a,void 0,void 0,void 0,Date.now());const g=a==="audio"?m.hasAudio:m.hasVideo;a==="audio"?m._trust_audio_stream_added_state_=!0:m._trust_video_stream_added_state_=!0,a==="audio"?(m._audio_added_=!0,u!==void 0&&(m._audioSSRC=u),p!==void 0&&(m._audioMid=p)):(m._video_added_=!0,u!==void 0&&(m._videoSSRC=u),p!==void 0&&(m._videoMid=p)),(a==="audio"?m.hasAudio:m.hasVideo)&&!g&&(O.info("[".concat(this._clientId,"] remote user ").concat(m.uid," published ").concat(a)),this.safeEmit(Ht.USER_PUBLISHED,m,a)),this._p2pChannel.hasPendingRemoteMedia(m,a)&&(O.debug("[".concat(this._clientId,"] resubscribe ").concat(a," for user ").concat(m.uid," after reconnect.")),this._subscribe(m,a,!0).catch(E=>{O.error("[".concat(this._clientId,"] resubscribe error"),E.toString())}))}),this._config=e,this._clientId=t||An(5,"client-"),this.store=new class{constructor(a,l,u,p){Ct(this,"state",void 0),this.state={codec:a,audioCodec:l,mode:u,clientId:p,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:ph.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(a){this.state=function(l,u){switch(u.type){case $t.SET_SESSION_ID:return tt(tt({},l),{},{sessionId:u.sessionId});case $t.SET_P2P_ID:return tt(tt({},l),{},{p2pId:u.p2pId});case $t.SET_UID:return tt(tt({},l),{},{uid:u.uid});case $t.SET_INT_UID:return tt(tt({},l),{},{intUid:u.intUid});case $t.SET_PUB_ID:return tt(tt({},l),{},{pubId:u.pubId});case $t.KEY_METRIC_CLIENT_CREATED:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{clientCreated:u.metric})});case $t.KEY_METRIC_JOIN_START:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{joinStart:u.metric})});case $t.KEY_METRIC_JOIN_END:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{joinEnd:u.metric})});case $t.KEY_METRIC_REQUEST_AP_START:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{requestAPStart:u.metric})});case $t.KEY_METRIC_REQUEST_AP_END:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{requestAPEnd:u.metric})});case $t.KEY_METRIC_JOIN_GATEWAY_START:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{joinGatewayStart:u.metric})});case $t.KEY_METRIC_JOIN_GATEWAY_END:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{joinGatewayEnd:u.metric})});case $t.KEY_METRIC_PEER_CONNECTION_START:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{peerConnectionStart:u.metric})});case $t.KEY_METRIC_PEER_CONNECTION_END:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{peerConnectionEnd:u.metric})});case $t.KEY_METRIC_DESCRIPTION_START:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{descriptionStart:u.metric})});case $t.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{signalChannelOpen:u.metric})});case $t.KEY_METRIC_ICE_CONNECTION_END:return tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{iceConnectionEnd:u.metric})});case $t.KEY_METRIC_PUBLISH:{const p=l.keyMetrics.publish,m=p.findIndex(g=>g.trackId===u.metric.trackId);return m!==-1?(p[m]=tt(tt({},p[m]),u.metric),tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{publish:[...p]})})):tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{publish:[...l.keyMetrics.publish,u.metric]})})}case $t.KEY_METRIC_SUBSCRIBE:{const p=l.keyMetrics.subscribe,m=p.findIndex(g=>g.userId===u.metric.userId&&g.type===u.metric.type);return m!==-1?(p[m]=tt(tt({},p[m]),u.metric),tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{subscribe:[...p]})})):tt(tt({},l),{},{keyMetrics:tt(tt({},l.keyMetrics),{},{subscribe:[...l.keyMetrics.subscribe,u.metric]})})}case $t.SET_CLOUD_PROXY_SERVER_MODE:return l.cloudProxyServerMode=u.mode,l;case $t.RECORD_JOIN_CHANNEL_SERVICE:return typeof u.index!="number"?l.joinChannelServiceRecords=[...l.joinChannelServiceRecords,u.record]:(l.joinChannelServiceRecords[u.index]=tt(tt({},l.joinChannelServiceRecords[u.index]),u.record),l.joinChannelServiceRecords=[...l.joinChannelServiceRecords]),l;case $t.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return l.joinChannelServiceRecords=[],l;case $t.RESET_KEY_METRICS:return l.keyMetrics={publish:[],subscribe:[]},l;case $t.SET_USE_P2P:return tt(tt({},l),{},{useP2P:u.val});case $t.SET_TRANSPORT_TYPE:return tt(tt({},l),{},{p2pTransport:u.val});default:return l}}(this.state,a)}set sessionId(a){this.dispatch({type:$t.SET_SESSION_ID,sessionId:a})}get sessionId(){return this.state.sessionId}set cid(a){this.state.cid=a}get cid(){return this.state.cid}set codec(a){this.state.codec=a}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(a){this.dispatch({type:$t.SET_P2P_ID,p2pId:a})}get p2pId(){return this.state.p2pId}set dcId(a){this.dispatch({type:$t.SET_DC_ID,dcId:a})}get dcId(){return this.state.dcId}set uid(a){this.dispatch({type:$t.SET_UID,uid:a})}get uid(){return this.state.uid}set intUid(a){this.dispatch({type:$t.SET_INT_UID,intUid:a})}get intUid(){return this.state.intUid}set pubId(a){this.dispatch({type:$t.SET_PUB_ID,pubId:a})}get pubId(){return this.state.pubId}set cloudProxyServerMode(a){this.dispatch({type:$t.SET_CLOUD_PROXY_SERVER_MODE,mode:a})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(a){this.dispatch({type:$t.SET_USE_P2P,val:a})}get useP2P(){return this.state.useP2P}set p2pTransport(a){this.dispatch({type:$t.SET_TRANSPORT_TYPE,val:a})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(a){this.state.hasStartJoinChannel=a}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(a){this.state.isABTestSuccess=a}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:$t.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:$t.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:$t.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:$t.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:$t.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:$t.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:$t.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:$t.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:$t.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:$t.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:$t.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:$t.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(a,l,u,p){this.dispatch({type:$t.KEY_METRIC_PUBLISH,metric:tt(tt({trackId:a,type:l},u&&{publishStart:u}),p&&{publishEnd:p})})}subscribe(a,l,u,p,m,g,E){this.dispatch({type:$t.KEY_METRIC_SUBSCRIBE,metric:tt(tt(tt(tt(tt({userId:a,type:l},u&&{subscribeStart:u}),p&&{subscribeEnd:p}),m&&{firstFrame:m}),g&&{streamAdded:g}),E&&{firstDecoded:E})})}massSubscribe(a,l,u,p){a.forEach(m=>{this.dispatch({type:$t.KEY_METRIC_SUBSCRIBE,metric:tt(tt(tt({userId:m.userId,type:m.type},l&&{subscribeStart:l}),u&&{subscribeEnd:u}),p&&{firstFrame:p})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(a,l){a.service==="gateway"&&Array.isArray(a.urls)&&(a.urls=a.urls.map(u=>u.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof l!="number"?(this.dispatch({type:$t.RECORD_JOIN_CHANNEL_SERVICE,record:tt(tt({},a),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(l<0||l>=this.state.joinChannelServiceRecords.length||this.dispatch({type:$t.RECORD_JOIN_CHANNEL_SERVICE,record:a,index:l}),l)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:$t.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:$t.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}}(e.codec,e.audioCodec,e.mode,this._clientId),this._leaveMutex=new Ai("client-leave",this._clientId),this._publishMutex=new Ai("client-publish",this._clientId),this._renewTokenMutex=new Ai("client-renewtoken",this._clientId),this._subscribeMutex=new Ai("client-subscribe",this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),O.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(zo," build: ").concat(PA,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{vA(e.clientRoleOptions),r=Object.assign({},e.clientRoleOptions)}catch(a){O.warning("[".concat(this._clientId,"] ").concat(a.toString()))}var s;this._statsCollector=new wg(this.store),this._statsCollector.onStatsException=(a,l,u)=>{O.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(a,", msg: ").concat(l,", uid: ").concat(u)),this.safeEmit(Ht.EXCEPTION,{code:a,msg:l,uid:u})},this._statsCollector.onUploadPublishDuration=(a,l,u,p)=>{const m=this._users.find(g=>g.uid===a);m&&st.peerPublishStatus(this._sessionId,{subscribeElapse:p,audioPublishDuration:l,videoPublishDuration:u,peer:m._uintid})},this._statsCollector.onVideoCodecChanged=a=>{if(Z("VIDEO_STANDARD_BITRATE_VERSION")&&(a==="av1"||a==="h265"||a==="h264")){const l=this.localTracks.find(u=>u instanceof Un);l&&l._saveEncodeBitrateRatio!==1&&l.setSaveEncodeBitrateRatio(a==="h264"?Z("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P=e.mode==="p2p",this._gateway=new Mue(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||Rr,httpRetryConfig:e.httpRetryConfig||Rr,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:r}),this._configDistribute=new Kue(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(s={store:this.store,statsCollector:this._statsCollector},Fl("P2PChannel").create(s)),this._handleP2PEvents()):this._p2pChannel=new Ag(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,r,s,a){let l=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],u=arguments.length>6&&arguments[6]!==void 0&&arguments[6];vn("JOIN_GATEWAY_USE_443PORT_ONLY",l),vn("JOIN_GATEWAY_USE_DUAL_DOMAIN",u);const p=this._gateway.signal.websocket;return p instanceof p1&&(p.use443PortOnly=l,p.tryDoubleDomain=u),async function(m,g,E){yy.get(m)||yy.set(m,[]),Sy.get(m)||Sy.set(m,g),zc.get(m)||zc.set(m,0);const y=yy.get(m),b=Sy.get(m);if(!y||!b)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(zc.get(m)===b){const q=tg();y.push(q),await q.promise}zc.set(m,zc.get(m)+1);for(var C=arguments.length,B=new Array(C>3?C-3:0),M=3;M<C;M++)B[M-3]=arguments[M];const F=await E(...B);return zc.set(m,zc.get(m)-1),zc.get(m)===b-1&&y.length>0&&(y[0].resolve(),y.shift()),zc.get(m)===0&&(yy.set(m,[]),Sy.set(m,0),zc.set(m,0)),F}("client.join",Z("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,r,s,a)}async join(e,t,r,s,a){const l=++this._numberOfJoinCount;this.store.joinStart(),s&&(this.store.uid=s);const u=(Ay||Ay||(Ay=(window.location.protocol.split(":")[0]||"").toUpperCase(),Ay))==="HTTPS",p=yV()?window.isSecureContext:"Browser Not Support";if(!yV()&&!u||!window.isSecureContext){const M="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";O.warning(M)}st.setAppId(e);try{if(!r&&r!==null)throw new me($.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&oi(r,"token",1,2047),oi(e,"appid",1,2047),$y(t),s&&Xy(s),a&&oi(a,"optionalInfo",1,2047)}catch(M){throw st.reportApiInvoke(hh(),{name:xr.JOIN,options:[e,t,r,s],states:{isHttps:u,isSecureContext:p},tag:sr.TRACER}).onError(M),M}if(this._leaveMutex.isLocked&&(O.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),O.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const M=new me($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw st.reportApiInvoke(hh(),{name:xr.JOIN,options:[e,t,r,s],states:{isHttps:u,isSecureContext:p},tag:sr.TRACER}).onError(M),M}this._gateway.state="CONNECTING";const m=await E6({appId:e,cname:t,uid:s,stringUid:typeof s=="string"?s:void 0,token:r||e,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const g=(m==null?void 0:m.sid)||hh();O.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(l)),this._sessionId||(this._sessionId=g,this.store.sessionId=this._sessionId);const E=st.reportApiInvoke(g,{id:this._clientId,name:xr.JOIN,options:[e,t,r,s],states:{isHttps:u,isSecureContext:p},tag:sr.TRACER}),y=Da(Da(Da({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:typeof s!="string"?s:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:a,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!m},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:Z("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(y.setLocalAPVersion=this._setLocalAPVersion),typeof s=="string"&&(y.stringUid=s,this._uintUid?(y.uid=this._uintUid,this._uintUid=void 0):y.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(y.aesmode=this._encryptionMode,y.aespassword=await(async M=>{const F=function(ce){const le=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),ae=new Uint8Array(new ArrayBuffer(le.length));for(let _e=0;_e<le.length;_e+=1)ae[_e]=le.charCodeAt(_e);return ae}(),q=await window.crypto.subtle.importKey("spki",F,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),Y=_A(M),re=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},q,Y);return function(ce){let le="";for(let ae=0;ae<ce.length;ae+=1)le+=String.fromCharCode(ce[ae]);return window.btoa(le)}(new Uint8Array(re))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(y.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const M=new TextEncoder,F=Z("USE_PURE_ENCRYPTION_MASTER_KEY")?M.encode(y.appId+this._encryptionSecret+this._encryptionSecret):M.encode(y.appId+y.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(q,Y,re){const ce=await window.crypto.subtle.importKey("raw",Y,"PBKDF2",!1,["deriveBits","deriveKey"]),le=q==="aes-128-gcm2"?128:256,ae=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:IV,hash:"SHA-256",salt:re},ce,le+ude);return new Uint8Array(ae).subarray(le/8)}(this._encryptionMode,F,uh(this._encryptionSalt)),this._encryptDataStreamKey=await async function(q,Y,re){const ce=await window.crypto.subtle.importKey("raw",Y,"PBKDF2",!1,["deriveBits","deriveKey"]),le=q==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:IV,hash:"SHA-256",salt:re},ce,{name:"AES-GCM",length:le},!0,["encrypt","decrypt"])}(this._encryptionMode,F,uh(this._encryptionSalt))}else p?O.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):O.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,O.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:t,appId:e,stringUid:y.stringUid});const b=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&b===this._sessionId&&st.joinChannelTimeout(this._sessionId,5)},5e3);try{var C;let M;const F=y.cloudProxyServer;if(je(C=["proxy3","proxy4","proxy5"]).call(C,F)){const le=Z("PROXY_SERVER_TYPE3");Array.isArray(le)?y.proxyServer=le[0]:y.proxyServer=le}if(st.setProxyServer(y.proxyServer),O.setProxyServer(y.proxyServer),this.store.requestAPStart(),m){if(O.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(y.stringUid?", ".concat(y.stringUid," => ").concat(m.intUid):""," ")),y.stringUid&&!y.uid&&(y.uid=m.intUid),M={gatewayInfo:m.ap.gatewayInfo},Z("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&y.turnServer.mode==="auto")if(m.ap.proxyInfo.addresses.length===0)O.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const le=(await h5(m.ap.proxyInfo,m.ap.gatewayInfo.uid)).map(ae=>({turnServerURL:ae.address,tcpport:ae.tcpport||xi.tcpport,udpport:ae.udpport||xi.udpport,username:ae.username||xi.username,password:ae.password||xi.password,forceturn:!1,security:!0}));y.turnServer={mode:"manual",servers:le}}S6(m,y.stringUid)}else{if(y.stringUid&&!y.uid){let le;[le,M]=await Ye.all([V5(y.stringUid,y,this._axiosCancelSource.token,this._config.httpRetryConfig||Rr,this.store),F5(y,this._axiosCancelSource.token,this._config.httpRetryConfig||Rr,!0,this.store)]),O.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(y.stringUid," => ").concat(le)),y.uid=le,M.gatewayInfo.uid=le,M.gatewayInfo.res.uid=le}else M=await F5(y,this._axiosCancelSource.token,this._config.httpRetryConfig||Rr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(y,this._axiosCancelSource.token),this._configDistribute.on(gg.UPDATE_BITRATE_LIMIT,le=>{this._p2pChannel.updateBitrateLimit(le)}),this._configDistribute.on(gg.UPDATE_CLIENT_ROLE_OPTIONS,le=>{this._setClientRoleOptions(le)})},0),this._key=r||e;const q=M.gatewayInfo,Y=y.uid?y.uid:q.uid;this._joinInfo=Da(Da({},y),{},{cid:q.cid,uid:Y,vid:q.vid,apResponse:q.res,apGatewayAddress:q.apGatewayAddress,uni_lbs_ip:q.uni_lbs_ip,gatewayAddrs:q.gatewayAddrs}),this.store.intUid=Y,this.store.cid=q.cid;const re=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));E.onSuccess(re),this._appId=e,this._channelName=y.cname,this._uid=re,this.store.uid=re,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(vi()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const ce=y.stringUid?"string uid: ".concat(y.stringUid,",uid: ").concat(y.uid):"uid: ".concat(this._uid);return O.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(ce)),setTimeout(()=>{O.startUpload()},5e3),this.store.joinEnd(),B=this,je(vh).call(vh,B)||vh.push(B),this._cloudProxyServerMode==="disabled"&&tn().supportWebCrypto&&Z("ENABLE_PRELOAD")&&V1(this._joinInfo),re}catch(M){const F=Array.isArray(M)?M[0]:M;throw F&&F.code===$.OPERATION_ABORTED?O.warning("[".concat(this._clientId,"] join number: ").concat(l,", Joining channel failed, rollback"),F):O.error("[".concat(this._clientId,"] join number: ").concat(l,", Joining channel failed, rollback"),F),F.code!==$.OPERATION_ABORTED&&this._numberOfJoinCount===l&&(this._gateway.state="DISCONNECTED",this._reset()),E.onError(F),F}var B}_joinGateway(){if(!this._joinInfo||!this._key)throw new me($.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!Z("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){O.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(vi()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(t){const r=vh.indexOf(t);r!==-1&&vh.splice(r,1)}(this),this._statsCollector.stopUpdateStats();const e=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return O.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave(this.connectionState!=="CONNECTED",hn.LEAVE),O.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(e)){if(!(e instanceof xf))return this._publishDataChannel(e);e=[e]}if(e.length===0)throw new me($.INVALID_PARAMS,"param list is empty");const r=e;if(this._gateway.role==="audience")throw new me($.INVALID_OPERATION,"audience can not publish stream");for(const a of r){if(!(a instanceof xf))throw new me($.INVALID_PARAMS,"parameter is not local track");if(!a._enabled&&t)throw new me($.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(a.getTrackId()))}O.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(r.map(a=>"".concat(a.getTrackId()," "))));const s=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&r.forEach(a=>{const l=this._configDistribute.getBitrateLimit();a instanceof Un&&l&&a.setBitrateLimit(l.uplink)});try{await this._publishHighStream(r),O.info("[".concat(this._clientId,"] Publish success, id ").concat(r.map(a=>"".concat(a.getTrackId()," "))))}catch(a){throw O.error("[".concat(this._clientId,"] publish error"),a.toString()),a}finally{s()}}async _publishDataChannel(e){xn(e.id,"id",0,65535,!0),kl(e.ordered,"ordered"),oi(e.metadata,"metadata",0,512),O.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const t=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(a=>a.id===e.id)!==-1)throw new me($.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new me($.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Z("FORCE_TURN")&&!Z("TURN_ENABLE_TCP")&&!Z("TURN_ENABLE_UDP"))throw new me($.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const r=function(a){return I5(a,!1)}(e),s=await this._p2pChannel.publishDataChannel([r]);if(s.length>0){if(typeof r._originDataChannelId!="number")throw O.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new me($.CREATE_DATACHANNEL_ERROR);try{await Ye.all(s.map(a=>this._uid&&this._gateway.publishDataChannel(this._uid,a,!0))),await r._waitTillOpen()}catch(a){if(a.code!==$.DISCONNECT_P2P)throw a}}return O.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(r.id)),r}catch(r){throw O.error("[".concat(this._clientId,"] publish datachannels error"),r.toString()),r}finally{t()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new me($.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof xf))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);O.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map(s=>"".concat(s.getTrackId()," "))," "));const r=await this._publishMutex.lock();try{if(this.store.useP2P){const s=await this._p2pChannel.unpublish(t);s&&await this._gateway.sendExtensionMessage(gr.UNPUBLISH,{unpubMsg:s},!0)}else{const s=await this._p2pChannel.unpublish(t);s&&await this._gateway.unpublish(s,this._uid),O.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map(a=>"".concat(a.getTrackId()))))}}catch(s){throw O.error("[".concat(this._clientId,"] unpublish error"),s.toString()),s}finally{r&&r()}}async _unpublishDataChannel(e){e!==void 0&&e.length!==0||(e=this._p2pChannel.getAllDataChannels()),O.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(r=>"".concat(r.id," "))," "));const t=await this._publishMutex.lock();try{const r=await this._p2pChannel.unpublishDataChannel(e);r&&await this._gateway.unpublishDataChannel(r),O.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(s=>"".concat(s.id))))}catch(r){throw O.error("[".concat(this._clientId,"] unpublish dataChannel error"),r.toString()),r}finally{t&&t()}}async subscribe(e,t,r){if(!(e instanceof Vd)){const s=this.remoteUsers.find(a=>a.uid===e);if(!s)throw new me($.INVALID_REMOTE_USER,"user is not in the channel");e=s}return t==="datachannel"?this._subscribeDataChannel(e,r):this._subscribe(e,t)}async presubscribe(e,t){if(Mr(t,"mediaType",["audio","video"]),this.store.useP2P)throw new me($.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new me($.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const r=t===Ze.AUDIO,s=t===Ze.VIDEO,a=await this._subscribeMutex.lock();try{const{ssrcId:l,ortc:u,rtxSsrcId:p,cname:m,uint_id:g}=await this._gateway.presubscribe(e,t,!0);if(l==null)throw new me($.UNEXPECTED_RESPONSE,"no ssrc id");let E=this._users.find(b=>b.uid===e);E||(E=new Vd(e,g||e),E._is_pre_created=!0,this._users.push(E)),m&&(E._cname=m),E._uintid||(E._uintid=g||e),r&&(E._audioSSRC=l,E._audio_pre_subscribed=!0,u&&(E._audioOrtc=u)),s&&(E._videoSSRC=l,E._video_pre_subscribed=!0,u&&(E._videoOrtc=u),p!=null&&(E._rtxSsrcId=p)),O.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(l)),await this._p2pChannel.subscribe(E,t,l,p,u);const y=r?E._audioTrack:E._videoTrack;if(!y)throw new me($.UNEXPECTED_ERROR,"can not find remote track in user");return r&&(E._trust_audio_stream_added_state_=!0,E._audio_added_=!0),s&&(E._trust_video_stream_added_state_=!0,E._video_added_=!0),y}catch(l){throw O.error("[".concat(this._clientId,"] presub user ").concat(e," error"),l),l}finally{a()}}async _subscribeDataChannel(e,t){var r;if(xn(t,"channelId",0,65535,!0),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(p=>p===e))throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new me($.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&e._dataChannels.length===0)throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new me($.INVALID_REMOTE_USER,"user is not published");const a=(r=e._dataChannels)===null||r===void 0?void 0:r.find(p=>p.id===t);if(!a)throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new me($.REMOTE_USER_IS_NOT_PUBLISHED);const l=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const p=await this._p2pChannel.subscribeDataChannel(e,[a]);if(p&&je(p).call(p,a.id))try{var u;if(typeof a._originDataChannelId!="number")throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new me($.CREATE_DATACHANNEL_ERROR);const m={id:a.id,datachannelId:a._originDataChannelId,ordered:a.ordered,maxRetransmits:a.maxRetransmits,metadata:(u=a.metadata)!==null&&u!==void 0?u:""};await this._gateway.subscribeDataChannel(e.uid,m,!0),await a._waitTillOpen()}catch(m){if((m==null?void 0:m.code)!==$.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[a]),m;await this._p2pChannel.unsubscribeDataChannel(e,[a]),this._p2pChannel.setPendingRemoteDataChannel(e,a.id)}return O.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),a}finally{l()}}async _p2pSubscribe(e,t,r){if(Mr(t,"mediaType",["audio","video"]),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(l=>l===e)){const l=new me($.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),l}if(!e.hasAudio&&!e.hasVideo){const l=new me($.INVALID_REMOTE_USER,"user is not published");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),l}if(!r&&(t==="audio"&&!e.hasAudio||t==="video"&&!e.hasVideo)){const l=new me($.REMOTE_USER_IS_NOT_PUBLISHED);throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),l}const a=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const u=t==="audio"?e._audioSSRC:e._videoSSRC,p=t==="audio"?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(e,t,u,p)}catch(u){throw u}O.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(u=>{O.warning("[".concat(this._clientId,"] auto set fallback failed"),u)});const l=t==="audio"?e._audioTrack:e._videoTrack;if(!l)throw new me($.UNEXPECTED_ERROR,"can not find remote track in user object");return l}catch(l){throw O.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),l),l}finally{a()}}async _subscribe(e,t,r){if(this.store.useP2P)return this._p2pSubscribe(e,t);if(Mr(t,"mediaType",["audio","video"]),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(g=>g===e)){const g=new me($.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),g}if(!e.hasAudio&&!e.hasVideo){const g=new me($.INVALID_REMOTE_USER,"user is not published");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),g}if(!(r||(t!=="audio"||e.hasAudio&&e._audioSSRC!==void 0)&&(t!=="video"||e.hasVideo&&e._videoSSRC!==void 0))){const g=new me($.REMOTE_USER_IS_NOT_PUBLISHED);throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),g}let a=t==="audio"?e._audioSSRC:e._videoSSRC,l=t==="audio"?e._audioOrtc:e._videoOrtc,u=t==="video"?e._rtxSsrcId:void 0,p={stream_type:t==="audio"?Ze.AUDIO:Ze.VIDEO,ssrcId:a};const m=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const E=t==="audio"?e._audioSSRC:e._videoSSRC;E!==void 0&&E!==a&&(a=E,l=t==="audio"?e._audioOrtc:e._videoOrtc,u=t==="video"?e._rtxSsrcId:void 0,p={stream_type:t==="audio"?Ze.AUDIO:Ze.VIDEO,ssrcId:a}),Oi.markSubscribeStart(this.store.clientId,a),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,a,u,l);try{this._p2pChannel.isPreSubScribe(a)||await this._gateway.subscribe(e.uid,p,!0)}catch(y){if((y==null?void 0:y.code)!==$.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),y;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(E){throw this._p2pChannel.reportSubscribeEvent(!1,E==null?void 0:E.code,e,t),E}O.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(E=>{O.warning("[".concat(this._clientId,"] auto set fallback failed"),E)});const g=t==="audio"?e._audioTrack:e._videoTrack;if(!g)throw new me($.UNEXPECTED_ERROR,"can not find remote track in user object");return g}catch(g){throw O.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),g),g}finally{m()}}async massSubscribe(e){if(Ll(e,"subscribeList"),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const t=Date.now(),r=new Map,s=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(p=>{let{user:m,mediaType:g}=p;return"user: ".concat(m==null?void 0:m.uid,", mediaType: ").concat(g)}).join("; ")));const a=(e=[...e]).map(p=>{let{user:m,mediaType:g}=p;return{user:m,mediaType:g}}),l=await this._p2pChannel.globalLock();try{var u;for(let m=e.length-1;m>=0;m--){const g=e[m],{user:E,mediaType:y}=g;if(Mr(y,"mediaType",["audio","video"]),!E){const M=new me($.INVALID_PARAMS,"user property does not exist in subscribeList item");throw O.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),M}if(!this._users.find(M=>M===E)){const M=new me($.INVALID_REMOTE_USER,"user is not in the channel");O.error("[".concat(this._clientId,"] can not massSubscribe ").concat(E.uid,", this user is not in the channel")),a[m].error=M,e.splice(m,1);continue}if(y==="audio"&&(!E.hasAudio||E._audioSSRC===void 0)||y==="video"&&(!E.hasVideo||E._videoSSRC===void 0)){const M=new me($.REMOTE_USER_IS_NOT_PUBLISHED);O.error("[".concat(this._clientId,"] can not subscribe ").concat(E.uid," with mediaType ").concat(y,", remote user is not published")),a[m].error=M,e.splice(m,1);continue}const C=Vr.Video|Vr.LwoVideo,B=r.get(E);if(B){if(y==="video"?B&C:B&Vr.Audio){e.splice(m,1),O.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(E.uid,", mediaType:").concat(y," twice"));continue}r.set(E,B|(y==="video"?C:Vr.Audio))}else r.set(E,y==="video"?C:Vr.Audio)}for(let m=e.length-1;m>=0;m--){const g=e[m],{user:E,mediaType:y}=g,b=Vr.Video|Vr.LwoVideo;if(this._p2pChannel.hasRemoteMedia(E,y)){await this._p2pChannel.unmuteRemoteNoLock(E,y);const C=r.get(E);r.set(E,y==="video"?C^b:C^Vr.Audio),e.splice(m,1)}}this.store.massSubscribe(e.map(m=>({userId:m.user.uid,type:m.mediaType})),t);let p=ma(u=Array.from(r.entries())).call(u,(m,g)=>{let[E,y]=g;if(y===0)return m;const b={stream_id:E.uid,stream_type:y};return y&Vr.Audio&&(b.audio_ssrc=E._audioSSRC),y&Vr.Video&&(b.video_ssrc=E._videoSSRC),m.push(b),m},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(g=>{let{user:E,mediaType:y}=g;return{user:E,mediaType:y,ssrcId:y===Ze.VIDEO?E._videoSSRC:E._audioSSRC,rtxSsrcId:y===Ze.VIDEO?E._rtxSsrcId:void 0}}));const m=new Map;if(p=p.filter(g=>g.video_ssrc&&!this._p2pChannel.isPreSubScribe(g.video_ssrc)||g.audio_ssrc&&!this._p2pChannel.isPreSubScribe(g.audio_ssrc)||!g.video_ssrc&&!g.audio_ssrc),p.length>0){const g=await this._gateway.subscribeAll(p,!0);((g==null?void 0:g.users)||[]).forEach(E=>{let{stream_id:y,video_error_code:b,audio_error_code:C,error_code:B}=E;(b||C||B)&&m.set(y,{video_error_code:b,audio_error_code:C,error_code:B})})}if(Array.from(m.entries()).length>0){const g=[];Array.from(m.entries()).forEach(E=>{let[y,b]=E;const C=this.remoteUsers.find(B=>B.uid===y);if(C){let B;b.error_code||b.video_error_code&&b.audio_error_code?B=void 0:b.video_error_code?B=Ze.VIDEO:b.audio_error_code&&(B=Ze.AUDIO),g.push({user:C,mediaType:B})}}),g.length>0&&await this._p2pChannel.massUnsubscribeNoLock(g)}for(const g of a){const E=m.get(g.user.uid);if(E){const y=E.error_code||g.mediaType==="audio"&&E.audio_error_code||g.mediaType==="video"&&E.video_error_code;if(y){const b=_g(y);O.error("user:".concat(g.user.uid," mediaType:").concat(g.mediaType," has massSubscribe error ").concat(b.desc)),g.error=new me($.SUBSCRIBE_FAILED,"code ".concat(y,": ").concat(b.desc))}}g.error||(g.mediaType==="video"?g.track=g.user.videoTrack:g.track=g.user.audioTrack)}return this.store.massSubscribe(a.filter(g=>!g.error).map(g=>({userId:g.user.uid,type:g.mediaType})),void 0,Date.now()),a.forEach(g=>{var E;st.subscribe(this.store.sessionId,{succ:!!g.error,ec:((E=g.error)===null||E===void 0?void 0:E.code)||null,video:g.mediaType===Ze.VIDEO,audio:g.mediaType===Ze.AUDIO,peerid:g.user.uid,subscribeRequestid:g.mediaType===Ze.VIDEO?g.user._videoSSRC:g.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t),preSsrc:this._p2pChannel.isPreSubScribe(g.user._videoSSRC)},!0)}),O.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(g=>{let{user:E,mediaType:y}=g;return"user: ".concat(E==null?void 0:E.uid,", mediaType: ").concat(y)}).join("; "))),a}catch(m){throw await this._p2pChannel.massUnsubscribeNoLock(e),m}}finally{l(),s()}}async unsubscribe(e,t,r){if(!(e instanceof Vd)){const l=this.remoteUsers.find(u=>u.uid===e);if(!l)throw new me($.INVALID_REMOTE_USER,"user is not in the channel");e=l}if(t||this.store.useP2P){if(t==="datachannel")return this._unsubscribeDataChannel(e,r)}else await this._unsubscribeDataChannel(e,r);if(t&&Mr(t,"mediaType",["audio","video"]),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(l=>l===e)){const l=new me($.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),l}O.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const a=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(e,t);else{const l=await this._p2pChannel.unsubscribe(e,t);l&&await this._gateway.unsubscribe(l,e.uid),t&&t!=="audio"||(e._audio_pre_subscribed=!1),t&&t!=="video"||(e._video_pre_subscribed=!1),e._is_pre_created&&wy(this._users,e),O.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(l){if(l.code===$.DISCONNECT_P2P)return void O.warning("disconnecting p2p, abort unsubscribe request.");throw O.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),l.toString()),l}finally{a()}}async _unsubscribeDataChannel(e,t){if(t&&xn(t,"id",0,65535,!0),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(a=>a===e)){const a=new me($.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),a}let s;if(typeof t=="number"){const a=e._dataChannels.find(l=>l.id===t);a&&(s=[a])}else s=e._dataChannels;if(s===void 0){const a=new me($.REMOTE_USER_IS_NOT_PUBLISHED);throw O.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),a}O.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(s.map(a=>a.id)));try{const a=await this._p2pChannel.unsubscribeDataChannel(e,s);a&&await this._gateway.unsubscribeDataChannel(a,e.uid),O.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(a))}catch(a){if(a.code===$.DISCONNECT_P2P)return void O.warning("disconnecting p2p, abort unsubscribe request.");throw O.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),a.toString()),a}}async massUnsubscribe(e){if(Ll(e,"unsubscribeList"),!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");O.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(r=>{let{user:s,mediaType:a}=r;return"user: ".concat(s==null?void 0:s.uid,", mediaType: ").concat(a,";")}).join())),e=[...e];const t=new Map;for(let r=e.length-1;r>=0;r--){const{user:s,mediaType:a}=e[r];if(!s){const p=new me($.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw O.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),p}if(Mr(a,"mediaType",["video","audio",void 0]),!this._users.find(p=>p===s)){O.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(s.uid,", user is not in the channel")),e.splice(r,1);continue}const u=Vr.Video|Vr.LwoVideo;if(t.has(s)){const p=t.get(s);let m;switch(a){case"video":m=p&u;break;case"audio":m=p&Vr.Audio;break;default:m=p&(Vr.Audio|u)}if(m){O.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(s.uid,",mediaType:").concat(a," twice.")),e.splice(r,1);continue}a?a==="audio"?t.set(s,p|Vr.Audio):a==="video"&&t.set(s,p|u):t.set(s,p|Vr.Audio|u)}else a?a==="audio"?t.set(s,Vr.Audio):a==="video"&&t.set(s,u):t.set(s,Vr.Audio|u)}try{const r=await this._p2pChannel.massUnsubscribe(e);r&&await this._gateway.massUnsubscribe(r),O.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(s=>{let{user:a,mediaType:l}=s;return"user: ".concat(a==null?void 0:a.uid,", mediaType: ").concat(l,";")}).join()))}catch(r){if(r.code===$.DISCONNECT_P2P)return void O.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw O.error("[".concat(this._clientId,"] massUnsubscribe error"),r.toString()),r}}async setLowStreamParameter(e){(function(r){if(!r)throw new Se($.INVALID_PARAMS);ir(r.width)||mA(r.width,"streamParameter.width"),ir(r.height)||mA(r.height,"streamParameter.height"),ir(r.framerate)||mA(r.framerate,"streamParameter.framerate"),ir(r.bitrate)||xn(r.bitrate,"streamParameter.bitrate")})(e),(!e.width&&e.height||e.width&&!e.height)&&O.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),O.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,Ie.LocalVideoLowTrack)}async enableDualStream(){if(!tn().supportDualStream)throw st.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new me($.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new me($.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw st.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,st.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),O.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new me($.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Ie.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw st.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,st.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),O.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(s){Mr(s,"role",["audience","host"])}(e),t&&vA(t),this.mode==="rtc"||this.mode==="p2p")throw O.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new me($.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&e==="host")throw new me($.INVALID_OPERATION,"host mode can not set audience latency level");if(e==="audience"&&this._p2pChannel.hasLocalMedia())throw new me($.INVALID_OPERATION,"can not set client role to audience when publishing stream");const r=this._config.role;this._joinInfo&&(this._joinInfo.role=e),e!==r&&Z("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(e,t),this._config.role=e,this._gateway.reconnect("recover",yi.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(e,t),this._config.role=e),O.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))}async _setClientRoleOptions(e){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let t=!1;try{e&&vA(e),await this._gateway.setClientRole(this._config.role,e),t=!0}catch{}finally{O.info("[".concat(this._clientId,"] set client role options ").concat(t?"succeed":"failed",", options is ").concat(e))}}getRemoteInboundOffset(){var e;const t=(e=this._p2pChannel.getStats())===null||e===void 0?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const r=t.timestamp-Date.now();return Math.abs(r)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?r:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(oi(e,"proxyServer"),!t){if(this.connectionState!=="DISCONNECTED")throw new me($.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new me($.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,st.setProxyServer(this._proxyServer),O.setProxyServer(this._proxyServer),O.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if(this.connectionState!=="DISCONNECTED")throw new me($.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new me($.INVALID_OPERATION,"You have already set the proxy")}if(og(e))return this._turnServer={servers:e,mode:"original-manual"},void O.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map(r=>r.urls).join(","),"."));e.forEach(r=>cV(r)),this._turnServer={servers:e,mode:"manual"},O.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if(this.connectionState!=="DISCONNECTED")throw new me($.INVALID_OPERATION,"you should set license before join channel");if(oi(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new me($.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,O.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if(this.connectionState!=="DISCONNECTED")throw new me($.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new me($.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let r;switch(e===void 0&&(e=3),e){case 1:case 2:throw new me($.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:r="proxy3";break;case 4:r="proxy4";break;case 5:r="proxy5";break;default:throw new me($.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=r,this.store.cloudProxyServerMode=r,O.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new me($.INVALID_OPERATION,"Stop proxy server after leave channel");st.setProxyServer(),O.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",O.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new me($.INVALID_PARAMS,"accessPoints is required.");Ll(e.accessPoints.serverList,"accessPoints.serverList"),oi(e.accessPoints.domain,"accessPoints.domain");const t=(b,C)=>{xn(b,C,0,65535,!0)};let r=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),r=e.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new me($.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");Z("CLOSE_AFB_FOR_LOCAL_AP")&&(vn("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),vn("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const s=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,a=e.accessPoints.domain,l=e.accessPoints.serverList.map(b=>s.test(b)?"".concat(b.replace(/\./g,"-"),".").concat(a):b),u=l.map(b=>"".concat(b,":").concat(r));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,vn("WEBCS_DOMAIN",u),vn("WEBCS_DOMAIN_BACKUP_LIST",u),vn("GATEWAY_DOMAINS",[a]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(Ll(e.report.hostname,"report.hostname"),vn("EVENT_REPORT_DOMAIN",e.report.hostname[0]),vn("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(vn("EVENT_REPORT_DOMAIN",l[0]),vn("EVENT_REPORT_BACKUP_DOMAIN",l[1]||l[0]));let p=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),p=e.report.port),vn("STATS_COLLECTOR_PORT",p),e.report?vn("ENABLE_EVENT_REPORT",!0):vn("ENABLE_EVENT_REPORT",!1);let m="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(Ll(e.log.hostname,"log.hostname"),m=e.log.hostname[0]):m=l[0];let g=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),g=e.log.port),vn("LOG_UPLOAD_SERVER","".concat(m,":").concat(g));let E=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(Ll(e.cds.hostname,"cds.hostname"),E=e.cds.hostname):E=l;let y=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),y=e.cds.port),vn("CDS_AP",E.map(b=>"".concat(b,":").concat(y))),e.cds?vn("ENABLE_CONFIG_DISTRIBUTE",!0):vn("ENABLE_CONFIG_DISTRIBUTE",!1),O.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(Ll(e,"serverList"),oi(t,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new me($.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(s=>r.test(s)?"".concat(s.replace(/\./g,"-"),".").concat(t):s),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,vn("WEBCS_DOMAIN",e),vn("WEBCS_DOMAIN_BACKUP_LIST",e),vn("GATEWAY_DOMAINS",[t]),vn("EVENT_REPORT_DOMAIN",e[0]),vn("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),vn("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),O.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(Mr(e,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(t){throw O.error("[".concat(this._clientId,"] set default remote video stream type error"),t.toString()),t}else O.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){Mr(t,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout(()=>{const r=this._users.find(s=>s.uid===e);r&&r.videoTrack&&r.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(r){throw O.error("[".concat(this._clientId,"] set remote video stream type error"),r.toString()),r}O.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){Mr(t,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(r){throw O.error("[".concat(this._clientId,"] set stream fallback option"),r.toString()),r}O.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,r,s){(function(l){Mr(l,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(e),oi(t,"secret");const a=["aes-128-gcm2","aes-256-gcm2"];if(je(a).call(a,e)){if(!r||!(r instanceof Uint8Array&&r.length===32))throw new me($.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new me($.INVALID_PARAMS,"current encrypt mode does not need salt");if(s){if(kl(s,"encryptDataStream"),!je(a).call(a,e))throw new me($.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(t)||O.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=e,this._encryptionSecret=t,r&&(this._encryptionSalt=Dd(r))}async renewToken(e){if(oi(e,"token",1,2047),!this._key||!this._joinInfo)throw new me($.INVALID_OPERATION,"renewToken should not be called before user join");const t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const r=await this._renewTokenMutex.lock();try{if(Z("USE_NEW_TOKEN")){O.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const s=await zue(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Rr);O.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:s})}else O.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});O.debug("[".concat(this._clientId,"] renewToken success"))}catch(s){throw this._key=t,this._joinInfo.token=t,O.error("[".concat(this._clientId,"] renewToken failed"),s.toString()),s}finally{r()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?O.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(Ht.VOLUME_INDICATOR,e)},Z("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if(this.codec!=="h264")throw new me($.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new me($.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new me($.LIVE_STREAMING_TASK_CONFLICT);const r=t?Jc.TRANSCODE:Jc.RAW;return this._createLiveStreamingClient(r).startLiveStreamingTask(e,r)}setLiveTranscoding(e){return this._createLiveStreamingClient(Jc.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(r=>r&&r.hasUrl(e));if(!t.length)throw new me($.INVALID_PARAMS,"can not find live streaming url to stop");await Ye.all(t.map(r=>r&&r.stopLiveStreamingTask(e)))}async startChannelMediaRelay(e){q5(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}async updateChannelMediaRelay(e){q5(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(e){this._p2pChannel instanceof Ag&&this._p2pChannel.addAudioMetadata(e)}async sendStreamMessage(e){var t;let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new me($.INVALID_OPERATION,"can not send data stream, not joined");if((typeof e=="string"||e instanceof Uint8Array)&&(e={payload:e}),typeof e.payload=="string"){const a=new TextEncoder;e.payload=a.encode(e.payload)}let s=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&je(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)&&(s=!0,e.payload=await async function(a,l,u){var p;const m=ma(p=Array.from(u)).call(p,(M,F)=>M+F,0),g={serverTs:0,seq:hde++,length:u.length,checkSum:m},E=new Uint8Array(gV(m,2)),y=new ArrayBuffer(mf),b=new DataView(y);b.setUint32(0,g.serverTs),b.setUint16(4,g.seq),b.setUint16(6,g.length),b.setUint16(8,g.checkSum);const C=16-u.length%16;u=uV(u,new Uint8Array(C));const B=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:a,tagLength:NV,additionalData:E},l,u);return uV(new Uint8Array(y),new Uint8Array(B))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new me($.INVALID_PARAMS,s?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(xt.DATA_STREAM,{payload:Dd(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-ehe},!r)}sendMetadata(e){if(!this._joinInfo)throw new me($.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new me($.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(xt.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Dd(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(Sde),!this._joinInfo)throw new me($.INVALID_OPERATION,"can not send custom report, not joined");await st.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){Mr(t.spatialLayer,"spatialLayer",[0,1,2,3]),Mr(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(r){throw O.error("[".concat(this._clientId,"] pick SVC layer failed"),r.toString()),r}}async setRTMConfig(e){const{apRTM:t=!1,rtmFlag:r}=e;if(kl(t,"apRTM"),xn(r,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=r,O.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=r,this._gateway.setRTM2Flag(r)}_reset(){if(O.debug("[".concat(this._clientId,"] reset client")),function(e){const t=Af.indexOf(e);t!==-1&&Af.splice(t,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=_s.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&y6(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&st.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(t=>t._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Ai("client-publish",this._clientId),this._subscribeMutex=new Ai("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(e,t){var r;const s=e||hh();e?O.debug("[".concat(this._clientId,"] new Session ").concat(s)):O.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(s));const a=e?"":this._sessionId||"";this._sessionId=s,this.store.sessionId=s,st.addSid(s);const l={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(t==null?void 0:t.stringUid)||((r=this._joinInfo)===null||r===void 0?void 0:r.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:a,clientRole:this.role==="audience"?2:1};st.sessionInit(this._sessionId,Da({cname:t.channel,appid:t.appId},l)),this._joinInfo&&(this._joinInfo.sid=s),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=s)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new me($.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Z("FORCE_TURN")&&!Z("TURN_ENABLE_TCP")&&!Z("TURN_ENABLE_UDP"))throw new me($.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");O.debug("[".concat(this._clientId,"] publish high stream"));try{const r=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const s=(await r.next()).value;if(s){try{await this._gateway.sendExtensionMessage(gr.PUBLISH,s,!0)}catch(a){throw r.throw(a),a}await r.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const s=(await r.next()).value;if(s){var t;let a;try{a=await this._gateway.publish(this._uid,s,!0)}catch(l){if(l.code!==$.DISCONNECT_P2P)throw r.throw(l),l}await r.next(((t=a)===null||t===void 0?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const a of e)a instanceof Un&&a._encoderConfig&&this._gateway.setVideoProfile(a._encoderConfig).catch(l=>{O.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!a.muted&&a.enabled||await this._p2pChannel.muteLocalTrack(a)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,e),(r==null?void 0:r.code)===$.WS_ABORT)return;throw r}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new me($.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new me($.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));O.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const r=await this._p2pChannel.publishLowStream(this._lowStreamParameter),s=(await r.next()).value;if(s){var t;let a;try{a=await this._gateway.publish(this._uid,s,!0)}catch(l){if(l.code!==$.DISCONNECT_P2P)throw r.throw(l),l}r.next(((t=a)===null||t===void 0?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,void 0,!0),(r==null?void 0:r.code)===$.WS_ABORT)return;throw r}}_createLiveStreamingClient(e){const t=()=>{if(!this._joinInfo||!this._appId)return new me($.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const r=(s={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},Fl("LiveStreaming").create(s));var s;return r.onLiveStreamError=(a,l)=>{st.reportApiInvoke(this._sessionId,{name:xr.ON_LIVE_STREAM_ERROR,options:[a,l],tag:sr.TRACER}).onSuccess(),this.safeEmit(Ht.LIVE_STREAMING_ERROR,a,l)},r.onLiveStreamWarning=(a,l)=>{st.reportApiInvoke(this._sessionId,{name:xr.ON_LIVE_STREAM_WARNING,options:[a,l],tag:sr.TRACER}).onSuccess(),this.safeEmit(Ht.LIVE_STREAMING_WARNING,a,l)},r.on(d1.REQUEST_WORKER_MANAGER_LIST,(a,l,u)=>{if(!this._joinInfo)return u(new me($.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(p,m,g,E){const y=Z("UAP_AP").slice(0,Z("AJAX_REQUEST_CONCURRENT")).map(b=>m.proxyServer?"https://".concat(m.proxyServer,"/ap/?url=").concat(b+"/api/v1?action=uap"):"https://".concat(b,"/api/v1?action=uap"));return await Fue(y,p,m,g,E)})(a,this._joinInfo,this._axiosCancelSource.token,Rr).then(l).catch(u)}),r};return e===Jc.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||t(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||t(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new me($.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:t,sendResolutionHeight:r}=this.getLocalVideoStats(),s=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:t,height:r}},Fl("ChannelMediaRelay").create(e));s.on("state",a=>{a===ks.RELAY_STATE_FAILURE&&s&&s.dispose(),this.safeEmit(Ht.CHANNEL_MEDIA_RELAY_STATE,a)}),s.on("event",a=>{this.safeEmit(Ht.CHANNEL_MEDIA_RELAY_EVENT,a)}),this._channelMediaRelayClient=s,this._statsCollector.onStatsChanged=(a,l)=>{var u;a==="resolution"&&((u=this._channelMediaRelayClient)===null||u===void 0||u.setVideoProfile(l))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:r,deleted:s}=e,a=[];if(t){const l=[];this._users.forEach(u=>{u._dataChannels.forEach(p=>{r.every(m=>m.uid!==u._uintid||m.stream_id!==p.id)&&l.push({uid:u._uintid,stream_id:p.id,ordered:p.ordered,max_retrans_times:p.maxRetransmits,metadata:p.metadata})})}),l.length>0&&this._handleUpdateDataChannel({added:[],deleted:l})}Array.isArray(r)&&r.length>0&&r.forEach(l=>{const{uid:u,stream_id:p,ordered:m,max_retrans_times:g,metadata:E}=l,y=this._users.find(b=>b._uintid===u);if(!y)return void O.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(O.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(u)),je(a).call(a,y)||a.push(y),y._uintid||(y._uintid=u),y._dataChannels.findIndex(b=>b.id===l.stream_id)===-1){const b={id:p,ordered:!!m,maxRetransmits:g,metadata:E},C=function(B){return I5(B,!0)}(b);y._dataChannels.push(C),O.info("[".concat(this._clientId,"] remote user ").concat(y.uid," published datachannel")),t||this.safeEmit(Ht.USER_PUBLISHED,y,"datachannel",b)}this._p2pChannel.hasPendingRemoteDataChannel(y,l.stream_id)&&(O.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(y.uid," after reconnect.")),this._subscribeDataChannel(y,l.stream_id).catch(b=>{O.error("[".concat(this._clientId,"] resubscribe datachannel error"),b.toString())}))}),t&&(this.safeEmit(Ht.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(s)&&s.length>0&&s.forEach(l=>{const{uid:u,stream_id:p}=l,m=this._users.find(E=>E._uintid===u);if(!m)return void O.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const g=m._dataChannels.find(E=>E.id===l.stream_id);g&&(O.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(u)),this._p2pChannel.unsubscribeDataChannel(m,[g]).then(E=>{if(m._dataChannels=m._dataChannels.filter(y=>y!==g),E)return this._gateway.unsubscribeDataChannel(E,m.uid)}),O.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished datachannel ,id:").concat(g.id)),this.safeEmit(Ht.USER_UNPUBLISHED,m,"datachannel",g._config))})}_handleRemoveDataChannels(e){const t=this._users.find(r=>r.uid===e.uid);if(t){if(t._dataChannels!==void 0&&t._dataChannels.length>0){O.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const r=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach(s=>{this.safeEmit(Ht.USER_UNPUBLISHED,t,"datachannel",s._config)})};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then(s=>{if(s)return this._gateway.unsubscribeDataChannel(s,t.uid)}),r()}}else O.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(Qr.UPDATE_GATEWAY_CONFIG,()=>{(function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void O.error("Error loading sdk config",t.message)}if(e)try{const t=JSON.parse(window.atob(e)),r=Date.now();Object.keys(t).forEach(s=>{const{value:a,type:l,expires:u}=t[s];u&&u<=r||l||r1()||!Object.prototype.hasOwnProperty.call(Oy,s)||(ac[s]=a,Wn[s]=a,O.debug("Update gateway parameters from config distribute",s,a))})}catch(t){O.error("Error update config from local cache",t.message)}})()}),this._gateway.on(Qr.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(Qr.CONNECTION_STATE_CHANGE,(e,t,r)=>{var s;if(r===hn.FALLBACK)return;const a=()=>{this.safeEmit(Ht.CONNECTION_STATE_CHANGE,e,t,r)};if(st.reportApiInvoke(this._sessionId||((s=this._gateway.joinInfo)===null||s===void 0?void 0:s.sid)||null,{name:xr.CONNECTION_STATE_CHANGE,options:[e,t,r],tag:sr.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:r})),O.info("[".concat(this._clientId,"] signal connection state change: ").concat(t," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void a();if(e==="RECONNECTING")this._users.forEach(u=>{u._trust_in_room_=!1,u._trust_audio_enabled_state_=!1,u._trust_video_enabled_state_=!1,u._trust_audio_mute_state_=!1,u._trust_video_mute_state_=!1,u._trust_audio_stream_added_state_=!1,u._trust_video_stream_added_state_=!1,u._is_pre_created||(u._audio_pre_subscribed||(u._audioSSRC=void 0,u._audioOrtc=void 0),u._video_pre_subscribed||(u._videoSSRC=void 0,u._videoOrtc=void 0,u._rtxSsrcId=void 0),u._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var l;this._streamFallbackTypeCacheMap.forEach((u,p)=>{this._gateway.setStreamFallbackOption(p,u).catch(m=>{O.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),m)})}),this._remoteStreamTypeCacheMap.forEach((u,p)=>{this._gateway.setRemoteVideoStreamType(p,u).catch(m=>{O.warning("[".concat(this._clientId,"] auto set remote stream type failed"),m)})}),this._remoteDefaultVideoStreamType!==void 0&&((l=this._joinInfo)===null||l===void 0?void 0:l.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{O.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(u=>{O.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(u))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(u=>!u._trust_in_room_).forEach(u=>{O.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(u.uid)),this._handleUserOffline({uid:u.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(u=>{u._trust_audio_mute_state_||(O.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(u.uid)),this._handleMuteStream(u.uid,Ze.AUDIO,!1)),u._trust_video_mute_state_||(O.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(u.uid)),this._handleMuteStream(u.uid,Ze.VIDEO,!1)),u._trust_audio_enabled_state_||(O.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(u.uid)),this._handleSetStreamLocalEnable("audio",u.uid,!0)),u._trust_video_enabled_state_||(O.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(u.uid)),this._handleSetStreamLocalEnable("video",u.uid,!0)),u._trust_video_stream_added_state_||(O.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(u.uid)),this._handleResetAddStream(u,"video")),u._trust_audio_stream_added_state_||(O.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(u.uid)),this._handleResetAddStream(u,"audio")),u._video_added_||u._audio_added_||(O.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(u.uid)),this._handleRemoveStream({uid:u.uid,uint_id:u._uintid}))}))},1e3))}a()}),this._gateway.on(Qr.REQUEST_NEW_GATEWAY_LIST,async(e,t)=>{if(!this._joinInfo)return t(new me($.UNEXPECTED_ERROR,"can not recover, no join info"));try{let r;const s=await E6(Da(Da({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));s?(r=s.ap,S6(s),this._joinInfo.preload=!0):(r=await R1(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||Rr,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=r.gatewayInfo.res,this._joinInfo.gatewayAddrs=r.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=r.gatewayInfo.uni_lbs_ip);const a=[];r.gatewayInfo.gatewayAddrs.forEach(l=>{let{address:u}=l;const[p,m]=u.split(":");this._joinInfo&&this._joinInfo.proxyServer?a.push({proxy:this._joinInfo.proxyServer,host:p,port:m}):a.push({host:p,port:m})}),e(a)}catch(r){t(r)}}),this._gateway.on(Qr.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Ht.NETWORK_QUALITY,e)}),this._gateway.on(Qr.STREAM_TYPE_CHANGE,(e,t)=>{this.safeEmit(Ht.STREAM_TYPE_CHANGED,e,t),st.reportApiInvoke(this._sessionId,{name:xr.STREAM_TYPE_CHANGE,options:[e,t],tag:sr.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))}),this._gateway.on(Qr.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(Qr.REQUEST_P2P_CONNECTION_PARAMS,async(e,t,r)=>{try{let s=await this._p2pChannel.getEstablishParams();Z("ENABLE_PREALLOC_PC")&&s||(s=await this._p2pChannel.startP2PConnection(e)),t(s)}catch(s){r(s)}}),this._gateway.on(Qr.JOIN_RESPONSE,(e,t)=>{if(this.store.useP2P)return;let r;e.attributes?r=e.attributes.userAttributes.preSubSsrcs:O.debug("no attributes in joinResponse");const s=E5(e.ortc,t,r);this._p2pChannel.connect(s)}),this._gateway.on(Qr.PRE_CONNECT_PC,async e=>{const{candidates:t,fingerprint:r}=e;if(this._joinInfo&&t.length>0&&!this._p2pChannel.isPlanB){var s;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:a,cid:l}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(l,"_").concat(a),icePwd:"".concat(l,"_").concat(a)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(s=Z("FINGERPRINT"))!==null&&s!==void 0?s:r}]},candidates:t,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(zt.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(zt.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(zt.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(zt.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(zt.ON_REMOTE_DATASTREAM_UPDATE,e=>{this._handleUpdateDataChannel(e)}),this._gateway.signal.on(zt.ON_REMOTE_FULL_DATASTREAM_INFO,e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(zt.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(zt.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(zt.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,Ze.AUDIO,!0)),this._gateway.signal.on(zt.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,Ze.AUDIO,!1)),this._gateway.signal.on(zt.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,Ze.VIDEO,!0)),this._gateway.signal.on(zt.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,Ze.VIDEO,!1)),this._gateway.signal.on(zt.RECEIVE_METADATA,e=>{const t=uh(e.metadata);this.safeEmit(Ht.RECEIVE_METADATA,e.uid,t)}),this._gateway.signal.on(zt.ON_DATA_STREAM,async e=>{var t;if(!e)return;let r=uh(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&je(t=["aes-128-gcm2","aes-256-gcm2"]).call(t,this._encryptionMode)){if(e.payload.length<mf)throw new me($.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(mf));r=await async function(l,u,p){const m=p.subarray(0,mf),g=m.slice(8,mf),E=(g[0]<<8)+g[1],y=(m[6]<<8)+m[7],b=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:l,tagLength:NV,additionalData:new Uint8Array(gV(E,2))},u,p.subarray(mf));return new Uint8Array(b).subarray(0,y)}(this._encryptDataStreamIv,this._encryptDataStreamKey,r)}let s=0;if(e.ordered||e.syncWithAudio){const a=this._p2pChannel.getStats(),l=this.remoteUsers.find(p=>p.uid===e.uid),u=a==null?void 0:a.audioRecv.find(p=>p.ssrc===(l==null?void 0:l._audioSSRC));s=u==null?void 0:u.jitterBufferMs}(s==null||Number.isNaN(s))&&(s=0),nhe(Da(Da({},e),{},{payload:r}),s,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(zt.ON_CRYPT_ERROR,()=>{Od(()=>{O.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Ht.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(zt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(zt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{O.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,hn.TOKEN_EXPIRE),this.safeEmit(Ht.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(zt.ON_STREAM_FALLBACK_UPDATE,e=>{O.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(Ht.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(zt.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),O.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))}),this._gateway.signal.on(zt.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(zt.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(bt.REQUEST_TIMEOUT,(e,t)=>{if(this._joinInfo)switch(e){case xt.PUBLISH:{if(!t)return;const a=t.ortc;if(a){var r,s;const l=a.some(m=>{let{stream_type:g}=m;return g===gn.Audio}),u=a.some(m=>{let{stream_type:g}=m;return g!==gn.Audio}),p=a.some(m=>{let{stream_type:g}=m;return g===gn.Screen||g===gn.ScreenLow});t.state==="offer"&&st.publish(this._joinInfo.sid,{eventElapse:Oi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:$.TIMEOUT,audio:l,video:u,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:p,audioName:l?(r=a.find(m=>{let{stream_type:g}=m;return g===gn.Audio}))===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId.toString():void 0,videoName:u?(s=a.find(m=>{let{stream_type:g}=m;return g!==gn.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0})}break}case xt.SUBSCRIBE:t&&st.subscribe(this._joinInfo.sid,{succ:!1,ec:$.TIMEOUT,audio:t.stream_type===Ze.AUDIO,video:t.stream_type===Ze.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:Oi.measureFromSubscribeStart(this.store.clientId,t.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(t.ssrcId)})}}),this._gateway.signal.on(zt.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(zt.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;Z("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter(s=>!yh(s.string_id||s.stream_id,this.channelName)));const t=[],r=[];for(const s of e.users){let a=this._users.find(E=>E._uintid===s.stream_id);a?a._trust_in_room_=!0:(a=new Vd(s.string_id||s.stream_id,s.stream_id),this._users.push(a),this.getListeners(Ht.PUBLISHED_USER_LIST).length===0&&(O.debug("[".concat(this._clientId,"] user online"),s.stream_id),this.safeEmit(Ht.USER_JOINED,a)));const l=Vr.Audio&s.stream_type,u=(Vr.Video|Vr.LwoVideo)&s.stream_type,p=(65280&s.stream_type)!=0,m=l&&a.hasAudio,g=u&&a.hasVideo;u&&(a._trust_video_stream_added_state_=!0,a._video_added_=!0,a._videoSSRC=s.video_ssrc,a._rtxSsrcId=s.video_rtx),l&&(a._trust_audio_stream_added_state_=!0,a._audio_added_=!0,a._audioSSRC=s.audio_ssrc),l&&!m&&this.getListeners(Ht.PUBLISHED_USER_LIST).length===0&&(O.info("[".concat(this._clientId,"] remote user ").concat(a.uid," published audio")),this.safeEmit(Ht.USER_PUBLISHED,a,"audio")),u&&!g&&this.getListeners(Ht.PUBLISHED_USER_LIST).length===0&&(O.info("[".concat(this._clientId,"] remote user ").concat(a.uid," published video")),this.safeEmit(Ht.USER_PUBLISHED,a,"video")),(l&&!m||u&&!g||p)&&t.push(a),u&&this._p2pChannel.hasPendingRemoteMedia(a,"video")&&r.push({user:a,mediaType:"video"}),l&&this._p2pChannel.hasPendingRemoteMedia(a,"audio")&&r.push({user:a,mediaType:"audio"})}r.length>0&&(O.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(r.map(s=>"user: ".concat(s.user.uid,", mediaType: ").concat(s.mediaType)).join("; ")," ")),this.massSubscribe(r).catch(s=>{O.error("[".concat(this._clientId,"] mass resubscribe error"),s.toString())})),this.getListeners(Ht.PUBLISHED_USER_LIST).length>0?Z("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(O.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map(s=>s.uid).join(", "))),this.safeEmit(Ht.PUBLISHED_USER_LIST,t)):O.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map(s=>s.uid).join(", ")))}),this._gateway.signal.on(zt.ON_RTP_CAPABILITY_CHANGE,e=>{const{video_codec:t}=e;this._p2pChannel instanceof Ag&&this._p2pChannel.updateRemoteRTPCapabilities(t.map(r=>r.toLowerCase()).filter(r=>{var s;return je(s=Object.keys(Dy)).call(s,r)}))})}_handleP2PEvents(){this._gateway.signal.on(zt.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(gr.PUBLISH,(e,t,r)=>{const{uid:s}=e;e.forEach(a=>{const{kind:l,ssrcs:u,mid:p,isMuted:m}=a;this._handleP2PAddAudioOrVideoStream(l,s,u[0].ssrcId,p);const g=this._users.find(E=>E.uid===s);return g&&this.store.useP2P?this._p2pChannel.mockSubscribe(g,l,u[0].ssrcId,p).then(()=>{t()}).catch(r):t(),this._handleMuteStream(s,l,!!m)})}),this._gateway.signal.on(gr.CALL,async(e,t,r)=>{if(this.store.useP2P)try{var s;t(await this._p2pChannel.startP2P({turnServer:(s=this._joinInfo)===null||s===void 0?void 0:s.turnServer},e))}catch(a){r(a)}}),this._gateway.signal.on(bt.P2P_CONNECTION,async e=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(e)}),this._gateway.signal.on(gr.UNPUBLISH,async(e,t,r)=>{if(this.store.useP2P){const{unpubMsg:s,uid:a}=e,l=this._users.find(u=>u.uid===a);if(!l)return O.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(a)),void t();try{s.forEach(async u=>{let{stream_type:p}=u;const m=p===gn.Audio?Ze.AUDIO:Ze.VIDEO;await this._p2pChannel.unsubscribe(l,m),this._handleMuteStream(a,m,!0)}),t()}catch(u){r(u)}}}),this._gateway.signal.on(gr.CONTROL,async(e,t)=>{const{action:r}=e;switch(r){case Ld.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,Ze.VIDEO,!0);break;case Ld.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,Ze.AUDIO,!0);break;case Ld.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,Ze.VIDEO,!1);break;case Ld.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,Ze.AUDIO,!1)}}),this._gateway.signal.on(gr.RESTART_ICE,async(e,t,r)=>{if(this.store.useP2P)try{const{direction:s,iceParameter:a}=e;s!==cs.SEND_ONLY||a?t(await this._p2pChannel.restartICE(s,a)):(this._p2pChannel.handleDisconnect(s),t())}catch(s){r(s)}}),this._gateway.signal.on(gr.CANDIDATE,e=>{if(this.store.useP2P){const{candidate:t,direction:r}=e;this._p2pChannel.addRemoteCandidate(t,r)}}),this._p2pChannel.on(ht.RequestP2PRestartICE,async(e,t,r)=>{try{const{direction:s}=e;t(await this._gateway.sendExtensionMessage(gr.RESTART_ICE,e,s===cs.SEND_ONLY))}catch(s){r(s)}}),this._p2pChannel.on(ht.LocalCandidate,e=>{this._gateway.sendExtensionMessage(gr.CANDIDATE,JSON.stringify(e),!0)}),this._p2pChannel.on(ht.RequestP2PMuteLocal,async(e,t,r)=>{try{await this._gateway.sendExtensionMessage(gr.CONTROL,e,!0),t()}catch(s){r(s)}}),this._p2pChannel.on(ht.RequestP2PUnmuteRemote,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===$.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(ht.RequestP2PMuteRemote,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===$.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(ht.StateChange,(e,t)=>{t===pn.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(ht.PeerConnectionStateChange,e=>{const t=this._peerConnectionState;e!==t&&(this.safeEmit(Ht.PEERCONNECTION_STATE_CHANGE,e,t),this._peerConnectionState=e)}),this._p2pChannel.on(ht.RequestMuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===$.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(ht.RequestUnmuteLocal,async(e,t,r)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(s){s.code===$.DISCONNECT_P2P?t():r(s)}else t()}),this._p2pChannel.on(ht.RequestRePublish,(e,t,r)=>{this.publish(e,!1).then(t).catch(r)}),this._p2pChannel.on(ht.RequestRePublishDataChannel,(e,t,r)=>{Ye.all(e.map(async s=>{const a=await this._p2pChannel.publishDataChannel([s]);try{a.forEach(l=>{this._uid&&this._gateway.publishDataChannel(this._uid,l,!0)})}catch(l){if(l.code!==$.DISCONNECT_P2P)throw l}})).then(t).catch(r)}),this._p2pChannel.on(ht.RequestReSubscribe,async(e,t,r)=>{try{for(const{user:s,kind:a}of e)a===Ze.VIDEO?await this.subscribe(s,"video"):await this.subscribe(s,"audio");t()}catch(s){r(s)}}),this._p2pChannel.on(ht.RequestUpload,(e,t)=>{this._gateway.upload(e,t)}),this._p2pChannel.on(ht.RequestUploadStats,e=>{this._gateway.uploadWRTCStats(e)}),this._p2pChannel.on(ht.MediaReconnectStart,e=>{this.safeEmit(Ht.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(ht.MediaReconnectEnd,e=>{this.safeEmit(Ht.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(ht.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(ht.RequestRestartICE,async e=>{if(this.store.useP2P)return;const t=await this._p2pChannel.restartICE(e),r=await t.next();if(r.done)return;const s=r.value;let a;try{a=await this._gateway.restartICE({iceParameters:s})}catch(u){return void t.throw(u)}const{iceParameters:l}=function(u){const p=u.iceParameters;return{iceParameters:{iceUfrag:p.iceUfrag,icePwd:p.icePwd}}}(a);await t.next({remoteIceParameters:l})}),this._p2pChannel.on(ht.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(ht.RequestReconnectPC,async()=>{var e;const{iceParameters:t,dtlsParameters:r,rtpCapabilities:s}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:a,gatewayAddress:l}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:r,rtpCapabilities:s}),u=E5(a,l);await this._p2pChannel.connect(u),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(ht.RequestUnpublishForReconnectPC,async(e,t,r)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),t()):r()}),this._p2pChannel.on(ht.P2PLost,()=>{this.safeEmit(Ht.P2P_LOST,this.store.uid)}),this._p2pChannel.on(ht.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(ht.ConnectionTypeChange,e=>{this.safeEmit(Ht.IS_USING_CLOUD_PROXY,e)}),this._p2pChannel.on(ht.RequestLowStreamParameter,e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(ht.QueryClientConnectionState,e=>{e(this.connectionState)}),this._p2pChannel.on(ht.AudioMetadata,e=>{this.safeEmit(Ht.AUDIO_METADATA,e)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const r=(t={config:e},Fl("ContentInspect").create(t));this._inspect=r,this.handleVideoInspectEvents(r);const{appId:s,cname:a,sid:l,token:u,uid:p,cid:m,vid:g}=this._joinInfo;await r.init({appId:s,areaCode:"",cname:a,sid:l,token:u,uid:p,cid:m,vid:g?Number(g):0},Rr)}catch(r){throw Array.isArray(r)?r[0]:r}var t}handleVideoInspectEvents(e){e.on(Zr.CONNECTION_STATE_CHANGE,(t,r)=>{if(this.safeEmit(Ht.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,r),r===Ra.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Ht.CONTENT_INSPECT_ERROR,new me($.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(Zr.INSPECT_RESULT,(t,r)=>{var s;if((r==null?void 0:r.code)===$.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return O.debug("Stop inspect content because that has left channel"),this==null||(s=this._inspect)===null||s===void 0||s.close(),void(this._inspect=void 0);this.safeEmit(Ht.CONTENT_INSPECT_RESULT,t,r)}),e.on(Zr.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(kl(e,"enabled"),e){if(!t)throw new me($.INVALID_PARAMS,"config is required");if(M6(t),!this._joinInfo)throw new me($.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(t);else{const s=(r={config:t},Fl("ImageModeration").create(r));this._moderation=s,this.handleImageModerationEvents(s);const{appId:a,cname:l,sid:u,token:p,uid:m,cid:g,vid:E}=this._joinInfo;await s.init({appId:a,areaCode:"",cname:l,sid:u,token:p,uid:m,cid:g,vid:E?Number(E):0},Rr)}}catch(s){throw Array.isArray(s)?s[0]:s}}else{var r;if(!this._moderation)throw new me($.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(s){throw Array.isArray(s)?s[0]:s}}}handleImageModerationEvents(e){e.on(dc.CONNECTION_STATE_CHANGE,(t,r)=>{if(this.safeEmit(Ht.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,r),t===Yo.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new me($.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(dc.CLIENT_LOCAL_VIDEO_TRACK,t=>{t(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}setP2PTransport(e){if(function(t){Mr(t,"transport",["default","auto","relay","sd-rtn"])}(e),this.mode!=="p2p")throw new me($.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,O.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return O.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){kl(e,"enabled"),vn("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},it($e.prototype,"leave",[j6],Object.getOwnPropertyDescriptor($e.prototype,"leave"),$e.prototype),it($e.prototype,"publish",[U6],Object.getOwnPropertyDescriptor($e.prototype,"publish"),$e.prototype),it($e.prototype,"unpublish",[F6],Object.getOwnPropertyDescriptor($e.prototype,"unpublish"),$e.prototype),it($e.prototype,"subscribe",[V6],Object.getOwnPropertyDescriptor($e.prototype,"subscribe"),$e.prototype),it($e.prototype,"presubscribe",[B6],Object.getOwnPropertyDescriptor($e.prototype,"presubscribe"),$e.prototype),it($e.prototype,"massSubscribe",[W6],Object.getOwnPropertyDescriptor($e.prototype,"massSubscribe"),$e.prototype),it($e.prototype,"unsubscribe",[H6],Object.getOwnPropertyDescriptor($e.prototype,"unsubscribe"),$e.prototype),it($e.prototype,"massUnsubscribe",[G6],Object.getOwnPropertyDescriptor($e.prototype,"massUnsubscribe"),$e.prototype),it($e.prototype,"setLowStreamParameter",[z6],Object.getOwnPropertyDescriptor($e.prototype,"setLowStreamParameter"),$e.prototype),it($e.prototype,"enableDualStream",[K6],Object.getOwnPropertyDescriptor($e.prototype,"enableDualStream"),$e.prototype),it($e.prototype,"disableDualStream",[q6],Object.getOwnPropertyDescriptor($e.prototype,"disableDualStream"),$e.prototype),it($e.prototype,"setClientRole",[Y6],Object.getOwnPropertyDescriptor($e.prototype,"setClientRole"),$e.prototype),it($e.prototype,"_setClientRoleOptions",[$6],Object.getOwnPropertyDescriptor($e.prototype,"_setClientRoleOptions"),$e.prototype),it($e.prototype,"setProxyServer",[X6],Object.getOwnPropertyDescriptor($e.prototype,"setProxyServer"),$e.prototype),it($e.prototype,"setTurnServer",[J6],Object.getOwnPropertyDescriptor($e.prototype,"setTurnServer"),$e.prototype),it($e.prototype,"setLicense",[Q6],Object.getOwnPropertyDescriptor($e.prototype,"setLicense"),$e.prototype),it($e.prototype,"startProxyServer",[Z6],Object.getOwnPropertyDescriptor($e.prototype,"startProxyServer"),$e.prototype),it($e.prototype,"stopProxyServer",[e8],Object.getOwnPropertyDescriptor($e.prototype,"stopProxyServer"),$e.prototype),it($e.prototype,"setLocalAccessPointsV2",[t8],Object.getOwnPropertyDescriptor($e.prototype,"setLocalAccessPointsV2"),$e.prototype),it($e.prototype,"setLocalAccessPoints",[n8],Object.getOwnPropertyDescriptor($e.prototype,"setLocalAccessPoints"),$e.prototype),it($e.prototype,"setRemoteDefaultVideoStreamType",[r8],Object.getOwnPropertyDescriptor($e.prototype,"setRemoteDefaultVideoStreamType"),$e.prototype),it($e.prototype,"setRemoteVideoStreamType",[i8],Object.getOwnPropertyDescriptor($e.prototype,"setRemoteVideoStreamType"),$e.prototype),it($e.prototype,"setStreamFallbackOption",[s8],Object.getOwnPropertyDescriptor($e.prototype,"setStreamFallbackOption"),$e.prototype),it($e.prototype,"setEncryptionConfig",[o8],Object.getOwnPropertyDescriptor($e.prototype,"setEncryptionConfig"),$e.prototype),it($e.prototype,"renewToken",[a8],Object.getOwnPropertyDescriptor($e.prototype,"renewToken"),$e.prototype),it($e.prototype,"enableAudioVolumeIndicator",[c8],Object.getOwnPropertyDescriptor($e.prototype,"enableAudioVolumeIndicator"),$e.prototype),it($e.prototype,"startLiveStreaming",[l8],Object.getOwnPropertyDescriptor($e.prototype,"startLiveStreaming"),$e.prototype),it($e.prototype,"setLiveTranscoding",[d8],Object.getOwnPropertyDescriptor($e.prototype,"setLiveTranscoding"),$e.prototype),it($e.prototype,"stopLiveStreaming",[u8],Object.getOwnPropertyDescriptor($e.prototype,"stopLiveStreaming"),$e.prototype),it($e.prototype,"startChannelMediaRelay",[h8],Object.getOwnPropertyDescriptor($e.prototype,"startChannelMediaRelay"),$e.prototype),it($e.prototype,"updateChannelMediaRelay",[p8],Object.getOwnPropertyDescriptor($e.prototype,"updateChannelMediaRelay"),$e.prototype),it($e.prototype,"stopChannelMediaRelay",[f8],Object.getOwnPropertyDescriptor($e.prototype,"stopChannelMediaRelay"),$e.prototype),it($e.prototype,"sendCustomReportMessage",[m8],Object.getOwnPropertyDescriptor($e.prototype,"sendCustomReportMessage"),$e.prototype),it($e.prototype,"pickSVCLayer",[g8],Object.getOwnPropertyDescriptor($e.prototype,"pickSVCLayer"),$e.prototype),it($e.prototype,"setRTMConfig",[_8],Object.getOwnPropertyDescriptor($e.prototype,"setRTMConfig"),$e.prototype),it($e.prototype,"enableContentInspect",[E8],Object.getOwnPropertyDescriptor($e.prototype,"enableContentInspect"),$e.prototype),it($e.prototype,"disableContentInspect",[v8],Object.getOwnPropertyDescriptor($e.prototype,"disableContentInspect"),$e.prototype),it($e.prototype,"setImageModeration",[y8],Object.getOwnPropertyDescriptor($e.prototype,"setImageModeration"),$e.prototype),it($e.prototype,"setP2PTransport",[S8],Object.getOwnPropertyDescriptor($e.prototype,"setP2PTransport"),$e.prototype),it($e.prototype,"getJoinChannelServiceRecords",[x8],Object.getOwnPropertyDescriptor($e.prototype,"getJoinChannelServiceRecords"),$e.prototype),it($e.prototype,"setPublishAudioFilterEnabled",[T8],Object.getOwnPropertyDescriptor($e.prototype,"setPublishAudioFilterEnabled"),$e.prototype),$e);class Ig{constructor(t,r){z(this,"id",0),z(this,"element",void 0),z(this,"peerPair",void 0),z(this,"context",void 0),z(this,"audioPlayerElement",void 0),z(this,"audioTrack",void 0),Ig.count+=1,this.id=Ig.count,this.element=t,this.context=r}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=t=>{const r=document.createElement("audio");r.srcObject=new MediaStream([t.track]),r.play(),this.audioPlayerElement=r}}async switchSdp(){if(!this.peerPair)return;const t=async(s,a)=>{const l=a==="offer"?await s.createOffer():await s.createAnswer();return await s.setLocalDescription(l),s.iceGatheringState==="complete"?s.localDescription:new Ye(u=>{s.onicegatheringstatechange=()=>{s.iceGatheringState==="complete"&&u(s.localDescription)}})},r=async(s,a)=>await s.setRemoteDescription(a);try{const s=await t(this.peerPair[0],"offer");await r(this.peerPair[1],s);const a=await t(this.peerPair[1],"answer");await r(this.peerPair[0],a)}catch(s){throw new me($.LOCAL_AEC_ERROR,s.toString()).print()}}async getTracksFromMediaElement(t){if(this.audioTrack)return this.audioTrack;let r;try{t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),r=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(t).connect(r)}catch(a){throw new me($.LOCAL_AEC_ERROR,a.toString()).print()}if(!r)throw new me($.LOCAL_AEC_ERROR,"no dest node when local aec").print();const s=r.stream.getAudioTracks()[0];return this.audioTrack=s,s}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const t=this.element,r=await this.getTracksFromMediaElement(t);this.peerPair&&this.peerPair[0].addTrack(r),await this.switchSdp()}close(){O.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(t=>{t.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var w8,xS;z(Ig,"count",0);const Ehe=window.AudioContext||window.webkitAudioContext,vhe=new(w8=_t({report:st}),it((xS=class{constructor(){z(this,"units",[]),z(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return O.debug("the system does not need to process local aec"),-1;this.context||(this.context=new Ehe);let t=this.units.find(r=>r&&r.getElement()===e);return t||(t=new Ig(e,this.context),this.units.push(t)),t.startEchoCancellation(),O.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return en().name!==cn.SAFARI}}).prototype,"processExternalMediaAEC",[w8],Object.getOwnPropertyDescriptor(xS.prototype,"processExternalMediaAEC"),xS.prototype),xS);function C8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function R8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C8(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C8(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const G1=window||document;function A8(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!G1)return;const r=Ar._cspEventHandlerPointer;if(r&&t)return void console.error(r,t);const s=a=>{if(!(a&&a.blockedURI&&(Ar.onSecurityPolicyViolation||Ar.getListeners(Qc.SECURITY_POLICY_VIOLATION).length>0)))return;const l=a.blockedURI;Z("CSP_DETECTED_HOSTNAME_LIST").some(u=>je(l).call(l,u))&&(Ar.onSecurityPolicyViolation&&typeof Ar.onSecurityPolicyViolation=="function"&&Ar.onSecurityPolicyViolation(a),Ar.getListeners(Qc.SECURITY_POLICY_VIOLATION).length>0&&Ar.safeEmit(Qc.SECURITY_POLICY_VIOLATION,a))};r&&G1.removeEventListener("securitypolicyviolation",r),(t||e&&typeof e=="function"||Ar.getListeners(Qc.SECURITY_POLICY_VIOLATION).length>0)&&G1.addEventListener("securitypolicyviolation",s),Ar._cspEventHandlerPointer=s}var yhe=I,She=uF,N8=RegExp.prototype,xhe=function(e){return e===N8||yhe(N8,e)?She(e):e.flags},Yi=d(xhe);function Hf(e){let t=e.length;for(;--t>=0;)e[t]=0}const z1=256,I8=286,Og=30,Dg=15,K1=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),TS=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),The=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),O8=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bl=new Array(576);Hf(Bl);const Pg=new Array(60);Hf(Pg);const kg=new Array(512);Hf(kg);const Lg=new Array(256);Hf(Lg);const q1=new Array(29);Hf(q1);const bS=new Array(Og);function Y1(e,t,r,s,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=s,this.max_length=a,this.has_stree=e&&e.length}let D8,P8,k8;function $1(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Hf(bS);const L8=e=>e<256?kg[e]:kg[256+(e>>>7)],Mg=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},wo=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,Mg(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},rl=(e,t,r)=>{wo(e,r[2*t],r[2*t+1])},M8=(e,t)=>{let r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1},j8=(e,t,r)=>{const s=new Array(16);let a,l,u=0;for(a=1;a<=Dg;a++)u=u+r[a-1]<<1,s[a]=u;for(l=0;l<=t;l++){let p=e[2*l+1];p!==0&&(e[2*l]=M8(s[p]++,p))}},U8=e=>{let t;for(t=0;t<I8;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Og;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},F8=e=>{e.bi_valid>8?Mg(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},V8=(e,t,r,s)=>{const a=2*t,l=2*r;return e[a]<e[l]||e[a]===e[l]&&s[t]<=s[r]},X1=(e,t,r)=>{const s=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&V8(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!V8(t,s,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=s},B8=(e,t,r)=>{let s,a,l,u,p=0;if(e.sym_next!==0)do s=255&e.pending_buf[e.sym_buf+p++],s+=(255&e.pending_buf[e.sym_buf+p++])<<8,a=e.pending_buf[e.sym_buf+p++],s===0?rl(e,a,t):(l=Lg[a],rl(e,l+z1+1,t),u=K1[l],u!==0&&(a-=q1[l],wo(e,a,u)),s--,l=L8(s),rl(e,l,r),u=TS[l],u!==0&&(s-=bS[l],wo(e,s,u)));while(p<e.sym_next);rl(e,256,t)},J1=(e,t)=>{const r=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems;let u,p,m,g=-1;for(e.heap_len=0,e.heap_max=573,u=0;u<l;u++)r[2*u]!==0?(e.heap[++e.heap_len]=g=u,e.depth[u]=0):r[2*u+1]=0;for(;e.heap_len<2;)m=e.heap[++e.heap_len]=g<2?++g:0,r[2*m]=1,e.depth[m]=0,e.opt_len--,a&&(e.static_len-=s[2*m+1]);for(t.max_code=g,u=e.heap_len>>1;u>=1;u--)X1(e,r,u);m=l;do u=e.heap[1],e.heap[1]=e.heap[e.heap_len--],X1(e,r,1),p=e.heap[1],e.heap[--e.heap_max]=u,e.heap[--e.heap_max]=p,r[2*m]=r[2*u]+r[2*p],e.depth[m]=(e.depth[u]>=e.depth[p]?e.depth[u]:e.depth[p])+1,r[2*u+1]=r[2*p+1]=m,e.heap[1]=m++,X1(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((E,y)=>{const b=y.dyn_tree,C=y.max_code,B=y.stat_desc.static_tree,M=y.stat_desc.has_stree,F=y.stat_desc.extra_bits,q=y.stat_desc.extra_base,Y=y.stat_desc.max_length;let re,ce,le,ae,_e,we,Be=0;for(ae=0;ae<=Dg;ae++)E.bl_count[ae]=0;for(b[2*E.heap[E.heap_max]+1]=0,re=E.heap_max+1;re<573;re++)ce=E.heap[re],ae=b[2*b[2*ce+1]+1]+1,ae>Y&&(ae=Y,Be++),b[2*ce+1]=ae,ce>C||(E.bl_count[ae]++,_e=0,ce>=q&&(_e=F[ce-q]),we=b[2*ce],E.opt_len+=we*(ae+_e),M&&(E.static_len+=we*(B[2*ce+1]+_e)));if(Be!==0){do{for(ae=Y-1;E.bl_count[ae]===0;)ae--;E.bl_count[ae]--,E.bl_count[ae+1]+=2,E.bl_count[Y]--,Be-=2}while(Be>0);for(ae=Y;ae!==0;ae--)for(ce=E.bl_count[ae];ce!==0;)le=E.heap[--re],le>C||(b[2*le+1]!==ae&&(E.opt_len+=(ae-b[2*le+1])*b[2*le],b[2*le+1]=ae),ce--)}})(e,t),j8(r,g,e.bl_count)},W8=(e,t,r)=>{let s,a,l=-1,u=t[1],p=0,m=7,g=4;for(u===0&&(m=138,g=3),t[2*(r+1)+1]=65535,s=0;s<=r;s++)a=u,u=t[2*(s+1)+1],++p<m&&a===u||(p<g?e.bl_tree[2*a]+=p:a!==0?(a!==l&&e.bl_tree[2*a]++,e.bl_tree[32]++):p<=10?e.bl_tree[34]++:e.bl_tree[36]++,p=0,l=a,u===0?(m=138,g=3):a===u?(m=6,g=3):(m=7,g=4))},H8=(e,t,r)=>{let s,a,l=-1,u=t[1],p=0,m=7,g=4;for(u===0&&(m=138,g=3),s=0;s<=r;s++)if(a=u,u=t[2*(s+1)+1],!(++p<m&&a===u)){if(p<g)do rl(e,a,e.bl_tree);while(--p!=0);else a!==0?(a!==l&&(rl(e,a,e.bl_tree),p--),rl(e,16,e.bl_tree),wo(e,p-3,2)):p<=10?(rl(e,17,e.bl_tree),wo(e,p-3,3)):(rl(e,18,e.bl_tree),wo(e,p-11,7));p=0,l=a,u===0?(m=138,g=3):a===u?(m=6,g=3):(m=7,g=4)}};let G8=!1;const z8=(e,t,r,s)=>{wo(e,0+(s?1:0),3),F8(e),Mg(e,r),Mg(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var bhe=e=>{G8||((()=>{let t,r,s,a,l;const u=new Array(16);for(s=0,a=0;a<28;a++)for(q1[a]=s,t=0;t<1<<K1[a];t++)Lg[s++]=a;for(Lg[s-1]=a,l=0,a=0;a<16;a++)for(bS[a]=l,t=0;t<1<<TS[a];t++)kg[l++]=a;for(l>>=7;a<Og;a++)for(bS[a]=l<<7,t=0;t<1<<TS[a]-7;t++)kg[256+l++]=a;for(r=0;r<=Dg;r++)u[r]=0;for(t=0;t<=143;)Bl[2*t+1]=8,t++,u[8]++;for(;t<=255;)Bl[2*t+1]=9,t++,u[9]++;for(;t<=279;)Bl[2*t+1]=7,t++,u[7]++;for(;t<=287;)Bl[2*t+1]=8,t++,u[8]++;for(j8(Bl,287,u),t=0;t<Og;t++)Pg[2*t+1]=5,Pg[2*t]=M8(t,5);D8=new Y1(Bl,K1,257,I8,Dg),P8=new Y1(Pg,TS,0,Og,Dg),k8=new Y1(new Array(0),The,0,19,7)})(),G8=!0),e.l_desc=new $1(e.dyn_ltree,D8),e.d_desc=new $1(e.dyn_dtree,P8),e.bl_desc=new $1(e.bl_tree,k8),e.bi_buf=0,e.bi_valid=0,U8(e)},whe=(e,t,r,s)=>{let a,l,u=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=(p=>{let m,g=4093624447;for(m=0;m<=31;m++,g>>>=1)if(1&g&&p.dyn_ltree[2*m]!==0)return 0;if(p.dyn_ltree[18]!==0||p.dyn_ltree[20]!==0||p.dyn_ltree[26]!==0)return 1;for(m=32;m<z1;m++)if(p.dyn_ltree[2*m]!==0)return 1;return 0})(e)),J1(e,e.l_desc),J1(e,e.d_desc),u=(p=>{let m;for(W8(p,p.dyn_ltree,p.l_desc.max_code),W8(p,p.dyn_dtree,p.d_desc.max_code),J1(p,p.bl_desc),m=18;m>=3&&p.bl_tree[2*O8[m]+1]===0;m--);return p.opt_len+=3*(m+1)+5+5+4,m})(e),a=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=a&&(a=l)):a=l=r+5,r+4<=a&&t!==-1?z8(e,t,r,s):e.strategy===4||l===a?(wo(e,2+(s?1:0),3),B8(e,Bl,Pg)):(wo(e,4+(s?1:0),3),((p,m,g,E)=>{let y;for(wo(p,m-257,5),wo(p,g-1,5),wo(p,E-4,4),y=0;y<E;y++)wo(p,p.bl_tree[2*O8[y]+1],3);H8(p,p.dyn_ltree,m-1),H8(p,p.dyn_dtree,g-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,u+1),B8(e,e.dyn_ltree,e.dyn_dtree)),U8(e),s&&F8(e)},Che=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(Lg[r]+z1+1)]++,e.dyn_dtree[2*L8(t)]++),e.sym_next===e.sym_end),Rhe=e=>{wo(e,2,3),rl(e,256,Bl),(t=>{t.bi_valid===16?(Mg(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(e)},Ahe={_tr_init:bhe,_tr_stored_block:z8,_tr_flush_block:whe,_tr_tally:Che,_tr_align:Rhe},jg=(e,t,r,s)=>{let a=65535&e|0,l=e>>>16&65535|0,u=0;for(;r!==0;){u=r>2e3?2e3:r,r-=u;do a=a+t[s++]|0,l=l+a|0;while(--u);a%=65521,l%=65521}return a|l<<16|0};const Nhe=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var ds=(e,t,r,s)=>{const a=Nhe,l=s+r;e^=-1;for(let u=s;u<l;u++)e=e>>>8^a[255&(e^t[u])];return-1^e},Ch={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Gf={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ihe,_tr_stored_block:Q1,_tr_flush_block:Ohe,_tr_tally:Gd,_tr_align:Dhe}=Ahe,{Z_NO_FLUSH:zd,Z_PARTIAL_FLUSH:Phe,Z_FULL_FLUSH:khe,Z_FINISH:Pa,Z_BLOCK:K8,Z_OK:Ss,Z_STREAM_END:q8,Z_STREAM_ERROR:il,Z_DATA_ERROR:Lhe,Z_BUF_ERROR:Z1,Z_DEFAULT_COMPRESSION:Mhe,Z_FILTERED:jhe,Z_HUFFMAN_ONLY:wS,Z_RLE:Uhe,Z_FIXED:Fhe,Z_DEFAULT_STRATEGY:Vhe,Z_UNKNOWN:Bhe,Z_DEFLATED:CS}=Gf,eN=286,Whe=30,Hhe=19,Ghe=2*eN+1,zhe=15,Rh=258,sl=262,zf=42,Ah=113,Ug=666,Nh=(e,t)=>(e.msg=Ch[t],t),Y8=e=>2*e-(e>4?9:0),Kd=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Khe=e=>{let t,r,s,a=e.w_size;t=e.hash_size,s=t;do r=e.head[--s],e.head[s]=r>=a?r-a:0;while(--t);t=a,s=t;do r=e.prev[--s],e.prev[s]=r>=a?r-a:0;while(--t)};let qd=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const $o=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Xo=(e,t)=>{Ohe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,$o(e.strm)},fr=(e,t)=>{e.pending_buf[e.pending++]=t},Fg=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},tN=(e,t,r,s)=>{let a=e.avail_in;return a>s&&(a=s),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),e.state.wrap===1?e.adler=jg(e.adler,t,a,r):e.state.wrap===2&&(e.adler=ds(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},$8=(e,t)=>{let r,s,a=e.max_chain_length,l=e.strstart,u=e.prev_length,p=e.nice_match;const m=e.strstart>e.w_size-sl?e.strstart-(e.w_size-sl):0,g=e.window,E=e.w_mask,y=e.prev,b=e.strstart+Rh;let C=g[l+u-1],B=g[l+u];e.prev_length>=e.good_match&&(a>>=2),p>e.lookahead&&(p=e.lookahead);do if(r=t,g[r+u]===B&&g[r+u-1]===C&&g[r]===g[l]&&g[++r]===g[l+1]){l+=2,r++;do;while(g[++l]===g[++r]&&g[++l]===g[++r]&&g[++l]===g[++r]&&g[++l]===g[++r]&&g[++l]===g[++r]&&g[++l]===g[++r]&&g[++l]===g[++r]&&g[++l]===g[++r]&&l<b);if(s=Rh-(b-l),l=b-Rh,s>u){if(e.match_start=t,u=s,s>=p)break;C=g[l+u-1],B=g[l+u]}}while((t=y[t&E])>m&&--a!=0);return u<=e.lookahead?u:e.lookahead},Kf=e=>{const t=e.w_size;let r,s,a;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-sl)&&(e.window.set(e.window.subarray(t,t+t-s),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Khe(e),s+=t),e.strm.avail_in===0)break;if(r=tN(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=r,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=qd(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=qd(e,e.ins_h,e.window[a+3-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<sl&&e.strm.avail_in!==0)},X8=(e,t)=>{let r,s,a,l=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,u=0,p=e.strm.avail_in;do{if(r=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,s=e.strstart-e.block_start,r>s+e.strm.avail_in&&(r=s+e.strm.avail_in),r>a&&(r=a),r<l&&(r===0&&t!==Pa||t===zd||r!==s+e.strm.avail_in)))break;u=t===Pa&&r===s+e.strm.avail_in?1:0,Q1(e,0,0,u),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,$o(e.strm),s&&(s>r&&(s=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,r-=s),r&&(tN(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(u===0);return p-=e.strm.avail_in,p&&(p>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=p&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-p,e.strm.next_in),e.strstart),e.strstart+=p,e.insert+=p>e.w_size-e.insert?e.w_size-e.insert:p),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),u?4:t!==zd&&t!==Pa&&e.strm.avail_in===0&&e.strstart===e.block_start?2:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(tN(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,l=a>e.w_size?e.w_size:a,s=e.strstart-e.block_start,(s>=l||(s||t===Pa)&&t!==zd&&e.strm.avail_in===0&&s<=a)&&(r=s>a?a:s,u=t===Pa&&e.strm.avail_in===0&&r===s?1:0,Q1(e,e.block_start,r,u),e.block_start+=r,$o(e.strm)),u?3:1)},nN=(e,t)=>{let r,s;for(;;){if(e.lookahead<sl){if(Kf(e),e.lookahead<sl&&t===zd)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=qd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-sl&&(e.match_length=$8(e,r)),e.match_length>=3)if(s=Gd(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=qd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=qd(e,e.ins_h,e.window[e.strstart+1]);else s=Gd(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(Xo(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Pa?(Xo(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(Xo(e,!1),e.strm.avail_out===0)?1:2},qf=(e,t)=>{let r,s,a;for(;;){if(e.lookahead<sl){if(Kf(e),e.lookahead<sl&&t===zd)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=qd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-sl&&(e.match_length=$8(e,r),e.match_length<=5&&(e.strategy===jhe||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,s=Gd(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=qd(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,s&&(Xo(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if(s=Gd(e,0,e.window[e.strstart-1]),s&&Xo(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=Gd(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Pa?(Xo(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(Xo(e,!1),e.strm.avail_out===0)?1:2};function ol(e,t,r,s,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=s,this.func=a}const Vg=[new ol(0,0,0,0,X8),new ol(4,4,8,4,nN),new ol(4,5,16,8,nN),new ol(4,6,32,32,nN),new ol(4,4,16,16,qf),new ol(8,16,32,32,qf),new ol(8,16,128,128,qf),new ol(8,32,128,256,qf),new ol(32,128,258,1024,qf),new ol(32,258,258,4096,qf)];function qhe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=CS,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Ghe),this.dyn_dtree=new Uint16Array(2*(2*Whe+1)),this.bl_tree=new Uint16Array(2*(2*Hhe+1)),Kd(this.dyn_ltree),Kd(this.dyn_dtree),Kd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(zhe+1),this.heap=new Uint16Array(2*eN+1),Kd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*eN+1),Kd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Bg=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==zf&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==Ah&&t.status!==Ug?1:0},J8=e=>{if(Bg(e))return Nh(e,il);e.total_in=e.total_out=0,e.data_type=Bhe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?zf:Ah,e.adler=t.wrap===2?0:1,t.last_flush=-2,Ihe(t),Ss},Q8=e=>{const t=J8(e);return t===Ss&&(r=>{r.window_size=2*r.w_size,Kd(r.head),r.max_lazy_match=Vg[r.level].max_lazy,r.good_match=Vg[r.level].good_length,r.nice_match=Vg[r.level].nice_length,r.max_chain_length=Vg[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0})(e.state),t},Z8=(e,t,r,s,a,l)=>{if(!e)return il;let u=1;if(t===Mhe&&(t=6),s<0?(u=0,s=-s):s>15&&(u=2,s-=16),a<1||a>9||r!==CS||s<8||s>15||t<0||t>9||l<0||l>Fhe||s===8&&u!==1)return Nh(e,il);s===8&&(s=9);const p=new qhe;return e.state=p,p.strm=e,p.status=zf,p.wrap=u,p.gzhead=null,p.w_bits=s,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=a+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+3-1)/3),p.window=new Uint8Array(2*p.w_size),p.head=new Uint16Array(p.hash_size),p.prev=new Uint16Array(p.w_size),p.lit_bufsize=1<<a+6,p.pending_buf_size=4*p.lit_bufsize,p.pending_buf=new Uint8Array(p.pending_buf_size),p.sym_buf=p.lit_bufsize,p.sym_end=3*(p.lit_bufsize-1),p.level=t,p.strategy=l,p.method=r,Q8(e)};var Yhe=(e,t)=>{if(Bg(e)||t>K8||t<0)return e?Nh(e,il):il;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===Ug&&t!==Pa)return Nh(e,e.avail_out===0?Z1:il);const s=r.last_flush;if(r.last_flush=t,r.pending!==0){if($o(e),e.avail_out===0)return r.last_flush=-1,Ss}else if(e.avail_in===0&&Y8(t)<=Y8(s)&&t!==Pa)return Nh(e,Z1);if(r.status===Ug&&e.avail_in!==0)return Nh(e,Z1);if(r.status===zf&&r.wrap===0&&(r.status=Ah),r.status===zf){let a=CS+(r.w_bits-8<<4)<<8,l=-1;if(l=r.strategy>=wS||r.level<2?0:r.level<6?1:r.level===6?2:3,a|=l<<6,r.strstart!==0&&(a|=32),a+=31-a%31,Fg(r,a),r.strstart!==0&&(Fg(r,e.adler>>>16),Fg(r,65535&e.adler)),e.adler=1,r.status=Ah,$o(e),r.pending!==0)return r.last_flush=-1,Ss}if(r.status===57){if(e.adler=0,fr(r,31),fr(r,139),fr(r,8),r.gzhead)fr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),fr(r,255&r.gzhead.time),fr(r,r.gzhead.time>>8&255),fr(r,r.gzhead.time>>16&255),fr(r,r.gzhead.time>>24&255),fr(r,r.level===9?2:r.strategy>=wS||r.level<2?4:0),fr(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(fr(r,255&r.gzhead.extra.length),fr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=ds(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(fr(r,0),fr(r,0),fr(r,0),fr(r,0),fr(r,0),fr(r,r.level===9?2:r.strategy>=wS||r.level<2?4:0),fr(r,3),r.status=Ah,$o(e),r.pending!==0)return r.last_flush=-1,Ss}if(r.status===69){if(r.gzhead.extra){let a=r.pending,l=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+l>r.pending_buf_size;){let p=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+p),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(e.adler=ds(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=p,$o(e),r.pending!==0)return r.last_flush=-1,Ss;a=0,l-=p}let u=new Uint8Array(r.gzhead.extra);r.pending_buf.set(u.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending+=l,r.gzhead.hcrc&&r.pending>a&&(e.adler=ds(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=73}if(r.status===73){if(r.gzhead.name){let a,l=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>l&&(e.adler=ds(e.adler,r.pending_buf,r.pending-l,l)),$o(e),r.pending!==0)return r.last_flush=-1,Ss;l=0}a=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,fr(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>l&&(e.adler=ds(e.adler,r.pending_buf,r.pending-l,l)),r.gzindex=0}r.status=91}if(r.status===91){if(r.gzhead.comment){let a,l=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>l&&(e.adler=ds(e.adler,r.pending_buf,r.pending-l,l)),$o(e),r.pending!==0)return r.last_flush=-1,Ss;l=0}a=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,fr(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>l&&(e.adler=ds(e.adler,r.pending_buf,r.pending-l,l))}r.status=103}if(r.status===103){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&($o(e),r.pending!==0))return r.last_flush=-1,Ss;fr(r,255&e.adler),fr(r,e.adler>>8&255),e.adler=0}if(r.status=Ah,$o(e),r.pending!==0)return r.last_flush=-1,Ss}if(e.avail_in!==0||r.lookahead!==0||t!==zd&&r.status!==Ug){let a=r.level===0?X8(r,t):r.strategy===wS?((l,u)=>{let p;for(;;){if(l.lookahead===0&&(Kf(l),l.lookahead===0)){if(u===zd)return 1;break}if(l.match_length=0,p=Gd(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++,p&&(Xo(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,u===Pa?(Xo(l,!0),l.strm.avail_out===0?3:4):l.sym_next&&(Xo(l,!1),l.strm.avail_out===0)?1:2})(r,t):r.strategy===Uhe?((l,u)=>{let p,m,g,E;const y=l.window;for(;;){if(l.lookahead<=Rh){if(Kf(l),l.lookahead<=Rh&&u===zd)return 1;if(l.lookahead===0)break}if(l.match_length=0,l.lookahead>=3&&l.strstart>0&&(g=l.strstart-1,m=y[g],m===y[++g]&&m===y[++g]&&m===y[++g])){E=l.strstart+Rh;do;while(m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&m===y[++g]&&g<E);l.match_length=Rh-(E-g),l.match_length>l.lookahead&&(l.match_length=l.lookahead)}if(l.match_length>=3?(p=Gd(l,1,l.match_length-3),l.lookahead-=l.match_length,l.strstart+=l.match_length,l.match_length=0):(p=Gd(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++),p&&(Xo(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,u===Pa?(Xo(l,!0),l.strm.avail_out===0?3:4):l.sym_next&&(Xo(l,!1),l.strm.avail_out===0)?1:2})(r,t):Vg[r.level].func(r,t);if(a!==3&&a!==4||(r.status=Ug),a===1||a===3)return e.avail_out===0&&(r.last_flush=-1),Ss;if(a===2&&(t===Phe?Dhe(r):t!==K8&&(Q1(r,0,0,!1),t===khe&&(Kd(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),$o(e),e.avail_out===0))return r.last_flush=-1,Ss}return t!==Pa?Ss:r.wrap<=0?q8:(r.wrap===2?(fr(r,255&e.adler),fr(r,e.adler>>8&255),fr(r,e.adler>>16&255),fr(r,e.adler>>24&255),fr(r,255&e.total_in),fr(r,e.total_in>>8&255),fr(r,e.total_in>>16&255),fr(r,e.total_in>>24&255)):(Fg(r,e.adler>>>16),Fg(r,65535&e.adler)),$o(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Ss:q8)},$he=(e,t)=>{let r=t.length;if(Bg(e))return il;const s=e.state,a=s.wrap;if(a===2||a===1&&s.status!==zf||s.lookahead)return il;if(a===1&&(e.adler=jg(e.adler,t,r,0)),s.wrap=0,r>=s.w_size){a===0&&(Kd(s.head),s.strstart=0,s.block_start=0,s.insert=0);let m=new Uint8Array(s.w_size);m.set(t.subarray(r-s.w_size,r),0),t=m,r=s.w_size}const l=e.avail_in,u=e.next_in,p=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Kf(s);s.lookahead>=3;){let m=s.strstart,g=s.lookahead-2;do s.ins_h=qd(s,s.ins_h,s.window[m+3-1]),s.prev[m&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=m,m++;while(--g);s.strstart=m,s.lookahead=2,Kf(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,e.next_in=u,e.input=p,e.avail_in=l,s.wrap=a,Ss},Wg={deflateInit:(e,t)=>Z8(e,t,CS,15,8,Vhe),deflateInit2:Z8,deflateReset:Q8,deflateResetKeep:J8,deflateSetHeader:(e,t)=>Bg(e)||e.state.wrap!==2?il:(e.state.gzhead=t,Ss),deflate:Yhe,deflateEnd:e=>{if(Bg(e))return il;const t=e.state.status;return e.state=null,t===Ah?Nh(e,Lhe):Ss},deflateSetDictionary:$he,deflateInfo:"pako deflate (from Nodeca project)"};const Xhe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var RS={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const s in r)Xhe(r,s)&&(e[s]=r[s])}}return e},flattenChunks:e=>{let t=0;for(let s=0,a=e.length;s<a;s++)t+=e[s].length;const r=new Uint8Array(t);for(let s=0,a=0,l=e.length;s<l;s++){let u=e[s];r.set(u,a),a+=u.length}return r}};let e9=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e9=!1}const Hg=new Uint8Array(256);for(let e=0;e<256;e++)Hg[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Hg[254]=Hg[254]=1;var Gg={string2buf:e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,s,a,l,u=e.length,p=0;for(a=0;a<u;a++)r=e.charCodeAt(a),(64512&r)==55296&&a+1<u&&(s=e.charCodeAt(a+1),(64512&s)==56320&&(r=65536+(r-55296<<10)+(s-56320),a++)),p+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(p),l=0,a=0;l<p;a++)r=e.charCodeAt(a),(64512&r)==55296&&a+1<u&&(s=e.charCodeAt(a+1),(64512&s)==56320&&(r=65536+(r-55296<<10)+(s-56320),a++)),r<128?t[l++]=r:r<2048?(t[l++]=192|r>>>6,t[l++]=128|63&r):r<65536?(t[l++]=224|r>>>12,t[l++]=128|r>>>6&63,t[l++]=128|63&r):(t[l++]=240|r>>>18,t[l++]=128|r>>>12&63,t[l++]=128|r>>>6&63,t[l++]=128|63&r);return t},buf2string:(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let s,a;const l=new Array(2*r);for(a=0,s=0;s<r;){let u=e[s++];if(u<128){l[a++]=u;continue}let p=Hg[u];if(p>4)l[a++]=65533,s+=p-1;else{for(u&=p===2?31:p===3?15:7;p>1&&s<r;)u=u<<6|63&e[s++],p--;p>1?l[a++]=65533:u<65536?l[a++]=u:(u-=65536,l[a++]=55296|u>>10&1023,l[a++]=56320|1023&u)}}return((u,p)=>{if(p<65534&&u.subarray&&e9)return String.fromCharCode.apply(null,u.length===p?u:u.subarray(0,p));let m="";for(let g=0;g<p;g++)m+=String.fromCharCode(u[g]);return m})(l,a)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(192&e[r])==128;)r--;return r<0||r===0?t:r+Hg[e[r]]>t?r:t}},t9=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const n9=Object.prototype.toString,{Z_NO_FLUSH:Jhe,Z_SYNC_FLUSH:Qhe,Z_FULL_FLUSH:Zhe,Z_FINISH:epe,Z_OK:AS,Z_STREAM_END:tpe,Z_DEFAULT_COMPRESSION:npe,Z_DEFAULT_STRATEGY:rpe,Z_DEFLATED:ipe}=Gf;function zg(e){this.options=RS.assign({level:npe,method:ipe,chunkSize:16384,windowBits:15,memLevel:8,strategy:rpe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new t9,this.strm.avail_out=0;let r=Wg.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==AS)throw new Error(Ch[r]);if(t.header&&Wg.deflateSetHeader(this.strm,t.header),t.dictionary){let s;if(s=typeof t.dictionary=="string"?Gg.string2buf(t.dictionary):n9.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,r=Wg.deflateSetDictionary(this.strm,s),r!==AS)throw new Error(Ch[r]);this._dict_set=!0}}function rN(e,t){const r=new zg(t);if(r.push(e,!0),r.err)throw r.msg||Ch[r.err];return r.result}zg.prototype.push=function(e,t){const r=this.strm,s=this.options.chunkSize;let a,l;if(this.ended)return!1;for(l=t===~~t?t:t===!0?epe:Jhe,typeof e=="string"?r.input=Gg.string2buf(e):n9.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(r.avail_out===0&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(l===Qhe||l===Zhe)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(a=Wg.deflate(r,l),a===tpe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=Wg.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===AS;if(r.avail_out!==0){if(l>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(r.avail_in===0)break}else this.onData(r.output)}return!0},zg.prototype.onData=function(e){this.chunks.push(e)},zg.prototype.onEnd=function(e){e===AS&&(this.result=RS.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var spe={Deflate:zg,deflate:rN,deflateRaw:function(e,t){return(t=t||{}).raw=!0,rN(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,rN(e,t)},constants:Gf};const NS=16209;var ope=function(e,t){let r,s,a,l,u,p,m,g,E,y,b,C,B,M,F,q,Y,re,ce,le,ae,_e,we,Be;const Xe=e.state;r=e.next_in,we=e.input,s=r+(e.avail_in-5),a=e.next_out,Be=e.output,l=a-(t-e.avail_out),u=a+(e.avail_out-257),p=Xe.dmax,m=Xe.wsize,g=Xe.whave,E=Xe.wnext,y=Xe.window,b=Xe.hold,C=Xe.bits,B=Xe.lencode,M=Xe.distcode,F=(1<<Xe.lenbits)-1,q=(1<<Xe.distbits)-1;e:do{C<15&&(b+=we[r++]<<C,C+=8,b+=we[r++]<<C,C+=8),Y=B[b&F];t:for(;;){if(re=Y>>>24,b>>>=re,C-=re,re=Y>>>16&255,re===0)Be[a++]=65535&Y;else{if(!(16&re)){if(!(64&re)){Y=B[(65535&Y)+(b&(1<<re)-1)];continue t}if(32&re){Xe.mode=16191;break e}e.msg="invalid literal/length code",Xe.mode=NS;break e}ce=65535&Y,re&=15,re&&(C<re&&(b+=we[r++]<<C,C+=8),ce+=b&(1<<re)-1,b>>>=re,C-=re),C<15&&(b+=we[r++]<<C,C+=8,b+=we[r++]<<C,C+=8),Y=M[b&q];n:for(;;){if(re=Y>>>24,b>>>=re,C-=re,re=Y>>>16&255,!(16&re)){if(!(64&re)){Y=M[(65535&Y)+(b&(1<<re)-1)];continue n}e.msg="invalid distance code",Xe.mode=NS;break e}if(le=65535&Y,re&=15,C<re&&(b+=we[r++]<<C,C+=8,C<re&&(b+=we[r++]<<C,C+=8)),le+=b&(1<<re)-1,le>p){e.msg="invalid distance too far back",Xe.mode=NS;break e}if(b>>>=re,C-=re,re=a-l,le>re){if(re=le-re,re>g&&Xe.sane){e.msg="invalid distance too far back",Xe.mode=NS;break e}if(ae=0,_e=y,E===0){if(ae+=m-re,re<ce){ce-=re;do Be[a++]=y[ae++];while(--re);ae=a-le,_e=Be}}else if(E<re){if(ae+=m+E-re,re-=E,re<ce){ce-=re;do Be[a++]=y[ae++];while(--re);if(ae=0,E<ce){re=E,ce-=re;do Be[a++]=y[ae++];while(--re);ae=a-le,_e=Be}}}else if(ae+=E-re,re<ce){ce-=re;do Be[a++]=y[ae++];while(--re);ae=a-le,_e=Be}for(;ce>2;)Be[a++]=_e[ae++],Be[a++]=_e[ae++],Be[a++]=_e[ae++],ce-=3;ce&&(Be[a++]=_e[ae++],ce>1&&(Be[a++]=_e[ae++]))}else{ae=a-le;do Be[a++]=Be[ae++],Be[a++]=Be[ae++],Be[a++]=Be[ae++],ce-=3;while(ce>2);ce&&(Be[a++]=Be[ae++],ce>1&&(Be[a++]=Be[ae++]))}break}}break}}while(r<s&&a<u);ce=C>>3,r-=ce,C-=ce<<3,b&=(1<<C)-1,e.next_in=r,e.next_out=a,e.avail_in=r<s?s-r+5:5-(r-s),e.avail_out=a<u?u-a+257:257-(a-u),Xe.hold=b,Xe.bits=C};const IS=15,ape=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),cpe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lpe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dpe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Kg=(e,t,r,s,a,l,u,p)=>{const m=p.bits;let g,E,y,b,C,B,M=0,F=0,q=0,Y=0,re=0,ce=0,le=0,ae=0,_e=0,we=0,Be=null;const Xe=new Uint16Array(16),jt=new Uint16Array(16);let kt,Tt,jn,bn=null;for(M=0;M<=IS;M++)Xe[M]=0;for(F=0;F<s;F++)Xe[t[r+F]]++;for(re=m,Y=IS;Y>=1&&Xe[Y]===0;Y--);if(re>Y&&(re=Y),Y===0)return a[l++]=20971520,a[l++]=20971520,p.bits=1,0;for(q=1;q<Y&&Xe[q]===0;q++);for(re<q&&(re=q),ae=1,M=1;M<=IS;M++)if(ae<<=1,ae-=Xe[M],ae<0)return-1;if(ae>0&&(e===0||Y!==1))return-1;for(jt[1]=0,M=1;M<IS;M++)jt[M+1]=jt[M]+Xe[M];for(F=0;F<s;F++)t[r+F]!==0&&(u[jt[t[r+F]]++]=F);if(e===0?(Be=bn=u,B=20):e===1?(Be=ape,bn=cpe,B=257):(Be=lpe,bn=dpe,B=0),we=0,F=0,M=q,C=l,ce=re,le=0,y=-1,_e=1<<re,b=_e-1,e===1&&_e>852||e===2&&_e>592)return 1;for(;;){kt=M-le,u[F]+1<B?(Tt=0,jn=u[F]):u[F]>=B?(Tt=bn[u[F]-B],jn=Be[u[F]-B]):(Tt=96,jn=0),g=1<<M-le,E=1<<ce,q=E;do E-=g,a[C+(we>>le)+E]=kt<<24|Tt<<16|jn|0;while(E!==0);for(g=1<<M-1;we&g;)g>>=1;if(g!==0?(we&=g-1,we+=g):we=0,F++,--Xe[M]==0){if(M===Y)break;M=t[r+u[F]]}if(M>re&&(we&b)!==y){for(le===0&&(le=re),C+=q,ce=M-le,ae=1<<ce;ce+le<Y&&(ae-=Xe[ce+le],!(ae<=0));)ce++,ae<<=1;if(_e+=1<<ce,e===1&&_e>852||e===2&&_e>592)return 1;y=we&b,a[y]=re<<24|ce<<16|C-l|0}}return we!==0&&(a[C+we]=M-le<<24|64<<16|0),p.bits=re,0};const{Z_FINISH:r9,Z_BLOCK:upe,Z_TREES:OS,Z_OK:Ih,Z_STREAM_END:hpe,Z_NEED_DICT:ppe,Z_STREAM_ERROR:ka,Z_DATA_ERROR:i9,Z_MEM_ERROR:s9,Z_BUF_ERROR:fpe,Z_DEFLATED:o9}=Gf,DS=16180,PS=16190,Wl=16191,iN=16192,sN=16194,kS=16199,LS=16200,oN=16206,ei=16209,a9=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function mpe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Oh=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<DS||t.mode>16211?1:0},c9=e=>{if(Oh(e))return ka;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=DS,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Ih},l9=e=>{if(Oh(e))return ka;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,c9(e)},d9=(e,t)=>{let r;if(Oh(e))return ka;const s=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?ka:(s.window!==null&&s.wbits!==t&&(s.window=null),s.wrap=r,s.wbits=t,l9(e))},u9=(e,t)=>{if(!e)return ka;const r=new mpe;e.state=r,r.strm=e,r.window=null,r.mode=DS;const s=d9(e,t);return s!==Ih&&(e.state=null),s};let aN,cN,h9=!0;const gpe=e=>{if(h9){aN=new Int32Array(512),cN=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Kg(1,e.lens,0,288,aN,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Kg(2,e.lens,0,32,cN,0,e.work,{bits:5}),h9=!1}e.lencode=aN,e.lenbits=9,e.distcode=cN,e.distbits=5},p9=(e,t,r,s)=>{let a;const l=e.state;return l.window===null&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new Uint8Array(l.wsize)),s>=l.wsize?(l.window.set(t.subarray(r-l.wsize,r),0),l.wnext=0,l.whave=l.wsize):(a=l.wsize-l.wnext,a>s&&(a=s),l.window.set(t.subarray(r-s,r-s+a),l.wnext),(s-=a)?(l.window.set(t.subarray(r-s,r),0),l.wnext=s,l.whave=l.wsize):(l.wnext+=a,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=a))),0};var _pe=(e,t)=>{let r,s,a,l,u,p,m,g,E,y,b,C,B,M,F,q,Y,re,ce,le,ae,_e,we=0;const Be=new Uint8Array(4);let Xe,jt;const kt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Oh(e)||!e.output||!e.input&&e.avail_in!==0)return ka;r=e.state,r.mode===Wl&&(r.mode=iN),u=e.next_out,a=e.output,m=e.avail_out,l=e.next_in,s=e.input,p=e.avail_in,g=r.hold,E=r.bits,y=p,b=m,_e=Ih;e:for(;;)switch(r.mode){case DS:if(r.wrap===0){r.mode=iN;break}for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(2&r.wrap&&g===35615){r.wbits===0&&(r.wbits=15),r.check=0,Be[0]=255&g,Be[1]=g>>>8&255,r.check=ds(r.check,Be,2,0),g=0,E=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=ei;break}if((15&g)!==o9){e.msg="unknown compression method",r.mode=ei;break}if(g>>>=4,E-=4,ae=8+(15&g),r.wbits===0&&(r.wbits=ae),ae>15||ae>r.wbits){e.msg="invalid window size",r.mode=ei;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&g?16189:Wl,g=0,E=0;break;case 16181:for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(r.flags=g,(255&Yi(r))!==o9){e.msg="unknown compression method",r.mode=ei;break}if(57344&Yi(r)){e.msg="unknown header flags set",r.mode=ei;break}r.head&&(r.head.text=g>>8&1),512&Yi(r)&&4&r.wrap&&(Be[0]=255&g,Be[1]=g>>>8&255,r.check=ds(r.check,Be,2,0)),g=0,E=0,r.mode=16182;case 16182:for(;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}r.head&&(r.head.time=g),512&Yi(r)&&4&r.wrap&&(Be[0]=255&g,Be[1]=g>>>8&255,Be[2]=g>>>16&255,Be[3]=g>>>24&255,r.check=ds(r.check,Be,4,0)),g=0,E=0,r.mode=16183;case 16183:for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&Yi(r)&&4&r.wrap&&(Be[0]=255&g,Be[1]=g>>>8&255,r.check=ds(r.check,Be,2,0)),g=0,E=0,r.mode=16184;case 16184:if(1024&Yi(r)){for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}r.length=g,r.head&&(r.head.extra_len=g),512&Yi(r)&&4&r.wrap&&(Be[0]=255&g,Be[1]=g>>>8&255,r.check=ds(r.check,Be,2,0)),g=0,E=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&Yi(r)&&(C=r.length,C>p&&(C=p),C&&(r.head&&(ae=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(s.subarray(l,l+C),ae)),512&Yi(r)&&4&r.wrap&&(r.check=ds(r.check,s,C,l)),p-=C,l+=C,r.length-=C),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&Yi(r)){if(p===0)break e;C=0;do ae=s[l+C++],r.head&&ae&&r.length<65536&&(r.head.name+=String.fromCharCode(ae));while(ae&&C<p);if(512&Yi(r)&&4&r.wrap&&(r.check=ds(r.check,s,C,l)),p-=C,l+=C,ae)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&Yi(r)){if(p===0)break e;C=0;do ae=s[l+C++],r.head&&ae&&r.length<65536&&(r.head.comment+=String.fromCharCode(ae));while(ae&&C<p);if(512&Yi(r)&&4&r.wrap&&(r.check=ds(r.check,s,C,l)),p-=C,l+=C,ae)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&Yi(r)){for(;E<16;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(4&r.wrap&&g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=ei;break}g=0,E=0}r.head&&(r.head.hcrc=Yi(r)>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Wl;break;case 16189:for(;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}e.adler=r.check=a9(g),g=0,E=0,r.mode=PS;case PS:if(r.havedict===0)return e.next_out=u,e.avail_out=m,e.next_in=l,e.avail_in=p,r.hold=g,r.bits=E,ppe;e.adler=r.check=1,r.mode=Wl;case Wl:if(t===upe||t===OS)break e;case iN:if(r.last){g>>>=7&E,E-=7&E,r.mode=oN;break}for(;E<3;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}switch(r.last=1&g,g>>>=1,E-=1,3&g){case 0:r.mode=16193;break;case 1:if(gpe(r),r.mode=kS,t===OS){g>>>=2,E-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=ei}g>>>=2,E-=2;break;case 16193:for(g>>>=7&E,E-=7&E;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ei;break}if(r.length=65535&g,g=0,E=0,r.mode=sN,t===OS)break e;case sN:r.mode=16195;case 16195:if(C=r.length,C){if(C>p&&(C=p),C>m&&(C=m),C===0)break e;a.set(s.subarray(l,l+C),u),p-=C,l+=C,m-=C,u+=C,r.length-=C;break}r.mode=Wl;break;case 16196:for(;E<14;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(r.nlen=257+(31&g),g>>>=5,E-=5,r.ndist=1+(31&g),g>>>=5,E-=5,r.ncode=4+(15&g),g>>>=4,E-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ei;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;E<3;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}r.lens[kt[r.have++]]=7&g,g>>>=3,E-=3}for(;r.have<19;)r.lens[kt[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Xe={bits:r.lenbits},_e=Kg(0,r.lens,0,19,r.lencode,0,r.work,Xe),r.lenbits=Xe.bits,_e){e.msg="invalid code lengths set",r.mode=ei;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;we=r.lencode[g&(1<<r.lenbits)-1],F=we>>>24,q=we>>>16&255,Y=65535&we,!(F<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(Y<16)g>>>=F,E-=F,r.lens[r.have++]=Y;else{if(Y===16){for(jt=F+2;E<jt;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(g>>>=F,E-=F,r.have===0){e.msg="invalid bit length repeat",r.mode=ei;break}ae=r.lens[r.have-1],C=3+(3&g),g>>>=2,E-=2}else if(Y===17){for(jt=F+3;E<jt;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=F,E-=F,ae=0,C=3+(7&g),g>>>=3,E-=3}else{for(jt=F+7;E<jt;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=F,E-=F,ae=0,C=11+(127&g),g>>>=7,E-=7}if(r.have+C>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ei;break}for(;C--;)r.lens[r.have++]=ae}}if(r.mode===ei)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ei;break}if(r.lenbits=9,Xe={bits:r.lenbits},_e=Kg(1,r.lens,0,r.nlen,r.lencode,0,r.work,Xe),r.lenbits=Xe.bits,_e){e.msg="invalid literal/lengths set",r.mode=ei;break}if(r.distbits=6,r.distcode=r.distdyn,Xe={bits:r.distbits},_e=Kg(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Xe),r.distbits=Xe.bits,_e){e.msg="invalid distances set",r.mode=ei;break}if(r.mode=kS,t===OS)break e;case kS:r.mode=LS;case LS:if(p>=6&&m>=258){e.next_out=u,e.avail_out=m,e.next_in=l,e.avail_in=p,r.hold=g,r.bits=E,ope(e,b),u=e.next_out,a=e.output,m=e.avail_out,l=e.next_in,s=e.input,p=e.avail_in,g=r.hold,E=r.bits,r.mode===Wl&&(r.back=-1);break}for(r.back=0;we=r.lencode[g&(1<<r.lenbits)-1],F=we>>>24,q=we>>>16&255,Y=65535&we,!(F<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(q&&!(240&q)){for(re=F,ce=q,le=Y;we=r.lencode[le+((g&(1<<re+ce)-1)>>re)],F=we>>>24,q=we>>>16&255,Y=65535&we,!(re+F<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=re,E-=re,r.back+=re}if(g>>>=F,E-=F,r.back+=F,r.length=Y,q===0){r.mode=16205;break}if(32&q){r.back=-1,r.mode=Wl;break}if(64&q){e.msg="invalid literal/length code",r.mode=ei;break}r.extra=15&q,r.mode=16201;case 16201:if(r.extra){for(jt=r.extra;E<jt;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,E-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;we=r.distcode[g&(1<<r.distbits)-1],F=we>>>24,q=we>>>16&255,Y=65535&we,!(F<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(!(240&q)){for(re=F,ce=q,le=Y;we=r.distcode[le+((g&(1<<re+ce)-1)>>re)],F=we>>>24,q=we>>>16&255,Y=65535&we,!(re+F<=E);){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}g>>>=re,E-=re,r.back+=re}if(g>>>=F,E-=F,r.back+=F,64&q){e.msg="invalid distance code",r.mode=ei;break}r.offset=Y,r.extra=15&q,r.mode=16203;case 16203:if(r.extra){for(jt=r.extra;E<jt;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,E-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ei;break}r.mode=16204;case 16204:if(m===0)break e;if(C=b-m,r.offset>C){if(C=r.offset-C,C>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ei;break}C>r.wnext?(C-=r.wnext,B=r.wsize-C):B=r.wnext-C,C>r.length&&(C=r.length),M=r.window}else M=a,B=u-r.offset,C=r.length;C>m&&(C=m),m-=C,r.length-=C;do a[u++]=M[B++];while(--C);r.length===0&&(r.mode=LS);break;case 16205:if(m===0)break e;a[u++]=r.length,m--,r.mode=LS;break;case oN:if(r.wrap){for(;E<32;){if(p===0)break e;p--,g|=s[l++]<<E,E+=8}if(b-=m,e.total_out+=b,r.total+=b,4&r.wrap&&b&&(e.adler=r.check=Yi(r)?ds(r.check,a,b,u-b):jg(r.check,a,b,u-b)),b=m,4&r.wrap&&(Yi(r)?g:a9(g))!==r.check){e.msg="incorrect data check",r.mode=ei;break}g=0,E=0}r.mode=16207;case 16207:if(r.wrap&&Yi(r)){for(;E<32;){if(p===0)break e;p--,g+=s[l++]<<E,E+=8}if(4&r.wrap&&g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=ei;break}g=0,E=0}r.mode=16208;case 16208:_e=hpe;break e;case ei:_e=i9;break e;case 16210:return s9;default:return ka}return e.next_out=u,e.avail_out=m,e.next_in=l,e.avail_in=p,r.hold=g,r.bits=E,(r.wsize||b!==e.avail_out&&r.mode<ei&&(r.mode<oN||t!==r9))&&p9(e,e.output,e.next_out,b-e.avail_out),y-=e.avail_in,b-=e.avail_out,e.total_in+=y,e.total_out+=b,r.total+=b,4&r.wrap&&b&&(e.adler=r.check=Yi(r)?ds(r.check,a,b,e.next_out-b):jg(r.check,a,b,e.next_out-b)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Wl?128:0)+(r.mode===kS||r.mode===sN?256:0),(y===0&&b===0||t===r9)&&_e===Ih&&(_e=fpe),_e},Hl={inflateReset:l9,inflateReset2:d9,inflateResetKeep:c9,inflateInit:e=>u9(e,15),inflateInit2:u9,inflate:_pe,inflateEnd:e=>{if(Oh(e))return ka;let t=e.state;return t.window&&(t.window=null),e.state=null,Ih},inflateGetHeader:(e,t)=>{if(Oh(e))return ka;const r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,Ih):ka},inflateSetDictionary:(e,t)=>{const r=t.length;let s,a,l;return Oh(e)?ka:(s=e.state,s.wrap!==0&&s.mode!==PS?ka:s.mode===PS&&(a=1,a=jg(a,t,r,0),a!==s.check)?i9:(l=p9(e,t,r,r),l?(s.mode=16210,s9):(s.havedict=1,Ih)))},inflateInfo:"pako inflate (from Nodeca project)"},Epe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const f9=Object.prototype.toString,{Z_NO_FLUSH:vpe,Z_FINISH:ype,Z_OK:qg,Z_STREAM_END:lN,Z_NEED_DICT:dN,Z_STREAM_ERROR:Spe,Z_DATA_ERROR:m9,Z_MEM_ERROR:xpe}=Gf;function Yg(e){this.options=RS.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new t9,this.strm.avail_out=0;let r=Hl.inflateInit2(this.strm,t.windowBits);if(r!==qg)throw new Error(Ch[r]);if(this.header=new Epe,Hl.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Gg.string2buf(t.dictionary):f9.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Hl.inflateSetDictionary(this.strm,t.dictionary),r!==qg)))throw new Error(Ch[r])}function uN(e,t){const r=new Yg(t);if(r.push(e),r.err)throw r.msg||Ch[r.err];return r.result}Yg.prototype.push=function(e,t){const r=this.strm,s=this.options.chunkSize,a=this.options.dictionary;let l,u,p;if(this.ended)return!1;for(u=t===~~t?t:t===!0?ype:vpe,f9.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),l=Hl.inflate(r,u),l===dN&&a&&(l=Hl.inflateSetDictionary(r,a),l===qg?l=Hl.inflate(r,u):l===m9&&(l=dN));r.avail_in>0&&l===lN&&r.state.wrap>0&&e[r.next_in]!==0;)Hl.inflateReset(r),l=Hl.inflate(r,u);switch(l){case Spe:case m9:case dN:case xpe:return this.onEnd(l),this.ended=!0,!1}if(p=r.avail_out,r.next_out&&(r.avail_out===0||l===lN))if(this.options.to==="string"){let m=Gg.utf8border(r.output,r.next_out),g=r.next_out-m,E=Gg.buf2string(r.output,m);r.next_out=g,r.avail_out=s-g,g&&r.output.set(r.output.subarray(m,m+g),0),this.onData(E)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(l!==qg||p!==0){if(l===lN)return l=Hl.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},Yg.prototype.onData=function(e){this.chunks.push(e)},Yg.prototype.onEnd=function(e){e===qg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=RS.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Tpe={Inflate:Yg,inflate:uN,inflateRaw:function(e,t){return(t=t||{}).raw=!0,uN(e,t)},ungzip:uN,constants:Gf};const{Deflate:GIe,deflate:bpe,deflateRaw:zIe,gzip:KIe}=spe,{Inflate:qIe,inflate:wpe,inflateRaw:YIe,ungzip:$Ie}=Tpe;var Cpe=bpe,Rpe=wpe,g9=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(g9||{});class Ape{constructor(){z(this,"_sequence",0),z(this,"_startTime",Date.now()),z(this,"isUseOneByte",!0)}get startTime(){const t=Date.now()-this._startTime;return t<Math.pow(2,16)?t:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(t){const r={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:t};if(t.byteLength>128){const p=new Uint8Array(4);p.set([1,0,0,0]);const m={id:0,length:4,data:p.buffer},g={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[m]};r.commonPacketHeader.extension=1,r.extension=g,r.payload=this.compress(t),r.commonPacketHeader.length=8+(r.extension.length+2)+r.payload.byteLength}else r.commonPacketHeader.length=8+r.payload.byteLength;Z("SHOW_DATASTREAM2_LOG")&&O.debug("send data header: ".concat(JSON.stringify(r.commonPacketHeader)));const s=new ArrayBuffer(r.commonPacketHeader.length),a=new Uint8Array(s),l=new DataView(s);let u=0;if(l.setUint16(u,r.commonPacketHeader.extension<<15|r.commonPacketHeader.reserved<<14|r.commonPacketHeader.length,!0),u+=2,l.setUint32(u,r.commonPacketHeader.sequence,!0),u+=4,l.setUint16(u,r.commonStreamHeader,!0),u+=2,r.extension){const p=this.serializeExtension(r.extension);a.set(new Uint8Array(p),u),u+=p.byteLength}if(a.set(new Uint8Array(r.payload),u),u+=r.payload.byteLength,u!==r.commonPacketHeader.length)throw Error("serialize error!");return s}deserialize(t){if(t.byteLength<4)return new ArrayBuffer(0);const r=new DataView(t);let s=0;const a=r.getUint16(s,!0);s+=2;const l={length:16383&a,reserved:(16384&a)>>14,extension:(32768&a)>>15,sequence:r.getUint16(s+2,!0)<<16|r.getUint16(s,!0)};let u,p;if(s+=4,Z("SHOW_DATASTREAM2_LOG")&&O.debug("receive data header: ".concat(JSON.stringify(l))),r.getUint16(s,!0),s+=2,l.extension){p=this.deserializeExtension(t.slice(s)),s+=2+p.length,u=t.slice(s);let m=!1;if(p.datas.length>0){const g=p.datas.find(E=>E.id===0);g&&(m=(1&new DataView(g.data).getUint32(0,!0))==1)}u=m?this.decompress(u):u}else u=t.slice(8);return u}serializeExtension(t){const{profile:r,length:s,datas:a}=t,l=new ArrayBuffer(s+2),u=new Uint8Array(l),p=new DataView(l);let m=0;if(p.setUint8(m++,r),p.setUint8(m++,s),a.forEach(g=>{r?(p.setUint8(m++,g.id),p.setUint8(m++,g.length),u.set(new Uint8Array(g.data),m),m+=g.data.byteLength):(p.setUint8(m++,g.id|g.length<<4),u.set(new Uint8Array(g.data),m),m+=g.data.byteLength)}),m!==s+2)throw Error("serialize extension error, is ".concat(m,"!==").concat(s+2));return l}deserializeExtension(t){const r=new DataView(t);let s=0;const a=r.getUint8(s);s++;const l=r.getUint8(s);s++;const u=a===g9.TWO_BYTE,p=[],m=new DataView(t,2);let g=0;for(;g<l;){let E=0,y=0,b=new ArrayBuffer(0);u?(E=m.getUint8(g),g++,y=m.getUint8(g),g++):(E=15&m.getUint8(g),y=m.getUint8(g)>>4,g++),y>0&&(b=m.buffer.slice(g+2,g+2+y),g+=b.byteLength),p.push({id:E,length:y,data:b})}if(g!==l)throw Error("parse error");return{profile:a,length:l,datas:p}}decompress(t){return Rpe(new Uint8Array(t))}compress(t){return Cpe(new Uint8Array(t))}}const Npe={name:"DataStream",create:(e,t)=>{const r=t?new Ude(e):new Fde(e);return r.useDataStream(new Ape),r}};class Ipe extends Zn{constructor(t,r,s){super(),z(this,"ws",void 0),z(this,"requestId",1),z(this,"heartBeatTimer",void 0),z(this,"joinInfo",void 0),z(this,"clientId",void 0),z(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),z(this,"onClose",a=>{this.emit("close"),this.dispose()}),z(this,"onMessage",a=>{const l=JSON.parse(a.data);if(!l||l.command!=="serverResponse"||!l.requestId)return l&&l.command==="serverStatus"&&l.serverStatus&&l.serverStatus.command?(this.emit("status",l.serverStatus),void this.emit(l.serverStatus.command,l.serverStatus)):void 0;this.emit("req_".concat(l.requestId),l)}),this.joinInfo=t,this.clientId=r,this.ws=new Eg("cross-channel-".concat(this.clientId),s),this.ws.on(Pt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(Pt.CONNECTED,this.onOpen),this.ws.on(Pt.ON_MESSAGE,this.onMessage),this.ws.on(Pt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(t){const r=this.requestId++;return t.requestId=r,t.seq=r,this.ws.sendMessage(t),r}waitStatus(t){return new Ye((r,s)=>{const a=window.setTimeout(()=>{s(new me($.TIMEOUT,"wait status timeout, status: ".concat(t)))},5e3);this.once(t,l=>{window.clearTimeout(a),l.state&&l.state!==0?s(new me($.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(t))):r(void 0)}),this.once("dispose",()=>{window.clearTimeout(a),s(new me($.WS_ABORT))})})}async request(t){if(this.ws.state==="closed")throw new me($.WS_DISCONNECT);const r=()=>new Ye((u,p)=>{this.ws.once(Pt.CLOSED,()=>p(new me($.WS_ABORT))),this.ws.once(Pt.CONNECTED,u)});this.ws.state!=="connected"&&await r();const s=this.sendMessage(t),a=new Ye((u,p)=>{const m=()=>{p(new me($.WS_ABORT))};this.ws.once(Pt.RECONNECTING,m),this.ws.once(Pt.CLOSED,m),this.once("req_".concat(s),u),ai(3e3).then(()=>{this.removeAllListeners("req_".concat(s)),this.ws.off(Pt.RECONNECTING,m),this.ws.off(Pt.CLOSED,m),p(new me($.TIMEOUT,"cross channel ws request timeout"))})}),l=await a;if(!l||l.code!==200)throw new me($.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(l)));return l}async connect(t){this.ws.removeAllListeners(Pt.REQUEST_NEW_URLS),this.ws.on(Pt.REQUEST_NEW_URLS,r=>{r(t)}),await this.ws.init(t)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(t){const r=this.requestId++;return t.requestId=r,this.ws.sendMessage(t),r}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Ope extends Zn{set state(t){t!==this._state&&(t!==ks.RELAY_STATE_FAILURE&&(this.errorCode=Nf.RELAY_OK),this.emit("state",t,this.errorCode),this._state=t)}get state(){return this._state}constructor(t,r,s,a,l){super(),z(this,"joinInfo",void 0),z(this,"sid",void 0),z(this,"clientId",void 0),z(this,"cancelToken",_s.CancelToken.source()),z(this,"workerToken",void 0),z(this,"requestId",0),z(this,"signal",void 0),z(this,"prevChannelMediaConfig",void 0),z(this,"httpRetryConfig",void 0),z(this,"_resolution",void 0),z(this,"_state",ks.RELAY_STATE_IDLE),z(this,"errorCode",Nf.RELAY_OK),z(this,"onStatus",u=>{O.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(u))),u&&u.command&&(u.command==="onAudioPacketReceived"&&this.emit("event",jl.PACKET_RECEIVED_AUDIO_FROM_SRC),u.command==="onVideoPacketReceived"&&this.emit("event",jl.PACKET_RECEIVED_VIDEO_FROM_SRC),u.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=Nf.SRC_TOKEN_EXPIRED,this.state=ks.RELAY_STATE_FAILURE),u.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=Nf.DEST_TOKEN_EXPIRED,this.state=ks.RELAY_STATE_FAILURE))}),z(this,"onReconnect",async()=>{O.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",jl.NETWORK_DISCONNECTED),this.state=ks.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(u=>{this.state!==ks.RELAY_STATE_IDLE&&(O.error("auto restart channel media relay failed",u.toString()),this.errorCode=Nf.SERVER_CONNECTION_LOST,this.state=ks.RELAY_STATE_FAILURE)})}),this.joinInfo=t,this.clientId=r,this.sid=hh(),this.signal=new Ipe(this.joinInfo,this.clientId,s),this.httpRetryConfig=a,this._resolution=l}async startChannelMediaRelay(t){if(this.state!==ks.RELAY_STATE_IDLE)throw new me($.INVALID_OPERATION);this.state=ks.RELAY_STATE_CONNECTING,await this.connect(),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(t)}catch(r){throw r.data&&r.data.serverResponse&&r.data.serverResponse.command==="SetSourceChannel"?new me($.CROSS_CHANNEL_FAILED_JOIN_SRC):r.data&&r.data.serverResponse&&r.serverResponse.command==="SetDestChannelStatus"?new me($.CROSS_CHANNEL_FAILED_JOIN_DEST):r.data&&r.data.serverResponse&&r.serverResponse.command==="StartPacketTransfer"?new me($.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):r}this.prevChannelMediaConfig=t}async updateChannelMediaRelay(t){if(this.state!==ks.RELAY_STATE_RUNNING)throw new me($.INVALID_OPERATION);await this.sendUpdateMessage(t),this.prevChannelMediaConfig=t}async setVideoProfile(t){if(this._resolution=t,this.state!==ks.RELAY_STATE_RUNNING)throw new me($.INVALID_OPERATION);const r=this.genMessage(ls.SetVideoProfile);await this.signal.request(r),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),O.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=ks.RELAY_STATE_IDLE,this.dispose()}dispose(){O.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=_s.CancelToken.source(),this.state=ks.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const t=await Gue(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=t.workerToken,await this.signal.connect(t.addressList),this.emit("event",jl.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(t){const r=this.genMessage(ls.StopPacketTransfer);await this.signal.request(r),await this.signal.waitStatus("Normal Quit"),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const s=this.genMessage(ls.SetSdkProfile,t);await this.signal.request(s),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const a=this.genMessage(ls.SetSourceChannel,t);await this.signal.request(a),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",jl.PACKET_JOINED_SRC_CHANNEL),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const l=this.genMessage(ls.SetSourceUserId,t);await this.signal.request(l),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const u=this.genMessage(ls.SetDestChannel,t);await this.signal.request(u),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",jl.PACKET_JOINED_DEST_CHANNEL),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const p=this.genMessage(ls.StartPacketTransfer,t);await this.signal.request(p),this.emit("event",jl.PACKET_SENT_TO_DEST_CHANNEL),this.state=ks.RELAY_STATE_RUNNING,O.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(t){const r=this.genMessage(ls.UpdateDestChannel,t);await this.signal.request(r),this.emit("event",jl.PACKET_UPDATE_DEST_CHANNEL),O.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const t=this.genMessage(ls.StopPacketTransfer);await this.signal.request(t),O.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(t,r){const s=[],a=[],l=[];this.requestId+=1;const u={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:zo,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};u.sdkVersion==="4.23.4"&&(u.sdkVersion="0.0.1");let p=null,m=null;switch(t){case ls.SetSdkProfile:return u.clientRequest={command:"SetSdkProfile",type:"multi_channel"},u;case ls.SetSourceChannel:if(m=r&&r.getSrcChannelMediaInfo(),!m)throw new me($.UNEXPECTED_ERROR,"can not find source config");return u.clientRequest={command:"SetSourceChannel",uid:"0",channelName:m.channelName,token:m.token||this.joinInfo.appId},u;case ls.SetSourceUserId:if(m=r&&r.getSrcChannelMediaInfo(),!m)throw new me($.UNEXPECTED_ERROR,"can not find source config");return u.clientRequest={command:"SetSourceUserId",uid:m.uid+""},u;case ls.SetDestChannel:if(p=r&&r.getDestChannelMediaInfo(),!p)throw new me($.UNEXPECTED_ERROR,"can not find dest config");return p.forEach(g=>{s.push(g.channelName),a.push(g.uid+""),l.push(g.token||this.joinInfo.appId)}),u.clientRequest={command:"SetDestChannel",channelName:s,uid:a,token:l},u;case ls.StartPacketTransfer:return u.clientRequest={command:"StartPacketTransfer"},u;case ls.Reconnect:return u.clientRequest={command:"Reconnect"},u;case ls.StopPacketTransfer:return u.clientRequest={command:"StopPacketTransfer"},u;case ls.UpdateDestChannel:if(p=r&&r.getDestChannelMediaInfo(),!p)throw new me($.UNEXPECTED_ERROR,"can not find dest config");return p.forEach(g=>{s.push(g.channelName),a.push(g.uid+""),l.push(g.token||this.joinInfo.appId)}),u.clientRequest={command:"UpdateDestChannel",channelName:s,uid:a,token:l},u;case ls.SetVideoProfile:u.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return u}}const Dpe={name:"ChannelMediaRelay",create:function(e){return new Ope(e.joinInfo,e.clientId,e.websocketRetryConfig||Rr,e.httpRetryConfig||Rr,e.resolution)}};function _9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $g(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_9(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class Ppe extends Zn{constructor(t,r,s,a){super(),z(this,"spec",void 0),z(this,"token",void 0),z(this,"websocket",void 0),z(this,"pingpongTimer",void 0),z(this,"reconnectMode","retry"),z(this,"serviceMode",void 0),z(this,"reqId",0),z(this,"commandReqId",0),z(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),z(this,"handleWebSocketMessage",l=>{if(!l.data)return;const u=JSON.parse(l.data);u.requestId?this.emit("@".concat(u.requestId,"-").concat(u.sid),u):(st.workerEvent(this.spec.sid,{actionType:"status",serverCode:u.code,workerType:this.serviceMode===Jc.TRANSCODE?1:2}),this.emit(kd.PUBLISH_STREAM_STATUS,u))}),this.spec=r,this.token=t,this.serviceMode=a,this.websocket=new Eg("live-streaming",s),this.websocket.on(Pt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(Pt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(Pt.REQUEST_NEW_URLS,(l,u)=>{Si(this,kd.REQUEST_NEW_ADDRESS).then(l).catch(u)}),this.websocket.on(Pt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(t){return this.websocket.init(t)}async request(t,r,s,a){this.reqId+=1,t==="request"&&(this.commandReqId+=1);const l=this.commandReqId,u=this.reqId;if(!u||!this.websocket)throw new me($.UNEXPECTED_ERROR);const p=$g({command:t,sdkVersion:zo==="4.23.4"?"0.0.1":zo,seq:u,requestId:u,allocate:s,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},r);if(this.websocket.state==="closed")throw new me($.WS_DISCONNECT);const m=()=>new Ye((b,C)=>{this.websocket.once(Pt.CLOSED,()=>C(new me($.WS_ABORT))),this.websocket.once(Pt.CONNECTED,b)});this.websocket.state!=="connected"&&await m(),p.clientRequest&&(p.clientRequest.workerToken=this.token);const g=new Ye((b,C)=>{const B=()=>{C(new me($.WS_ABORT))};this.websocket.once(Pt.RECONNECTING,B),this.websocket.once(Pt.CLOSED,B),this.once("@".concat(u,"-").concat(this.spec.sid),M=>{b(M)})});a&&st.workerEvent(this.spec.sid,$g($g({},a),{},{requestId:l,actionType:"request",payload:JSON.stringify(r.clientRequest),serverCode:0,code:0}));const E=Date.now();this.websocket.sendMessage(p);let y=null;try{y=await g}catch(b){if(this.websocket.state==="closed")throw b;return await m(),await this.request(t,r,s)}return a&&st.workerEvent(this.spec.sid,$g($g({},a),{},{requestId:l,actionType:"response",payload:JSON.stringify(y.serverResponse),serverCode:y.code,success:y.code===200,responseTime:Date.now()-E})),y.code!==200&&this.handleResponseError(y),y}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const t=zo==="4.23.4"?"0.0.1":zo;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:t,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(t){switch(t.code){case Dr.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void O.warning("live stream response already exists stream");case Dr.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Dr.LIVE_STREAM_RESPONSE_BAD_STREAM:case Dr.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new me($.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:t.code}).throw();case Dr.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(t.serverResponse.command==="UnpublishStream")return;throw new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Dr.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new me($.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:t.code}).throw();case Dr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const r=new me($.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(kd.WARNING,r,t.serverResponse.url)}case Dr.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const r=new me($.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(kd.WARNING,r,t.serverResponse.url)}case Dr.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Dr.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new me($.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:t.code}).throw();case Dr.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const r=new me($.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(kd.WARNING,r,t.serverResponse.url)}case Dr.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code}).throw();case Dr.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Dr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Dr.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(t.serverResponse.command==="UnpublishStream")return;throw new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Dr.ERROR_FAIL_SEND_MESSAGE:if(t.serverResponse.command==="UnpublishStream")return;if(t.serverResponse.command==="UpdateTranscoding"||t.serverResponse.command==="ControlStream")return new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:t.code}).throw();throw new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Dr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Dr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Dr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Dr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new me($.LIVE_STREAMING_CDN_ERROR,"",{code:t.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(Ry)},6e3)}}function E9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E9(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class kpe extends Zn{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rr,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Rr;super(),z(this,"onLiveStreamWarning",void 0),z(this,"onLiveStreamError",void 0),z(this,"spec",void 0),z(this,"retryTimeout",1e4),z(this,"connection",void 0),z(this,"httpRetryConfig",void 0),z(this,"wsRetryConfig",void 0),z(this,"streamingTasks",new Map),z(this,"isStartingStreamingTask",!1),z(this,"taskMutex",new Ai("live-streaming")),z(this,"cancelToken",_s.CancelToken.source()),z(this,"transcodingConfig",void 0),z(this,"uapResponse",void 0),z(this,"lastTaskId",1),z(this,"statusError",new Map),this.spec=t,this.httpRetryConfig=s,this.wsRetryConfig=r}async setTranscodingConfig(t){const r=Ls(Ls({},Tue),t);r.videoCodecProfile!==66&&r.videoCodecProfile!==77&&r.videoCodecProfile!==100&&(O.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(r.videoCodecProfile," -> 100")),r.videoCodecProfile=100),r.transcodingUsers||(r.transcodingUsers=r.userConfigs),r.transcodingUsers&&(r.transcodingUsers=r.transcodingUsers.map(u=>Ls(Ls(Ls({},xue),u),{},{zOrder:u.zOrder?u.zOrder+1:1}))),function(u){ir(u.width)||xn(u.width,"config.width",0,1e4),ir(u.height)||xn(u.height,"config.height",0,1e4),ir(u.videoBitrate)||xn(u.videoBitrate,"config.videoBitrate",1,1e6),ir(u.videoFrameRate)||xn(u.videoFrameRate,"config.videoFrameRate"),ir(u.lowLatency)||kl(u.lowLatency,"config.lowLatency"),ir(u.audioSampleRate)||Mr(u.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),ir(u.audioBitrate)||xn(u.audioBitrate,"config.audioBitrate",1,128),ir(u.audioChannels)||Mr(u.audioChannels,"config.audioChannels",[1,2,3,4,5]),ir(u.videoGop)||xn(u.videoGop,"config.videoGop"),ir(u.videoCodecProfile)||Mr(u.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),ir(u.userCount)||xn(u.userCount,"config.userCount",0,17),ir(u.backgroundColor)||xn(u.backgroundColor,"config.backgroundColor",0,16777215),ir(u.userConfigExtraInfo)||oi(u.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),u.transcodingUsers&&!ir(u.transcodingUsers)&&(Ll(u.transcodingUsers,"config.transcodingUsers"),u.transcodingUsers.forEach((p,m)=>{Xy(p.uid),ir(p.x)||xn(p.x,"transcodingUser[".concat(m,"].x"),0,1e4),ir(p.y)||xn(p.y,"transcodingUser[".concat(m,"].y"),0,1e4),ir(p.width)||xn(p.width,"transcodingUser[".concat(m,"].width"),0,1e4),ir(p.height)||xn(p.height,"transcodingUser[".concat(m,"].height"),0,1e4),ir(p.zOrder)||xn(p.zOrder-1,"transcodingUser[".concat(m,"].zOrder"),0,100),ir(p.alpha)||xn(p.alpha,"transcodingUser[".concat(m,"].alpha"),0,1,!1)})),ir(u.watermark)||l1(u.watermark,"watermark"),ir(u.backgroundImage)||l1(u.backgroundImage,"backgroundImage"),u.images&&!ir(u.images)&&(Ll(u.images,"config.images"),u.images.forEach((p,m)=>{l1(p,"images[".concat(m,"]"))}))}(r);const s=[];r.images&&s.push(...r.images.map(u=>Ls(Ls(Ls({},c1),u),{},{zOrder:255}))),r.backgroundImage&&(s.push(Ls(Ls(Ls({},c1),r.backgroundImage),{},{zOrder:0})),delete r.backgroundImage),r.watermark&&(s.push(Ls(Ls(Ls({},c1),r.watermark),{},{zOrder:255})),delete r.watermark),r.images=s,r.transcodingUsers&&(r.userConfigs=r.transcodingUsers.map(u=>Ls({},u)),r.userCount=r.transcodingUsers.length,delete r.transcodingUsers);const a=(r.userConfigs||[]).map(u=>typeof u.uid=="number"?Ye.resolve(u.uid):V5(u.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await Ye.all(a)).forEach((u,p)=>{r.userConfigs&&r.userConfigs[p]&&(r.userConfigs[p].uid=u)}),this.transcodingConfig=r,this.connection)try{var l;const u=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from($s(l=this.streamingTasks).call(l)).map(p=>p.taskId).join("#")});O.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(u.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(u){if(!u.data||!u.data.retry)throw u;u.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(p=>{O.warning("[".concat(this.spec.clientId,"] live streaming receive error"),u.toString(),"try to republish",p.url),this.startLiveStreamingTask(p.url,p.mode,u).then(()=>{O.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(p.url," success"))}).catch(m=>{O.error("[".concat(this.spec.clientId,"] live streaming republish failed"),p.url,m.toString()),this.onLiveStreamError&&this.onLiveStreamError(p.url,m)})})}}async startLiveStreamingTask(t,r,s){if(!this.transcodingConfig&&r===Jc.TRANSCODE)throw new me($.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const a={command:"PublishStream",ts:Date.now(),url:t,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};O.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(t,", mode: ").concat(r));const l=await this.taskMutex.lock();if(!this.connection&&s)return void l();if(this.streamingTasks.get(t)&&!s)return l(),new me($.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(r))}catch(p){throw l(),p}switch(r){case Jc.TRANSCODE:a.transcodingConfig=Ls({},this.transcodingConfig);case Jc.RAW:}this.uapResponse&&this.uapResponse.vid&&(a.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const u=this.lastTaskId++;try{const p=new Ye((g,E)=>{ai(this.retryTimeout).then(()=>{if(s)return E(s);const y=this.statusError.get(t);return y?(this.statusError.delete(t),E(y)):void 0})}),m=await Ye.race([this.connection.request("request",{clientRequest:a},!0,{url:t,command:"PublishStream",workerType:r===Jc.TRANSCODE?1:2,requestByUser:!s,tid:u.toString()}),p]);this.isStartingStreamingTask=!1,O.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(m.code)),this.streamingTasks.set(t,{clientRequest:a,mode:r,url:t,taskId:u}),l()}catch(p){if(l(),this.isStartingStreamingTask=!1,!p.data||!p.data.retry||s)throw p;return p.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(t,r,p)):await this.startLiveStreamingTask(t,r,p)}}stopLiveStreamingTask(t){return new Ye((r,s)=>{const a=this.streamingTasks.get(t);if(!a||!this.connection)return new me($.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const l=a.mode;a.abortTask=()=>{O.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(t),r()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:a.url}},!1,{url:t,command:"UnPublishStream",workerType:l===Jc.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(u=>{O.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(u.code)),this.streamingTasks.delete(t),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),r()}).catch(s)})}resetAllTask(){var t;const r=Array.from($s(t=this.streamingTasks).call(t));this.terminate();for(const s of r)this.startLiveStreamingTask(s.url,s.mode).catch(a=>{this.onLiveStreamError&&this.onLiveStreamError(s.url,a)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=_s.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(t){if(this.connection)throw new me($.UNEXPECTED_ERROR,"live streaming connection has already connected");const r=await Si(this,d1.REQUEST_WORKER_MANAGER_LIST,t);return this.uapResponse=r,this.connection=new Ppe(r.workerToken,this.spec,this.wsRetryConfig,t),this.connection.on(kd.WARNING,(s,a)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(a,s)),this.connection.on(kd.PUBLISH_STREAM_STATUS,s=>this.handlePublishStreamServer(s)),this.connection.on(kd.REQUEST_NEW_ADDRESS,(s,a)=>{if(!this.connection)return a(new me($.UNEXPECTED_ERROR,"can not get new live streaming address list"));Si(this,d1.REQUEST_WORKER_MANAGER_LIST,t).then(l=>{this.uapResponse=l,s(l.addressList)}).catch(a)}),await this.connection.init(r.addressList),this.connection}handlePublishStreamServer(t){const r=t.serverStatus&&t.serverStatus.url||"empty_url",s=this.streamingTasks.get(r),a=t.reason;switch(t.code){case Dr.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Dr.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Dr.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Dr.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const u=new me($.LIVE_STREAMING_CDN_ERROR,"",{code:t.code});if(s)return O.error(u.toString()),this.onLiveStreamError&&this.onLiveStreamError(r,u);if(!this.isStartingStreamingTask)return;this.statusError.set(r,u)}case Dr.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const u=new me($.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,a);return this.onLiveStreamWarning&&this.onLiveStreamWarning(r,u)}case Dr.LIVE_STREAM_RESPONSE_WORKER_LOST:case Dr.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var l;if(!this.connection)return;this.connection.tryNextAddress();const u=Array.from($s(l=this.streamingTasks).call(l));for(const p of u)p.abortTask?p.abortTask():(O.warning("[".concat(this.spec.clientId,"] publish stream status code"),t.code,"try to republish",p.url),this.startLiveStreamingTask(p.url,p.mode,new me($.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:t.code})).then(()=>{O.debug("[".concat(this.spec.clientId,"] republish live stream success"),p.url)}).catch(m=>{O.error(m.toString()),this.onLiveStreamError&&this.onLiveStreamError(p.url,m)}));return}}}hasUrl(t){return this.streamingTasks.has(t)}}const Lpe={name:"LiveStreaming",create:function(e){return new kpe(e.joinInfo,e.websocketRetryConfig||Rr,e.httpRetryConfig||Rr)}};function Mpe(e){let t=S9();return function(r,s){let a=r.appId;a!==void 0&&(_n(s,10),al(s,a));let l=r.cid;l!==void 0&&(_n(s,16),_n(s,l));let u=r.cname;u!==void 0&&(_n(s,26),al(s,u));let p=r.deviceId;p!==void 0&&(_n(s,34),al(s,p));let m=r.elapse;m!==void 0&&(_n(s,40),Yd(s,m));let g=r.fileSize;g!==void 0&&(_n(s,48),Yd(s,Yf(g)));let E=r.height;E!==void 0&&(_n(s,56),Yd(s,Yf(E)));let y=r.jpg;y!==void 0&&(_n(s,66),_n(s,y.length),function(xs,Ce){let ke=$f(xs,Ce.length);xs.bytes.set(Ce,ke)}(s,y));let b=r.networkType;b!==void 0&&(_n(s,72),Yd(s,Yf(b)));let C=r.osType;C!==void 0&&(_n(s,80),Yd(s,Yf(C)));let B=r.requestId;B!==void 0&&(_n(s,90),al(s,B));let M=r.sdkVersion;M!==void 0&&(_n(s,98),al(s,M));let F=r.sequence;F!==void 0&&(_n(s,104),Yd(s,Yf(F)));let q=r.sid;q!==void 0&&(_n(s,114),al(s,q));let Y=r.timestamp;Y!==void 0&&(_n(s,120),Yd(s,Y));let re=r.uid;re!==void 0&&(_n(s,128),_n(s,re));let ce=r.vid;ce!==void 0&&(_n(s,136),_n(s,ce));let le=r.width;le!==void 0&&(_n(s,144),Yd(s,Yf(le)));let ae=r.service;ae!==void 0&&(_n(s,152),_n(s,ae));let _e=r.callbackData;_e!==void 0&&(_n(s,162),al(s,_e));let we=r.jpgEncryption;we!==void 0&&(_n(s,168),_n(s,we));let Be=r.requestType;Be!==void 0&&(_n(s,176),_n(s,Be));let Xe=r.scorePorn;Xe!==void 0&&(_n(s,185),gN(s,Xe));let jt=r.scoreSexy;jt!==void 0&&(_n(s,193),gN(s,jt));let kt=r.scoreNeutral;kt!==void 0&&(_n(s,201),gN(s,kt));let Tt=r.scene;Tt!==void 0&&(_n(s,208),_n(s,Tt));let jn=r.ossFilePrefix;jn!==void 0&&(_n(s,218),al(s,jn));let bn=r.serviceVendor;if(bn!==void 0)for(let xs of bn){_n(s,226);let Ce=S9();Fpe(xs,Ce),_n(s,Ce.limit),Hpe(s,Ce),Wpe(Ce)}}(e,t),function(r){let s=r.bytes,a=r.limit;return s.length===a?s:s.subarray(0,a)}(t)}function jpe(e){return function(r){let s={};e:for(;!x9(r);){let a=cl(r);switch(a>>>3){case 0:break e;case 1:s.code=cl(r);break;case 2:s.msg=T9(r,cl(r));break;case 3:{let l=Vpe(r);s.data=Upe(r),r.limit=l;break}default:v9(r,7&a)}}return s}({bytes:t=e,offset:0,limit:t.length});var t}function Upe(e){let t={};e:for(;!x9(e);){let r=cl(e);switch(r>>>3){case 0:break e;case 1:t.requestId=T9(e,cl(e));break;case 2:t.requestType=cl(e)>>>0;break;case 3:t.scorePorn=mN(e);break;case 4:t.scoreSexy=mN(e);break;case 5:t.scoreNeutral=mN(e);break;case 6:t.requestScene=cl(e)>>>0;break;case 7:t.scene=cl(e)>>>0;break;default:v9(e,7&r)}}return t}function Fpe(e,t){let r=e.service;r!==void 0&&(_n(t,8),_n(t,r));let s=e.vendor;s!==void 0&&(_n(t,16),_n(t,s));let a=e.token;a!==void 0&&(_n(t,26),al(t,a));let l=e.callbackUrl;l!==void 0&&(_n(t,34),al(t,l))}function Vpe(e){let t=cl(e),r=e.limit;return e.limit=e.offset+t,r}function v9(e,t){switch(t){case 0:for(;128&b9(e););break;case 2:pN(e,cl(e));break;case 5:pN(e,4);break;case 1:pN(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let Bpe=new Float32Array(1);new Uint8Array(Bpe.buffer);let hN=new Float64Array(1),Ms=new Uint8Array(hN.buffer);function Yf(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let y9=[];function S9(){const e=y9.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function Wpe(e){y9.push(e)}function pN(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function x9(e){return e.offset>=e.limit}function $f(e,t){let r=e.bytes,s=e.offset,a=e.limit,l=s+t;if(l>r.length){let u=new Uint8Array(2*l);u.set(r),e.bytes=u}return e.offset=l,l>a&&(e.limit=l),s}function fN(e,t){let r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function T9(e,t){let r=fN(e,t),s=String.fromCharCode,a=e.bytes,l="",u="";for(let p=0;p<t;p++){let m,g,E,y,b=a[p+r];128&b?(224&b)==192?p+1>=t?u+=l:(m=a[p+r+1],(192&m)!=128?u+=l:(y=(31&b)<<6|63&m,y<128?u+=l:(u+=s(y),p++))):(240&b)==224?p+2>=t?u+=l:(m=a[p+r+1],g=a[p+r+2],(49344&(m|g<<8))!=32896?u+=l:(y=(15&b)<<12|(63&m)<<6|63&g,y<2048||y>=55296&&y<=57343?u+=l:(u+=s(y),p+=2))):(248&b)==240?p+3>=t?u+=l:(m=a[p+r+1],g=a[p+r+2],E=a[p+r+3],(12632256&(m|g<<8|E<<16))!=8421504?u+=l:(y=(7&b)<<18|(63&m)<<12|(63&g)<<6|63&E,y<65536||y>1114111?u+=l:(y-=65536,u+=s(55296+(y>>10),56320+(1023&y)),p+=3))):u+=l:u+=s(b)}return u}function al(e,t){let r=t.length,s=0;for(let u=0;u<r;u++){let p=t.charCodeAt(u);p>=55296&&p<=56319&&u+1<r&&(p=(p<<10)+t.charCodeAt(++u)-56613888),s+=p<128?1:p<2048?2:p<65536?3:4}_n(e,s);let a=$f(e,s),l=e.bytes;for(let u=0;u<r;u++){let p=t.charCodeAt(u);p>=55296&&p<=56319&&u+1<r&&(p=(p<<10)+t.charCodeAt(++u)-56613888),p<128?l[a++]=p:(p<2048?l[a++]=p>>6&31|192:(p<65536?l[a++]=p>>12&15|224:(l[a++]=p>>18&7|240,l[a++]=p>>12&63|128),l[a++]=p>>6&63|128),l[a++]=63&p|128)}}function Hpe(e,t){let r=$f(e,t.limit),s=e.bytes,a=t.bytes;for(let l=0,u=t.limit;l<u;l++)s[l+r]=a[l]}function b9(e){return e.bytes[fN(e,1)]}function w9(e,t){let r=$f(e,1);e.bytes[r]=t}function mN(e){let t=fN(e,8),r=e.bytes;return Ms[0]=r[t++],Ms[1]=r[t++],Ms[2]=r[t++],Ms[3]=r[t++],Ms[4]=r[t++],Ms[5]=r[t++],Ms[6]=r[t++],Ms[7]=r[t++],hN[0]}function gN(e,t){let r=$f(e,8),s=e.bytes;hN[0]=t,s[r++]=Ms[0],s[r++]=Ms[1],s[r++]=Ms[2],s[r++]=Ms[3],s[r++]=Ms[4],s[r++]=Ms[5],s[r++]=Ms[6],s[r++]=Ms[7]}function cl(e){let t,r=0,s=0;do t=b9(e),r<32&&(s|=(127&t)<<r),r+=7;while(128&t);return s}function _n(e,t){for(t>>>=0;t>=128;)w9(e,127&t|128),t>>>=7;w9(e,t)}function Yd(e,t){let r=t.low>>>0,s=(t.low>>>28|t.high<<4)>>>0,a=t.high>>>24,l=a===0?s===0?r<16384?r<128?1:2:r<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:a<128?9:10,u=$f(e,l),p=e.bytes;switch(l){case 10:p[u+9]=a>>>7&1;case 9:p[u+8]=l!==9?128|a:127&a;case 8:p[u+7]=l!==8?s>>>21|128:s>>>21&127;case 7:p[u+6]=l!==7?s>>>14|128:s>>>14&127;case 6:p[u+5]=l!==6?s>>>7|128:s>>>7&127;case 5:p[u+4]=l!==5?128|s:127&s;case 4:p[u+3]=l!==4?r>>>21|128:r>>>21&127;case 3:p[u+2]=l!==3?r>>>14|128:r>>>14&127;case 2:p[u+1]=l!==2?r>>>7|128:r>>>7&127;case 1:p[u]=l!==1?128|r:127&r}}function C9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}const Gpe=new Map([["moderation",1],["supervise",2]]);class zpe extends Zn{get connectionState(){return this._connectionState}set connectionState(t){if(this._connectionState===t)return;const r=this._connectionState;this._connectionState=t,this.emit(Zr.CONNECTION_STATE_CHANGE,r,t)}get inspectType(){return this._inspectType}set inspectType(t){var r;this._inspectMode=ma(r=t.map(s=>Gpe.get(s)||0)).call(r,(s,a)=>s+a),this._inspectType=t}get quality(){return this._quality}set quality(t){this._quality=t>1?1:t<.1?.1:t,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(t){super(),z(this,"name","AgoraRTCVideoContentInspect"),z(this,"_connectionState",Ra.CONNECTING),z(this,"_innerConnectionState",void 0),z(this,"sequence",0),z(this,"inspectStartTime",void 0),z(this,"workerManagerConnection",void 0),z(this,"workerConnection",void 0),z(this,"workerMessageLengthLimit",void 0),z(this,"inspectIntervalMinimum",void 0),z(this,"qualityRatio",void 0),z(this,"_connectInfo",void 0),z(this,"_cancelTokenSource",_s.CancelToken.source()),z(this,"_retryConfig",void 0),z(this,"wmSequence",0),z(this,"inspectInterval",void 0),z(this,"inspectTimer",null),z(this,"ossFilePrefix",void 0),z(this,"extraInfo",void 0),z(this,"_inspectType",void 0),z(this,"_inspectMode",void 0),z(this,"_quality",1),z(this,"qualityTimer",null),z(this,"_inspectId",void 0),z(this,"_needWorkUrlOnly",!1),z(this,"inspectImage",()=>{if(this.connectionState!==Ra.CONNECTED)throw new me($.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Ra.CONNECTED?this.requestToInspectImage():O.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=An(5,"inspect-"),this.workerMessageLengthLimit=Z("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=Z("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=Z("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=t.interval,this.ossFilePrefix=t.ossFilePrefix,this.extraInfo=t.extraInfo,this.inspectType=t.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new Eg("worker-manager-"+this._inspectId,Rr),this.on(Zr.STATE_CHANGE,(r,s)=>{this._innerConnectionState=r,O.debug("[".concat(this._inspectId,"] Inspect operation :").concat(Aa[r]," ").concat(s||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new Eg("worker-"+this._inspectId,Rr),this.handleWorkerEvents()}async init(t,r){this.emit(Zr.STATE_CHANGE,Aa.CONNECT_AP),this._connectInfo=t;const s=this._cancelTokenSource.token;return this._retryConfig=r,new Ye((a,l)=>{this.on(Zr.CONNECTION_STATE_CHANGE,(u,p)=>{p===Ra.CONNECTED&&a()}),this.requestAP(t,s,r).then(u=>{this.connectWorkerManager(u)}).catch(u=>{l(u)})})}async requestAP(t,r,s){const a=Z("WEBCS_DOMAIN").map(p=>"https://".concat(p,"/api/v1")),l=await function(p,m,g,E){let{appId:y,areaCode:b,cname:C,sid:B,token:M,uid:F}=m;Mf++;const q="image_moderation_api",Y={service_name:q,json_body:JSON.stringify({appId:y,areaCode:b,cname:C,command:"allocateEdge",requestId:Mf,seq:Mf,sid:B,token:M,ts:Date.now(),uid:F+""})};let re,ce,le=p[0];return oc(async()=>{re=Date.now();const ae=await uc(le,{data:Y,cancelToken:g,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ce=Date.now()-re,ae.code!==0){const Xe=new me($.UNEXPECTED_RESPONSE,"image inspect ap error, code"+ae.code,{retry:!0,responseTime:ce});throw O.error(Xe.toString()),Xe}const _e=JSON.parse(ae.json_body);if(_e.code!==200){const Xe=new me($.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(_e.code,", reason: ").concat(_e.reason),{code:_e.code,responseTime:ce});throw O.error(Xe.toString()),Xe}if(!_e.servers||!Array.isArray(_e.servers)||_e.servers.length===0){const Xe=new me($.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:_e.code,responseTime:ce});throw O.error(Xe.toString()),Xe}const we=Z("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Be=Z("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:_e.servers.map(Xe=>{let{address:jt,wss:kt}=Xe;if(jt&&kt)return"wss://".concat(jt.replace(/\./g,"-"),".").concat(we,":").concat(Be||kt)}).filter(Xe=>!!Xe),workerToken:_e.workerToken,vid:_e.vid,responseTime:ce}},(ae,_e)=>(st.apworkerEvent(B,{success:!0,sc:200,serviceName:q,responseDetail:JSON.stringify(ae.addressList),firstSuccess:_e===0,responseTime:ce,serverIp:p[_e%p.length]}),!1),(ae,_e)=>(st.apworkerEvent(B,{success:!1,sc:ae.data&&ae.data.code||200,serviceName:q,responseTime:ce,serverIp:p[_e%p.length]}),!!(ae.code!==$.OPERATION_ABORTED&&ae.code!==$.UNEXPECTED_RESPONSE||ae.data&&ae.data.retry)&&(le=p[(_e+1)%p.length],!0)),E)}(a,t,r,s);this.emit(Zr.STATE_CHANGE,Aa.AP_CONNECTED);const{addressList:u}=l;return this.wmSequence++,u}async connectWorkerManager(t){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=r,this.emit(Zr.STATE_CHANGE,Aa.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(t,1e4)}async connectWorker(t){await this.workerConnection.init([t])}handleWorkerManagerEvents(){this.workerManagerConnection.on(Pt.CONNECTED,async()=>{this.emit(Zr.STATE_CHANGE,Aa.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.4",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(Pt.CLOSED,()=>{this._innerConnectionState<Aa.GET_WORKER_MANAGER_RESPONSE&&O.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(Pt.FAILED,()=>{this._innerConnectionState<Aa.GET_WORKER_MANAGER_RESPONSE&&O.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(Pt.RECONNECTING,()=>{this._innerConnectionState<Aa.GET_WORKER_MANAGER_RESPONSE&&O.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(Pt.ON_MESSAGE,async t=>{this.emit(Zr.STATE_CHANGE,Aa.GET_WORKER_MANAGER_RESPONSE);const r=this.workerManagerConnection.url;this.workerManagerConnection.close();const s=JSON.parse(t.data);if(s.code!==200)throw O.error("[".concat(this._inspectId,"] Unexpected code ").concat(s.code," from worker manager")),new me($.UNEXPECTED_RESPONSE,"response code of worker is unexpected",s);if(!(s.serverResponse&&s.serverResponse.portWss&&r))throw O.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(s))),new me($.UNEXPECTED_RESPONSE,"response content of worker is unexpected",s);{const a=Z("VIDEO_INSPECT_WORKER_PORT")||s.serverResponse.portWss,l=r.replace(/:\d+\/?$/,":".concat(a));this.emit(Zr.STATE_CHANGE,Aa.CONNECT_WORKER,l),this._needWorkUrlOnly?this.emit(Zr.REQUEST_NEW_WORKER_URL,l):await this.connectWorker(l)}}),this.workerManagerConnection.on(Pt.WILL_RECONNECT,(t,r,s)=>{s(t)}),this.workerManagerConnection.on(Pt.REQUEST_NEW_URLS,(t,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(t).catch(r)})}handleWorkerEvents(){this.workerConnection.on(Pt.CONNECTED,async()=>{this.emit(Zr.STATE_CHANGE,Aa.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Ra.CONNECTED}),this.workerConnection.on(Pt.ON_MESSAGE,async t=>{if(t.data instanceof ArrayBuffer){const s=jpe(new Uint8Array(t.data));if(Z("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&O.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(s)),s.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Zr.INSPECT_RESULT,void 0,void 0);if(s.data&&s.data.scorePorn&&s.data.scoreSexy&&s.data.scoreNeutral){var r;const a={porn:s.data.scorePorn,sexy:s.data.scoreSexy,neutral:s.data.scoreNeutral},l=ma(r=Object.keys(a)).call(r,(p,m)=>a[p]>a[m]?p:m,"porn"),u=Object.keys(a).find(p=>p===l);this.emit(Zr.INSPECT_RESULT,u)}else this.emit(Zr.INSPECT_RESULT,void 0,new me($.UNEXPECTED_RESPONSE,s.code+"","There is an unexpected data on message"))}else this.emit(Zr.INSPECT_RESULT,void 0,new me($.UNEXPECTED_RESPONSE,s.code+"",s.msg))}else O.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Zr.INSPECT_RESULT,void 0,new me($.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(Pt.CLOSED,()=>{this.connectionState=Ra.CLOSED}),this.workerConnection.on(Pt.FAILED,()=>{this.connectionState=Ra.CLOSED}),this.workerConnection.on(Pt.RECONNECTING,()=>{this.connectionState=this.connectionState===Ra.CONNECTED?Ra.RECONNECTING:Ra.CONNECTING}),this.workerConnection.on(Pt.WILL_RECONNECT,(t,r,s)=>{t==="recover"&&s(t),s("tryNext")}),this.workerConnection.on(Pt.REQUEST_NEW_URLS,(t,r)=>{this.workerManagerConnection.close(),this.once(Zr.REQUEST_NEW_WORKER_URL,s=>{t([s])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(s=>{this.connectWorkerManager(s,!0)}).catch(s=>{r(s)})})}async requestToInspectImage(){this.sequence++;const t=mo(this,Zr.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(t){if(!t.isPlaying)return void this.emit(Zr.INSPECT_RESULT,void 0,new me($.INVALID_OPERATION,"Only the track being played can be inspected"));const s=await this.generateRequestData(t,r);this.workerConnection.sendMessage(s,!0,!0)}else this.emit(Zr.INSPECT_RESULT,void 0,new me($.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(t,r){let{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m}=r;const g=Date.now(),E=await t.getCurrentFrameImage("image/jpeg",this.quality),y=await o3(E,s,a),b=this.sequence+"-"+l+"-"+m+"-"+g+"-"+An(12,""),C={appId:s,cid:l,cname:a,deviceId:"",elapse:(B=Number(g-this.inspectStartTime),{low:B|=0,high:B>>31,unsigned:B>=0}),fileSize:y.byteLength,jpgEncryption:2,height:E.height,width:E.width,jpg:y,networkType:6,osType:7,requestId:b,sdkVersion:"4.23.4",sequence:this.sequence,sid:p,timestamp:k6(g),uid:m,vid:u,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var B;this.extraInfo===void 0&&delete C.callbackData,this.ossFilePrefix===void 0&&delete C.ossFilePrefix;const M=Mpe(C);if(M.byteLength<this.workerMessageLengthLimit){if(Z("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const F=function(q){for(var Y=1;Y<arguments.length;Y++){var re=arguments[Y]!=null?arguments[Y]:{};Y%2?C9(Object(re),!0).forEach(function(ce){z(q,ce,re[ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(re)):C9(Object(re)).forEach(function(ce){Object.defineProperty(q,ce,Object.getOwnPropertyDescriptor(re,ce))})}return q}({},C);delete F.jpg,O.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(F))}return M}{const F=this.quality*this.qualityRatio;return this.quality=F,await this.generateRequestData(t,{appId:s,cname:a,cid:l,vid:u,sid:p,uid:m})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=_s.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Ra.CLOSED,this.emit(Zr.STATE_CHANGE,Aa.CLOSED)}}const Kpe={name:"ContentInspect",create:function(e){let{config:t}=e;return function(r){if(!r)throw new me($.INVALID_PARAMS,"inspectConfig is necessary.");if(!r.inspectType||!Array.isArray(r.inspectType))throw new me($.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const s=[...new Set(r.inspectType)];s.forEach(a=>{var l;if(!je(l=["supervise","moderation"]).call(l,a))throw new me($.INVALID_PARAMS,"".concat(a," is not a valid inspect type."))}),r.inspectType=s}if(r&&r.extraInfo&&r.extraInfo.length>1024)throw new me($.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(t),new zpe(t)}};var R9=d($r.Object.getOwnPropertySymbols),qpe=yt,Ype=Ed.indexOf,$pe=JE,_N=oe([].indexOf),A9=!!_N&&1/_N([1],1,-0)<0;qpe({target:"Array",proto:!0,forced:A9||!$pe("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return A9?_N(this,e,t)||0:Ype(this,e,t)}});var Xpe=ho("Array","indexOf"),Jpe=I,Qpe=Xpe,EN=Array.prototype,Zpe=function(e){var t=e.indexOf;return e===EN||Jpe(EN,e)&&t===EN.indexOf?Qpe:t},N9=d(Zpe);function efe(e,t){if(e==null)return{};var r,s,a=function(u,p){if(u==null)return{};var m={};for(var g in u)if({}.hasOwnProperty.call(u,g)){if(N9(p).call(p,g)!==-1)continue;m[g]=u[g]}return m}(e,t);if(R9){var l=R9(e);for(s=0;s<l.length;s++)r=l[s],N9(t).call(t,r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}let I9=class{get localCapabilities(){return er(this._localCapabilities)}get rtpCapabilities(){return er(this._rtpCapabilities)}get candidates(){return er(this._candidates)}get iceParameters(){return er(this._iceParameters)}get dtlsParameters(){return er(this._dtlsParameters)}constructor(e){z(this,"sessionDesc",void 0),z(this,"_localCapabilities",void 0),z(this,"_rtpCapabilities",void 0),z(this,"_candidates",void 0),z(this,"_iceParameters",void 0),z(this,"_dtlsParameters",void 0),z(this,"setup",void 0),z(this,"currentMidIndex",void 0),z(this,"cname","o/i14u9pJrxRKAsu"),z(this,"firefoxSsrcMidMap",new Map),e=er(e);const{remoteIceParameters:t,remoteDtlsParameters:r,candidates:s,remoteRTPCapabilities:a,localCapabilities:l,direction:u,setup:p,videoCodec:m,audioCodec:g}=e;let E;this.setup=p,E=u===cs.RECEIVE_ONLY?Ps(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):Ps(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=a,this._candidates=s,this._iceParameters=t,this._dtlsParameters=r,this._localCapabilities=l;const y=u===cs.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,b=u===cs.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,C=u===cs.RECEIVE_ONLY?a.send.videoCodecs:Sg(Ze.VIDEO,y,b,m),B=u===cs.RECEIVE_ONLY?a.send.audioCodecs:Sg(Ze.AUDIO,y,b,g);for(const M of E.mediaDescriptions)M.attributes.iceUfrag=t.iceUfrag,M.attributes.icePwd=t.icePwd,M.attributes.fingerprints=r.fingerprints,M.attributes.candidates=s,M.attributes.setup=this.setup,M.media.mediaType==="application"&&(M.attributes.sctpPort="5000"),M.media.mediaType==="video"&&(M.media.fmts=C.map(F=>F.payloadType.toString(10)),M.attributes.payloads=C,M.attributes.extmaps=y.videoExtensions),M.media.mediaType==="audio"&&(M.media.fmts=B.map(F=>F.payloadType.toString(10)),M.attributes.payloads=B,M.attributes.extmaps=y.audioExtensions,Lf(M));this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1}toString(){return Pd(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every(t=>this.hasMid(t)):this.sessionDesc.mediaDescriptions.some(t=>t.attributes.mid===e)}send(e,t,r,s,a){r=r.replace(/ /g,"-");const{ssrcs:l,ssrcGroups:u}=Sh(t,this.cname,Z("SYNC_GROUP")?r:void 0),p=this.findPreloadMediaDesc(l);if(p){if(rr()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,p.attributes.mid),a&&(a.twcc||a.remb)){const m=this.sessionDesc.mediaDescriptions.indexOf(p);return this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(p,a),{mid:p.attributes.mid,needExchangeSDP:!0}}return{mid:p.attributes.mid,needExchangeSDP:!1}}{const m=this.findAvailableMediaIndex(e,l,s);let g;return m===-1?(g=this.createOrRecycleSendMedia(e,l,u,"sendonly",s,a),this.updateBundleMids()):(g=er(this.sessionDesc.mediaDescriptions[m]),g.attributes.direction="sendonly",g.attributes.ssrcs=l,g.attributes.ssrcGroups=u,this.sessionDesc.mediaDescriptions[m]=this.mungSendMediaDesc(g,a)),rr()&&this.firefoxSsrcMidMap.set(l[0].ssrcId,g.attributes.mid),{needExchangeSDP:!0,mid:g.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach(r=>{r.attributes.ssrcs=[]}),this.updateBundleMids()}receive(e,t,r){const s=[];return e.forEach(a=>{const l=a._mediaStreamTrack.kind,u=this.findAvailableRecvMediaIndex(l);let p,m=!1;u===-1?(m=!0,p=this.createOrRecycleRecvMedia(a,[],"recvonly",t,r),this.updateBundleMids()):(p=er(this.sessionDesc.mediaDescriptions[u]),p.attributes.direction="recvonly"),s.push({mid:p.attributes.mid,needCreateTransceiver:m})}),s}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>e.indexOf(r.attributes.mid)!==-1);if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:r,address:s,port:a,type:l,relatedAddress:u,relatedPort:p,priority:m}=new RTCIceCandidate(e),g={foundation:t??"",componentId:"1",transport:r??"",priority:m?m+"":"",connectionAddress:s??"",port:a?a+"":"",type:l?l+"":"",relAddr:u??"",relPort:p?p+"":"",extension:{}};this.candidates.some(E=>E.priority===g.priority&&E.connectionAddress===g.connectionAddress&&E.port===g.port)||(this._candidates.push(g),this.sessionDesc.mediaDescriptions.forEach(E=>{E.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,r,s,a){const l=e._mediaStreamTrack.kind,u=this.rtpCapabilities.recv,p=Sg(l,u,this.localCapabilities.send,l===Ze.AUDIO?a:s),m=l===Ze.VIDEO?u.videoExtensions:u.audioExtensions,g="".concat(++this.currentMidIndex);let E={media:{mediaType:l,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(b=>b.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(g)}};E=this.mungRecvMediaDsec(E,e);const y=this.findFirstClosedMedia(l);if(y){const b=this.sessionDesc.mediaDescriptions.indexOf(y);this.sessionDesc.mediaDescriptions[b]=E}else this.sessionDesc.mediaDescriptions.push(E);return E}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>je(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter(r=>je(e).call(e,r.attributes.mid||""));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach(r=>{r.attributes.direction="recvonly"})}findAvailableMediaIndex(e,t,r){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const a=s.media.mediaType===e&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(rr()){if(a){const l=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(l||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!l||l!==s.attributes.mid)}return!1}return a&&s.attributes.mid===r})}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(t=>{const r=t.media.mediaType===e&&t.media.port!=="0"&&(t.attributes.direction==="recvonly"||t.attributes.direction==="sendrecv");return t.attributes.mid!=="0"&&t.attributes.mid!=="1"&&r})}predictReceivingMids(e){const t=[];for(let r=0;r<e;r++)t.push((this.currentMidIndex+r+1).toString(10));return t}restartICE(e){e=er(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd})}createOrRecycleSendMedia(e,t,r,s,a,l){const u=this.rtpCapabilities.send,p=e===Ze.VIDEO?u.videoCodecs:u.audioCodecs,m=e===Ze.VIDEO?u.videoExtensions:u.audioExtensions;rr()&&(a="".concat(++this.currentMidIndex));let g={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:p.map(y=>y.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:m,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:p,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:a}};g=this.mungSendMediaDesc(g,l);const E=this.findFirstClosedMedia(e);if(E){const y=this.sessionDesc.mediaDescriptions.indexOf(E);this.sessionDesc.mediaDescriptions[y]=g}else this.sessionDesc.mediaDescriptions.push(g);return g}mungRecvMediaDsec(e,t,r){const s=er(e);return g1(s),kf(s,t),_1(s,t),y5(s),rS(s,r,this.localCapabilities.send),s}mungSendMediaDesc(e,t){const r=er(e);return rS(r,t,this.localCapabilities.recv),Lf(r),r}updateRecvMedia(e,t){const r=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===e);if(r!==-1){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],t);this.sessionDesc.mediaDescriptions[r]=s}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(t=>{var r;return((r=t.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===e[0].ssrcId})}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(t=>rr()?t.media.port==="0"&&t.media.mediaType===e:t.media.port==="0")}};const tfe=["sdp"];var Fn;function O9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O9(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let D9=(Fn=class sm extends n5{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var t,r;return(t=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&t!==void 0?t:null}get localCodecs(){return[]}set isInRestartIce(t){this._isInRestartIce=t}get isInRestartIce(){return this._isInRestartIce}constructor(t,r,s){super(t,r),z(this,"direction",void 0),z(this,"name",void 0),z(this,"store",void 0),z(this,"spec",void 0),z(this,"peerConnection",void 0),z(this,"initialOffer",void 0),z(this,"transport",void 0),z(this,"statsFilter",void 0),z(this,"localCandidateCount",0),z(this,"_isInRestartIce",!1),z(this,"mutex",void 0),z(this,"onLocalCandidate",void 0),z(this,"remoteSDP",void 0),z(this,"pendingCandidates",[]),z(this,"localCapabilities",void 0),z(this,"isReady",!1),z(this,"restartCnt",0),z(this,"curTurnServerIndex",0),this.store=r,this.spec=t,this.mutex=new Ai("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(sm.resolvePCConfiguration(t,r.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=s??cs.SEND_ONLY,this.name=this.direction===cs.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=NA(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,rr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(t){try{const r=await x5();if(this.localCapabilities=iS(r),t){const{sdp:s}=t,a=efe(t,tfe),l=function(){const E={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},y=yg(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),b={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},C={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},B={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Na(y,E,"videoExtensions",b,C,B),Na(y,E,"videoCodecs",b,C,B),Na(y,E,"audioExtensions",b,C,B),Na(y,E,"audioCodecs",b,C,B),Z("RAISE_H264_BASELINE_PRIORITY")){const M=B.videoCodecs.findIndex(F=>F.rtpMap&&F.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&F.fmtp&&F.fmtp.parameters["profile-level-id"]==="42001f");if(M!==-1){const F=B.videoCodecs.findIndex(q=>q.rtpMap&&q.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(F<M){O.debug("raising H264 baseline profile priority");const q=B.videoCodecs[M];B.videoCodecs.splice(M,1),B.videoCodecs.splice(F,0,q)}F!==-1&&Z("FILTER_SEND_H264_BASELINE")&&(b.videoCodecs=b.videoCodecs.filter(q=>!(q.rtpMap&&q.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&q.fmtp&&q.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:b,recv:C,sendrecv:B}}({},{},s);this.remoteSDP=new I9({remoteIceParameters:a.iceParameters,remoteDtlsParameters:a.dtlsParameters,candidates:[],remoteRTPCapabilities:l,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const u=await this.peerConnection.createAnswer();if(!u.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const p=Ud(u.sdp);await this.peerConnection.setLocalDescription(u);const m=await T5({},{},u.sdp);this.localCapabilities=iS(m);const g=this.peerConnection.getTransceivers()[0];return g!=null&&g.receiver&&g.receiver.transport&&this.tryBindTransportEvents(g.receiver.transport),$d($d({},p),{},{sdp:u.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const a=Ud(s.sdp);return this.initialOffer=s,$d($d({},a),{},{sdp:s.sdp})}}catch(r){throw new Se($.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:r,iceParameters:s,dtlsParameters:a}=t,l=await T5({},{},r);this.remoteSDP=new I9({remoteIceParameters:s,remoteDtlsParameters:a,candidates:[],remoteRTPCapabilities:l,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const u=this.peerConnection.getTransceivers()[0];u!=null&&u.sender&&u.sender.transport&&this.tryBindTransportEvents(u.sender.transport)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async addRemoteCandidate(t){try{t&&this.pendingCandidates.push(t),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(r=>{this.peerConnection.addIceCandidate(r)}),this.pendingCandidates=[])}catch(r){throw new Se($.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(r.toString()))}}send(t,r,s){var a=this;return Go(function*(){const l=yield Zt(a.mutex.lock("From P2PConnection.send"));try{if(!a.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=[],p=a.remoteSDP.receive(t,r,s);t.forEach((F,q)=>{if(p[q].needCreateTransceiver){const Y=a.peerConnection.addTransceiver(F._mediaStreamTrack,{direction:"sendonly"});u.push(Y),F._updateRtpTransceiver(Y)}else{const Y=a.peerConnection.getTransceivers().find(re=>re.mid===p[q].mid);if(!Y)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(p[q].mid));u.push(Y),F._updateRtpTransceiver(Y)}}),rr()&&Z("SIMULCAST")===!0&&(yield Zt(a.applySimulcastForFirefox(u,t)));const m=p.map(F=>F.mid),g=yield Zt(a.peerConnection.createOffer()),E=a.mungSendOfferSDP(g.sdp,t,m),y=Ps(E),b=m.map(F=>{const q=y.mediaDescriptions.find(Y=>Y.attributes.mid===F);if(!q)throw new Error("Cannot extract ssrc from mediaDescription.");return _5(q,Z("USE_PUB_RTX"))}),C=u.map((F,q)=>{const Y=m[q];return{localSSRC:b[q],id:Y}});yield Zt(a.peerConnection.setLocalDescription({type:"offer",sdp:E}));try{yield C}catch(F){const q=a.remoteSDP.toString();throw yield Zt(a.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield Zt(a.peerConnection.setRemoteDescription({type:"answer",sdp:q})),yield Zt(a.stopSending(m,!0)),F}yield Zt(a.applySimulcastEncodings(u,t)),yield Zt(a.applySendEncodings(u,t));const B=a.remoteSDP.toString(),M=a.logSDPExchange(E,"offer","local","send");return M==null||M(B),yield Zt(a.setRemoteDescription({type:"answer",sdp:B})),u.map((F,q)=>{const Y=m[q];return{localSSRC:b[q],id:Y}})}catch(u){throw u instanceof Se?u:new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{l()}})()}async stopSending(t,r){const s=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const a=this.peerConnection.getTransceivers().filter(m=>t.indexOf(m.mid)!==-1);if(a.length!==t.length)throw new Error("Transceivers' length (".concat(a.length,") doesn't match mids' length (").concat(t.length,") when trying to call P2PConnection.stopSending."));a.map(m=>{var g;m.direction="inactive",(g=m.stop)===null||g===void 0||g.call(m)});const l=await this.peerConnection.createOffer(),u=this.logSDPExchange(l.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(l),this.remoteSDP.stopReceiving(t);const p=this.remoteSDP.toString();u==null||u(p),await this.setRemoteDescription({type:"answer",sdp:p})}catch(a){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(a.toString()))}finally{s&&s()}}async receive(t,r,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(t,r,s,a);if(u){const m=this.remoteSDP.toString(),g=this.logSDPExchange(m,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:m});const E=await this.peerConnection.createAnswer(),y=this.mungReceiveAnswerSDP(E.sdp,l,t);g==null||g(y||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:y}),O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."));const p=this.peerConnection.getTransceivers().find(m=>m.mid===l);if(!p||p.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:p.receiver.track,mid:p.mid,transceiver:p}}catch(l){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async mockReceive(t,r,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{mid:l,needExchangeSDP:u}=this.remoteSDP.send(t,r,s,a);if(u){const p=this.remoteSDP.toString(),m=this.logSDPExchange(p,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:p});const g=await this.peerConnection.createAnswer(),E=this.mungReceiveAnswerSDP(g.sdp,l,t);m==null||m(E||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:E}),O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," by exchanging SDP."))}else O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(t," no need to exchange SDP."))}catch(l){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:r});const a=await this.peerConnection.createAnswer();s==null||s(a.sdp||""),await this.peerConnection.setLocalDescription(a)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===ph.Auto&&(this.store.p2pTransport=ph.SdRtn,tn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(sm.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,tn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(sm.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const r=await this.peerConnection.createOffer({iceRestart:!0});if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:s}=Ud(r.sdp);return this.store.descriptionStart(),this.direction===cs.SEND_ONLY&&await this.peerConnection.setLocalDescription(r),s}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===cs.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const r=await this.peerConnection.createAnswer();if(!r.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:s}=Ud(r.sdp);return await this.peerConnection.setLocalDescription(r),s}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}close(){var t;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[r],[t]);this.remoteSDP.updateRecvMedia(t,r);const l=this.remoteSDP.toString(),u=this.logSDPExchange(a,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),u==null||u(l),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new Se($.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(t,r){const s=this.peerConnection.getTransceivers().filter(a=>a.mid===t);s.length===1&&(this.isVP8Simulcast(r)?rr()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const s=this.peerConnection.getTransceivers().find(a=>a.mid===r);s&&await s.sender.replaceTrack(t._mediaStreamTrack)}async getSelectedCandidatePair(){const t=this.peerConnection.getReceivers();if(t.length>0&&t[0].transport&&t[0].transport.iceTransport&&t[0].transport.iceTransport.getSelectedCandidatePair&&t[0].transport.iceTransport.getSelectedCandidatePair()){const r=t[0].transport.iceTransport,{local:s,remote:a}=r.getSelectedCandidatePair();return{local:$d($d({},qc),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:$d($d({},qc),{},{candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t,r;je(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=t=>{if(t.candidate){var r;t.candidate.candidate&&((r=this.onLocalCandidate)===null||r===void 0||r.call(this,t.candidate.toJSON())),this.localCandidateCount+=1}else O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const a={iceServers:[]};var l;return t.iceServers?a.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(og(t.turnServer.servers)?a.iceServers=t.turnServer.servers:(a.iceServers&&a.iceServers.push(...sm.turnServerConfigToIceServers(t.turnServer.servers,r,s)),Z("USE_TURN_SERVER_OF_GATEWAY")&&a.iceServers&&t.turnServer.serversFromGateway&&a.iceServers.push(...sm.turnServerConfigToIceServers(t.turnServer.serversFromGateway,r,s)),je(l=[ph.Relay,ph.SdRtn]).call(l,r)&&(a.iceTransportPolicy="relay"),Z("FORCE_TURN_TCP")?a.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(u=>{u.forceturn&&(a.iceTransportPolicy="relay")}))),Z("ENABLE_ENCODED_TRANSFORM")&&tn().supportWebRTCEncodedTransform&&(a.encodedInsertableStreams=!0),O.debug("P2PConnection p2pTransport is ".concat(r)),a}static turnServerConfigToIceServers(t,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const a=[],l=t.filter(p=>p.tcpport);O.debug("P2PConnection turnServers is ".concat(l,", current index is ").concat(s));const u=l.length>s?l[s]:l[0];switch(r){case ph.SdRtn:const p=t.filter(g=>{var E;return je(E=g.username).call(E,"glb:")&&g.turnServerURL==g.turnServerURL}),m=p.length>s?p[s]:p[0];m&&(a.push({username:m.username,credential:m.password,credentialType:"password",urls:"turn:".concat(Md(m.turnServerURL),":").concat(m.tcpport,"?transport=udp")}),a.push({username:m.username,credential:m.password,credentialType:"password",urls:"turns:".concat(Md(m.turnServerURL),":").concat(m.tcpport,"?transport=tcp")}));break;case ph.Relay:u&&(a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turn:".concat(u.turnServerURL,":").concat(u.tcpport,"?transport=udp")}),a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turns:".concat(Md(u.turnServerURL),":").concat(u.tcpport,"?transport=tcp")}));break;default:u&&(a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turn:".concat(u.turnServerURL,":").concat(u.tcpport,"?transport=udp")}),a.push({username:u.username,credential:u.password,credentialType:"password",urls:"turns:".concat(Md(u.turnServerURL),":").concat(u.tcpport,"?transport=tcp")}),a.push({username:u.username,credential:u.password,credentialType:"password",urls:"stun:".concat(u.turnServerURL,":").concat(u.tcpport)}))}return a}tryBindTransportEvents(t){if(t){this.transport=t,t.onstatechange=()=>{var s;t!=null&&t.state&&((s=this.onDTLSTransportStateChange)===null||s===void 0||s.call(this,t.state))},t.onerror=s=>{var a;(a=this.onDTLSTransportError)===null||a===void 0||a.call(this,"error"in s?s.error:s)};const r=t.iceTransport;r&&(r.onstatechange=()=>{const s=t==null?void 0:t.iceTransport.state;var a;s&&((a=this.onICETransportStateChange)===null||a===void 0||a.call(this,s))},r.getSelectedCandidatePair&&(r.onselectedcandidatepairchange=()=>{if(r.getSelectedCandidatePair()){const{local:s,remote:a}=r.getSelectedCandidatePair();O.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:s.type,protocol:s.protocol}),", remote ").concat(JSON.stringify({candidateType:a.type,protocol:a.protocol,address:a.address,port:a.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(t,r){var s;if(r||(r=this.peerConnection.getSenders().find(E=>E.track===t._mediaStreamTrack)),!r)return O.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(t))return O.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!tn().supportSetRtpSenderParameters)return O.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const a={},l={};switch(t._optimizationMode){case"motion":a.degradationPreference="maintain-framerate";break;case"detail":a.degradationPreference="maintain-resolution";break;default:a.degradationPreference="balanced"}if(t._encoderConfig){var u;const{bitrateMax:E,frameRate:y,scaleResolutionDownBy:b}=t._encoderConfig;E&&(l.maxBitrate=1e3*E),je(u=t._hints).call(u,Tn.LOW_STREAM)&&(y&&(l.maxFramerate=Zs(y)),b&&b>=1&&(l.scaleResolutionDownBy=b))}if(Z("DSCP_TYPE")&&Pl()){var p;const E=Z("DSCP_TYPE");je(p=["very-low","low","medium","high"]).call(p,E)&&(l.networkPriority=E)}const m=r.getParameters(),g=(s=m.encodings)===null||s===void 0?void 0:s[0];rr()&&!g&&(a.encodings=[l]),g&&Object.assign(g,l),Object.assign(m,a),O.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),await r.setParameters(m)}async applySendEncodings(t,r){try{if(!tn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let s=0;s<t.length;s++){const a=t[s],l=r[s];l instanceof Un&&!this.isVP8Simulcast(l)&&await this.updateRtpSenderEncodings(l,a.sender)}}catch{O.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r,s){const a=Ps(t);return r.forEach((l,u)=>{const p=s[u],m=a.mediaDescriptions.find(g=>g.attributes.mid===p);m&&(kf(m,l),S5(m,l,this.store.codec))}),Pd(a)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,t,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onFirstVideoDecodedTimeout=t=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(t,r){if(t.length===r.length)for(let m=0;m<t.length;m++){var s,a,l,u,p;const g=t[m],E=r[m];if(E instanceof Un&&!je(s=E._hints).call(s,Tn.LOW_STREAM)&&(a=E._encoderConfig)!==null&&a!==void 0&&a.bitrateMax&&((l=E._encoderConfig)===null||l===void 0?void 0:l.bitrateMax)>200&&(u=E._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((p=E._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1&&this.store.codec==="vp8"){const y={},b={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};y.encodings=[{rid:"m",active:!0,maxBitrate:b.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:b.high}];const C=g.sender.getParameters();await g.sender.setParameters(Object.assign(C,y))}}}async applySimulcastEncodings(t,r){if(!rr()&&t.length===r.length)for(let s=0;s<t.length;s++){const a=r[s];if(a instanceof Un&&this.isVP8Simulcast(a)){const l=t[s],u={},p={high:1e3*(a._encoderConfig.bitrateMax-50),medium:5e4};u.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:p.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:p.medium,scaleResolutionDownBy:4}];const m=l.sender.getParameters();await l.sender.setParameters(Object.assign(m,u))}}}isVP8Simulcast(t){var r,s,a,l,u;return!!(t instanceof Un&&Z("SIMULCAST")&&this.store.codec==="vp8"&&!je(r=t._hints).call(r,Tn.LOW_STREAM)&&(s=t._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((a=t._encoderConfig)===null||a===void 0?void 0:a.bitrateMax)>200&&(l=t._scalabilityMode)!==null&&l!==void 0&&l.numSpatialLayers&&((u=t._scalabilityMode)===null||u===void 0?void 0:u.numSpatialLayers)>1)}logSDPExchange(t,r,s,a){if(Z("SDP_LOGGING"))return O.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(r," SDP during P2PConnection.").concat(a,`
`),t),r==="offer"?l=>{this.logSDPExchange(l,"answer",s==="local"?"remote":"local",a)}:void 0}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(u=>u.mid&&t.indexOf(u.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(u=>{u.direction="inactive"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(t);const l=this.remoteSDP.toString();a==null||a(l),await this.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(u=>u.mid&&t.indexOf(u.mid)!==-1);if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async u=>{u.direction="sendonly"});const s=await this.peerConnection.createOffer(),a=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(t);const l=this.remoteSDP.toString();a==null||a(l),await this.setRemoteDescription({type:"answer",sdp:l})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}async getRemoteSSRC(t,r){var s;if(r=r??((s=this.currentRemoteDescription)===null||s===void 0?void 0:s.sdp)){var a;const l=(a=Ps(r).mediaDescriptions.find(u=>u.attributes.mid===t))===null||a===void 0?void 0:a.attributes.ssrcs;return l==null?void 0:l[0].ssrcId}}async setRemoteDescription(t){var r;await this.peerConnection.setRemoteDescription(t),je(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(t,r,s){const a=Ps(t),l=a.mediaDescriptions.find(u=>u.attributes.mid===r);return l&&s===Ze.AUDIO&&l.media.mediaType==="audio"&&Lf(l),Pd(a)}},it(Fn.prototype,"establish",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"establish"),Fn.prototype),it(Fn.prototype,"connect",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"connect"),Fn.prototype),it(Fn.prototype,"receive",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"receive"),Fn.prototype),it(Fn.prototype,"mockReceive",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"mockReceive"),Fn.prototype),it(Fn.prototype,"stopReceiving",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"stopReceiving"),Fn.prototype),it(Fn.prototype,"restartICE",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"restartICE"),Fn.prototype),it(Fn.prototype,"close",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"close"),Fn.prototype),it(Fn.prototype,"updateEncoderConfig",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"updateEncoderConfig"),Fn.prototype),it(Fn.prototype,"updateSendParameters",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"updateSendParameters"),Fn.prototype),it(Fn.prototype,"replaceTrack",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"replaceTrack"),Fn.prototype),it(Fn.prototype,"muteLocal",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"muteLocal"),Fn.prototype),it(Fn.prototype,"unmuteLocal",[La],Object.getOwnPropertyDescriptor(Fn.prototype,"unmuteLocal"),Fn.prototype),Fn);function La(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const a=this.mutex,l=await a.lock("From P2PConnection.".concat(t));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},r}let pc=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});var P9,k9,L9,M9,j9,U9,F9,V9,B9,W9,H9,$n;function G9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function MS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G9(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let nfe=(P9=fc(pc.SEND_ONLY),k9=fc(pc.SEND_ONLY),L9=fc(),M9=fc(pc.RECEIVE_ONLY),j9=fc(pc.RECEIVE_ONLY),U9=fc(pc.RECEIVE_ONLY),F9=fc(pc.RECEIVE_ONLY),V9=fc(pc.RECEIVE_ONLY),B9=fc(pc.RECEIVE_ONLY),W9=fc(),H9=fc(pc.RECEIVE_ONLY),$n=class extends Zn{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(ht.StateChange,t,this._state)}constructor(e,t){super(),z(this,"isPlanB",!1),z(this,"store",void 0),z(this,"statsUploader",void 0),z(this,"sendConnection",void 0),z(this,"recvConnection",void 0),z(this,"localTrackMap",new Map),z(this,"remoteUserMap",new Map),z(this,"localDataChannels",[]),z(this,"pendingLocalTracks",[]),z(this,"pendingRemoteTracks",[]),z(this,"statsCollector",void 0),z(this,"dtlsFailedCount",0),z(this,"sendMutex",void 0),z(this,"recvMutex",void 0),z(this,"_state",pn.Disconnected),z(this,"_restartStates",["disconnected","failed"]),z(this,"reconnectInterval",void 0),z(this,"uploadUnplinkStarted",!1),z(this,"uploadDownlinkStarted",!1),z(this,"uplinkStateUploadInterval",void 0),z(this,"downlinkStatsUploadInterval",void 0),z(this,"handleMuteLocalTrack",async(r,s,a)=>{const l=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==pn.Connected)return void a(new Se($.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const m=this.filterTobeMutedTracks(r);if(m.length===0)return void s();const g=m.find(C=>C[0]==="videoLowTrack");g&&g[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(m.map(C=>{let[,{id:B}]=C;return B}));let E=!1;var u,p;r.trackMediaType==="video"?E=!((u=this.localTrackMap.get(Ie.LocalAudioTrack))===null||u===void 0||!u.track._muted):E=((p=this.localTrackMap.get(Ie.LocalVideoTrack))===null||p===void 0?void 0:p.id)===void 0;const y=this.createMuteMessage(m);await Cn(this,ht.RequestMuteLocal,y);const b=r.trackMediaType==="video"?Ld.MUTE_LOCAL_VIDEO:Ld.MUTE_LOCAL_AUDIO;await Cn(this,ht.RequestP2PMuteLocal,{action:b,message:y,isMuteAll:E}),s()}catch(m){a(m)}finally{l()}}),z(this,"handleUnmuteLocalTrack",async(r,s,a)=>{const l=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==pn.Connected)return void a(new Se($.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const u=this.filterTobeUnmutedTracks(r);if(u.length===0)return void s();await this.sendConnection.unmuteLocal(u.map(g=>{let[,{id:E}]=g;return E}));const p=this.createUnmuteMessage(u),m=r.trackMediaType==="video"?Ld.UNMUTE_LOCAL_VIDEO:Ld.UNMUTE_LOCAL_AUDIO;await Cn(this,ht.RequestP2PMuteLocal,{action:m,message:p}),s()}catch(u){a(u)}finally{l()}}),z(this,"handleUpdateVideoEncoder",async(r,s,a,l)=>{let u;typeof l=="boolean"&&l||(u=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const m=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.sendConnection||!m||m.track!==r||this.state!==pn.Connected)return void s();const{id:g,track:E}=m;g&&(await this.sendConnection.updateSendParameters(g,E),await this.sendConnection.updateEncoderConfig(g,E),this.emit(ht.UpdateVideoEncoder,E)),s()}catch(m){a(m)}finally{var p;(p=u)===null||p===void 0||p()}}),z(this,"handleUpdateVideoSendParameters",async(r,s,a)=>{const l=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const u=this.localTrackMap.get(Ie.LocalVideoTrack);if(!this.sendConnection||!u||u.track!==r||this.state!==pn.Connected)return void s();const{id:p,track:m}=u;p&&await this.sendConnection.updateSendParameters(p,m),s()}catch(u){a(u)}finally{l()}}),z(this,"handleReplaceTrack",async(r,s,a,l)=>{let u;O.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof l=="boolean"&&l||(u=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var p;const g=Array.from(this.localTrackMap.entries()).find(E=>{let[,{track:y}]=E;return r===y});if(!this.sendConnection||!g||g[1].id===void 0||this.state!==pn.Connected)return void s();if(await((p=this.sendConnection)===null||p===void 0?void 0:p.replaceTrack(r,g[1].id)),g[0]===Ie.LocalVideoTrack&&tn().supportDualStreamEncoding){const E=this.localTrackMap.get(Ie.LocalVideoLowTrack);if(E){const y=r._mediaStreamTrack.clone();E.track._originMediaStreamTrack.stop(),E.track._mediaStreamTrack=y,E.track._originMediaStreamTrack=y,await new Ye((b,C)=>{this.handleReplaceTrack(E.track,b,C,!0)})}}s()}catch(g){a(g)}finally{var m;(m=u)===null||m===void 0||m()}}),z(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),z(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),z(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),z(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new o6(e),this.bindStatsUploaderEvents(),this.sendMutex=new Ai("P2PChannel2-send-mutex",e.clientId),this.recvMutex=new Ai("P2PChannel2-recv-mutex",e.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(r=>{r&&(r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))})},Z("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new Se($.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new Se($.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let r;try{if(t){this.recvConnection&&(O.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),r=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new D9(e,this.store,cs.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const s=await this.recvConnection.establish(t);return{iceParameters:s.iceParameters,dtlsParameters:s.dtlsParameters,sdp:s.sdp}}{this.state=pn.New,this.sendConnection&&(O.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),r=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new D9(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const s=await this.sendConnection.establish();return{iceParameters:s.iceParameters,dtlsParameters:s.dtlsParameters,sdp:s.sdp}}}finally{r&&r()}}async p2pConnect(e){if(!this.sendConnection)throw new Se($.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=pn.Connected}async addRemoteCandidate(e,t){if(t===cs.RECEIVE_ONLY){if(!this.sendConnection)throw new Se($.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new Se($.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,r){var s=this;return Go(function*(){const a=yield Zt(s.sendMutex.lock("From P2PChannel.publish"));try{if(!s.sendConnection||s.state!==pn.Connected){s.throwIfTrackTypeNotMatch(e);const g=e.filter(E=>s.pendingLocalTracks.indexOf(E)===-1);return void(s.pendingLocalTracks=s.pendingLocalTracks.concat(g))}s.store.pubId=s.store.pubId+1,Oi.markPublishStart(s.store.clientId,s.store.pubId);const l=s.filterTobePublishedTracks(e,t,r);if(l.length===0)return void(yield Zt(s.tryToUnmuteAudio(e)));l.forEach(g=>{let{track:E,type:y}=g;const b=Date.now();s.store.publish(E.getTrackId(),y===Ie.LocalAudioTrack?"audio":"video",b)}),s.bindLocalTrackEvents(l);const u=yield Zt(s.sendConnection.send(l.map(g=>{let{track:E}=g;return E}),s.store.codec,s.store.audioCodec)),p=(yield Zt(u.next())).value,m=s.createGatewayPublishMessage(l,p);try{yield m}catch(g){throw u.throw(g),(g==null?void 0:g.code)===$.WS_ABORT&&l.forEach(E=>{let{track:y}=E;s.pendingLocalTracks.indexOf(y)===-1&&s.pendingLocalTracks.push(y)}),s.unbindLocalTrackEvents(l),g}yield Zt(u.next()),l.forEach(g=>{let{type:E}=g;s.statsCollector.addLocalStats(E)}),s.statsUploader.startUploadOutboundStats(),s.assignLocalTracks(l,p),l.forEach(g=>{let{track:E,type:y}=g;const b=Date.now();s.store.publish(E.getTrackId(),y===Ie.LocalAudioTrack?"audio":"video",void 0,b)}),s.startUploadUplinkState()}finally{a()}})()}async unpublish(e){if(!this.sendConnection||this.state!==pn.Connected)return void(e.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(a=>!je(e).call(e,a)));const t=this.filterTobeUnpublishedTracks(e);if(t.length===0)return;const r=t.find(a=>a[0]==="videoLowTrack");r&&r[1].track.close();const s=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map(a=>{let[,{id:l}]=a;return l})),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map(a=>{let[l,{track:u}]=a;return{type:l,track:u}})),t.forEach(a=>{let[l]=a;this.statsCollector.removeLocalStats(l)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===pn.Connected)return r&&r[1].track.close(),s;e.forEach(a=>{const l=this.pendingLocalTracks.indexOf(a);l!==-1&&this.pendingLocalTracks.splice(l,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const t=[],r=[];Array.from(this.localTrackMap.entries()).forEach(s=>{let[a,{track:l,ssrcs:u}]=s;const p={stream_type:Xue(l,a),ssrcs:u};l._muted||!l._enabled?t.push(p):r.push(p)}),t.length>0&&t.forEach(s=>{Cn(this,ht.RequestMuteLocal,[s])}),r.length>0&&r.forEach(s=>{Cn(this,ht.RequestUnmuteLocal,[s])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return Go(function*(){throw new Se($.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(O.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Si(this,ht.RequestRePublish,this.pendingLocalTracks),this.emit(ht.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new Se($.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,r,s){var a;if(!this.recvConnection)throw new Se($.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((a=this.remoteUserMap.get(e))!==null&&a!==void 0&&a.has(t))return;const{track:l,mid:u,transceiver:p}=await this.recvConnection.receive(t,[{ssrcId:r}],String(e.uid),s);t===Ze.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(l):(e._audioTrack=new Cf(l,e.uid,e._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),p&&e._audioTrack._updateRtpTransceiver(p),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=r,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(l):(e._videoTrack=new wf(l,e.uid,e._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),p&&e._videoTrack._updateRtpTransceiver(p),this.bindRemoteTrackEvents(e,e._videoTrack));const m=this.remoteUserMap.get(e);m?m.set(t,u):this.remoteUserMap.set(e,new Map([[t,u]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const g=this.pendingRemoteTracks.findIndex(E=>{let{user:y,kind:b}=E;return y.uid===e.uid&&t===b});g!==-1&&(this.pendingRemoteTracks.splice(g,1),this.emit(ht.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,r,s){if(!this.recvConnection)throw new Se($.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:r}],String(e.uid),s)}async unsubscribe(e,t,r){const s=this.pendingRemoteTracks.filter(l=>{let{user:u,kind:p}=l;return t!==void 0?u.uid===e.uid&&t===p:u.uid===e.uid});if(s.forEach(l=>{const u=this.pendingRemoteTracks.indexOf(l);this.pendingRemoteTracks.splice(u,1)}),this.recvConnection||r||s.forEach(l=>{let{kind:u}=l;var p;if(u===Ze.AUDIO)(p=e._audioTrack)===null||p===void 0||p._destroy(),e._audioTrack=void 0;else if(u===Ze.VIDEO){var m;(m=e._videoTrack)===null||m===void 0||m._destroy(),e._videoTrack=void 0}}),!this.recvConnection)return;const a=this.filterTobeUnSubscribedTracks(e,t);a.length!==0&&(await this.recvConnection.stopReceiving(a.map(l=>{let[,{id:u}]=l;return u})),this.withdrawRemoteTracks(a),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),a.forEach(l=>{let[u,{kind:p}]=l;var m,g;if(p===Ze.VIDEO&&u._videoSSRC&&((m=this.recvConnection)===null||m===void 0||m.setStatsRemoteVideoIsReady(u._videoSSRC,!1)),p===Ze.VIDEO)this.unbindRemoteTrackEvents(u._videoTrack),r||((g=u._videoTrack)===null||g===void 0||g._destroy(),u._videoTrack=void 0);else if(p===Ze.AUDIO){var E;this.unbindRemoteTrackEvents(u._audioTrack),!r&&((E=u._audioTrack)===null||E===void 0||E._destroy(),u._audioTrack=void 0)}}),a.forEach(l=>{let[,{kind:u}]=l;Cn(this,ht.RequestP2PMuteRemote,u)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach(t=>{let[,r]=t;[Ze.VIDEO,Ze.AUDIO].forEach(s=>{r.has(s)?Cn(this,ht.RequestP2PUnmuteRemote,s):Cn(this,ht.RequestP2PMuteRemote,s)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new Se($.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new Se($.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new Se($.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new Se($.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;const r=this.remoteUserMap.get(e);if(!r)return void O.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(t))return void O.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const s=t===Ze.VIDEO?e._videoSSRC:e._audioSSRC;s!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(s,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;const r=this.remoteUserMap.get(e);if(!r)return void O.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(t)||O.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."))}getAllTracks(e){const t=this.localTrackMap.get(Ie.LocalAudioTrack);if((t==null?void 0:t.track)instanceof Or){const r=t.track;return Array.from(this.localTrackMap.entries()).filter(s=>{let[a]=s;return a!==Ie.LocalAudioTrack}).filter(s=>{let[a]=s;return!(e&&a===Ie.LocalVideoLowTrack)}).map(s=>{let[,{track:a}]=s;return a}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[s]=r;return!(e&&s===Ie.LocalVideoLowTrack)}).map(r=>{let[,{track:s}]=r;return s})}reportPublishEvent(e,t,r,s,a){if(e){const u=this.localTrackMap.get(Ie.LocalAudioTrack),p=s?this.localTrackMap.get(Ie.LocalVideoLowTrack):this.localTrackMap.get(Ie.LocalVideoTrack);st.publish(this.store.sessionId,{eventElapse:Oi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:u==null?void 0:u.track.getTrackLabel(),videoName:p==null?void 0:p.track.getTrackLabel(),screenshare:(p==null?void 0:p.track._hints.indexOf(Tn.SCREEN_TRACK))!==-1,audio:!!u,video:!!p,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:a})}else{var l;r||(r=[]);const u=r.find(m=>m instanceof dr),p=s?(l=this.localTrackMap.get(Ie.LocalVideoTrack))===null||l===void 0?void 0:l.track:r.find(m=>m instanceof Un);st.publish(this.store.sessionId,{eventElapse:Oi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:u==null?void 0:u.getTrackLabel(),videoName:p==null?void 0:p.getTrackLabel(),screenshare:(p==null?void 0:p._hints.indexOf(Tn.SCREEN_TRACK))!==-1,audio:!!u,video:!!p,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:a})}}reportSubscribeEvent(e,t,r,s){const a=s===Ze.VIDEO?r._videoSSRC:r._audioSSRC;a&&st.subscribe(this.store.sessionId,{succ:e,ec:t,video:s===Ze.VIDEO,audio:s===Ze.AUDIO,peerid:r.uid,subscribeRequestid:s===Ze.VIDEO?r._videoSSRC:r._audioSSRC,p2pid:this.store.p2pId,eventElapse:Oi.measureFromSubscribeStart(this.store.clientId,a)})}reset(){O.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Ai("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Ai("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(Ie.LocalAudioTrack);if((e==null?void 0:e.track)instanceof Or){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach(r=>{t.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=pn.Disconnected}getStats(e){var t,r;return e?(r=this.recvConnection)===null||r===void 0?void 0:r.getStats():(t=this.sendConnection)===null||t===void 0?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return((t=this.recvConnection)===null||t===void 0?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(Ie.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(Ie.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof Un||t&&t.track instanceof dr?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!t||r.has(t))}getRemoteMedia(e){var t;const r=Array.from(_o(t=this.remoteUserMap).call(t)).find(s=>s.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[s]=r;return{uid:s.uid,level:s.audioTrack?100*s.audioTrack._source.getAccurateVolumeLevel():0}});const t=this.localTrackMap.get(Ie.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=th(e).call(e,(r,s)=>r.level-s.level),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(O.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=pn.Reconnecting,Z("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t]=e;var r;t._videoTrack&&t._videoTrack._player&&((r=t._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var t;let[r,{track:s}]=e;switch(r){case Ie.LocalVideoTrack:je(t=s._hints).call(t,Tn.LOW_STREAM)?s.close():this.pendingLocalTracks.push(s);break;case Ie.LocalAudioTrack:s instanceof Or?this.pendingLocalTracks=this.pendingLocalTracks.concat(s.trackList):this.pendingLocalTracks.push(s);case Ie.LocalVideoLowTrack:}}),this.emit(ht.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;Array.from(_o(r).call(r)).forEach(s=>{this.setPendingRemoteMedia(t,s)}),this.emit(ht.MediaReconnectStart,t.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),O.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(const r of this.pendingRemoteTracks){const{user:s,kind:a}=r;if((e instanceof Vd?e.uid:e)===s.uid&&t===a)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let r,s;if(e===cs.SEND_ONLY){if(!this.sendConnection)throw new Se($.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");r=await this.sendMutex.lock("From P2PChannel.restartICE"),s=this.sendConnection}else{if(!this.recvConnection)throw new Se($.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");r=await this.recvMutex.lock("From P2PChannel.restartICE"),s=this.recvConnection}try{if(t){const a=await s.restartICE(t);return s.isInRestartIce=!1,a}{const a=await s.restartICE();if(a){const l=await Si(this,ht.RequestP2PRestartICE,{direction:cs.RECEIVE_ONLY,iceParameter:a});await s.restartICE(l),s.isInRestartIce=!1}}}finally{r()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(Ie.LocalVideoTrack),r=this.localTrackMap.get(Ie.LocalAudioTrack),s=e.videoSend.find(C=>{var B;return C.ssrc===(t==null||(B=t.ssrcs)===null||B===void 0?void 0:B[0].ssrcId)}),a=e.audioSend.find(C=>{var B;return C.ssrc===(r==null||(B=r.ssrcs)===null||B===void 0?void 0:B[0].ssrcId)});if(!s||!a)return 1;const l=mo(this,ht.NeedSignalRTT),u=s?s.rttMs:void 0,p=a?a.rttMs:void 0,m=u&&p?(u+p)/2:u||p,g=(m&&l?(m+l)/2:m||l)||0,E=100*e.sendPacketLossRate*.7/50+.3*g/1500,y=E<.17?1:E<.36?2:E<.59?3:E<.1?4:5,b=t==null?void 0:t.track;if(b&&b._encoderConfig&&b._hints.indexOf(Tn.SCREEN_TRACK)===-1){const C=b._encoderConfig.bitrateMax,B=e.bitrate.actualEncoded;if(C&&B){const M=(1e3*C-B)/(1e3*C);return YB[M<.15?0:M<.3?1:M<.45?2:M<.6?3:4][y]}}return y}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[s]=r;const a=s._audioSSRC,l=s._videoSSRC,u=e.audioRecv.find(B=>B.ssrc===a),p=e.videoRecv.find(B=>B.ssrc===l);if(!u&&!p)return void(t+=1);const m=mo(this,ht.NeedSignalRTT),g=e.rtt,E=(g&&m?(g+m)/2:g||m)||0,y=u?u.jitterMs:void 0,b=e.recvPacketLossRate;let C=.7*b*100/50+.3*E/1500;y&&(C=.6*b*100/50+.2*E/1500+.2*y/400),t+=C<.1?1:C<.17?2:C<.36?3:C<.59?4:5}),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new Ye((t,r)=>{this.handleMuteLocalTrack(e,t,r)})}filterTobePublishedTracks(e,t,r){const s=[],a=tn(),l=this.getAllTracks();e=hf(e=e.filter(m=>l.indexOf(m)===-1));let u=!1,p=!1;for(const m of e){if(m instanceof Un&&(this.localTrackMap.has(Ie.LocalVideoTrack)||u?new Se($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(s.push({track:m,type:Ie.LocalVideoTrack}),u=!0),t)){const g=this.getLowVideoTrack(m,r);s.push({track:g,type:Ie.LocalVideoLowTrack})}if(m instanceof dr){const g=this.localTrackMap.get(Ie.LocalAudioTrack);if(g){if(!(g.track instanceof Or))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(m._bypassWebAudio)throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");g.track.addAudioTrack(m),this.bindLocalAudioTrackEvents(m,!0)}else if(p){const E=s.find(y=>{let{type:b}=y;return b===Ie.LocalAudioTrack});if(!(E.track instanceof Or))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(m._bypassWebAudio)throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");E.track.addAudioTrack(m)}else{if(!a.webAudioMediaStreamDest||m instanceof Or||m._bypassWebAudio)s.push({track:m,type:Ie.LocalAudioTrack});else{const E=new Or;E.addAudioTrack(m),s.push({track:E,type:Ie.LocalAudioTrack})}p=!0}}}return s}filterTobeUnpublishedTracks(e){const t=[],r=this.getAllTracks();e=hf(e=e.filter(s=>r.indexOf(s)!==-1));for(const s of e){if(s instanceof dr){const a=this.localTrackMap.get(Ie.LocalAudioTrack);if(!a)continue;a.track instanceof Or?(a.track.removeAudioTrack(s),this.unbindLocalAudioTrackEvents(s),a.track.trackList.length===0&&(t.push([Ie.LocalAudioTrack,a]),a.track.close())):t.push([Ie.LocalAudioTrack,a])}if(s instanceof Un){const a=this.localTrackMap.get(Ie.LocalVideoTrack);if(!a)continue;t.push([Ie.LocalVideoTrack,a]);const l=this.localTrackMap.get(Ie.LocalVideoLowTrack);l&&t.push([Ie.LocalVideoLowTrack,l])}}return t}bindLocalTrackEvents(e){e.forEach(t=>{let{track:r,type:s}=t;switch(s){case Ie.LocalVideoTrack:r.addListener(rt.GET_STATS,this.handleGetLocalVideoStats),r.addListener(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(rt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(rt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case Ie.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,t){e instanceof Or?e.trackList.forEach(r=>{r.addListener(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(rt.GET_STATS,this.handleGetLocalAudioStats),r.addListener(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(rt.GET_STATS,this.handleGetLocalAudioStats),e.addListener(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(t=>{let[r,{track:s}]=t;return{track:s,type:r}})),e.forEach(t=>{let{track:r,type:s}=t;switch(s){case Ie.LocalVideoTrack:r.off(rt.GET_STATS,this.handleGetLocalVideoStats),r.off(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(rt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(rt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ie.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case Ie.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof Or?e.trackList.forEach(t=>{t.off(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(rt.GET_STATS,this.handleGetLocalAudioStats),t.off(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(rt.GET_STATS,this.handleGetLocalAudioStats),e.off(rt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(rt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(rt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(rt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(rt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof wf&&t.addListener(rt.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),t instanceof Cf&&t.addListener(rt.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(rt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[t,r]=e;r.has(Ze.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),r.has(Ze.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)})}createGatewayPublishMessage(e,t){return e.map((r,s)=>{var a;let l,{track:u,type:p}=r;switch(p){case Ie.LocalAudioTrack:l=gn.Audio;break;case Ie.LocalVideoTrack:l=je(a=u._hints).call(a,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalVideoLowTrack:l=gn.Low}return{kind:p===Ie.LocalAudioTrack?Ze.AUDIO:Ze.VIDEO,stream_type:l,mid:t[s].id,ssrcs:t[s].localSSRC,isMuted:u.muted||!u.enabled}})}createGatewayUnpublishMessage(e){return e.map(t=>{var r;let s,[a,{track:l,ssrcs:u,id:p}]=t;switch(a){case Ie.LocalVideoTrack:s=je(r=l._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoLowTrack:s=gn.Low}return{stream_type:s,ssrcs:u,mid:p}})}assignLocalTracks(e,t){e.forEach((r,s)=>{let{track:a,type:l}=r;this.localTrackMap.set(l,{track:a,id:t[s].id,ssrcs:t[s].localSSRC})})}withdrawLocalTracks(e){e.forEach(t=>{let[r]=t;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var r;O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(ht.PeerConnectionStateChange,t),t!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),t==="connected"&&(e.isInRestartIce=!1),je(r=this._restartStates).call(r,t)&&!e.isInRestartIce&&(t==="disconnected"&&await ai(800),e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="failed"||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=t=>{t!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(t,")")),st.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:t,tag:sr.TRACER}).onSuccess(),this.emit(ht.IceConnectionStateChange,t)},e.onICETransportStateChange=t=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(t,")"))},e.onDTLSTransportStateChange=t=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(t,")"))},e.onDTLSTransportError=t=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(t,")"))},e.onFirstAudioDecoded=t=>{var r;const s=Array.from(_o(r=this.remoteUserMap).call(r)).find(l=>l._audioSSRC===t);var a;s&&(this.store.subscribe(s.uid,"audio",void 0,void 0,void 0,Date.now()),(a=s.audioTrack)===null||a===void 0||a.emit(yf.FIRST_FRAME_DECODED),st.firstRemoteFrame(this.store.sessionId,Fr.FIRST_AUDIO_DECODE,qn.FIRST_AUDIO_DECODE,{peer:s._uintid,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=t=>{var r;const s=Array.from(_o(r=this.remoteUserMap).call(r)).find(a=>a._audioSSRC===t);s&&st.firstRemoteFrame(this.store.sessionId,Fr.FIRST_AUDIO_RECEIVED,qn.FIRST_AUDIO_RECEIVED,{peer:s._uintid,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(t,r,s)=>{this.reportVideoFirstFrameDecoded(t,r,s)},e.onFirstVideoReceived=t=>{var r;const s=Array.from(_o(r=this.remoteUserMap).call(r)).find(a=>a._videoSSRC===t);s&&st.firstRemoteFrame(this.store.sessionId,Fr.FIRST_VIDEO_RECEIVED,qn.FIRST_VIDEO_RECEIVED,{peer:s._uintid,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,t),subscribeRequestid:t,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(t,r)=>{const s=t.candidateType==="relay",a=r.candidateType==="relay";r.candidateType!=="unknown"&&s===a||this.emit(ht.ConnectionTypeChange,s),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(jd(r))," -> ").concat(JSON.stringify(jd(t)),")"))},e.onSelectedRemoteCandidateChanged=(t,r)=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(jd(r))," -> ").concat(JSON.stringify(jd(t)),")"))},e.onFirstVideoDecodedTimeout=t=>{this.reportVideoFirstFrameDecoded(t,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(ht.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const t=e===cs.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,O.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===cs.SEND_ONLY?this.restartICE(e):Si(this,ht.RequestP2PRestartICE,{direction:cs.SEND_ONLY}))}filterTobeMutedTracks(e){const t=[];if(this.getAllTracks().indexOf(e)===-1)return t;const r=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof dr&&(r==null?void 0:r.track)instanceof Or)return r.track.isActive||t.push([Ie.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(a=>{let[,{track:l}]=a;return e===l});if(s&&(t.push(s),s[0]===Ie.LocalVideoTrack)){const a=this.localTrackMap.get(Ie.LocalVideoLowTrack);a&&t.push([Ie.LocalVideoLowTrack,a])}return t}filterTobeUnmutedTracks(e){const t=[],r=this.localTrackMap.get(Ie.LocalAudioTrack);if(e instanceof dr&&(r==null?void 0:r.track)instanceof Or)return r.track.isActive&&t.push([Ie.LocalAudioTrack,r]),t;const s=Array.from(this.localTrackMap.entries()).find(a=>{let[,{track:l}]=a;return e===l});if(s)if(s[0]===Ie.LocalVideoTrack){t.push(s);const a=this.localTrackMap.get(Ie.LocalVideoLowTrack);a&&t.push([Ie.LocalVideoLowTrack,a])}else t.push(s);return t}createMuteMessage(e){return e.map(t=>{var r;let s,[a,{track:l,ssrcs:u,id:p}]=t;switch(a){case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoTrack:s=je(r=l._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalVideoLowTrack:s=gn.Low}return{stream_type:s,ssrcs:u,mid:p}})}createUnmuteMessage(e){return e.map(t=>{var r;let s,[a,{track:l,ssrcs:u,id:p}]=t;switch(a){case Ie.LocalAudioTrack:s=gn.Audio;break;case Ie.LocalVideoTrack:s=je(r=l._hints).call(r,Tn.SCREEN_TRACK)?gn.Screen:gn.High;break;case Ie.LocalVideoLowTrack:s=gn.Low}return{stream_type:s,ssrcs:u,mid:p}})}filterTobeUnSubscribedTracks(e,t){const r=[],s=this.remoteUserMap.get(e);if(!s)return r;if(t){const a=s.get(t);if(!a)return r;r.push([e,{kind:t,id:a}])}else Array.from(s.entries()).forEach(a=>{let[l,u]=a;r.push([e,{kind:l,id:u}])});return r}createUnsubscribeMessage(e){const t=[];return e.forEach(r=>{let[s,{kind:a,id:l}]=r;switch(a){case Ze.VIDEO:return void(s._videoSSRC&&t.push({stream_type:Ze.VIDEO,ssrcId:s._videoSSRC}));case Ze.AUDIO:return void(s._audioSSRC&&t.push({stream_type:Ze.AUDIO,ssrcId:s._audioSSRC}))}}),t}withdrawRemoteTracks(e){e.forEach(t=>{let[r,{kind:s}]=t;const a=this.remoteUserMap.get(r);a&&(a.delete(s),Array.from(a.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){const t=this.localTrackMap.get(Ie.LocalVideoTrack),r=this.localTrackMap.get(Ie.LocalVideoLowTrack);t&&(await t.track.setBitrateLimit(e.uplink),await new Ye((s,a)=>{this.handleUpdateVideoEncoder(t.track,s,a,!0)})),r&&e.low_stream_uplink&&(await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new Ye((s,a)=>{this.handleUpdateVideoEncoder(r.track,s,a,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return e!=="connected"&&t!=="connected"}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof dr){const r=this.filterTobeUnmutedTracks(e[t]);if(r.length===0)continue;const s=this.createUnmuteMessage(r);return void await Cn(this,ht.RequestUnmuteLocal,s)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:t}]=e;return!!t}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!((t=this.recvConnection)===null||t===void 0||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(ht.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(ht.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await ai(TA(this.dtlsFailedCount,Rr)),this.emit(ht.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Ie.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Un)}throwIfTrackTypeNotMatch(e){if(e.filter(t=>t instanceof Un).length>1)throw new Se($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(t=>t instanceof dr).length>1&&(e.some(t=>t instanceof dr&&t._bypassWebAudio)||!tn().webAudioMediaStreamDest))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof Un&&this.pendingLocalTracks.some(r=>r instanceof Un))throw new Se($.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof dr&&this.pendingLocalTracks.some(r=>r instanceof dr)&&(!tn().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof dr&&r._bypassWebAudio)))throw new Se($.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const r=!Z("DISABLE_DUAL_STREAM_USE_ENCODING")&&tn().supportDualStreamEncoding,s=MS(MS({},{width:160,height:120,framerate:15,bitrate:50}),t);let a;a=r?e._mediaStreamTrack.clone():P1(e,s);const l=An(8,"track-low-"),u=new Un(a,MS(MS({},r&&{scaleResolutionDownBy:m1(s,e)}),{},{frameRate:s.framerate,bitrateMax:s.bitrate,bitrateMin:s.bitrate}),void 0,void 0,l);return u.on(fh.TRANSCEIVER_UPDATED,p=>{e._updateRtpTransceiver(p,Ef.LOW_STREAM)}),u._hints.push(Tn.LOW_STREAM),e.addListener(rt.NEED_CLOSE,()=>{u.close()}),u}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,r,s){var a;const l=Array.from(_o(a=this.remoteUserMap).call(a)).find(u=>u._videoSSRC===e);if(l){s||this.store.subscribe(l.uid,"video",void 0,void 0,void 0,void 0,Date.now());const u=this.store.keyMetrics,p=u.subscribe.find(m=>m.userId===l.uid&&m.type==="video");st.firstRemoteVideoDecode(this.store.sessionId,Fr.FIRST_VIDEO_DECODE,qn.FIRST_VIDEO_DECODE,{peer:l._uintid,videowidth:t,videoheight:r,subscribeElapse:Oi.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:u.requestAPEnd||0,apStart:u.requestAPStart||0,joinGwEnd:u.joinGatewayEnd||0,joinGwStart:u.joinGatewayStart||0,pcEnd:u.peerConnectionEnd||0,pcStart:u.peerConnectionStart||0,subscriberEnd:(p==null?void 0:p.subscribeEnd)||0,subscriberStart:(p==null?void 0:p.subscribeStart)||0,videoAddNotify:(p==null?void 0:p.streamAdded)||0,state:s?1:0})}}async remoteMediaSsrcChanged(e,t,r){if(!this.recvConnection)return!1;const s=this.remoteUserMap.get(e);if(!s)return!1;const a=s.get(t);if(!a)return!1;const l=await this.recvConnection.getRemoteSSRC(a);return l!==void 0&&l!==r}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new Se($.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new Se($.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new Se($.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new Se($.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new Se($.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new Se($.NOT_SUPPORTED)}async preConnect(e){throw new Se($.NOT_SUPPORTED)}getEstablishParams(){throw new Se($.NOT_SUPPORTED)}async reSubscribe(e){throw new Se($.NOT_SUPPORTED)}async updateVideoStreamParameter(e,t){throw new Se($.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[t,{track:r}]=e;t===Ie.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,Ef.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},it($n.prototype,"p2pConnect",[P9],Object.getOwnPropertyDescriptor($n.prototype,"p2pConnect"),$n.prototype),it($n.prototype,"unpublish",[k9],Object.getOwnPropertyDescriptor($n.prototype,"unpublish"),$n.prototype),it($n.prototype,"unpublishLowStream",[L9],Object.getOwnPropertyDescriptor($n.prototype,"unpublishLowStream"),$n.prototype),it($n.prototype,"subscribe",[M9],Object.getOwnPropertyDescriptor($n.prototype,"subscribe"),$n.prototype),it($n.prototype,"mockSubscribe",[j9],Object.getOwnPropertyDescriptor($n.prototype,"mockSubscribe"),$n.prototype),it($n.prototype,"unsubscribe",[U9],Object.getOwnPropertyDescriptor($n.prototype,"unsubscribe"),$n.prototype),it($n.prototype,"muteRemote",[F9],Object.getOwnPropertyDescriptor($n.prototype,"muteRemote"),$n.prototype),it($n.prototype,"unmuteRemote",[V9],Object.getOwnPropertyDescriptor($n.prototype,"unmuteRemote"),$n.prototype),it($n.prototype,"hasRemoteMediaWithLock",[B9],Object.getOwnPropertyDescriptor($n.prototype,"hasRemoteMediaWithLock"),$n.prototype),it($n.prototype,"disconnectForReconnect",[W9],Object.getOwnPropertyDescriptor($n.prototype,"disconnectForReconnect"),$n.prototype),it($n.prototype,"remoteMediaSsrcChanged",[H9],Object.getOwnPropertyDescriptor($n.prototype,"remoteMediaSsrcChanged"),$n.prototype),$n);function fc(e){return function(t,r,s){const a=t[r];if(typeof a!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){for(var l=arguments.length,u=new Array(l),p=0;p<l;p++)u[p]=arguments[p];switch(e){case pc.SEND_ONLY:{const m=await this.sendMutex.lock("From P2PChannel2.".concat(r));try{return await a.apply(this,u)}finally{m()}}case pc.RECEIVE_ONLY:{const m=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await a.apply(this,u)}finally{m()}}default:{const m=await this.sendMutex.lock("From P2PChannel2.".concat(r)),g=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await a.apply(this,u)}finally{m(),g()}}}},s}}class Dh extends Zn{constructor(t,r){super(),z(this,"signal",void 0),z(this,"token",void 0),z(this,"tokenTimeout",void 0),z(this,"tokenInterval",void 0),z(this,"_sequence",0),z(this,"userMap",new Map),z(this,"encoder",new TextEncoder),this.signal=t,this.token=r;const s=()=>{this.signal.connectionState===Mn.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(s,1e3):this.tokenInterval=window.setTimeout(s,3*Z("P2P_TOKEN_INTERVAL"))};s()}async send(t,r,s,a,l){var u;if(this.userMap.size===0)return;const p=Array.from($s(u=this.userMap).call(u))[0].token;typeof r!="string"&&(r=JSON.stringify(r)),a=a??An(6,""),l=l??this._sequence++;const m={_id:a,_type:t,_seq:l,_message:r,token:"".concat(this.token,"_").concat(p)};Z("SHOW_P2P_LOG")&&O.debug("send message",m,"noNeedResponse : ".concat(s)),this.splitMessage(JSON.stringify(m)).forEach(E=>{this.signal.request(xt.DATA_STREAM,{payload:Dd(this.encoder.encode(E))})});const g=new Ye((E,y)=>{const b=window.setTimeout(()=>{this.off("res-@".concat(a,"_ack"),C),this.off("res-@".concat(a),M),this.off(Of.ABORT,B),O.debug("[external-signal] request timeout, type: ".concat(t,", requestId: ").concat(a)),this.userMap.size===0?y(new Se($.INVALID_REMOTE_USER)):y(new Se($.TIMEOUT))},Z("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),C=()=>{b&&window.clearTimeout(b),this.off(Of.ABORT,B),s&&E()},B=()=>{b&&window.clearTimeout(b),this.off("res-@".concat(a,"_ack"),C),this.off("res-@".concat(a),M),y(new Se($.EXTERNAL_SIGNAL_ABORT,"type: ".concat(t,", requestId: ").concat(a)))};this.once(Of.ABORT,B),this.once("res-@".concat(a,"_ack"),C);const M=(q,Y)=>{F=!0,b&&window.clearTimeout(b),this.off("res-@".concat(a,"_ack"),C),this.off(Of.ABORT,B),q==="success"?E(Y):y(new Se($.P2P_MESSAGE_FAILED,"request ".concat(t," failed, requestId: ").concat(a)))};let F=!1;s||(this.once("res-@".concat(a),M),ai(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{F||O.warning("external_signal request timeout, type: ".concat(t,", requestId: ").concat(a,", ").concat(m))}))});try{return await g}catch(E){if(E.code===$.TIMEOUT)return await this.send(t,r,s,a,l);throw E}}onMessage(t){var r;const{_uid:s}=t;let a,l=this.userMap.get(s);if(l)a=l.splitMessageMap;else{if(this.userMap.size>0||!("_type"in t)||t._type!==gr.CHECK)return;const{token:g}=t;a=new Map,l={uid:s,isStart:!0,token:g,splitMessageMap:a,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(s,l),this.signal.emit(zt.ON_USER_ONLINE,{uid:s}),this.handleUserOnline()}if("id"in t&&"total"in t){var u;const{id:g,total:E}=t,y=(u=a.get(g))!==null&&u!==void 0?u:[];if(y.push(t),a.has(g)||a.set(g,y),y.length!==E)return;{const b=th(y).call(y,(C,B)=>C.index-B.index).map(C=>C.payload).join("");a.delete(g),(t=JSON.parse(b))._uid=s}}const{_type:p,token:m}=t;if(je(r=[gr.ACK,gr.CHECK]).call(r,p))return p===gr.CHECK&&this.handleCheckToken(l,m),void this.receiveMessage(t);m==="".concat(l.token,"_").concat(this.token)?this.handleReceivedMessage(t):O.debug('Receive unexpected message", '.concat(m,", cur_token: ").concat(l.token,"_").concat(this.token),t)}check(){const t={_id:An(6,""),token:this.token,_type:gr.CHECK};Z("SHOW_P2P_LOG")&&O.debug("send message",t),this.signal.request(xt.DATA_STREAM,{payload:Dd(this.encoder.encode(JSON.stringify(t)))})}ack(t){const r={_id:t,_type:gr.ACK,token:this.token};Z("SHOW_P2P_LOG")&&O.debug("send message",r),this.signal.request(xt.DATA_STREAM,{payload:Dd(this.encoder.encode(JSON.stringify(r)))})}response(t,r,s){this.send(gr.RESPONSE,JSON.stringify({success:!s,message:r}),!0,t)}handleReceivedMessage(t){const r=()=>{this.userMap.forEach(g=>{const{receivedMessagesMap:E,nextExpectedSequenceNumber:y}=g;for(;E.has(y);){const b=E.get(y);E.delete(y),this.receiveMessage(b),g.nextExpectedSequenceNumber++}})};if(!t)return void r();const{_uid:s,_seq:a}=t,l=this.userMap.get(s),{receivedMessagesMap:u,isStart:p,nextExpectedSequenceNumber:m}=l;if(a<m)return this.ack(t._id),void O.debug("[external-signal] receive old message, seq: ".concat(a,", ").concat(t._message));u.set(a,t),p&&a===m&&(this.receiveMessage(t),u.delete(m),l.nextExpectedSequenceNumber++,r())}receiveMessage(t){const{_id:r,_type:s,_message:a,_uid:l}=t;if(Z("SHOW_P2P_LOG")&&O.debug("receive message",t),r){let u;switch(t._type!==gr.ACK&&(a&&(u=JSON.parse(a)),this.ack(t._id)),t._type){case gr.CANDIDATE:case gr.CONTROL:this.signal.emit(s,u,l);break;case gr.PUBLISH:case gr.UNPUBLISH:case gr.RESTART_ICE:case gr.CALL:u.uid=l,Si(this.signal,s,u).then(p=>{this.response(t._id,p)}).catch(()=>{this.response(t._id,void 0,!0)});break;case gr.ACK:this.getListeners("res-@".concat(r,"_ack")).length>0&&this.emit("res-@".concat(r,"_ack"));break;case gr.RESPONSE:{const{success:p,message:m}=u;this.emit("res-@".concat(r),p?"success":"failed",m);break}}}}splitMessage(t){if(t.length<Dh.MAX_MESSAGE_SIZE)return[t];const r=[],{remoteToken:s}=JSON.parse(t),a=An(6,"");let l=0,u=800;const p=Math.ceil(t.length/u);for(;t.length>0;){l++;const m={id:a,index:l,total:p,payload:t.slice(0,u),token:"".concat(this.token,"_").concat(s)};JSON.stringify(m).length>Dh.MAX_MESSAGE_SIZE?u-=50:(r.push(m),t=t.slice(u))}return r.map(m=>JSON.stringify(m))}handleCheckToken(t,r){return t.token!==r?(O.debug("token changed, from ".concat(t.token," to ").concat(r)),this.reset(t.uid,r),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{O.debug("token timeout, ".concat(r)),this.reset(t.uid)},Z("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const t=await Si(this.signal,gr.CALL,void 0),r=await this.send(gr.CALL,t);this.signal.emit(bt.P2P_CONNECTION,r,!0)}async reset(t,r){const s=this.userMap.get(t);s&&(this.emit(Of.ABORT),this.signal.emit(zt.ON_USER_OFFLINE,{uid:s.uid,reason:bue.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),r||(O.debug("change local token from ".concat(r," to ").concat(r)),this.token=An(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Of.ABORT)}}z(Dh,"MAX_SIZE",1),z(Dh,"MAX_MESSAGE_SIZE",1024);class rfe extends Zn{get connectionState(){return this._connectionState}set connectionState(t){t!==this._connectionState&&(this._connectionState=t,t===Mn.CONNECTED?this.emit(bt.WS_CONNECTED):t===Mn.RECONNECTING?this.emit(bt.WS_RECONNECTING,this._websocketReconnectReason):t===Mn.CLOSED&&this.emit(bt.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(t,r){super(),z(this,"_disconnectedReason",void 0),z(this,"_websocketReconnectReason",void 0),z(this,"_connectionState",Mn.CLOSED),z(this,"reconnectToken",void 0),z(this,"p2pToken",void 0),z(this,"websocket",void 0),z(this,"openConnectionTime",void 0),z(this,"clientId",void 0),z(this,"lastMsgTime",Date.now()),z(this,"uploadCache",[]),z(this,"uploadCacheInterval",void 0),z(this,"rttRolling",new vV(5)),z(this,"pingpongTimer",void 0),z(this,"pingpongTimeoutCount",0),z(this,"joinResponse",void 0),z(this,"multiIpOption",void 0),z(this,"initError",void 0),z(this,"spec",void 0),z(this,"store",void 0),z(this,"_external_signal",void 0),z(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(bt.ON_BINARY_DATA,s.data);const a=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(a,"_id")){const l="res-@".concat(a._id);this.emit(l,a._result,a._message)}else if(Object.prototype.hasOwnProperty.call(a,"_type")){switch(a._type){case zt.ON_DATA_STREAM:return void this.handleDataStream(a._message);case zt.MUTE_AUDIO:case zt.MUTE_VIDEO:case zt.ON_P2P_LOST:case zt.ON_USER_ONLINE:return;case zt.ON_USER_OFFLINE:const{uid:l}=a._message;return O.debug("[".concat(this.clientId,"] user-offline uid: ").concat(l)),void this._external_signal.reset(l)}if(this.emit(a._type,a._message),a._type===zt.ON_NOTIFICATION&&this.handleNotification(a._message),a._type===zt.ON_USER_BANNED)switch(a._message.error_code){case 14:this.close(hn.UID_BANNED);break;case 15:this.close(hn.IP_BANNED);break;case 16:this.close(hn.CHANNEL_BANNED)}if(a._type===zt.ON_USER_LICENSE_BANNED)switch(a._message.error_code){case ft.ERR_LICENSE_MISSING:this.close(hn.LICENSE_MISSING);break;case ft.ERR_LICENSE_EXPIRED:this.close(hn.LICENSE_EXPIRED);break;case ft.ERR_LICENSE_MINUTES_EXCEEDED:this.close(hn.LICENSE_MINUTES_EXCEEDED);break;case ft.ERR_LICENSE_PERIOD_INVALID:this.close(hn.LICENSE_PERIOD_INVALID);break;case ft.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(hn.LICENSE_MULTIPLE_SDK_SERVICE);break;case ft.ERR_LICENSE_ILLEGAL:this.close(hn.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=t.clientId,this.spec=t,this.store=r,this.websocket=new p1("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Z("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Z("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===Mn.CONNECTED&&this.reconnect("retry",yi.OFFLINE)}),this.p2pToken=An(6,""),this._external_signal=new Dh(this,this.p2pToken)}async request(t,r,s,a){const l=An(6,""),u={_id:l,_type:t,_message:r},p=this.websocket.connectionID,m=()=>new Ye((B,M)=>{if(this.connectionState===Mn.CONNECTED)return B();const F=()=>{this.off(bt.WS_CLOSED,q),B()},q=()=>{this.off(bt.WS_CONNECTED,F),M(new Se($.WS_ABORT))};this.once(bt.WS_CONNECTED,F),this.once(bt.WS_CLOSED,q)});if(this.connectionState!==Mn.CONNECTING&&this.connectionState!==Mn.RECONNECTING||t===xt.JOIN||t===xt.REJOIN||await m(),this.websocket.sendMessage(u,!0),a)return;const g=new Ye((B,M)=>{let F=!1;const q=(re,ce)=>{F=!0,B({isSuccess:re==="success",message:ce||{}}),this.off(bt.WS_CLOSED,Y),this.off(bt.WS_RECONNECTING,Y),this.emit(bt.REQUEST_SUCCESS,t,r)};this.once("res-@".concat(l),q);const Y=()=>{M(new Se($.WS_ABORT,"type: ".concat(t))),this.off(bt.WS_CLOSED,Y),this.off(bt.WS_RECONNECTING,Y),this.off("res-@".concat(l),q)};this.once(bt.WS_CLOSED,Y),this.once(bt.WS_RECONNECTING,Y),ai(Z("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==p||F||(O.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(t)),this.emit(bt.REQUEST_TIMEOUT,t,r))})});let E=null;try{E=await g}catch(B){if(this.connectionState===Mn.CLOSED||t===xt.LEAVE)throw new Se($.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?B.throw():t===xt.JOIN||t===xt.REJOIN?null:(await m(),await this.request(t,r))}if(E.isSuccess)return E.message;const y=Number(E.message.error_code||E.message.code),b=_g(y),C=new Se($.UNEXPECTED_RESPONSE,"".concat(b.desc,": ").concat(E.message.error_str),{code:y,data:E.message,desc:b.desc});return b.action==="success"?E.message:(O.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(t,", error_code: ").concat(y,", message: ").concat(b.desc,", action: ").concat(b.action)),y===ft.ERR_TOO_MANY_BROADCASTERS?((t===xt.JOIN||t===xt.REJOIN)&&(this.initError=C,this.close()),C.throw()):b.action==="failed"?C.throw():b.action==="quit"?(this.initError=C,this.close(),C.throw()):(y===ft.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,O.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",yi.MULTI_IP)):this.reconnect(b.action,yi.SERVER_ERROR),t===xt.JOIN||t===xt.REJOIN?null:await this.request(t,r)))}waitMessage(t,r){return new Ye(s=>{const a=l=>{(!r||r(l))&&(this.off(t,a),s(l))};this.on(t,a)})}uploadWRTCStats(t){if(!this.store.sessionId)return void O.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:t};this.upload(mg.WRTC_STATS,r)}upload(t,r){const s={_type:t,_message:r};try{this.websocket.sendMessage(s)}catch{const l=Z("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>l&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==Mn.CONNECTED)return;const u=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(u._type,u._message)},Z("UPLOAD_CACHE_INTERVAL")||2e3))}}send(t,r){const s={_type:t,_message:r};this.websocket.sendMessage(s)}async sendExtensionMessage(t,r,s){return await this._external_signal.send(t,r,s)}init(t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new Ye((r,s)=>{this.once(bt.WS_CONNECTED,()=>r(this.joinResponse)),this.once(bt.WS_CLOSED,()=>s(this.initError||new Se($.WS_ABORT))),this.connectionState=Mn.CONNECTING,this.websocket.init(t).catch(s)})}close(t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=t||hn.LEAVE,this.connectionState=Mn.CLOSED,O.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=An(6,""),this._external_signal.clear(),this._external_signal=new Dh(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(bt.ABORT_P2P_EXECUTION);const t=await Si(this,bt.REQUEST_JOIN_INFO),r=await this.request(xt.JOIN,t);if(!r)return this.emit(bt.REPORT_JOIN_GATEWAY,$.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(bt.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=Mn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(t,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(t,r)}handleDataStream(t){try{var r;const s=uh(t.payload),a=new TextDecoder().decode(s),l=JSON.parse(a);"total"in l&&"id"in l||je(r=Object.values(gr)).call(r,l._type)?(l._uid=t.uid,this._external_signal.onMessage(l)):this.emit(zt.ON_DATA_STREAM,t)}catch{this.emit(zt.ON_DATA_STREAM,t)}}handleNotification(t){O.debug("[".concat(this.clientId,"] receive notification: "),t);const r=_g(t.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(hn.UID_BANNED),void this.close()):void this.reconnect(r.action,yi.SERVER_ERROR);O.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const t=Z("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=t&&(O.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Z("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",yi.TIMEOUT):this.request(xt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),Z("REPORT_STATS")&&this.send(xt.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWebsocketEvents(){this.websocket.on(Pt.RECONNECT_CREATE_CONNECTION,t=>{this.emit(bt.WS_RECONNECT_CREATE_CONNECTION,t)}),this.websocket.on(Pt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Pt.CLOSED,()=>{this.connectionState=Mn.CLOSED}),this.websocket.on(Pt.FAILED,()=>{this._disconnectedReason=hn.NETWORK_ERROR,this.connectionState=Mn.CLOSED}),this.websocket.on(Pt.RECONNECTING,t=>{this._websocketReconnectReason=t,this.joinResponse=void 0,this.connectionState===Mn.CONNECTED?this.connectionState=Mn.RECONNECTING:this.connectionState=Mn.CONNECTING}),this.websocket.on(Pt.WILL_RECONNECT,(t,r,s)=>{t!=="retry"?(O.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(t)),this.reconnectToken=void 0):O.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),s(t)}),this.websocket.on(Pt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(t=>{if(this.emit(bt.REPORT_JOIN_GATEWAY,t,this.url||""),t instanceof Se&&t.code===$.UNEXPECTED_RESPONSE&&t.data.code===ft.ERR_NO_AUTHORIZED)return O.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",yi.SERVER_ERROR);O.error("[".concat(this.clientId,"] join gateway request failed"),t.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",yi.SERVER_ERROR):(this.initError=t,this.close())})}),this.websocket.on(Pt.REQUEST_NEW_URLS,(t,r)=>{Si(this,bt.REQUEST_RECOVER,this.multiIpOption).then(t).catch(r)}),this.websocket.on(Pt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(zt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const ife={name:"P2PChannel",create:function(e){let{store:t,statsCollector:r}=e;return new nfe(t,r)},createSubmodule:function(e){let{store:t,spec:r}=e;return new rfe(r,t)}};function z9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function K9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z9(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}class sfe{constructor(t){z(this,"sessionDesc",void 0),z(this,"localCapabilities",void 0),z(this,"rtpCapabilities",void 0),z(this,"candidates",void 0),z(this,"_originCandidates",void 0),z(this,"iceParameters",void 0),z(this,"dtlsParameters",void 0),z(this,"setup",void 0),z(this,"currentMidIndex",void 0),z(this,"cname",void 0),t=er(t);const{iceParameters:r,dtlsParameters:s,candidates:a,rtpCapabilities:l,setup:u,localCapabilities:p,sdkCodec:m,cname:g}=t,E=Ps(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=l,this.candidates=a,this._originCandidates=er(a),this.iceParameters=r,this.dtlsParameters=s,this.setup=u,this.localCapabilities=p,this.cname=g;for(let y=0;y<E.mediaDescriptions.length;y++){const b=E.mediaDescriptions[y];if(b.attributes.iceUfrag=r.iceUfrag,b.attributes.icePwd=r.icePwd,b.attributes.fingerprints=s.fingerprints,b.attributes.candidates=a,b.attributes.setup=u,b.media.mediaType==="video"){b.media.fmts=l.videoCodecs.map(B=>B.payloadType.toString(10));let C=l.videoCodecs.filter(B=>{var M,F;return(M=B.rtpMap)===null||M===void 0?void 0:je(F=M.encodingName.toLowerCase()).call(F,m)});C.length===0&&(C=l.videoCodecs),b.attributes.payloads=C,b.attributes.extmaps=l.videoExtensions}b.media.mediaType==="audio"&&(b.media.fmts=l.audioCodecs.map(C=>C.payloadType.toString(10)),b.attributes.payloads=l.audioCodecs,b.attributes.extmaps=l.audioExtensions),E.mediaDescriptions[y]=this.mungMediaDesc(b)}this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1}toString(){return Pd(this.sessionDesc)}send(t,r,s){const{ssrcs:a,ssrcGroups:l}=Sh(r,this.cname),u=this.sessionDesc.mediaDescriptions.find(g=>t===Ze.VIDEO?g.media.mediaType==="video":g.media.mediaType==="audio"),p=a[0].attributes.label,m=a[0].attributes.mslabel;return u.attributes.ssrcs=u.attributes.ssrcs.concat(a),u.attributes.ssrcGroups=u.attributes.ssrcGroups.concat(l),{id:p,mslabel:m}}batchSend(t){return t.map(r=>{let{kind:s,ssrcMsg:a}=r;return this.send(s,a,void 0)})}stopSending(t){this.sessionDesc.mediaDescriptions.forEach(r=>{const s=[],a=[],l=[];r.attributes.ssrcs.forEach(u=>{je(t).call(t,u.attributes.label||"")?l.push(u):s.push(u)}),r.attributes.ssrcGroups.forEach(u=>{var p;je(p=l.map(m=>m.ssrcId)).call(p,u.ssrcIds[0])||a.push(u)}),r.attributes.ssrcs=s,r.attributes.ssrcGroups=a})}mute(t){const r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(t){const r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===t);if(!r)throw new Error("mediaDescription not found with ".concat(t," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}receive(t,r,s){t.forEach((a,l)=>{const u=a._mediaStreamTrack,p=this.sessionDesc.mediaDescriptions.findIndex(g=>g.attributes.mid===u.kind),m=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[p],a);this.sessionDesc.mediaDescriptions[p]=m})}stopReceiving(t){}updateCandidates(t){const r=this._originCandidates.filter(a=>a.transport==="udp"),s=[];if(r.forEach(a=>{s.push(K9(K9({},a),{},{foundation:"tcpcandidate",priority:Number(a.priority)-1+"",transport:"tcp",port:Number(a.port)+90+""}))}),r.length!==0){switch(t){case Ii.TCP_RELAY:this.candidates=s;break;case Ii.UDP_TCP_RELAY:case Ii.RELAY:this.candidates=[...r,...s];break;default:this.candidates=r}for(const a of this.sessionDesc.mediaDescriptions)a.attributes.candidates=this.candidates}}restartICE(t){t=er(t),this.iceParameters=t,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=t.iceUfrag,r.attributes.icePwd=t.icePwd})}predictReceivingMids(t){const r=[];for(let s=0;s<t;s++)r.push((this.currentMidIndex+s+1).toString(10));return r}mungRecvMediaDsec(t,r){const s=er(t);return kf(s,r),_1(s,r),s}updateRecvMedia(t,r){const s=this.sessionDesc.mediaDescriptions.findIndex(a=>a.attributes.mid===t);if(s!==-1){const a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],r);this.sessionDesc.mediaDescriptions[s]=a}}bumpMid(t){this.currentMidIndex+=t}updateTrackLabel(t,r,s){const a=this.sessionDesc.mediaDescriptions.find(u=>t===Ze.VIDEO?u.attributes.mid==="video":u.attributes.mid==="audio");if(a){const u=a.attributes.ssrcs.find(p=>p.attributes.label===r);var l;u&&(u.attributes.label=s,(l=u.attributes.msid)===null||l===void 0||l.replace(r,s))}}mungMediaDesc(t){const r=er(t);return g1(r),function(s){const a=s.attributes.extmaps.find(l=>nS(l.extensionName));a&&s.attributes.extmaps.splice(s.attributes.extmaps.indexOf(a),1),s.attributes.payloads.forEach(l=>{const u=l.rtcpFeedbacks.findIndex(p=>p.type==="transport-cc");u!==-1&&l.rtcpFeedbacks.splice(u,1)})}(r),r}getSSRC(t){for(const r of this.sessionDesc.mediaDescriptions)for(const s of r.attributes.ssrcs)if(s.attributes.label===t)return[s]}}var Rn;function q9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function jS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q9(Object(r),!0).forEach(function(s){z(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}let ofe=(Rn=class E_ extends r5{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(t=>t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").filter(t=>{var r;return je(r=Object.keys(Dy)).call(r,t)}))]}constructor(t,r){super(t,r),z(this,"store",void 0),z(this,"peerConnection",void 0),z(this,"remoteSDP",void 0),z(this,"initialOffer",void 0),z(this,"statsFilter",void 0),z(this,"useRTX",!1),z(this,"localCapabilities",void 0),z(this,"localCandidateCount",0),z(this,"allCandidatesReceived",!1),z(this,"establishPromise",void 0),z(this,"mutex",void 0),this.store=r,this.mutex=new Ai("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(E_.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=NA(this.peerConnection,Z("STATS_UPDATE_INTERVAL"),void 0,rr()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const t=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!t.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=Ud(t.sdp),s=yg(t.sdp,{filterRTX:!this.useRTX,filterVideoFec:Z("FILTER_VIDEO_FEC"),filterAudioFec:Z("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=s,this.initialOffer=t,jS(jS({},r),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:s},offerSDP:t.sdp})}catch(t){throw new Se($.GET_LOCAL_CONNECTION_PARAMS_FAILED,t.toString())}}async updateRemoteConnect(){}async connect(t){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new sfe(jS(jS({},t),{},{rtpCapabilities:t.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async updateRemoteRTPCapabilities(t,r){throw new Se($.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(t){}send(t,r){var s=this;return Go(function*(){const a=yield Zt(s.mutex.lock());try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const l=t.map(b=>s.peerConnection.addTrack(b._mediaStreamTrack)),u=yield Zt(s.peerConnection.createOffer()),p=Ps(u.sdp),m=t.map(b=>{const C=b._mediaStreamTrack,B=p.mediaDescriptions.find(M=>M.attributes.mid===C.kind);if(!B)throw new Error("Cannot extract ssrc from mediaDescription.");return function(M,F,q){const Y=M.attributes.ssrcs.filter(ce=>ce.attributes.label===F),re=M.attributes.ssrcGroups;if(Y.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(re&&Y.length>1){const ce=re.find(le=>le.ssrcIds.indexOf(Y[0].ssrcId)!==-1);return ce?[{ssrcId:ce.ssrcIds[0],rtx:q?ce.ssrcIds[1]:void 0}]:[{ssrcId:Y[0].ssrcId}]}return[{ssrcId:Y[0].ssrcId}]}(B,C.id,s.useRTX)});let g;try{g=yield m}catch(b){throw l.forEach(C=>{vi()&&C.replaceTrack(null),s.peerConnection.removeTrack(C)}),b}const E=s.mungSendOfferSDP(u.sdp,t);s.remoteSDP.receive(t,r,g);const y=s.remoteSDP.toString();return yield Zt(s.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield Zt(s.applySendEncodings(l,t)),yield Zt(s.peerConnection.setRemoteDescription({type:"answer",sdp:y})),t.map((b,C)=>{const B=b._mediaStreamTrack.id;return{localSSRC:m[C],id:B}})}catch(l){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(l.toString()))}finally{a()}})()}async stopSending(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=this.peerConnection.getSenders().filter(l=>{var u;return t.indexOf(((u=l.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(r.length!==t.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");r.map(l=>{vi()&&l.replaceTrack(null),this.peerConnection.removeTrack(l)});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.remoteSDP.stopReceiving(t);const a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:a})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(r.toString()))}}async receive(t,r,s,a){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(t," before remoteSDP created."));const{id:l,mslabel:u}=this.remoteSDP.send(t,r,a),p=new Ye((E,y)=>{const b=setTimeout(()=>{y(new Error("Cannot receive track, id: ".concat(l)))},1e4),C=B=>{const M=en();if((M.name==="Safari"&&Number(M.version)===11||ss())&&B.track.id!==l&&B.streams[0].id===u){var F;const q=B.streams[0].getTracks()[0];return(F=this.remoteSDP)===null||F===void 0||F.updateTrackLabel(t,l,B.track.id),this.peerConnection.removeEventListener("track",C),clearTimeout(b),void E(q)}if(B.track.id===l)return this.peerConnection.removeEventListener("track",C),clearTimeout(b),void E(B.track)};this.peerConnection.addEventListener("track",C)}),m=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:m});const g=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(g),{track:await p,id:l}}catch(l){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(l.toString()))}}async stopReceiving(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(t);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(t){}async unmuteRemote(t){}async muteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(s=>{var a;return t.indexOf(((a=s.track)===null||a===void 0?void 0:a.id)||"")!==-1});if(r.length!==t.length)throw new Error("sender' length doesn't match mids' length.");r.map(s=>{if(vi()&&s.track)s.track.enabled=!1;else{const a=s.getParameters();a.encodings.forEach(l=>l.active=!1),s.setParameters(a)}})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(l=>{var u;return t.indexOf(((u=l.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(r.length!==t.length)throw new Error("Senders' length doesn't match mids' length.");r.map(async l=>{if(vi()&&l.track)l.track.enabled=!0;else{const u=l.getParameters();u.encodings.forEach(p=>p.active=!0),await l.setParameters(u)}});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s);const a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:a})}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(t){var r=this;return Go(function*(){const s=yield Zt(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const a=tn().supportPCSetConfiguration;if(t===Ii.RELAY&&!a)return;if(a){const g=r.peerConnection.getConfiguration(),E=t===Ii.RELAY?"relay":"all";g.iceTransportPolicy!==E&&(O.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(g.iceTransportPolicy,"] to [").concat(E,"]")),g.iceTransportPolicy=E,r.peerConnection.setConfiguration(g))}t!==Ii.RELAY&&r.remoteSDP.updateCandidates(t);const l=yield Zt(r.peerConnection.createOffer({iceRestart:!0}));if(!l.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const u=Ud(l.sdp),{remoteIceParameters:p}=yield u.iceParameters;r.remoteSDP.restartICE(p);const m=r.remoteSDP.toString();yield Zt(r.peerConnection.setLocalDescription(l)),yield Zt(r.peerConnection.setRemoteDescription({type:"answer",sdp:m}))}catch(a){O.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),a)}finally{s()}})()}close(){var t;this.peerConnection.close(),(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(t){return this.statsFilter.getVideoIsReady(t)}async updateEncoderConfig(t,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),a=this.mungSendOfferSDP(s.sdp,[r]);this.remoteSDP.updateRecvMedia(r._mediaStreamTrack.kind,r);const l=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:a}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:l})}catch(s){throw new Se($.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(t,r){const s=this.peerConnection.getSenders().filter(a=>{var l;return((l=a.track)===null||l===void 0?void 0:l.id)===t});s.length===1&&await this.applySendEncodings(s,[r])}setStatsRemoteVideoIsReady(t,r){this.statsFilter.setVideoIsReady2(t,r)}async replaceTrack(t,r){const s=this.peerConnection.getSenders().find(a=>{var l;return((l=a.track)===null||l===void 0?void 0:l.id)===r});s&&await s.replaceTrack(t._mediaStreamTrack)}createDataChannels(t,r){throw new Se($.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(t){throw new Se($.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var t;(t=this.onICEConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var t;(t=this.onConnectionStateChange)===null||t===void 0||t.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=t=>{t.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Z("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const r={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&t.turnServer.mode!=="off"&&(og(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...E_.turnServerConfigToIceServers(t.turnServer.servers)),Z("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...E_.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(t){const r=[];return t.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}async updateRtpSenderEncodings(t,r){var s;if(r||(r=this.peerConnection.getSenders().find(g=>{var E;return((E=g.track)===null||E===void 0?void 0:E.id)===t._mediaStreamTrack.id})),!r)return O.warn("[".concat(t.getTrackId(),"] no rtpSender found}"));if(!tn().supportSetRtpSenderParameters)return O.warn("Browser not support set rtp-sender parameters");const a={},l={};if(t instanceof Un)switch(t._optimizationMode){case"motion":a.degradationPreference="maintain-framerate";break;case"detail":a.degradationPreference="maintain-resolution";break;default:a.degradationPreference="balanced"}if(Z("DSCP_TYPE")&&Pl()){var u;const g=Z("DSCP_TYPE");je(u=["very-low","low","medium","high"]).call(u,g)&&(l.networkPriority=g)}const p=r.getParameters(),m=(s=p.encodings)===null||s===void 0?void 0:s[0];m&&Object.assign(m,l),Object.assign(p,a),O.debug("[".concat(t.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(p.encodings))),await r.setParameters(p)}async applySendEncodings(t,r){try{if(!tn().supportSetRtpSenderParameters||t.length!==r.length)return;for(let s=0;s<t.length;s++){const a=t[s],l=r[s];a&&l&&await this.updateRtpSenderEncodings(l,a)}}catch{O.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(t,r){const s=Ps(t);return r.forEach((a,l)=>{const u=a._mediaStreamTrack,p=s.mediaDescriptions.find(m=>m.attributes.mid===u.kind);p&&kf(p,a)}),Pd(s)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=t=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoReceived=t=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstAudioDecoded=t=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,t)},this.statsFilter.onFirstVideoDecoded=(t,r,s)=>{var a;(a=this.onFirstVideoDecoded)===null||a===void 0||a.call(this,t,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(t,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,t,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(t,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,t,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const r=this.remoteSDP.batchSend(t).map((l,u)=>{let{id:p,mslabel:m}=l;const{kind:g}=t[u];return new Ye((E,y)=>{const b=setTimeout(()=>{y(new Error("Cannot receive track, id: ".concat(p)))},1e4),C=B=>{const M=en();if(M.name==="Safari"&&Number(M.version)===11&&B.track.id!==p&&B.streams[0].id===m){var F;const q=B.streams[0].getTracks()[0];return(F=this.remoteSDP)===null||F===void 0||F.updateTrackLabel(g,p,B.track.id),this.peerConnection.removeEventListener("track",C),clearTimeout(b),void E({track:q,id:p})}if(B.track.id===p)return this.peerConnection.removeEventListener("track",C),clearTimeout(b),void E({track:B.track,id:p})};this.peerConnection.addEventListener("track",C)})}),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(a),await Ye.all(r)}catch(r){throw new Se($.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async getRemoteSSRC(t){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(t);return r==null?void 0:r[0].ssrcId}setConfiguration(t){if(tn().supportPCSetConfiguration){const r=E_.resolvePCConfiguration(t);this.peerConnection.setConfiguration(r)}}},it(Rn.prototype,"connect",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"connect"),Rn.prototype),it(Rn.prototype,"stopSending",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"stopSending"),Rn.prototype),it(Rn.prototype,"receive",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"receive"),Rn.prototype),it(Rn.prototype,"stopReceiving",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"stopReceiving"),Rn.prototype),it(Rn.prototype,"muteRemote",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"muteRemote"),Rn.prototype),it(Rn.prototype,"unmuteRemote",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"unmuteRemote"),Rn.prototype),it(Rn.prototype,"muteLocal",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"muteLocal"),Rn.prototype),it(Rn.prototype,"unmuteLocal",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"unmuteLocal"),Rn.prototype),it(Rn.prototype,"close",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"close"),Rn.prototype),it(Rn.prototype,"updateEncoderConfig",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"updateEncoderConfig"),Rn.prototype),it(Rn.prototype,"updateSendParameters",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"updateSendParameters"),Rn.prototype),it(Rn.prototype,"replaceTrack",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"replaceTrack"),Rn.prototype),it(Rn.prototype,"getRemoteSSRC",[Jo],Object.getOwnPropertyDescriptor(Rn.prototype,"getRemoteSSRC"),Rn.prototype),Rn);function Jo(e,t,r){const s=e[t];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const a=this.mutex,l=await a.lock("Locking from P2PConnection.".concat(t));try{for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return await s.apply(this,p)}finally{l()}},r}const afe={name:"PlanBConnection",create:function(e){let{store:t,spec:r}=e;return new ofe(r,t)}},cfe={interceptLocalAudioFrame:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tn().supportWebRTCEncodedTransform)return void O.warning("browser not support audio encoded transform");if(Vy.has(e)||!e.track)return;const r={track:e.track};if(Dl()){if(!e.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let a=null;try{a=e.createEncodedStreams()}catch(u){return void O.error("create audio-encoded-streams error",u&&u.message)}const l=new TransformStream({transform(u,p){r.controller||(r.controller=p),e.track&&e.track.id!==r.track.id&&(O.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s));const m=t.metadata&&t.metadata();m?function(g,E){const{chunk:y,controller:b}=E,C=Z("ENABLE_AUDIO_PTS_METADATA")?Ml.AUDIO_64_BIT_PTS:Ml.METADATA;y.data=function(B,M,F){const q=F.byteLength,Y=q+ZA+WB,re=JA+QA+Y,ce=new ArrayBuffer(B.byteLength+re),le=new DataView(ce);le.setUint8(0,BB),le.setUint16(1,Y),le.setUint8(3,M),le.setUint16(4,q);for(let _e=0;_e<q;_e++)le.setUint8(6+_e,F[_e]);const ae=new Uint8Array(le.buffer);return ae.set(new Uint8Array(B),re),ae.buffer}(y.data,C,g),b.enqueue(y)}(m,{sender:e,chunk:u,controller:p}):p.enqueue(u)}});a.readable.pipeThrough(l).pipeTo(a.writable)}else if(vi()){if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const a=Fy(),l=new MessageChannel;await new Ye(p=>a.onmessage=m=>{m.data==="registered"&&p(void 0)});const u=new RTCRtpScriptTransform(a,{name:"audio-metadata-tx",port:l.port2},[l.port2]);e.transform=u,await new Ye(p=>a.onmessage=m=>{m.data==="started"&&p(void 0)}),l.port1.onmessage=p=>{var m;if(p.data.transformed&&e.track&&((m=e.track)===null||m===void 0?void 0:m.id)!==r.track.id)O.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s);else if(p.data.getMetadata){const g=t.metadata&&t.metadata();g&&l.port1.postMessage({metadata:g})}},r.worker=a}function s(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",s)}const a=Vy.get(e);if(a){Vy.delete(e);try{var l,u;(l=a.controller)===null||l===void 0||l.terminate(),(u=a.worker)===null||u===void 0||u.terminate()}catch(p){O.warning(p&&p.message)}}}Vy.set(e,r),e.track.addEventListener("ended",s)},interceptRemoteAudioFrame:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tn().supportWebRTCEncodedTransform)return void O.warning("browser not support audio encoded transform");if(Ky.has(e))return;const r={track:e.track,onMetadata:t.onMetadata};if(Dl()){if(!e.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");dA(cn.CHROME,87,116)||(t.enableTopn=!1);let a=null;try{a=e.createEncodedStreams()}catch(u){return void O.error("create audio-encoded-streams error",u&&u.message)}const l=new TransformStream({transform(u,p){r.controller||(r.controller=p),e.track&&e.track.id!==r.track.id&&(O.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s)),t.enableTopn?function(m,g,E){var y;const b=HB(new DataView(g.data));if(!b)return E.enqueue(g);const C=m.track.id;Gde.set(C,m.track);const B=(y=b.tlv.find(ce=>ce.tag===Ml.AUDIO_LEVEL))===null||y===void 0?void 0:y.value;let M=0;typeof B=="number"&&(M=127-B);const F=Math.round(Math.pow(10,M/60)-1),{selected:q,speaker:Y}=function(ce,le){let ae=Rf.get(ce);if(ae||(ae=function(_e){const we=new zB;return Rf.set(_e,we),cc||(cc=new Wde(Z("TOPN_SILENCE_THRESHOLD")||500),cc.on("ActiveSpeakerChanged",Be=>{Be!=null&&(Hy=Be)})),cc.addSpeakers([we]),we}(ce)),Rf.size<=KB)return{selected:!0,speaker:ae};if(!cc)throw new Error("no active speaker detector");return cc.levelChanged(ae.id,le),Eh=cc.loudest.map(_e=>_e.id),Hy&&!je(Eh).call(Eh,Hy)&&Eh.length>=KB&&Eh.pop(),{selected:je(Eh).call(Eh,ae.id)||ae.id===Hy,speaker:ae}}(m,F),re=function(ce,le,ae){const _e=lc.get(ce)||new Hde(ce,le);return _e.score=ae,lc.set(ce,_e),function(we){if(Gy.set(we,!0),!zy)return void(zy=Date.now());const Be=Date.now();Be-zy>1e3&&(Gy.get(we)?Gy.set(we,!1):(qB(we),Gy.delete(we)),zy=Be)}(ce),_e}(C,m.track,Y.energyScore);re.addSample(q),re.active&&(g.data=b.frame.buffer,E.enqueue(g))}(e,u,p):t.enableMetadata?function(m,g,E){const y=HB(new DataView(m.data));if(!y)return g.enqueue(m);const b=y.tlv.find(C=>C.tag===Ml.METADATA||C.tag===Ml.AUDIO_64_BIT_PTS);b&&E&&b.value instanceof Uint8Array&&E(b.value),m.data=y.frame.buffer,g.enqueue(m)}(u,p,t.onMetadata):p.enqueue(u)}});a.readable.pipeThrough(l).pipeTo(a.writable)}else if(vi()){if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const a=Fy(),l=new MessageChannel;await new Ye(p=>a.onmessage=m=>{m.data==="registered"&&p(void 0)});const u=new RTCRtpScriptTransform(a,{name:"audio-metadata-rx",port:l.port2},[l.port2]);e.transform=u,await new Ye(p=>a.onmessage=m=>{m.data==="started"&&p(void 0)}),l.port1.onmessage=p=>{var m;p.data.transformed&&e.track&&((m=e.track)===null||m===void 0?void 0:m.id)!==r.track.id?(O.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s)):p.data.metadata&&r.onMetadata&&r.onMetadata(p.data.metadata)},r.worker=a}function s(){e.track.removeEventListener("ended",s),function(a){const l=Ky.get(a);if(l){(function(m){const g=Rf.get(m);g&&(Rf.delete(m),cc&&(cc.removeSpeakers([g]),Rf.size===0&&(cc.destroy(),cc=null)))})(a),qB(a.track.id),Ky.delete(a);try{var u,p;(u=l.controller)===null||u===void 0||u.terminate(),(p=l.worker)===null||p===void 0||p.terminate()}catch(m){O.warning(m&&m.message)}}}(e)}Ky.set(e,r),e.track.addEventListener("ended",s)},interceptLocalVideoFrame:async function(e,t){if(!tn().supportWebRTCEncodedTransform)return void O.warning("browser not support video encoded transform");if(qy.has(e)||!e.track)return;const r={track:e.track};if(Dl()){if(!e.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let a=null;try{a=e.createEncodedStreams()}catch(p){return void O.error("create video-encoded-streams error",p&&p.message)}const l=[];t.on("sei-to-send",p=>{l.push(p)});const u=new TransformStream({transform(p,m){r.controller||(r.controller=m),e.track&&e.track.id!==r.track.id&&(O.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s));const g=l.shift();g&&(p.data=function(E,y){const b=function(Y){const re=Y.length;let ce=[],le=0;for(;le<re;)le+2<re&&Y[le]===0&&Y[le+1]===0&&(Y[le+2]===0||Y[le+2]===1||Y[le+2]===2||Y[le+2]===3)?(ce.push(Y[le],Y[le+1],3,Y[le+2]),le+=3):(ce.push(Y[le]),le++);return new Uint8Array(ce)}(y),C=b.length,B=Math.floor(C/255),M=C%255,F=new Uint8Array(6+B+1+C+E.byteLength);F[0]=0,F[1]=0,F[2]=0,F[3]=1,F[4]=6,F[5]=101;let q=0;for(;q<B;)F[6+q]=255,q++;return F[6+q]=M,q++,F.set(b,6+q),F.set(new Uint8Array(E),6+q+C),F.buffer}(p.data,g)),m.enqueue(p)}});a.readable.pipeThrough(u).pipeTo(a.writable)}else{if(!vi())return;{if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const a=Fy(),l=new MessageChannel;await new Ye(p=>a.onmessage=m=>{m.data==="registered"&&p(void 0)});const u=new RTCRtpScriptTransform(a,{name:"sei-tx",port:l.port2},[l.port2]);e.transform=u,await new Ye(p=>a.onmessage=m=>{m.data==="started"&&p(void 0)}),t.on("sei-to-send",p=>{l.port1.postMessage({sei:p})}),l.port1.onmessage=p=>{var m;p.data.transformed&&e.track&&((m=e.track)===null||m===void 0?void 0:m.id)!==r.track.id&&(O.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s))},r.worker=a}}function s(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",s)}const a=qy.get(e);if(a){qy.delete(e);try{var l,u;(l=a.controller)===null||l===void 0||l.terminate(),(u=a.worker)===null||u===void 0||u.terminate()}catch(p){O.warning(p&&p.message)}}}qy.set(e,r),e.track.addEventListener("ended",s)},interceptRemoteVideoFrame:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tn().supportWebRTCEncodedTransform)return void O.warning("browser not support video encoded transform");if(!e.track)return;if(fg.has(e)){const a=fg.get(e);return void(a&&(a.onSei=t.onSei))}const r={track:e.track,onSei:t.onSei};if(Dl()){if(!e.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let a=null;try{a=e.createEncodedStreams()}catch(u){return void O.error("create video-encoded-streams error",u&&u.message)}const l=new TransformStream({transform(u,p){r.controller||(r.controller=p),e.track&&e.track.id!==r.track.id&&(O.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s));const m=function(g){const E=new DataView(g.data);let y=0;for(;y+4<g.data.byteLength;){if(E.getUint8(y+0)===0&&E.getUint8(y+1)===0&&E.getUint8(y+2)===0&&E.getUint8(y+3)===1&&E.getUint8(y+4)===6){let b=y+6,C=0,B=0;for(;(B=E.getUint8(b++))===255;)C+=255;C+=B;const M=zde(g.data,b,C);return new Uint8Array(M)}y++}return null}(u);m&&r.onSei&&r.onSei(m),p.enqueue(u)}});a.readable.pipeThrough(l).pipeTo(a.writable)}else if(vi()){if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const a=Fy(),l=new MessageChannel;await new Ye(p=>a.onmessage=m=>{m.data==="registered"&&p(void 0)});const u=new RTCRtpScriptTransform(a,{name:"sei-rx",port:l.port2},[l.port2]);e.transform=u,await new Ye(p=>a.onmessage=m=>{m.data==="started"&&p(void 0)}),l.port1.onmessage=p=>{var m;p.data.transformed&&e.track&&((m=e.track)===null||m===void 0?void 0:m.id)!==r.track.id?(O.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",s),r.track=e.track,r.track.addEventListener("ended",s)):p.data.sei&&r.onSei&&r.onSei(p.data.sei)},r.worker=a}function s(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",s)}(function(a){const l=fg.get(a);if(l){fg.delete(a);try{var u,p;(u=l.controller)===null||u===void 0||u.terminate(),(p=l.worker)===null||p===void 0||p.terminate()}catch(m){O.warning(m&&m.message)}}})(e)}fg.set(e,r),e.track.addEventListener("ended",s)}},lfe={name:"InterceptFrame",create:()=>cfe};IA(),vn("PROCESS_ID","process-".concat(An(8,""),"-").concat(An(4,""),"-").concat(An(4,""),"-").concat(An(4,""),"-").concat(An(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(t){return void O.error("Error loading sdk config",t.message)}if(e)try{const t=JSON.parse(window.atob(e)),r=Date.now();O.debug("Loading global parameters from cache",t),Object.keys(t).forEach(s=>{if(Object.prototype.hasOwnProperty.call(Wn,s)){const{value:a,expires:l}=t[s];if(l&&l<=r)return;ac[s]=a,Wn[s]=a}})}catch(t){O.error("Error loading mutableParamsCache: ".concat(e),t.message)}}(),Array.isArray(ac.AREAS)&&ac.AREAS.length>0&&x1(ac.AREAS,!0);const Y9=(e,t,r)=>{O.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),vn(e,t,r)};Fd(Dpe,!1),Fd(Lpe,!1),Fd(ghe,!1),Fd(Kpe,!1),Fd(Npe,!1),Fd(ife,!1),Fd(afe,!1),Fd(lfe,!1);const Ar=function(e){const t=new Zn,r=e,s={getListeners:t.getListeners.bind(t),on:(a,l)=>(function(u,p){u===Qc.SECURITY_POLICY_VIOLATION&&A8(p,!0)}(a,l),t.on.bind(t)(a,l)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return R8(R8({},r),s)}({__TRACK_LIST__:_f,VERSION:zo,BUILD:PA,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:Y9,getParameter:Z,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;const r=await async function(s){let a;return tn().supportUnifiedPlan?(s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"}),a=(await s.createOffer()).sdp):a=(await s.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,a}(t);if(!r)return e;t.close(),t=null,e=function(s){const a={video:[],audio:[]};return s.match(/ VP8/i)&&a.video.push("VP8"),s.match(/ VP9/i)&&a.video.push("VP9"),s.match(/ AV1/i)&&a.video.push("AV1"),s.match(/ H264/i)&&a.video.push("H264"),s.match(/ H265/i)&&a.video.push("H265"),s.match(/ opus/i)&&a.audio.push("OPUS"),s.match(/ PCMU/i)&&a.audio.push("PCMU"),s.match(/ PCMA/i)&&a.audio.push("PCMA"),s.match(/ G722/i)&&a.audio.push("G722"),a}(r)}catch(t){throw new me($.CREATE_OFFER_FAILED,t.toString&&t.toString()).print()}return e},checkSystemRequirements:function(){const e=st.reportApiInvoke(null,{name:xr.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:sr.TRACER});let t=!1;try{const l=window.RTCPeerConnection,u=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,p=window.WebSocket;t=!!(l&&u&&p),t&&fA()&&YF(75)&&new l().close()}catch(l){return O.error("check system requirement failed: ",l),!1}let r=!1;const s=en();s.name===cn.CHROME&&Number(s.version)>=58&&(sc.engine.name!=="WebKit"||function(){const l=en();if(Ty()){if(l.os===Ur.MAC_OS)return!0;if(l.os===Ur.IOS){const u=sc.os.version&&sc.os.version.split(".");if(u&&Number(u[0])===14&&u[1]&&Number(u[1])>=3||u&&Number(u[0])>14)return!0}}return!1}())&&(r=!0),(s.name===cn.FIREFOX&&Number(s.version)>=56||s.name===cn.OPERA&&Number(s.version)>=45||s.name===cn.SAFARI&&Number(s.version)>=11||s.name==="WebKit"&&(ss()||xa())&&s.osVersion&&Number(s.osVersion.split(".")[0])>=11||eV()||en().name===cn.QQ)&&(r=!0),O.debug("checkSystemRequirements, api:",t,"browser",r);const a=t&&r;return e.onSuccess(a),a},getDevices:function(e){return xo.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return xo.getRecordingDevices(e)},getCameras:function(e){return xo.getCamerasDevices(e)},getElectronScreenSources:YV,getPlaybackDevices:function(e){return xo.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const r=An(5,"client-"),s=st.reportApiInvoke(null,{id:r,name:xr.CREATE_CLIENT,options:[t],tag:sr.TRACER});try{(function(a){Mr(a.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Mr(a.mode,"config.mode",["rtc","live","p2p"]),a.audioCodec!==void 0&&Mr(a.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),a.proxyServer!==void 0&&oi(a.proxyServer,"config.proxyServer",1,1e4),a.turnServer!==void 0&&cV(a.turnServer),a.httpRetryConfig!==void 0&&aV(a.httpRetryConfig),a.websocketRetryConfig!==void 0&&aV(a.websocketRetryConfig)})(t)}catch(a){throw s.onError(a),a}return(XF(16,0,!0)||JF(16,0,!0))&&(t.codec==="vp9"&&(t.codec="vp8",O.debug("browser not support vp9, force use vp8")),vn("UNSUPPORTED_VIDEO_CODEC",["vp9"])),t.audioCodec===void 0&&(t.audioCodec="opus"),s.onSuccess(),new _he(Da(Da({forceWaitGatewayResponse:!0},t),{},{role:je(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}),r)},createCameraVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Z("CAMERA_CAPTURE_CONFIG"),r=An(8,"track-cam-"),s=st.reportApiInvoke(null,{id:r,tag:sr.TRACER,name:xr.CREATE_CAM_VIDEO_TRACK,options:[Yn({},e),t]});t&&(e.encoderConfig=t);const a=Uy(e);let l=null;O.info("start create camera video track with config",JSON.stringify(e),"trackId",r);try{l=(await So({video:a},r)).getVideoTracks()[0]||null}catch(p){throw s.onError(p),p}if(!l){const p=new Se($.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(p),p.throw(O)}if(e.optimizationMode&&XA(r,l,e,wa(e.encoderConfig)),Z("USE_STANDARD_BITRATE_DEFAULT")){const p=wa(e.encoderConfig);e.encoderConfig=p,delete p.bitrateMax,delete p.bitrateMin}const u=new $A(l,e,a,e.scalabiltyMode?ky(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,r);return s.onSuccess(u.getTrackId()),O.info("create camera video success, trackId:",r),u},createCustomVideoTrack:function(e){const t=An(8,"track-cus-"),r=st.reportApiInvoke(null,{id:t,tag:sr.TRACER,name:xr.CREATE_CUSTOM_VIDEO_TRACK,options:[e]});Z("USE_STANDARD_BITRATE_DEFAULT")&&(delete e.bitrateMax,delete e.bitrateMin);const s=new Un(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?ky(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,t,[Tn.CUSTOM_TRACK]);return r.onSuccess(s.getTrackId()),O.info("create custom video track success with config",e,"trackId",s.getTrackId()),s},createScreenVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const r=typeof t=="object"?function(b){return i3(b)}(t):void 0;r&&(t="auto");const s=An(8,"track-scr-v-"),a=st.reportApiInvoke(null,{id:s,tag:sr.TRACER,name:xr.CREATE_SCREEN_VIDEO_TRACK,options:[Yn({},e),t]});e.encoderConfig?typeof e.encoderConfig=="string"||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const l=function(b){const C={};b.screenSourceType&&(C.mediaSource=b.screenSourceType),b.extensionId&&Dl()&&(C.extensionId=b.extensionId);const{displaySurface:B,selfBrowserSurface:M,surfaceSwitching:F,systemAudio:q,preferCurrentTab:Y}=b;(ng(107)||uA(107)||hA(93))&&(B&&(Mr(B,"displaySurface",["browser","window","monitor"]),C.displaySurface=B),M?(Mr(M,"selfBrowserSurface",["exclude","include"]),C.selfBrowserSurface=M):C.selfBrowserSurface="include",F&&(Mr(F,"surfaceSwitching",["exclude","include"]),C.surfaceSwitching=F)),(ng(105)||uA(105)||hA(91))&&q&&(Mr(q,"systemAudio",["exclude","include"]),C.systemAudio=q),(ng(94)||uA(94)||hA(80))&&Y&&(C.preferCurrentTab=!0),b.electronScreenSourceId&&(C.sourceId=b.electronScreenSourceId);const re=b.encoderConfig?UA(b.encoderConfig):null;return C.mandatory={chromeMediaSource:"desktop",maxWidth:re?re.width:void 0,maxHeight:re?re.height:void 0},re&&(re.frameRate&&(typeof re.frameRate=="number"?(C.mandatory.maxFrameRate=re.frameRate,C.mandatory.minFrameRate=re.frameRate):(C.mandatory.maxFrameRate=re.frameRate.max||re.frameRate.ideal||re.frameRate.exact||void 0,C.mandatory.minFrameRate=re.frameRate.min||re.frameRate.ideal||re.frameRate.exact||void 0),C.frameRate=re.frameRate),re.width&&(C.width=re.width),re.height&&(C.height=re.height)),C}(e);let u=null,p=null;const m=tn();if(!m.supportShareAudio&&t==="enable"){const b=new Se($.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return a.onError(b),b.throw(O)}O.info("start create screen video track with config",e,"withAudio",t,"trackId",s);const g=m.supportShareAudio&&t!=="disable";try{const b=await So({screen:l,screenAudio:g?r||!0:void 0},s);u=b.getVideoTracks()[0]||null,p=b.getAudioTracks()[0]||null}catch(b){throw a.onError(b),b}if(!u){const b=new Se($.UNEXPECTED_ERROR,"can not find track in media stream");return a.onError(b),b.throw(O)}if(!p&&t==="enable"){u&&u.stop();const b=new Se($.SHARE_AUDIO_NOT_ALLOWED);return a.onError(b),b.throw(O)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(XA(s,u,e,e.encoderConfig&&UA(e.encoderConfig)||void 0),e.encoderConfig&&typeof e.encoderConfig!="string"&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const E=new Un(u,e.encoderConfig?UA(e.encoderConfig):{},e.scalabiltyMode?ky(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,s,[Tn.SCREEN_TRACK]);if(!p)return a.onSuccess(E.getTrackId()),O.info("create screen video track success","video:",E.getTrackId()),E;const y=new dr(p,void 0,An(8,"track-scr-a-"),!1);return a.onSuccess([E.getTrackId(),y.getTrackId()]),O.info("create screen video track success","video:",E.getTrackId(),"audio:",y.getTrackId()),[E,y]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=Z("CAMERA_CAPTURE_CONFIG"),s=An(8,"track-mic-"),a=An(8,"track-cam-"),l=st.reportApiInvoke(null,{id:"".concat(s,"-").concat(a),tag:sr.TRACER,name:xr.CREATE_MIC_AND_CAM_TRACKS,options:[e,t,r]});r&&(t.encoderConfig=r);const u=Uy(t),p=s3(e);let m=null,g=null;O.info("start create camera video track(".concat(a,") and microphone audio track(").concat(s,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{const b=await So({audio:p,video:u},"".concat(s,"-").concat(a));m=b.getAudioTracks()[0],g=b.getVideoTracks()[0]}catch(b){throw l.onError(b),b}if(!m||!g){const b=new Se($.UNEXPECTED_ERROR,"can not find tracks in media stream");return l.onError(b),b.throw(O)}if(t.optimizationMode&&XA(a,g,t,wa(t.encoderConfig)),Z("USE_STANDARD_BITRATE_DEFAULT")){const b=wa(t.encoderConfig);t.encoderConfig=b,delete b.bitrateMax,delete b.bitrateMin}const E=new pg(m,e,p,s),y=new $A(g,t,u,t.scalabiltyMode?ky(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,a);return l.onSuccess([E.getTrackId(),y.getTrackId()]),O.info("create camera video track(".concat(a,") and microphone audio track(").concat(s,") success")),[E,y]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=An(8,"track-mic-"),r=st.reportApiInvoke(null,{id:t,tag:sr.TRACER,name:xr.CREATE_MIC_AUDIO_TRACK,options:[e]}),s=s3(e);let a=null;O.info("start create microphone audio track with config",JSON.stringify(e),"trackId",t);try{a=(await So({audio:s},t)).getAudioTracks()[0]||null}catch(u){throw r.onError(u),u}if(!a){const u=new Se($.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(u),u.throw(O)}const l=new pg(a,e,s,t);return r.onSuccess(l.getTrackId()),O.info("create microphone audio track success, trackId:",t),l},createCustomAudioTrack:function(e){const t=An(8,"track-cus-"),r=st.reportApiInvoke(null,{id:t,tag:sr.TRACER,name:xr.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),s=new dr(e.mediaStreamTrack,e.encoderConfig?Ly(e.encoderConfig):{},t,!1);return O.info("create custom audio track success with config",e,"trackId",s.getTrackId()),r.onSuccess(s.getTrackId()),s},createBufferSourceAudioTrack:async function(e){var t;const{cacheOnlineFile:r,encoderConfig:s}=e;let{source:a}=e;const l={source:a instanceof AudioBuffer?"AudioBuffer":a instanceof File?(t=File.name)!==null&&t!==void 0?t:"File":a,cacheOnlineFile:r,encoderConfig:s},u=An(8,"track-buf-"),p=st.reportApiInvoke(null,{id:u,tag:sr.TRACER,name:xr.CREATE_BUFFER_AUDIO_TRACK,options:[l]});if(Z("DISABLE_WEBAUDIO"))throw new Se($.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");O.info("start create buffer source audio track with config",JSON.stringify(l),"trackId",u);const m=a;if(!(a instanceof AudioBuffer))try{a=await async function(y,b){let C=null;if(typeof y=="string"){const M=z3.get(y);if(M)return O.debug("use cached audio resource: ",y),M;try{C=(await oc(()=>_s.get(y,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(F){throw new Se($.FETCH_AUDIO_FILE_FAILED,F.toString())}}else C=await new Ye((F,q)=>{const Y=new FileReader;Y.onload=re=>{re.target?F(re.target.result):q(new Se($.READ_LOCAL_AUDIO_FILE_ERROR))},Y.onerror=()=>{q(new Se($.READ_LOCAL_AUDIO_FILE_ERROR))},Y.readAsArrayBuffer(y)});const B=await function(M){const F=Tf();return new Ye((q,Y)=>{F.decodeAudioData(M,re=>{q(re)},re=>{Y(new Se($.DECODE_AUDIO_FILE_FAILED,re.toString()))})})}(C);return typeof y=="string"&&b&&z3.set(y,B),B}(a,r)}catch(y){return p.onError(y),y.throw(O)}const g=new jde(a),E=new Mde(m,g,s?Ly(s):{},u);return O.info("create buffer source audio track success, trackId:",u),p.onSuccess(E.getTrackId()),E},setAppType:function(e){if(O.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw O.debug("Invalid appType"),new me($.INVALID_PARAMS,"invalid app type",e);vn("APP_TYPE",Math.floor(e))},setLogLevel:function(e){O.setLogLevel(e)},enableLogUpload:function(){Z("USE_NEW_LOG")?vn("UPLOAD_LOG",!0):O.enableLogUpload()},disableLogUpload:function(){Z("USE_NEW_LOG")?vn("UPLOAD_LOG",!1):O.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new K5},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=st.reportApiInvoke(null,{tag:sr.TRACER,name:xr.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof dr||e instanceof Cf)){const m=new me($.INVALID_TRACK,"the parameter is not a audio track");return r.onError(m),m.throw()}t&&t<1e3&&(t=1e3);const s=e instanceof dr?e.getTrackLabel():"remote_track",a=e.getVolumeLevel();let l=a,u=a;const p=Date.now();return new Ye(m=>{const g=setInterval(()=>{const E=e.getVolumeLevel();l=E>l?E:l,u=E<u?E:u;const y=l-u>1e-4,b=Date.now()-p;if(y||b>t){clearInterval(g);const C=y,B={duration:b,deviceLabel:s,maxVolumeLevel:l,result:C};O.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(B))),r.onSuccess(B),m(C)}},200)})},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=st.reportApiInvoke(null,{tag:sr.TRACER,name:xr.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Un||e instanceof wf)){const y=new me($.INVALID_TRACK,"the parameter is not a video track");return r.onError(y),y.throw()}t&&t<1e3&&(t=1e3);const s=e instanceof Un?e.getTrackLabel():"remote_track",a=e.getMediaStreamTrack(!0),l=document.createElement("video");l.style.width="1px",l.style.height="1px",l.setAttribute("muted",""),l.muted=!0,l.setAttribute("playsinline",""),l.controls=!1,(vi()||Ty())&&(l.style.opacity="0.01",l.style.position="fixed",l.style.left="0",l.style.top="0",document.body.appendChild(l)),l.srcObject=new MediaStream([a]),l.play();const u=document.createElement("canvas");u.width=160,u.height=120;let p=0,m=0;try{const y=Date.now();p=await function(b,C,B,M){let F,q=0,Y=null;return new Ye((re,ce)=>{function le(){q>M&&F&&(F(),re(q));const ae=B.getContext("2d");if(!ae){const Be=new me($.UNEXPECTED_ERROR,"can not get canvas 2d context.");return O.error(Be.toString()),void ce(Be)}ae.drawImage(b,0,0,160,120);const _e=ae.getImageData(0,0,B.width,B.height),we=Math.floor(_e.data.length/3);if(Y){for(let Be=0;Be<we;Be+=3)if(_e.data[Be]!==Y[Be])return q+=1,void(Y=_e.data);Y=_e.data}else Y=_e.data}setTimeout(()=>{F&&(F(),re(q))},C),F=HA(()=>{le()},30)})}(l,t,u,4),m=Date.now()-y}catch(y){throw r.onError(y),y}rhe===cn.SAFARI&&(l.pause(),l.remove()),l.srcObject=null;const g=p>4,E={duration:m,changedPicNum:p,deviceLabel:s,result:g};return O.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(E))),r.onSuccess(E),g},setArea:x1,audioElementPlayCenter:Es,resumeAudioContext:function(){Es.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){vhe.processExternalMediaAEC(e)},registerExtensions:function(e){const t=Z("PLUGIN_INFO")||[];e.forEach(r=>{"name"in r&&!je(t).call(t,r.name)&&t.push(r.name);const s=r;s.__registered__=!0,s.logger.hookLog=O.extLog,s.reporter.hookApiInvoke=st.extApiInvoke,s.parameters&&Object.keys(s.parameters).forEach(a=>{s.parameters[a]=Z(a)})}),Y9("PLUGIN_INFO",t)},ChannelMediaRelayError:Nf,ChannelMediaRelayEvent:jl,ChannelMediaRelayState:ks,RemoteStreamFallbackType:Nde,RemoteStreamType:Ade,ConnectionDisconnectedReason:hn,AudienceLatencyLevelType:sde,AREAS:ln,preload:async function(e,t,r,s){return _6(e,t,r,s)}});return Object.defineProperties(Ar,{onAudioAutoplayFailed:{get:()=>To.onAudioAutoplayFailed,set:e=>{To.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>To.onAutoplayFailed,set:e=>{To.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Ar._onSecurityPolicyViolation,set(e){Ar._onSecurityPolicyViolation=e,A8(e)}},__CLIENT_LIST__:{get:()=>Z("SHOW_GLOBAL_CLIENT_LIST")?vh:[]}}),xo.on(mh.CAMERA_DEVICE_CHANGED,e=>{O.info("camera device changed",JSON.stringify(e)),Ar.onCameraChanged&&Ar.onCameraChanged(e),Ar.safeEmit(Qc.CAMERA_CHANGED,e)}),xo.on(mh.RECORDING_DEVICE_CHANGED,e=>{O.info("microphone device changed",JSON.stringify(e)),Ar.onMicrophoneChanged&&Ar.onMicrophoneChanged(e),Ar.safeEmit(Qc.MICROPHONE_CHANGED,e)}),xo.on(mh.PLAYOUT_DEVICE_CHANGED,e=>{O.debug("playout device changed",JSON.stringify(e)),Ar.onPlaybackDeviceChanged&&Ar.onPlaybackDeviceChanged(e),Ar.safeEmit(Qc.PLAYBACK_DEVICE_CHANGED,e)}),Es.onAutoplayFailed=()=>{O.info("detect audio element autoplay failed"),To.onAudioAutoplayFailed&&To.onAudioAutoplayFailed()},yn.on("autoplay-failed",()=>{O.info("detect webaudio autoplay failed"),To.onAudioAutoplayFailed&&To.onAudioAutoplayFailed(),Ar.safeEmit(Qc.AUTOPLAY_FAILED)}),yn.on(li.STATE_CHANGE,(e,t)=>{O.info("audio context state changed: ".concat(t," => ").concat(e)),Ar.onAudioContextStateChanged&&Ar.onAudioContextStateChanged(e,t),Ar.safeEmit(Qc.AUDIO_CONTEXT_STATE_CHANGED,e,t)}),Tr.on(uf.NETWORK_STATE_CHANGE,(e,t)=>{O.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))}),window&&(window.__ARTC__=Ar),Ar})})(uJ);var HCe=uJ.exports;const fI=$T(HCe),n2=({channel:n,uid:i})=>{const o=X.useRef(fI.createClient({mode:"rtc",codec:"vp8"})),c=X.useRef(null),d=X.useRef(null),f=X.useRef(),_=X.useRef(),[v,x]=X.useState(!1),T=async()=>{console.log("join call button clicked."),x(!0);try{const R=await Jn.get("https://astro-talk-backend.onrender.com/web/agora/astro/token",{params:{channelname:n,Uid:i}}),{appId:I,token:j}=R.data;console.log("response data",R),await o.current.join("f9380eb239b64da997b887ea4823b509",n,j,i),c.current=await fI.createMicrophoneAudioTrack(),d.current=await fI.createCameraVideoTrack(),d.current.play(f.current),await o.current.publish([c.current,d.current]),o.current.on("user-published",async(P,k)=>{await o.current.subscribe(P,k),k==="video"&&P.videoTrack.play(_.current),k==="audio"&&P.audioTrack.play()}),o.current.on("user-unpublished",()=>{_.current.innerHTML=""})}catch(R){console.error("Failed to join call:",R),x(!1)}},w=async()=>{try{c.current&&(c.current.stop(),c.current.close()),d.current&&(d.current.stop(),d.current.close()),await o.current.leave(),x(!1)}catch(R){console.error("Error leaving the call:",R)}};return h.jsxs("div",{children:[v?h.jsx("button",{onClick:w,children:"Leave Call"}):h.jsxs(vt,{variant:"outline",className:"w-full justify-start text-left py-3 border-red-300 hover:border-red-500 hover:bg-red-50",onClick:T,children:[h.jsx(dp,{className:"mr-3 h-5 w-5 text-red-500"})," Join Call"]}),v&&h.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:h.jsxs("div",{children:[h.jsxs("div",{className:"flex flex-col md:flex-row gap-5 bg-[#222] p-5 rounded-lg",children:[h.jsx("div",{ref:f,className:"w-[320px] h-[240px] md:w-[620px] md:h-[500px] bg-black"}),h.jsx("div",{ref:_,className:"w-[320px] h-[240px] md:w-[620px] md:h-[500px] bg-black"})]}),h.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"2rem"},children:h.jsx("button",{onClick:w,style:{background:"red",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"Leave Call"})})]})})]})},GCe=()=>h.jsxs(h.Fragment,{children:[h.jsx(fwe,{}),h.jsx(PCe,{}),h.jsx(gwe,{}),h.jsx(Ewe,{}),h.jsx(CCe,{}),h.jsx(ICe,{}),h.jsx(MCe,{}),h.jsx(UCe,{}),h.jsx(VCe,{}),h.jsx(IX,{}),h.jsx(DCe,{}),h.jsx(jwe,{}),h.jsx(ACe,{}),h.jsx(kCe,{}),h.jsx(WCe,{}),h.jsx(xCe,{}),h.jsx(dJ,{}),h.jsx(bCe,{})]}),fJ=X.createContext();function zCe(){return X.useContext(fJ)}function KCe({children:n}){const[i,o]=X.useState(null),[c,d]=X.useState(!0);X.useEffect(()=>{const T=localStorage.getItem("instaAstroUser");T&&o(JSON.parse(T)),d(!1)},[]);const x={user:i,login:async(T,w)=>new Promise((R,I)=>{d(!0),setTimeout(()=>{const P=(JSON.parse(localStorage.getItem("instaAstroUsers"))||[]).find(k=>k.email===T&&k.password===w);if(P){const k={email:P.email,id:P.id};o(k),localStorage.setItem("instaAstroUser",JSON.stringify(k)),d(!1),R(k)}else d(!1),I(new Error("Invalid credentials"))},1e3)}),register:async(T,w)=>new Promise((R,I)=>{d(!0),setTimeout(()=>{let j=JSON.parse(localStorage.getItem("instaAstroUsers"))||[];if(j.find(k=>k.email===T)){d(!1),I(new Error("User already exists with this email."));return}const P={id:Date.now().toString(),email:T,password:w};j.push(P),localStorage.setItem("instaAstroUsers",JSON.stringify(j)),d(!1),R(P)},1e3)}),logout:()=>{o(null),localStorage.removeItem("instaAstroUser")},loading:c};return h.jsx(fJ.Provider,{value:x,children:!c&&n})}const Zf=({title:n,description:i,icon:o,actionText:c,onActionClick:d,bgColorClass:f="bg-white"})=>{const _=o;return h.jsx(Dt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:h.jsxs(ur,{className:Ir("shadow-lg hover:shadow-xl transition-shadow duration-300 rounded-xl",f),children:[h.jsxs(qr,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[h.jsx(ni,{className:"text-lg font-semibold text-gray-700",children:n}),_&&h.jsx(_,{className:"h-6 w-6 text-red-500"})]}),h.jsxs(vr,{children:[h.jsx("p",{className:"text-sm text-gray-600 mb-4",children:i}),c&&d&&h.jsx(vt,{onClick:d,className:"w-full bg-red-500 hover:bg-red-600 text-white",children:c})]})]})})},qCe=()=>{const n=Qi(),i=JSON.parse(localStorage.getItem("user")||"{}");X.useEffect(()=>{localStorage.getItem("userToken")||n("/user-login")},[n]);const o=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),n("/user-login")};return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100 p-4 md:p-8",children:h.jsxs(Dt.div,{className:"container mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-4 md:mb-0",children:["Welcome, ",(i==null?void 0:i.user_name)||"User","!"]}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"})," Account Settings"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:o,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"})," Logout"]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[h.jsx(Zf,{title:"My Profile",description:"View and update your personal information and preferences.",icon:$h,actionText:"View Profile",onActionClick:()=>n("/profile"),bgColorClass:"bg-red-50"}),h.jsx(Zf,{title:"Order History",description:"Track your past consultations, reports, and product purchases.",icon:MEe,actionText:"View Orders",onActionClick:()=>n("/orders")}),h.jsx(Zf,{title:"Saved Astrologers",description:"Access your list of favorite astrologers for quick connections.",icon:oo,actionText:"Manage Favorites",onActionClick:()=>n("/favorites")}),h.jsx(Zf,{title:"Chat History",description:"Review your past chat conversations with astrologers.",icon:dp,actionText:"View Chats",onActionClick:()=>n("/user-chats")}),h.jsx(Zf,{title:"Call Recordings",description:"Listen to recordings of your previous call consultations.",icon:bT,actionText:"Access Recordings",onActionClick:()=>n("/calls")}),h.jsx(Zf,{title:"Support Center",description:"Get help with any issues or questions you may have.",icon:SY,actionText:"Contact Support",onActionClick:()=>n("/support"),bgColorClass:"bg-yellow-50"})]}),h.jsxs(ur,{className:"shadow-lg rounded-xl mb-8",children:[h.jsxs(qr,{children:[h.jsx(ni,{className:"text-xl font-semibold text-gray-700",children:"Quick Actions"}),h.jsx(qs,{className:"text-sm text-gray-500",children:"Access common features quickly."})]}),h.jsxs(vr,{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[h.jsxs(vt,{variant:"outline",className:"w-full justify-start text-left py-3 border-red-300 hover:border-red-500 hover:bg-red-50",onClick:()=>n("/kundli"),children:[h.jsx(zEe,{className:"mr-3 h-5 w-5 text-red-500"})," New Kundli"]}),h.jsxs(vt,{variant:"outline",className:"w-full justify-start text-left py-3 border-red-300 hover:border-red-500 hover:bg-red-50",onClick:()=>n("/matchmaking"),children:[h.jsx(uk,{className:"mr-3 h-5 w-5 text-red-500"})," Matchmaking"]}),h.jsxs(vt,{variant:"outline",className:"w-full justify-start text-left py-3 border-red-300 hover:border-red-500 hover:bg-red-50",onClick:()=>n("/daily-horoscope"),children:[h.jsx(oo,{className:"mr-3 h-5 w-5 text-red-500"})," Daily Horoscope"]}),h.jsxs(vt,{variant:"outline",className:"w-full justify-start text-left py-3 border-red-300 hover:border-red-500 hover:bg-red-50",onClick:()=>n("/astrologers"),children:[h.jsx(dp,{className:"mr-3 h-5 w-5 text-red-500"})," Chat with Astrologer"]})]})]}),h.jsx("div",{className:"text-center mt-10"})]})})};var mI="focusScope.autoFocusOnMount",gI="focusScope.autoFocusOnUnmount",QH={bubbles:!1,cancelable:!0},YCe="FocusScope",mJ=X.forwardRef((n,i)=>{const{loop:o=!1,trapped:c=!1,onMountAutoFocus:d,onUnmountAutoFocus:f,..._}=n,[v,x]=X.useState(null),T=Sl(d),w=Sl(f),R=X.useRef(null),I=Ks(i,k=>x(k)),j=X.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;X.useEffect(()=>{if(c){let k=function(V){if(j.paused||!v)return;const K=V.target;v.contains(K)?R.current=K:eu(R.current,{select:!0})},W=function(V){if(j.paused||!v)return;const K=V.relatedTarget;K!==null&&(v.contains(K)||eu(R.current,{select:!0}))},H=function(V){if(document.activeElement===document.body)for(const te of V)te.removedNodes.length>0&&eu(v)};document.addEventListener("focusin",k),document.addEventListener("focusout",W);const L=new MutationObserver(H);return v&&L.observe(v,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",k),document.removeEventListener("focusout",W),L.disconnect()}}},[c,v,j.paused]),X.useEffect(()=>{if(v){eG.add(j);const k=document.activeElement;if(!v.contains(k)){const H=new CustomEvent(mI,QH);v.addEventListener(mI,T),v.dispatchEvent(H),H.defaultPrevented||($Ce(eRe(gJ(v)),{select:!0}),document.activeElement===k&&eu(v))}return()=>{v.removeEventListener(mI,T),setTimeout(()=>{const H=new CustomEvent(gI,QH);v.addEventListener(gI,w),v.dispatchEvent(H),H.defaultPrevented||eu(k??document.body,{select:!0}),v.removeEventListener(gI,w),eG.remove(j)},0)}}},[v,T,w,j]);const P=X.useCallback(k=>{if(!o&&!c||j.paused)return;const W=k.key==="Tab"&&!k.altKey&&!k.ctrlKey&&!k.metaKey,H=document.activeElement;if(W&&H){const L=k.currentTarget,[V,K]=XCe(L);V&&K?!k.shiftKey&&H===K?(k.preventDefault(),o&&eu(V,{select:!0})):k.shiftKey&&H===V&&(k.preventDefault(),o&&eu(K,{select:!0})):H===L&&k.preventDefault()}},[o,c,j.paused]);return h.jsx(Wi.div,{tabIndex:-1,..._,ref:I,onKeyDown:P})});mJ.displayName=YCe;function $Ce(n,{select:i=!1}={}){const o=document.activeElement;for(const c of n)if(eu(c,{select:i}),document.activeElement!==o)return}function XCe(n){const i=gJ(n),o=ZH(i,n),c=ZH(i.reverse(),n);return[o,c]}function gJ(n){const i=[],o=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const d=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||d?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)i.push(o.currentNode);return i}function ZH(n,i){for(const o of n)if(!JCe(o,{upTo:i}))return o}function JCe(n,{upTo:i}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(i!==void 0&&n===i)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function QCe(n){return n instanceof HTMLInputElement&&"select"in n}function eu(n,{select:i=!1}={}){if(n&&n.focus){const o=document.activeElement;n.focus({preventScroll:!0}),n!==o&&QCe(n)&&i&&n.select()}}var eG=ZCe();function ZCe(){let n=[];return{add(i){const o=n[0];i!==o&&(o==null||o.pause()),n=tG(n,i),n.unshift(i)},remove(i){var o;n=tG(n,i),(o=n[0])==null||o.resume()}}}function tG(n,i){const o=[...n],c=o.indexOf(i);return c!==-1&&o.splice(c,1),o}function eRe(n){return n.filter(i=>i.tagName!=="A")}var _I=0;function tRe(){X.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??nG()),document.body.insertAdjacentElement("beforeend",n[1]??nG()),_I++,()=>{_I===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(i=>i.remove()),_I--}},[])}function nG(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var gl=function(){return gl=Object.assign||function(i){for(var o,c=1,d=arguments.length;c<d;c++){o=arguments[c];for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(i[f]=o[f])}return i},gl.apply(this,arguments)};function _J(n,i){var o={};for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&i.indexOf(c)<0&&(o[c]=n[c]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(n);d<c.length;d++)i.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(n,c[d])&&(o[c[d]]=n[c[d]]);return o}function nRe(n,i,o){if(o||arguments.length===2)for(var c=0,d=i.length,f;c<d;c++)(f||!(c in i))&&(f||(f=Array.prototype.slice.call(i,0,c)),f[c]=i[c]);return n.concat(f||Array.prototype.slice.call(i))}var Fx="right-scroll-bar-position",Vx="width-before-scroll-bar",rRe="with-scroll-bars-hidden",iRe="--removed-body-scroll-bar-size";function EI(n,i){return typeof n=="function"?n(i):n&&(n.current=i),n}function sRe(n,i){var o=X.useState(function(){return{value:n,callback:i,facade:{get current(){return o.value},set current(c){var d=o.value;d!==c&&(o.value=c,o.callback(c,d))}}}})[0];return o.callback=i,o.facade}var oRe=typeof window<"u"?X.useLayoutEffect:X.useEffect,rG=new WeakMap;function aRe(n,i){var o=sRe(i||null,function(c){return n.forEach(function(d){return EI(d,c)})});return oRe(function(){var c=rG.get(o);if(c){var d=new Set(c),f=new Set(n),_=o.current;d.forEach(function(v){f.has(v)||EI(v,null)}),f.forEach(function(v){d.has(v)||EI(v,_)})}rG.set(o,n)},[n]),o}function cRe(n){return n}function lRe(n,i){i===void 0&&(i=cRe);var o=[],c=!1,d={read:function(){if(c)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return o.length?o[o.length-1]:n},useMedium:function(f){var _=i(f,c);return o.push(_),function(){o=o.filter(function(v){return v!==_})}},assignSyncMedium:function(f){for(c=!0;o.length;){var _=o;o=[],_.forEach(f)}o={push:function(v){return f(v)},filter:function(){return o}}},assignMedium:function(f){c=!0;var _=[];if(o.length){var v=o;o=[],v.forEach(f),_=o}var x=function(){var w=_;_=[],w.forEach(f)},T=function(){return Promise.resolve().then(x)};T(),o={push:function(w){_.push(w),T()},filter:function(w){return _=_.filter(w),o}}}};return d}function dRe(n){n===void 0&&(n={});var i=lRe(null);return i.options=gl({async:!0,ssr:!1},n),i}var EJ=function(n){var i=n.sideCar,o=_J(n,["sideCar"]);if(!i)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var c=i.read();if(!c)throw new Error("Sidecar medium not found");return X.createElement(c,gl({},o))};EJ.isSideCarExport=!0;function uRe(n,i){return n.useMedium(i),EJ}var vJ=dRe(),vI=function(){},Wb=X.forwardRef(function(n,i){var o=X.useRef(null),c=X.useState({onScrollCapture:vI,onWheelCapture:vI,onTouchMoveCapture:vI}),d=c[0],f=c[1],_=n.forwardProps,v=n.children,x=n.className,T=n.removeScrollBar,w=n.enabled,R=n.shards,I=n.sideCar,j=n.noIsolation,P=n.inert,k=n.allowPinchZoom,W=n.as,H=W===void 0?"div":W,L=n.gapMode,V=_J(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),K=I,te=aRe([o,i]),ie=gl(gl({},V),d);return X.createElement(X.Fragment,null,w&&X.createElement(K,{sideCar:vJ,removeScrollBar:T,shards:R,noIsolation:j,inert:P,setCallbacks:f,allowPinchZoom:!!k,lockRef:o,gapMode:L}),_?X.cloneElement(X.Children.only(v),gl(gl({},ie),{ref:te})):X.createElement(H,gl({},ie,{className:x,ref:te}),v))});Wb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Wb.classNames={fullWidth:Vx,zeroRight:Fx};var iG,hRe=function(){if(iG)return iG;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function pRe(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var i=hRe();return i&&n.setAttribute("nonce",i),n}function fRe(n,i){n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i))}function mRe(n){var i=document.head||document.getElementsByTagName("head")[0];i.appendChild(n)}var gRe=function(){var n=0,i=null;return{add:function(o){n==0&&(i=pRe())&&(fRe(i,o),mRe(i)),n++},remove:function(){n--,!n&&i&&(i.parentNode&&i.parentNode.removeChild(i),i=null)}}},_Re=function(){var n=gRe();return function(i,o){X.useEffect(function(){return n.add(i),function(){n.remove()}},[i&&o])}},yJ=function(){var n=_Re(),i=function(o){var c=o.styles,d=o.dynamic;return n(c,d),null};return i},ERe={left:0,top:0,right:0,gap:0},yI=function(n){return parseInt(n||"",10)||0},vRe=function(n){var i=window.getComputedStyle(document.body),o=i[n==="padding"?"paddingLeft":"marginLeft"],c=i[n==="padding"?"paddingTop":"marginTop"],d=i[n==="padding"?"paddingRight":"marginRight"];return[yI(o),yI(c),yI(d)]},yRe=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return ERe;var i=vRe(n),o=document.documentElement.clientWidth,c=window.innerWidth;return{left:i[0],top:i[1],right:i[2],gap:Math.max(0,c-o+i[2]-i[0])}},SRe=yJ(),Im="data-scroll-locked",xRe=function(n,i,o,c){var d=n.left,f=n.top,_=n.right,v=n.gap;return o===void 0&&(o="margin"),`
  .`.concat(rRe,` {
   overflow: hidden `).concat(c,`;
   padding-right: `).concat(v,"px ").concat(c,`;
  }
  body[`).concat(Im,`] {
    overflow: hidden `).concat(c,`;
    overscroll-behavior: contain;
    `).concat([i&&"position: relative ".concat(c,";"),o==="margin"&&`
    padding-left: `.concat(d,`px;
    padding-top: `).concat(f,`px;
    padding-right: `).concat(_,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(v,"px ").concat(c,`;
    `),o==="padding"&&"padding-right: ".concat(v,"px ").concat(c,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Fx,` {
    right: `).concat(v,"px ").concat(c,`;
  }
  
  .`).concat(Vx,` {
    margin-right: `).concat(v,"px ").concat(c,`;
  }
  
  .`).concat(Fx," .").concat(Fx,` {
    right: 0 `).concat(c,`;
  }
  
  .`).concat(Vx," .").concat(Vx,` {
    margin-right: 0 `).concat(c,`;
  }
  
  body[`).concat(Im,`] {
    `).concat(iRe,": ").concat(v,`px;
  }
`)},sG=function(){var n=parseInt(document.body.getAttribute(Im)||"0",10);return isFinite(n)?n:0},TRe=function(){X.useEffect(function(){return document.body.setAttribute(Im,(sG()+1).toString()),function(){var n=sG()-1;n<=0?document.body.removeAttribute(Im):document.body.setAttribute(Im,n.toString())}},[])},bRe=function(n){var i=n.noRelative,o=n.noImportant,c=n.gapMode,d=c===void 0?"margin":c;TRe();var f=X.useMemo(function(){return yRe(d)},[d]);return X.createElement(SRe,{styles:xRe(f,!i,d,o?"":"!important")})},WD=!1;if(typeof window<"u")try{var ux=Object.defineProperty({},"passive",{get:function(){return WD=!0,!0}});window.addEventListener("test",ux,ux),window.removeEventListener("test",ux,ux)}catch{WD=!1}var em=WD?{passive:!1}:!1,wRe=function(n){return n.tagName==="TEXTAREA"},SJ=function(n,i){if(!(n instanceof Element))return!1;var o=window.getComputedStyle(n);return o[i]!=="hidden"&&!(o.overflowY===o.overflowX&&!wRe(n)&&o[i]==="visible")},CRe=function(n){return SJ(n,"overflowY")},RRe=function(n){return SJ(n,"overflowX")},oG=function(n,i){var o=i.ownerDocument,c=i;do{typeof ShadowRoot<"u"&&c instanceof ShadowRoot&&(c=c.host);var d=xJ(n,c);if(d){var f=TJ(n,c),_=f[1],v=f[2];if(_>v)return!0}c=c.parentNode}while(c&&c!==o.body);return!1},ARe=function(n){var i=n.scrollTop,o=n.scrollHeight,c=n.clientHeight;return[i,o,c]},NRe=function(n){var i=n.scrollLeft,o=n.scrollWidth,c=n.clientWidth;return[i,o,c]},xJ=function(n,i){return n==="v"?CRe(i):RRe(i)},TJ=function(n,i){return n==="v"?ARe(i):NRe(i)},IRe=function(n,i){return n==="h"&&i==="rtl"?-1:1},ORe=function(n,i,o,c,d){var f=IRe(n,window.getComputedStyle(i).direction),_=f*c,v=o.target,x=i.contains(v),T=!1,w=_>0,R=0,I=0;do{var j=TJ(n,v),P=j[0],k=j[1],W=j[2],H=k-W-f*P;(P||H)&&xJ(n,v)&&(R+=H,I+=P),v instanceof ShadowRoot?v=v.host:v=v.parentNode}while(!x&&v!==document.body||x&&(i.contains(v)||i===v));return(w&&(d&&Math.abs(R)<1||!d&&_>R)||!w&&(d&&Math.abs(I)<1||!d&&-_>I))&&(T=!0),T},hx=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},aG=function(n){return[n.deltaX,n.deltaY]},cG=function(n){return n&&"current"in n?n.current:n},DRe=function(n,i){return n[0]===i[0]&&n[1]===i[1]},PRe=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},kRe=0,tm=[];function LRe(n){var i=X.useRef([]),o=X.useRef([0,0]),c=X.useRef(),d=X.useState(kRe++)[0],f=X.useState(yJ)[0],_=X.useRef(n);X.useEffect(function(){_.current=n},[n]),X.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(d));var k=nRe([n.lockRef.current],(n.shards||[]).map(cG),!0).filter(Boolean);return k.forEach(function(W){return W.classList.add("allow-interactivity-".concat(d))}),function(){document.body.classList.remove("block-interactivity-".concat(d)),k.forEach(function(W){return W.classList.remove("allow-interactivity-".concat(d))})}}},[n.inert,n.lockRef.current,n.shards]);var v=X.useCallback(function(k,W){if("touches"in k&&k.touches.length===2||k.type==="wheel"&&k.ctrlKey)return!_.current.allowPinchZoom;var H=hx(k),L=o.current,V="deltaX"in k?k.deltaX:L[0]-H[0],K="deltaY"in k?k.deltaY:L[1]-H[1],te,ie=k.target,A=Math.abs(V)>Math.abs(K)?"h":"v";if("touches"in k&&A==="h"&&ie.type==="range")return!1;var de=oG(A,ie);if(!de)return!0;if(de?te=A:(te=A==="v"?"h":"v",de=oG(A,ie)),!de)return!1;if(!c.current&&"changedTouches"in k&&(V||K)&&(c.current=te),!te)return!0;var ue=c.current||te;return ORe(ue,W,k,ue==="h"?V:K,!0)},[]),x=X.useCallback(function(k){var W=k;if(!(!tm.length||tm[tm.length-1]!==f)){var H="deltaY"in W?aG(W):hx(W),L=i.current.filter(function(te){return te.name===W.type&&(te.target===W.target||W.target===te.shadowParent)&&DRe(te.delta,H)})[0];if(L&&L.should){W.cancelable&&W.preventDefault();return}if(!L){var V=(_.current.shards||[]).map(cG).filter(Boolean).filter(function(te){return te.contains(W.target)}),K=V.length>0?v(W,V[0]):!_.current.noIsolation;K&&W.cancelable&&W.preventDefault()}}},[]),T=X.useCallback(function(k,W,H,L){var V={name:k,delta:W,target:H,should:L,shadowParent:MRe(H)};i.current.push(V),setTimeout(function(){i.current=i.current.filter(function(K){return K!==V})},1)},[]),w=X.useCallback(function(k){o.current=hx(k),c.current=void 0},[]),R=X.useCallback(function(k){T(k.type,aG(k),k.target,v(k,n.lockRef.current))},[]),I=X.useCallback(function(k){T(k.type,hx(k),k.target,v(k,n.lockRef.current))},[]);X.useEffect(function(){return tm.push(f),n.setCallbacks({onScrollCapture:R,onWheelCapture:R,onTouchMoveCapture:I}),document.addEventListener("wheel",x,em),document.addEventListener("touchmove",x,em),document.addEventListener("touchstart",w,em),function(){tm=tm.filter(function(k){return k!==f}),document.removeEventListener("wheel",x,em),document.removeEventListener("touchmove",x,em),document.removeEventListener("touchstart",w,em)}},[]);var j=n.removeScrollBar,P=n.inert;return X.createElement(X.Fragment,null,P?X.createElement(f,{styles:PRe(d)}):null,j?X.createElement(bRe,{gapMode:n.gapMode}):null)}function MRe(n){for(var i=null;n!==null;)n instanceof ShadowRoot&&(i=n.host,n=n.host),n=n.parentNode;return i}const jRe=uRe(vJ,LRe);var bJ=X.forwardRef(function(n,i){return X.createElement(Wb,gl({},n,{ref:i,sideCar:jRe}))});bJ.classNames=Wb.classNames;const URe=bJ;var FRe=function(n){if(typeof document>"u")return null;var i=Array.isArray(n)?n[0]:n;return i.ownerDocument.body},nm=new WeakMap,px=new WeakMap,fx={},SI=0,wJ=function(n){return n&&(n.host||wJ(n.parentNode))},VRe=function(n,i){return i.map(function(o){if(n.contains(o))return o;var c=wJ(o);return c&&n.contains(c)?c:(console.error("aria-hidden",o,"in not contained inside",n,". Doing nothing"),null)}).filter(function(o){return!!o})},BRe=function(n,i,o,c){var d=VRe(i,Array.isArray(n)?n:[n]);fx[o]||(fx[o]=new WeakMap);var f=fx[o],_=[],v=new Set,x=new Set(d),T=function(R){!R||v.has(R)||(v.add(R),T(R.parentNode))};d.forEach(T);var w=function(R){!R||x.has(R)||Array.prototype.forEach.call(R.children,function(I){if(v.has(I))w(I);else try{var j=I.getAttribute(c),P=j!==null&&j!=="false",k=(nm.get(I)||0)+1,W=(f.get(I)||0)+1;nm.set(I,k),f.set(I,W),_.push(I),k===1&&P&&px.set(I,!0),W===1&&I.setAttribute(o,"true"),P||I.setAttribute(c,"true")}catch(H){console.error("aria-hidden: cannot operate on ",I,H)}})};return w(i),v.clear(),SI++,function(){_.forEach(function(R){var I=nm.get(R)-1,j=f.get(R)-1;nm.set(R,I),f.set(R,j),I||(px.has(R)||R.removeAttribute(c),px.delete(R)),j||R.removeAttribute(o)}),SI--,SI||(nm=new WeakMap,nm=new WeakMap,px=new WeakMap,fx={})}},WRe=function(n,i,o){o===void 0&&(o="data-aria-hidden");var c=Array.from(Array.isArray(n)?n:[n]),d=i||FRe(n);return d?(c.push.apply(c,Array.from(d.querySelectorAll("[aria-live]"))),BRe(c,d,o,"aria-hidden")):function(){return null}},Hb="Dialog",[CJ,tOe]=Sp(Hb),[HRe,kc]=CJ(Hb),RJ=n=>{const{__scopeDialog:i,children:o,open:c,defaultOpen:d,onOpenChange:f,modal:_=!0}=n,v=X.useRef(null),x=X.useRef(null),[T,w]=yE({prop:c,defaultProp:d??!1,onChange:f,caller:Hb});return h.jsx(HRe,{scope:i,triggerRef:v,contentRef:x,contentId:M_(),titleId:M_(),descriptionId:M_(),open:T,onOpenChange:w,onOpenToggle:X.useCallback(()=>w(R=>!R),[w]),modal:_,children:o})};RJ.displayName=Hb;var AJ="DialogTrigger",NJ=X.forwardRef((n,i)=>{const{__scopeDialog:o,...c}=n,d=kc(AJ,o),f=Ks(i,d.triggerRef);return h.jsx(Wi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":d.open,"aria-controls":d.contentId,"data-state":s2(d.open),...c,ref:f,onClick:Vi(n.onClick,d.onOpenToggle)})});NJ.displayName=AJ;var r2="DialogPortal",[GRe,IJ]=CJ(r2,{forceMount:void 0}),OJ=n=>{const{__scopeDialog:i,forceMount:o,children:c,container:d}=n,f=kc(r2,i);return h.jsx(GRe,{scope:i,forceMount:o,children:X.Children.map(c,_=>h.jsx(t0,{present:o||f.open,children:h.jsx(ik,{asChild:!0,container:d,children:_})}))})};OJ.displayName=r2;var VT="DialogOverlay",DJ=X.forwardRef((n,i)=>{const o=IJ(VT,n.__scopeDialog),{forceMount:c=o.forceMount,...d}=n,f=kc(VT,n.__scopeDialog);return f.modal?h.jsx(t0,{present:c||f.open,children:h.jsx(KRe,{...d,ref:i})}):null});DJ.displayName=VT;var zRe=sE("DialogOverlay.RemoveScroll"),KRe=X.forwardRef((n,i)=>{const{__scopeDialog:o,...c}=n,d=kc(VT,o);return h.jsx(URe,{as:zRe,allowPinchZoom:!0,shards:[d.contentRef],children:h.jsx(Wi.div,{"data-state":s2(d.open),...c,ref:i,style:{pointerEvents:"auto",...c.style}})})}),hp="DialogContent",PJ=X.forwardRef((n,i)=>{const o=IJ(hp,n.__scopeDialog),{forceMount:c=o.forceMount,...d}=n,f=kc(hp,n.__scopeDialog);return h.jsx(t0,{present:c||f.open,children:f.modal?h.jsx(qRe,{...d,ref:i}):h.jsx(YRe,{...d,ref:i})})});PJ.displayName=hp;var qRe=X.forwardRef((n,i)=>{const o=kc(hp,n.__scopeDialog),c=X.useRef(null),d=Ks(i,o.contentRef,c);return X.useEffect(()=>{const f=c.current;if(f)return WRe(f)},[]),h.jsx(kJ,{...n,ref:d,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vi(n.onCloseAutoFocus,f=>{var _;f.preventDefault(),(_=o.triggerRef.current)==null||_.focus()}),onPointerDownOutside:Vi(n.onPointerDownOutside,f=>{const _=f.detail.originalEvent,v=_.button===0&&_.ctrlKey===!0;(_.button===2||v)&&f.preventDefault()}),onFocusOutside:Vi(n.onFocusOutside,f=>f.preventDefault())})}),YRe=X.forwardRef((n,i)=>{const o=kc(hp,n.__scopeDialog),c=X.useRef(!1),d=X.useRef(!1);return h.jsx(kJ,{...n,ref:i,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:f=>{var _,v;(_=n.onCloseAutoFocus)==null||_.call(n,f),f.defaultPrevented||(c.current||(v=o.triggerRef.current)==null||v.focus(),f.preventDefault()),c.current=!1,d.current=!1},onInteractOutside:f=>{var x,T;(x=n.onInteractOutside)==null||x.call(n,f),f.defaultPrevented||(c.current=!0,f.detail.originalEvent.type==="pointerdown"&&(d.current=!0));const _=f.target;((T=o.triggerRef.current)==null?void 0:T.contains(_))&&f.preventDefault(),f.detail.originalEvent.type==="focusin"&&d.current&&f.preventDefault()}})}),kJ=X.forwardRef((n,i)=>{const{__scopeDialog:o,trapFocus:c,onOpenAutoFocus:d,onCloseAutoFocus:f,..._}=n,v=kc(hp,o),x=X.useRef(null),T=Ks(i,x);return tRe(),h.jsxs(h.Fragment,{children:[h.jsx(mJ,{asChild:!0,loop:!0,trapped:c,onMountAutoFocus:d,onUnmountAutoFocus:f,children:h.jsx(rk,{role:"dialog",id:v.contentId,"aria-describedby":v.descriptionId,"aria-labelledby":v.titleId,"data-state":s2(v.open),..._,ref:T,onDismiss:()=>v.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx($Re,{titleId:v.titleId}),h.jsx(JRe,{contentRef:x,descriptionId:v.descriptionId})]})]})}),i2="DialogTitle",LJ=X.forwardRef((n,i)=>{const{__scopeDialog:o,...c}=n,d=kc(i2,o);return h.jsx(Wi.h2,{id:d.titleId,...c,ref:i})});LJ.displayName=i2;var MJ="DialogDescription",jJ=X.forwardRef((n,i)=>{const{__scopeDialog:o,...c}=n,d=kc(MJ,o);return h.jsx(Wi.p,{id:d.descriptionId,...c,ref:i})});jJ.displayName=MJ;var UJ="DialogClose",FJ=X.forwardRef((n,i)=>{const{__scopeDialog:o,...c}=n,d=kc(UJ,o);return h.jsx(Wi.button,{type:"button",...c,ref:i,onClick:Vi(n.onClick,()=>d.onOpenChange(!1))})});FJ.displayName=UJ;function s2(n){return n?"open":"closed"}var VJ="DialogTitleWarning",[nOe,BJ]=g_e(VJ,{contentName:hp,titleName:i2,docsSlug:"dialog"}),$Re=({titleId:n})=>{const i=BJ(VJ),o=`\`${i.contentName}\` requires a \`${i.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${i.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${i.docsSlug}`;return X.useEffect(()=>{n&&(document.getElementById(n)||console.error(o))},[o,n]),null},XRe="DialogDescriptionWarning",JRe=({contentRef:n,descriptionId:i})=>{const c=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${BJ(XRe).contentName}}.`;return X.useEffect(()=>{var f;const d=(f=n.current)==null?void 0:f.getAttribute("aria-describedby");i&&d&&(document.getElementById(i)||console.warn(c))},[c,n,i]),null},WJ=RJ,HJ=NJ,GJ=OJ,o2=DJ,a2=PJ,c2=LJ,zJ=jJ,KJ=FJ;const pp=WJ,QRe=HJ,ZRe=GJ,qJ=wt.forwardRef(({className:n,...i},o)=>h.jsx(o2,{ref:o,className:Ir("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...i}));qJ.displayName=o2.displayName;const Cu=wt.forwardRef(({className:n,children:i,...o},c)=>h.jsxs(ZRe,{children:[h.jsx(qJ,{}),h.jsxs(a2,{ref:c,className:Ir("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...o,children:[i,h.jsxs(KJ,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(xp,{className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Cu.displayName=a2.displayName;const fp=({className:n,...i})=>h.jsx("div",{className:Ir("flex flex-col space-y-1.5 text-center sm:text-left",n),...i});fp.displayName="DialogHeader";const mp=wt.forwardRef(({className:n,...i},o)=>h.jsx(c2,{ref:o,className:Ir("text-lg font-semibold leading-none tracking-tight",n),...i}));mp.displayName=c2.displayName;const eAe=wt.forwardRef(({className:n,...i},o)=>h.jsx(zJ,{ref:o,className:Ir("text-sm text-muted-foreground",n),...i}));eAe.displayName=zJ.displayName;const YJ="/assets/logo-93cc99be.png",$J=()=>{const[n,i]=X.useState(!1),[o,c]=X.useState(!1),{user:d,logout:f}=zCe(),_=Oc();X.useEffect(()=>{const x=()=>{c(window.scrollY>20)};return window.addEventListener("scroll",x),()=>window.removeEventListener("scroll",x)},[]),X.useEffect(()=>{i(!1)},[_]);const v=[{name:"Home",href:"/"},{name:"Astrologers",href:"/astrologers"},{name:"Services",icon:h.jsx(ED,{className:"ml-1 inline-block w-4 h-4"}),dropdown:[{name:"Store",href:"/store"},{name:"Karamkandi",href:"/karamkandi"},{name:"Horoscope",href:"/horoscope"}]},{name:"Matching ",icon:h.jsx(ED,{className:"ml-1 inline-block w-4 h-4"}),dropdown:[{name:"Dashakoot",href:"/dashakoot"},{name:"Ashtakoot",href:"/ashtakoot"}]},{name:"Testimonials",href:"/testimonials"},{name:"Blog",href:"/blog"},{name:"Contact",href:"/contact"}];return h.jsx("section",{className:"topheader-width",children:h.jsxs("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${o?"bg-white/90 backdrop-blur-md shadow-md":"bg-transparent"}`,children:[h.jsxs("div",{className:"container mx-auto flex items-center justify-between h-16 px-4",children:[h.jsx("div",{className:"flex items-center flex-shrink-0 h-full",children:h.jsx(Xn,{to:"/",className:"flex items-center",children:h.jsx("img",{src:YJ,className:"w-auto h-[15rem]",alt:"Logo"})})}),h.jsxs("div",{className:"hidden xl:flex items-center space-x-4 relative",children:[v.map(x=>x.dropdown?h.jsxs("div",{className:"relative group",children:[h.jsxs("div",{className:"flex items-center cursor-pointer px-3 py-2 text-gray-700 hover:text-primary text-sm font-medium transition-colors",children:[x.name,x.icon]}),h.jsx("div",{className:"absolute top-full left-0 invisible opacity-0 group-hover:visible group-hover:opacity-100 bg-white shadow-lg rounded-md py-2 mt-1 w-48 z-50 transition-all duration-200 ease-out transform translate-y-2 group-hover:translate-y-0",children:x.dropdown.map(T=>h.jsx(Xn,{to:T.href,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:T.name},T.name))})]},x.name):h.jsx(Xn,{to:x.href,className:"text-gray-700 hover:text-primary px-3 py-2 rounded-md text-sm font-medium transition-colors",children:x.name},x.name)),d?h.jsxs(h.Fragment,{children:[h.jsxs("span",{className:"text-sm text-gray-700",children:["Welcome, ",d.email.split("@")[0],"!"]}),h.jsxs(vt,{variant:"outline",size:"sm",onClick:f,children:[h.jsx(Tl,{className:"mr-2 h-4 w-4"})," Logout"]})]}):h.jsxs(h.Fragment,{children:[h.jsx(Xn,{to:"/user-register",children:h.jsxs(vt,{className:"cosmic-gradient text-white",children:[h.jsx($h,{className:"mr-2 h-4 w-4"})," User Register"]})}),h.jsx(Xn,{to:"/astro-register",children:h.jsxs(vt,{className:"cosmic-gradient text-white",children:[h.jsx($h,{className:"mr-2 h-4 w-4"})," Astro Register"]})})]})]}),h.jsxs("div",{className:"xl:hidden flex items-center gap-2",children:[h.jsxs(pp,{children:[h.jsx(QRe,{asChild:!0,children:h.jsx(vt,{variant:"outline",size:"sm",children:h.jsx(Iu,{className:"h-4 w-4"})})}),h.jsx(Cu,{className:"sm:max-w-[425px] p-6",children:h.jsxs("div",{className:"grid gap-4",children:[h.jsx("h3",{className:"text-lg font-medium",children:"Talk to an Astrologer Now"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Enter your phone number and we'll connect you with an expert astrologer."}),h.jsx(Vt,{placeholder:"Enter your phone number",type:"tel"}),h.jsx(vt,{className:"cosmic-gradient text-white w-full",children:"Connect Now"})]})})]}),h.jsx("button",{onClick:()=>i(!n),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-primary focus:outline-none",children:n?h.jsx(xp,{className:"block h-6 w-6"}):h.jsx(REe,{className:"block h-6 w-6"})})]})]}),n&&h.jsx(Dt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"xl:hidden bg-white shadow-lg px-4",children:h.jsxs("div",{className:"flex flex-col gap-2 py-4",children:[v.map(x=>x.dropdown?h.jsxs("details",{className:"px-3 py-1",children:[h.jsx("summary",{className:"cursor-pointer text-gray-700 text-base font-medium hover:text-primary",children:x.name}),h.jsx("div",{className:"ml-3 mt-2 space-y-1",children:x.dropdown.map(T=>h.jsx(Xn,{to:T.href,className:"block text-gray-600 hover:text-primary text-sm",onClick:()=>i(!1),children:T.name},T.name))})]},x.name):h.jsx(Xn,{to:x.href,className:"text-gray-700 hover:text-primary block px-3 py-2 rounded-md text-base font-medium",onClick:()=>i(!1),children:x.name},x.name)),d?h.jsxs(h.Fragment,{children:[h.jsxs("span",{className:"text-gray-700 block px-3 py-2 text-base",children:["Welcome, ",d.email.split("@")[0],"!"]}),h.jsxs(vt,{variant:"outline",className:"w-full",onClick:()=>{f(),i(!1)},children:[h.jsx(Tl,{className:"mr-2 h-4 w-4"})," Logout"]})]}):h.jsxs(h.Fragment,{children:[h.jsx(Xn,{to:"/user-register",onClick:()=>i(!1),children:h.jsxs(vt,{className:"cosmic-gradient text-white w-full",children:[h.jsx($h,{className:"mr-2 h-4 w-4"})," User Register"]})}),h.jsx(Xn,{to:"/astro-register",onClick:()=>i(!1),children:h.jsxs(vt,{className:"cosmic-gradient text-white w-full",children:[h.jsx($h,{className:"mr-2 h-4 w-4"})," Astro Register"]})})]})]})})]})})},XJ=()=>h.jsxs(h.Fragment,{children:[h.jsx("footer",{className:"hidden md:block bg-gray-900 text-white pt-16 pb-8",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[h.jsxs("div",{className:"flex flex-col items-start lg:items-start",children:[h.jsx("img",{src:YJ,alt:"AstroTruth Logo",className:"w-36 h-auto object-contain mb-4"}),h.jsx("p",{className:"text-gray-400 mb-4 leading-relaxed",children:"Connecting you with expert astrologers for guidance on life's journey."}),h.jsxs("div",{className:"flex space-x-4",children:[h.jsx("a",{href:"https://www.facebook.com/share/1EjUg7c5fc/",className:"text-gray-400 hover:text-white transition-colors",target:"_blank",children:h.jsx(gEe,{className:"h-5 w-5"})}),h.jsx("a",{href:"https://www.linkedin.com/in/astrotruth-a6a428372?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app",target:"_blank",className:"text-gray-400 hover:text-white transition-colors",children:h.jsx(CEe,{className:"h-5 w-5"})}),h.jsx("a",{href:"https://www.instagram.com/astr.otruth?igsh=MW9rNGV5dmwxMG9oOA==",className:"text-gray-400 hover:text-white transition-colors",target:"_blank",children:h.jsx(TEe,{className:"h-5 w-5"})}),h.jsx("a",{href:"https://youtube.com/@astrotruthabc?si=cgJFqvA0PwZWmD7e",className:"text-gray-400 hover:text-white transition-colors",target:"_blank",children:h.jsx(GEe,{className:"h-5 w-5"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx(Xn,{to:"/",className:"text-gray-400 hover:text-white transition-colors",children:"Home"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/astrologers",className:"text-gray-400 hover:text-white transition-colors",children:"Astrologers"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/services",className:"text-gray-400 hover:text-white transition-colors",children:"Services"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/testimonials",className:"text-gray-400 hover:text-white transition-colors",children:"Testimonials"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/blog",className:"text-gray-400 hover:text-white transition-colors",children:"Blog"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/contact",className:"text-gray-400 hover:text-white transition-colors",children:"Contact"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Services"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx(Xn,{to:"/kundalimatch",className:"text-gray-400 hover:text-white transition-colors",children:"Kundali Matching"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/",className:"text-gray-400 hover:text-white transition-colors",children:"Horoscope"})}),h.jsx("li",{children:h.jsx(Xn,{to:"/",className:"text-gray-400 hover:text-white transition-colors",children:"Free Kundali"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Contact Us"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("p",{className:"flex items-start",children:[h.jsx(pk,{className:"h-5 w-5 mr-2 mt-0.5 text-gray-400"}),h.jsx("span",{className:"text-gray-400",children:"SA.5/136, SANJAY NAGAR RAMAREY PUR, Varanasi Cantt, India"})]}),h.jsxs("p",{className:"flex items-center",children:[h.jsx(Iu,{className:"h-5 w-5 mr-2 text-gray-400"}),h.jsx("a",{href:"tel:+919415695659",children:h.jsx("span",{className:"text-gray-400",children:"+91 9415695659"})})]}),h.jsxs("p",{className:"flex items-center",children:[h.jsx(ad,{className:"h-5 w-5 mr-2 text-gray-400"}),h.jsx("span",{className:"text-gray-400",children:"support@astrotruth.in"})]})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("h5",{className:"text-sm font-medium mb-2",children:"Subscribe to our newsletter"}),h.jsxs("div",{className:"flex",children:[h.jsx(Vt,{type:"email",placeholder:"Your email",className:"bg-gray-800 border-gray-700 text-white"}),h.jsx(vt,{className:"ml-2 cosmic-gradient",children:"Subscribe"})]})]})]})]}),h.jsx("div",{className:"border-t border-gray-800 pt-8",children:h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[h.jsx("p",{className:"text-gray-400 text-sm mb-4 md:mb-0",children:" 2025 Astrotuth. All rights reserved."}),h.jsxs("div",{className:"flex space-x-4",children:[h.jsx(Xn,{to:"/privacy-policy",className:"text-gray-400 hover:text-white text-sm transition-colors",children:"Privacy Policy"}),h.jsx(Xn,{to:"/terms",className:"text-gray-400 hover:text-white text-sm transition-colors",children:"Terms of Service"}),h.jsx(Xn,{to:"/privacy-policy",className:"text-gray-400 hover:text-white text-sm transition-colors",children:"Refund Policy"})]})]})})]})}),h.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-white border-t shadow flex justify-around py-2",children:[h.jsxs(Xn,{to:"/",className:"flex flex-col items-center text-gray-700",children:[h.jsx(hk,{className:"h-6 w-6"}),h.jsx("span",{className:"text-xs",children:"Home"})]}),h.jsxs(Xn,{to:"/astrologers",className:"flex flex-col items-center text-gray-700",children:[h.jsx(UEe,{className:"h-6 w-6"}),h.jsx("span",{className:"text-xs",children:"Astro"})]}),h.jsxs(Xn,{to:"/astrologers",className:"flex flex-col items-center text-gray-700",children:[h.jsx(OEe,{className:"h-6 w-6"}),h.jsx("span",{className:"text-xs",children:"Live"})]}),h.jsxs(Xn,{to:"/user-chats",className:"flex flex-col items-center text-gray-700",children:[h.jsx(vb,{className:"h-6 w-6"}),h.jsx("span",{className:"text-xs",children:"Chat"})]}),h.jsxs(Xn,{to:"/astrologers",className:"flex flex-col items-center text-gray-700",children:[h.jsx(xEe,{className:"h-6 w-6"}),h.jsx("span",{className:"text-xs",children:"History"})]})]})]}),tAe=({children:n})=>{const i=Oc(),c=["/user-dashboard","/astro-dashboard","/admin","/astrologer","/users","/karmkandy","/user-profile","/astro-profile","/user-update","/user-chats","/astro-update","/store","/product","/checkout"].some(d=>i.pathname.startsWith(d));return h.jsxs(h.Fragment,{children:[!c&&h.jsx($J,{}),h.jsx("div",{children:n}),!c&&h.jsx(XJ,{})]})};var JJ={exports:{}},xI={exports:{}};/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */var lG;function nAe(){return lG||(lG=1,function(n){(function(i,o){n.exports=i.document?o(i,!0):function(c){if(!c.document)throw new Error("jQuery requires a window with a document");return o(c)}})(typeof window<"u"?window:En,function(i,o){var c=[],d=Object.getPrototypeOf,f=c.slice,_=c.flat?function(S){return c.flat.call(S)}:function(S){return c.concat.apply([],S)},v=c.push,x=c.indexOf,T={},w=T.toString,R=T.hasOwnProperty,I=R.toString,j=I.call(Object),P={},k=function(N){return typeof N=="function"&&typeof N.nodeType!="number"&&typeof N.item!="function"},W=function(N){return N!=null&&N===N.window},H=i.document,L={type:!0,src:!0,nonce:!0,noModule:!0};function V(S,N,U){U=U||H;var G,J,Q=U.createElement("script");if(Q.text=S,N)for(G in L)J=N[G]||N.getAttribute&&N.getAttribute(G),J&&Q.setAttribute(G,J);U.head.appendChild(Q).parentNode.removeChild(Q)}function K(S){return S==null?S+"":typeof S=="object"||typeof S=="function"?T[w.call(S)]||"object":typeof S}var te="3.7.1",ie=/HTML$/i,A=function(S,N){return new A.fn.init(S,N)};A.fn=A.prototype={jquery:te,constructor:A,length:0,toArray:function(){return f.call(this)},get:function(S){return S==null?f.call(this):S<0?this[S+this.length]:this[S]},pushStack:function(S){var N=A.merge(this.constructor(),S);return N.prevObject=this,N},each:function(S){return A.each(this,S)},map:function(S){return this.pushStack(A.map(this,function(N,U){return S.call(N,U,N)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(A.grep(this,function(S,N){return(N+1)%2}))},odd:function(){return this.pushStack(A.grep(this,function(S,N){return N%2}))},eq:function(S){var N=this.length,U=+S+(S<0?N:0);return this.pushStack(U>=0&&U<N?[this[U]]:[])},end:function(){return this.prevObject||this.constructor()},push:v,sort:c.sort,splice:c.splice},A.extend=A.fn.extend=function(){var S,N,U,G,J,Q,ne=arguments[0]||{},ge=1,fe=arguments.length,be=!1;for(typeof ne=="boolean"&&(be=ne,ne=arguments[ge]||{},ge++),typeof ne!="object"&&!k(ne)&&(ne={}),ge===fe&&(ne=this,ge--);ge<fe;ge++)if((S=arguments[ge])!=null)for(N in S)G=S[N],!(N==="__proto__"||ne===G)&&(be&&G&&(A.isPlainObject(G)||(J=Array.isArray(G)))?(U=ne[N],J&&!Array.isArray(U)?Q=[]:!J&&!A.isPlainObject(U)?Q={}:Q=U,J=!1,ne[N]=A.extend(be,Q,G)):G!==void 0&&(ne[N]=G));return ne},A.extend({expando:"jQuery"+(te+Math.random()).replace(/\D/g,""),isReady:!0,error:function(S){throw new Error(S)},noop:function(){},isPlainObject:function(S){var N,U;return!S||w.call(S)!=="[object Object]"?!1:(N=d(S),N?(U=R.call(N,"constructor")&&N.constructor,typeof U=="function"&&I.call(U)===j):!0)},isEmptyObject:function(S){var N;for(N in S)return!1;return!0},globalEval:function(S,N,U){V(S,{nonce:N&&N.nonce},U)},each:function(S,N){var U,G=0;if(de(S))for(U=S.length;G<U&&N.call(S[G],G,S[G])!==!1;G++);else for(G in S)if(N.call(S[G],G,S[G])===!1)break;return S},text:function(S){var N,U="",G=0,J=S.nodeType;if(!J)for(;N=S[G++];)U+=A.text(N);return J===1||J===11?S.textContent:J===9?S.documentElement.textContent:J===3||J===4?S.nodeValue:U},makeArray:function(S,N){var U=N||[];return S!=null&&(de(Object(S))?A.merge(U,typeof S=="string"?[S]:S):v.call(U,S)),U},inArray:function(S,N,U){return N==null?-1:x.call(N,S,U)},isXMLDoc:function(S){var N=S&&S.namespaceURI,U=S&&(S.ownerDocument||S).documentElement;return!ie.test(N||U&&U.nodeName||"HTML")},merge:function(S,N){for(var U=+N.length,G=0,J=S.length;G<U;G++)S[J++]=N[G];return S.length=J,S},grep:function(S,N,U){for(var G,J=[],Q=0,ne=S.length,ge=!U;Q<ne;Q++)G=!N(S[Q],Q),G!==ge&&J.push(S[Q]);return J},map:function(S,N,U){var G,J,Q=0,ne=[];if(de(S))for(G=S.length;Q<G;Q++)J=N(S[Q],Q,U),J!=null&&ne.push(J);else for(Q in S)J=N(S[Q],Q,U),J!=null&&ne.push(J);return _(ne)},guid:1,support:P}),typeof Symbol=="function"&&(A.fn[Symbol.iterator]=c[Symbol.iterator]),A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(S,N){T["[object "+N+"]"]=N.toLowerCase()});function de(S){var N=!!S&&"length"in S&&S.length,U=K(S);return k(S)||W(S)?!1:U==="array"||N===0||typeof N=="number"&&N>0&&N-1 in S}function ue(S,N){return S.nodeName&&S.nodeName.toLowerCase()===N.toLowerCase()}var oe=c.pop,ye=c.sort,Ee=c.splice,xe="[\\x20\\t\\r\\n\\f]",Oe=new RegExp("^"+xe+"+|((?:^|[^\\\\])(?:\\\\.)*)"+xe+"+$","g");A.contains=function(S,N){var U=N&&N.parentNode;return S===U||!!(U&&U.nodeType===1&&(S.contains?S.contains(U):S.compareDocumentPosition&&S.compareDocumentPosition(U)&16))};var ct=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function at(S,N){return N?S==="\0"?"":S.slice(0,-1)+"\\"+S.charCodeAt(S.length-1).toString(16)+" ":"\\"+S}A.escapeSelector=function(S){return(S+"").replace(ct,at)};var lt=H,He=v;(function(){var S,N,U,G,J,Q=He,ne,ge,fe,be,We,Qe=A.expando,Me=0,dt=0,on=Ed(),Gn=Ed(),un=Ed(),Gi=Ed(),Lr=function(he,Te){return he===Te&&(J=!0),0},Bo="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",da="(?:\\\\[\\da-fA-F]{1,6}"+xe+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",yt="\\["+xe+"*("+da+")(?:"+xe+"*([*^$|!~]?=)"+xe+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+da+"))|)"+xe+"*\\]",Cl=":("+da+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+yt+")*)|.*)\\)|)",Kn=new RegExp(xe+"+","g"),Jr=new RegExp("^"+xe+"*,"+xe+"*"),zu=new RegExp("^"+xe+"*([>+~]|"+xe+")"+xe+"*"),Ku=new RegExp(xe+"|>"),ua=new RegExp(Cl),qu=new RegExp("^"+da+"$"),ha={ID:new RegExp("^#("+da+")"),CLASS:new RegExp("^\\.("+da+")"),TAG:new RegExp("^("+da+"|[*])"),ATTR:new RegExp("^"+yt),PSEUDO:new RegExp("^"+Cl),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+xe+"*(even|odd|(([+-]|)(\\d*)n|)"+xe+"*(?:([+-]|)"+xe+"*(\\d+)|))"+xe+"*\\)|)","i"),bool:new RegExp("^(?:"+Bo+")$","i"),needsContext:new RegExp("^"+xe+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+xe+"*((?:-\\d)?\\d*)"+xe+"*\\)|)(?=[^-]|$)","i")},pa=/^(?:input|select|textarea|button)$/i,Fc=/^h\d$/i,uo=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,kp=/[+~]/,Ja=new RegExp("\\\\[\\da-fA-F]{1,6}"+xe+"?|\\\\([^\\r\\n\\f])","g"),ts=function(he,Te){var Ne="0x"+he.slice(1)-65536;return Te||(Ne<0?String.fromCharCode(Ne+65536):String.fromCharCode(Ne>>10|55296,Ne&1023|56320))},ww=function(){Vc()},Cw=$u(function(he){return he.disabled===!0&&ue(he,"fieldset")},{dir:"parentNode",next:"legend"});function Rw(){try{return ne.activeElement}catch{}}try{Q.apply(c=f.call(lt.childNodes),lt.childNodes),c[lt.childNodes.length].nodeType}catch{Q={apply:function(Te,Ne){He.apply(Te,f.call(Ne))},call:function(Te){He.apply(Te,f.call(arguments,1))}}}function lr(he,Te,Ne,Fe){var Je,Et,Nt,Ft,It,kn,rn,an=Te&&Te.ownerDocument,Ln=Te?Te.nodeType:9;if(Ne=Ne||[],typeof he!="string"||!he||Ln!==1&&Ln!==9&&Ln!==11)return Ne;if(!Fe&&(Vc(Te),Te=Te||ne,fe)){if(Ln!==11&&(It=uo.exec(he)))if(Je=It[1]){if(Ln===9)if(Nt=Te.getElementById(Je)){if(Nt.id===Je)return Q.call(Ne,Nt),Ne}else return Ne;else if(an&&(Nt=an.getElementById(Je))&&lr.contains(Te,Nt)&&Nt.id===Je)return Q.call(Ne,Nt),Ne}else{if(It[2])return Q.apply(Ne,Te.getElementsByTagName(he)),Ne;if((Je=It[3])&&Te.getElementsByClassName)return Q.apply(Ne,Te.getElementsByClassName(Je)),Ne}if(!Gi[he+" "]&&(!be||!be.test(he))){if(rn=he,an=Te,Ln===1&&(Ku.test(he)||zu.test(he))){for(an=kp.test(he)&&S0(Te.parentNode)||Te,(an!=Te||!P.scope)&&((Ft=Te.getAttribute("id"))?Ft=A.escapeSelector(Ft):Te.setAttribute("id",Ft=Qe)),kn=Yu(he),Et=kn.length;Et--;)kn[Et]=(Ft?"#"+Ft:":scope")+" "+Lp(kn[Et]);rn=kn.join(",")}try{return Q.apply(Ne,an.querySelectorAll(rn)),Ne}catch{Gi(he,!0)}finally{Ft===Qe&&Te.removeAttribute("id")}}}return Qa(he.replace(Oe,"$1"),Te,Ne,Fe)}function Ed(){var he=[];function Te(Ne,Fe){return he.push(Ne+" ")>N.cacheLength&&delete Te[he.shift()],Te[Ne+" "]=Fe}return Te}function Wo(he){return he[Qe]=!0,he}function vd(he){var Te=ne.createElement("fieldset");try{return!!he(Te)}catch{return!1}finally{Te.parentNode&&Te.parentNode.removeChild(Te),Te=null}}function Aw(he){return function(Te){return ue(Te,"input")&&Te.type===he}}function ho(he){return function(Te){return(ue(Te,"input")||ue(Te,"button"))&&Te.type===he}}function XE(he){return function(Te){return"form"in Te?Te.parentNode&&Te.disabled===!1?"label"in Te?"label"in Te.parentNode?Te.parentNode.disabled===he:Te.disabled===he:Te.isDisabled===he||Te.isDisabled!==!he&&Cw(Te)===he:Te.disabled===he:"label"in Te?Te.disabled===he:!1}}function Rl(he){return Wo(function(Te){return Te=+Te,Wo(function(Ne,Fe){for(var Je,Et=he([],Ne.length,Te),Nt=Et.length;Nt--;)Ne[Je=Et[Nt]]&&(Ne[Je]=!(Fe[Je]=Ne[Je]))})})}function S0(he){return he&&typeof he.getElementsByTagName<"u"&&he}function Vc(he){var Te,Ne=he?he.ownerDocument||he:lt;return Ne==ne||Ne.nodeType!==9||!Ne.documentElement||(ne=Ne,ge=ne.documentElement,fe=!A.isXMLDoc(ne),We=ge.matches||ge.webkitMatchesSelector||ge.msMatchesSelector,ge.msMatchesSelector&&lt!=ne&&(Te=ne.defaultView)&&Te.top!==Te&&Te.addEventListener("unload",ww),P.getById=vd(function(Fe){return ge.appendChild(Fe).id=A.expando,!ne.getElementsByName||!ne.getElementsByName(A.expando).length}),P.disconnectedMatch=vd(function(Fe){return We.call(Fe,"*")}),P.scope=vd(function(){return ne.querySelectorAll(":scope")}),P.cssHas=vd(function(){try{return ne.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),P.getById?(N.filter.ID=function(Fe){var Je=Fe.replace(Ja,ts);return function(Et){return Et.getAttribute("id")===Je}},N.find.ID=function(Fe,Je){if(typeof Je.getElementById<"u"&&fe){var Et=Je.getElementById(Fe);return Et?[Et]:[]}}):(N.filter.ID=function(Fe){var Je=Fe.replace(Ja,ts);return function(Et){var Nt=typeof Et.getAttributeNode<"u"&&Et.getAttributeNode("id");return Nt&&Nt.value===Je}},N.find.ID=function(Fe,Je){if(typeof Je.getElementById<"u"&&fe){var Et,Nt,Ft,It=Je.getElementById(Fe);if(It){if(Et=It.getAttributeNode("id"),Et&&Et.value===Fe)return[It];for(Ft=Je.getElementsByName(Fe),Nt=0;It=Ft[Nt++];)if(Et=It.getAttributeNode("id"),Et&&Et.value===Fe)return[It]}return[]}}),N.find.TAG=function(Fe,Je){return typeof Je.getElementsByTagName<"u"?Je.getElementsByTagName(Fe):Je.querySelectorAll(Fe)},N.find.CLASS=function(Fe,Je){if(typeof Je.getElementsByClassName<"u"&&fe)return Je.getElementsByClassName(Fe)},be=[],vd(function(Fe){var Je;ge.appendChild(Fe).innerHTML="<a id='"+Qe+"' href='' disabled='disabled'></a><select id='"+Qe+"-\r\\' disabled='disabled'><option selected=''></option></select>",Fe.querySelectorAll("[selected]").length||be.push("\\["+xe+"*(?:value|"+Bo+")"),Fe.querySelectorAll("[id~="+Qe+"-]").length||be.push("~="),Fe.querySelectorAll("a#"+Qe+"+*").length||be.push(".#.+[+~]"),Fe.querySelectorAll(":checked").length||be.push(":checked"),Je=ne.createElement("input"),Je.setAttribute("type","hidden"),Fe.appendChild(Je).setAttribute("name","D"),ge.appendChild(Fe).disabled=!0,Fe.querySelectorAll(":disabled").length!==2&&be.push(":enabled",":disabled"),Je=ne.createElement("input"),Je.setAttribute("name",""),Fe.appendChild(Je),Fe.querySelectorAll("[name='']").length||be.push("\\["+xe+"*name"+xe+"*="+xe+`*(?:''|"")`)}),P.cssHas||be.push(":has"),be=be.length&&new RegExp(be.join("|")),Lr=function(Fe,Je){if(Fe===Je)return J=!0,0;var Et=!Fe.compareDocumentPosition-!Je.compareDocumentPosition;return Et||(Et=(Fe.ownerDocument||Fe)==(Je.ownerDocument||Je)?Fe.compareDocumentPosition(Je):1,Et&1||!P.sortDetached&&Je.compareDocumentPosition(Fe)===Et?Fe===ne||Fe.ownerDocument==lt&&lr.contains(lt,Fe)?-1:Je===ne||Je.ownerDocument==lt&&lr.contains(lt,Je)?1:G?x.call(G,Fe)-x.call(G,Je):0:Et&4?-1:1)}),ne}lr.matches=function(he,Te){return lr(he,null,null,Te)},lr.matchesSelector=function(he,Te){if(Vc(he),fe&&!Gi[Te+" "]&&(!be||!be.test(Te)))try{var Ne=We.call(he,Te);if(Ne||P.disconnectedMatch||he.document&&he.document.nodeType!==11)return Ne}catch{Gi(Te,!0)}return lr(Te,ne,null,[he]).length>0},lr.contains=function(he,Te){return(he.ownerDocument||he)!=ne&&Vc(he),A.contains(he,Te)},lr.attr=function(he,Te){(he.ownerDocument||he)!=ne&&Vc(he);var Ne=N.attrHandle[Te.toLowerCase()],Fe=Ne&&R.call(N.attrHandle,Te.toLowerCase())?Ne(he,Te,!fe):void 0;return Fe!==void 0?Fe:he.getAttribute(Te)},lr.error=function(he){throw new Error("Syntax error, unrecognized expression: "+he)},A.uniqueSort=function(he){var Te,Ne=[],Fe=0,Je=0;if(J=!P.sortStable,G=!P.sortStable&&f.call(he,0),ye.call(he,Lr),J){for(;Te=he[Je++];)Te===he[Je]&&(Fe=Ne.push(Je));for(;Fe--;)Ee.call(he,Ne[Fe],1)}return G=null,he},A.fn.uniqueSort=function(){return this.pushStack(A.uniqueSort(f.apply(this)))},N=A.expr={cacheLength:50,createPseudo:Wo,match:ha,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(he){return he[1]=he[1].replace(Ja,ts),he[3]=(he[3]||he[4]||he[5]||"").replace(Ja,ts),he[2]==="~="&&(he[3]=" "+he[3]+" "),he.slice(0,4)},CHILD:function(he){return he[1]=he[1].toLowerCase(),he[1].slice(0,3)==="nth"?(he[3]||lr.error(he[0]),he[4]=+(he[4]?he[5]+(he[6]||1):2*(he[3]==="even"||he[3]==="odd")),he[5]=+(he[7]+he[8]||he[3]==="odd")):he[3]&&lr.error(he[0]),he},PSEUDO:function(he){var Te,Ne=!he[6]&&he[2];return ha.CHILD.test(he[0])?null:(he[3]?he[2]=he[4]||he[5]||"":Ne&&ua.test(Ne)&&(Te=Yu(Ne,!0))&&(Te=Ne.indexOf(")",Ne.length-Te)-Ne.length)&&(he[0]=he[0].slice(0,Te),he[2]=Ne.slice(0,Te)),he.slice(0,3))}},filter:{TAG:function(he){var Te=he.replace(Ja,ts).toLowerCase();return he==="*"?function(){return!0}:function(Ne){return ue(Ne,Te)}},CLASS:function(he){var Te=on[he+" "];return Te||(Te=new RegExp("(^|"+xe+")"+he+"("+xe+"|$)"))&&on(he,function(Ne){return Te.test(typeof Ne.className=="string"&&Ne.className||typeof Ne.getAttribute<"u"&&Ne.getAttribute("class")||"")})},ATTR:function(he,Te,Ne){return function(Fe){var Je=lr.attr(Fe,he);return Je==null?Te==="!=":Te?(Je+="",Te==="="?Je===Ne:Te==="!="?Je!==Ne:Te==="^="?Ne&&Je.indexOf(Ne)===0:Te==="*="?Ne&&Je.indexOf(Ne)>-1:Te==="$="?Ne&&Je.slice(-Ne.length)===Ne:Te==="~="?(" "+Je.replace(Kn," ")+" ").indexOf(Ne)>-1:Te==="|="?Je===Ne||Je.slice(0,Ne.length+1)===Ne+"-":!1):!0}},CHILD:function(he,Te,Ne,Fe,Je){var Et=he.slice(0,3)!=="nth",Nt=he.slice(-4)!=="last",Ft=Te==="of-type";return Fe===1&&Je===0?function(It){return!!It.parentNode}:function(It,kn,rn){var an,Ln,Yt,mr,ns,rs=Et!==Nt?"nextSibling":"previousSibling",je=It.parentNode,fa=Ft&&It.nodeName.toLowerCase(),Sd=!rn&&!Ft,gs=!1;if(je){if(Et){for(;rs;){for(Yt=It;Yt=Yt[rs];)if(Ft?ue(Yt,fa):Yt.nodeType===1)return!1;ns=rs=he==="only"&&!ns&&"nextSibling"}return!0}if(ns=[Nt?je.firstChild:je.lastChild],Nt&&Sd){for(Ln=je[Qe]||(je[Qe]={}),an=Ln[he]||[],mr=an[0]===Me&&an[1],gs=mr&&an[2],Yt=mr&&je.childNodes[mr];Yt=++mr&&Yt&&Yt[rs]||(gs=mr=0)||ns.pop();)if(Yt.nodeType===1&&++gs&&Yt===It){Ln[he]=[Me,mr,gs];break}}else if(Sd&&(Ln=It[Qe]||(It[Qe]={}),an=Ln[he]||[],mr=an[0]===Me&&an[1],gs=mr),gs===!1)for(;(Yt=++mr&&Yt&&Yt[rs]||(gs=mr=0)||ns.pop())&&!((Ft?ue(Yt,fa):Yt.nodeType===1)&&++gs&&(Sd&&(Ln=Yt[Qe]||(Yt[Qe]={}),Ln[he]=[Me,gs]),Yt===It)););return gs-=Je,gs===Fe||gs%Fe===0&&gs/Fe>=0}}},PSEUDO:function(he,Te){var Ne,Fe=N.pseudos[he]||N.setFilters[he.toLowerCase()]||lr.error("unsupported pseudo: "+he);return Fe[Qe]?Fe(Te):Fe.length>1?(Ne=[he,he,"",Te],N.setFilters.hasOwnProperty(he.toLowerCase())?Wo(function(Je,Et){for(var Nt,Ft=Fe(Je,Te),It=Ft.length;It--;)Nt=x.call(Je,Ft[It]),Je[Nt]=!(Et[Nt]=Ft[It])}):function(Je){return Fe(Je,0,Ne)}):Fe}},pseudos:{not:Wo(function(he){var Te=[],Ne=[],Fe=b0(he.replace(Oe,"$1"));return Fe[Qe]?Wo(function(Je,Et,Nt,Ft){for(var It,kn=Fe(Je,null,Ft,[]),rn=Je.length;rn--;)(It=kn[rn])&&(Je[rn]=!(Et[rn]=It))}):function(Je,Et,Nt){return Te[0]=Je,Fe(Te,null,Nt,Ne),Te[0]=null,!Ne.pop()}}),has:Wo(function(he){return function(Te){return lr(he,Te).length>0}}),contains:Wo(function(he){return he=he.replace(Ja,ts),function(Te){return(Te.textContent||A.text(Te)).indexOf(he)>-1}}),lang:Wo(function(he){return qu.test(he||"")||lr.error("unsupported lang: "+he),he=he.replace(Ja,ts).toLowerCase(),function(Te){var Ne;do if(Ne=fe?Te.lang:Te.getAttribute("xml:lang")||Te.getAttribute("lang"))return Ne=Ne.toLowerCase(),Ne===he||Ne.indexOf(he+"-")===0;while((Te=Te.parentNode)&&Te.nodeType===1);return!1}}),target:function(he){var Te=i.location&&i.location.hash;return Te&&Te.slice(1)===he.id},root:function(he){return he===ge},focus:function(he){return he===Rw()&&ne.hasFocus()&&!!(he.type||he.href||~he.tabIndex)},enabled:XE(!1),disabled:XE(!0),checked:function(he){return ue(he,"input")&&!!he.checked||ue(he,"option")&&!!he.selected},selected:function(he){return he.parentNode&&he.parentNode.selectedIndex,he.selected===!0},empty:function(he){for(he=he.firstChild;he;he=he.nextSibling)if(he.nodeType<6)return!1;return!0},parent:function(he){return!N.pseudos.empty(he)},header:function(he){return Fc.test(he.nodeName)},input:function(he){return pa.test(he.nodeName)},button:function(he){return ue(he,"input")&&he.type==="button"||ue(he,"button")},text:function(he){var Te;return ue(he,"input")&&he.type==="text"&&((Te=he.getAttribute("type"))==null||Te.toLowerCase()==="text")},first:Rl(function(){return[0]}),last:Rl(function(he,Te){return[Te-1]}),eq:Rl(function(he,Te,Ne){return[Ne<0?Ne+Te:Ne]}),even:Rl(function(he,Te){for(var Ne=0;Ne<Te;Ne+=2)he.push(Ne);return he}),odd:Rl(function(he,Te){for(var Ne=1;Ne<Te;Ne+=2)he.push(Ne);return he}),lt:Rl(function(he,Te,Ne){var Fe;for(Ne<0?Fe=Ne+Te:Ne>Te?Fe=Te:Fe=Ne;--Fe>=0;)he.push(Fe);return he}),gt:Rl(function(he,Te,Ne){for(var Fe=Ne<0?Ne+Te:Ne;++Fe<Te;)he.push(Fe);return he})}},N.pseudos.nth=N.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})N.pseudos[S]=Aw(S);for(S in{submit:!0,reset:!0})N.pseudos[S]=ho(S);function x0(){}x0.prototype=N.filters=N.pseudos,N.setFilters=new x0;function Yu(he,Te){var Ne,Fe,Je,Et,Nt,Ft,It,kn=Gn[he+" "];if(kn)return Te?0:kn.slice(0);for(Nt=he,Ft=[],It=N.preFilter;Nt;){(!Ne||(Fe=Jr.exec(Nt)))&&(Fe&&(Nt=Nt.slice(Fe[0].length)||Nt),Ft.push(Je=[])),Ne=!1,(Fe=zu.exec(Nt))&&(Ne=Fe.shift(),Je.push({value:Ne,type:Fe[0].replace(Oe," ")}),Nt=Nt.slice(Ne.length));for(Et in N.filter)(Fe=ha[Et].exec(Nt))&&(!It[Et]||(Fe=It[Et](Fe)))&&(Ne=Fe.shift(),Je.push({value:Ne,type:Et,matches:Fe}),Nt=Nt.slice(Ne.length));if(!Ne)break}return Te?Nt.length:Nt?lr.error(he):Gn(he,Ft).slice(0)}function Lp(he){for(var Te=0,Ne=he.length,Fe="";Te<Ne;Te++)Fe+=he[Te].value;return Fe}function $u(he,Te,Ne){var Fe=Te.dir,Je=Te.next,Et=Je||Fe,Nt=Ne&&Et==="parentNode",Ft=dt++;return Te.first?function(It,kn,rn){for(;It=It[Fe];)if(It.nodeType===1||Nt)return he(It,kn,rn);return!1}:function(It,kn,rn){var an,Ln,Yt=[Me,Ft];if(rn){for(;It=It[Fe];)if((It.nodeType===1||Nt)&&he(It,kn,rn))return!0}else for(;It=It[Fe];)if(It.nodeType===1||Nt)if(Ln=It[Qe]||(It[Qe]={}),Je&&ue(It,Je))It=It[Fe]||It;else{if((an=Ln[Et])&&an[0]===Me&&an[1]===Ft)return Yt[2]=an[2];if(Ln[Et]=Yt,Yt[2]=he(It,kn,rn))return!0}return!1}}function Xu(he){return he.length>1?function(Te,Ne,Fe){for(var Je=he.length;Je--;)if(!he[Je](Te,Ne,Fe))return!1;return!0}:he[0]}function Nw(he,Te,Ne){for(var Fe=0,Je=Te.length;Fe<Je;Fe++)lr(he,Te[Fe],Ne);return Ne}function Mp(he,Te,Ne,Fe,Je){for(var Et,Nt=[],Ft=0,It=he.length,kn=Te!=null;Ft<It;Ft++)(Et=he[Ft])&&(!Ne||Ne(Et,Fe,Je))&&(Nt.push(Et),kn&&Te.push(Ft));return Nt}function yd(he,Te,Ne,Fe,Je,Et){return Fe&&!Fe[Qe]&&(Fe=yd(Fe)),Je&&!Je[Qe]&&(Je=yd(Je,Et)),Wo(function(Nt,Ft,It,kn){var rn,an,Ln,Yt,mr=[],ns=[],rs=Ft.length,je=Nt||Nw(Te||"*",It.nodeType?[It]:It,[]),fa=he&&(Nt||!Te)?Mp(je,mr,he,It,kn):je;if(Ne?(Yt=Je||(Nt?he:rs||Fe)?[]:Ft,Ne(fa,Yt,It,kn)):Yt=fa,Fe)for(rn=Mp(Yt,ns),Fe(rn,[],It,kn),an=rn.length;an--;)(Ln=rn[an])&&(Yt[ns[an]]=!(fa[ns[an]]=Ln));if(Nt){if(Je||he){if(Je){for(rn=[],an=Yt.length;an--;)(Ln=Yt[an])&&rn.push(fa[an]=Ln);Je(null,Yt=[],rn,kn)}for(an=Yt.length;an--;)(Ln=Yt[an])&&(rn=Je?x.call(Nt,Ln):mr[an])>-1&&(Nt[rn]=!(Ft[rn]=Ln))}}else Yt=Mp(Yt===Ft?Yt.splice(rs,Yt.length):Yt),Je?Je(null,Ft,Yt,kn):Q.apply(Ft,Yt)})}function T0(he){for(var Te,Ne,Fe,Je=he.length,Et=N.relative[he[0].type],Nt=Et||N.relative[" "],Ft=Et?1:0,It=$u(function(an){return an===Te},Nt,!0),kn=$u(function(an){return x.call(Te,an)>-1},Nt,!0),rn=[function(an,Ln,Yt){var mr=!Et&&(Yt||Ln!=U)||((Te=Ln).nodeType?It(an,Ln,Yt):kn(an,Ln,Yt));return Te=null,mr}];Ft<Je;Ft++)if(Ne=N.relative[he[Ft].type])rn=[$u(Xu(rn),Ne)];else{if(Ne=N.filter[he[Ft].type].apply(null,he[Ft].matches),Ne[Qe]){for(Fe=++Ft;Fe<Je&&!N.relative[he[Fe].type];Fe++);return yd(Ft>1&&Xu(rn),Ft>1&&Lp(he.slice(0,Ft-1).concat({value:he[Ft-2].type===" "?"*":""})).replace(Oe,"$1"),Ne,Ft<Fe&&T0(he.slice(Ft,Fe)),Fe<Je&&T0(he=he.slice(Fe)),Fe<Je&&Lp(he))}rn.push(Ne)}return Xu(rn)}function Iw(he,Te){var Ne=Te.length>0,Fe=he.length>0,Je=function(Et,Nt,Ft,It,kn){var rn,an,Ln,Yt=0,mr="0",ns=Et&&[],rs=[],je=U,fa=Et||Fe&&N.find.TAG("*",kn),Sd=Me+=je==null?1:Math.random()||.1,gs=fa.length;for(kn&&(U=Nt==ne||Nt||kn);mr!==gs&&(rn=fa[mr])!=null;mr++){if(Fe&&rn){for(an=0,!Nt&&rn.ownerDocument!=ne&&(Vc(rn),Ft=!fe);Ln=he[an++];)if(Ln(rn,Nt||ne,Ft)){Q.call(It,rn);break}kn&&(Me=Sd)}Ne&&((rn=!Ln&&rn)&&Yt--,Et&&ns.push(rn))}if(Yt+=mr,Ne&&mr!==Yt){for(an=0;Ln=Te[an++];)Ln(ns,rs,Nt,Ft);if(Et){if(Yt>0)for(;mr--;)ns[mr]||rs[mr]||(rs[mr]=oe.call(It));rs=Mp(rs)}Q.apply(It,rs),kn&&!Et&&rs.length>0&&Yt+Te.length>1&&A.uniqueSort(It)}return kn&&(Me=Sd,U=je),ns};return Ne?Wo(Je):Je}function b0(he,Te){var Ne,Fe=[],Je=[],Et=un[he+" "];if(!Et){for(Te||(Te=Yu(he)),Ne=Te.length;Ne--;)Et=T0(Te[Ne]),Et[Qe]?Fe.push(Et):Je.push(Et);Et=un(he,Iw(Je,Fe)),Et.selector=he}return Et}function Qa(he,Te,Ne,Fe){var Je,Et,Nt,Ft,It,kn=typeof he=="function"&&he,rn=!Fe&&Yu(he=kn.selector||he);if(Ne=Ne||[],rn.length===1){if(Et=rn[0]=rn[0].slice(0),Et.length>2&&(Nt=Et[0]).type==="ID"&&Te.nodeType===9&&fe&&N.relative[Et[1].type]){if(Te=(N.find.ID(Nt.matches[0].replace(Ja,ts),Te)||[])[0],Te)kn&&(Te=Te.parentNode);else return Ne;he=he.slice(Et.shift().value.length)}for(Je=ha.needsContext.test(he)?0:Et.length;Je--&&(Nt=Et[Je],!N.relative[Ft=Nt.type]);)if((It=N.find[Ft])&&(Fe=It(Nt.matches[0].replace(Ja,ts),kp.test(Et[0].type)&&S0(Te.parentNode)||Te))){if(Et.splice(Je,1),he=Fe.length&&Lp(Et),!he)return Q.apply(Ne,Fe),Ne;break}}return(kn||b0(he,rn))(Fe,Te,!fe,Ne,!Te||kp.test(he)&&S0(Te.parentNode)||Te),Ne}P.sortStable=Qe.split("").sort(Lr).join("")===Qe,Vc(),P.sortDetached=vd(function(he){return he.compareDocumentPosition(ne.createElement("fieldset"))&1}),A.find=lr,A.expr[":"]=A.expr.pseudos,A.unique=A.uniqueSort,lr.compile=b0,lr.select=Qa,lr.setDocument=Vc,lr.tokenize=Yu,lr.escape=A.escapeSelector,lr.getText=A.text,lr.isXML=A.isXMLDoc,lr.selectors=A.expr,lr.support=A.support,lr.uniqueSort=A.uniqueSort})();var et=function(S,N,U){for(var G=[],J=U!==void 0;(S=S[N])&&S.nodeType!==9;)if(S.nodeType===1){if(J&&A(S).is(U))break;G.push(S)}return G},ut=function(S,N){for(var U=[];S;S=S.nextSibling)S.nodeType===1&&S!==N&&U.push(S);return U},Ae=A.expr.match.needsContext,Le=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function ze(S,N,U){return k(N)?A.grep(S,function(G,J){return!!N.call(G,J,G)!==U}):N.nodeType?A.grep(S,function(G){return G===N!==U}):typeof N!="string"?A.grep(S,function(G){return x.call(N,G)>-1!==U}):A.filter(N,S,U)}A.filter=function(S,N,U){var G=N[0];return U&&(S=":not("+S+")"),N.length===1&&G.nodeType===1?A.find.matchesSelector(G,S)?[G]:[]:A.find.matches(S,A.grep(N,function(J){return J.nodeType===1}))},A.fn.extend({find:function(S){var N,U,G=this.length,J=this;if(typeof S!="string")return this.pushStack(A(S).filter(function(){for(N=0;N<G;N++)if(A.contains(J[N],this))return!0}));for(U=this.pushStack([]),N=0;N<G;N++)A.find(S,J[N],U);return G>1?A.uniqueSort(U):U},filter:function(S){return this.pushStack(ze(this,S||[],!1))},not:function(S){return this.pushStack(ze(this,S||[],!0))},is:function(S){return!!ze(this,typeof S=="string"&&Ae.test(S)?A(S):S||[],!1).length}});var qe,fn=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,qt=A.fn.init=function(S,N,U){var G,J;if(!S)return this;if(U=U||qe,typeof S=="string")if(S[0]==="<"&&S[S.length-1]===">"&&S.length>=3?G=[null,S,null]:G=fn.exec(S),G&&(G[1]||!N))if(G[1]){if(N=N instanceof A?N[0]:N,A.merge(this,A.parseHTML(G[1],N&&N.nodeType?N.ownerDocument||N:H,!0)),Le.test(G[1])&&A.isPlainObject(N))for(G in N)k(this[G])?this[G](N[G]):this.attr(G,N[G]);return this}else return J=H.getElementById(G[2]),J&&(this[0]=J,this.length=1),this;else return!N||N.jquery?(N||U).find(S):this.constructor(N).find(S);else{if(S.nodeType)return this[0]=S,this.length=1,this;if(k(S))return U.ready!==void 0?U.ready(S):S(A)}return A.makeArray(S,this)};qt.prototype=A.fn,qe=A(H);var Dn=/^(?:parents|prev(?:Until|All))/,Kt={children:!0,contents:!0,next:!0,prev:!0};A.fn.extend({has:function(S){var N=A(S,this),U=N.length;return this.filter(function(){for(var G=0;G<U;G++)if(A.contains(this,N[G]))return!0})},closest:function(S,N){var U,G=0,J=this.length,Q=[],ne=typeof S!="string"&&A(S);if(!Ae.test(S)){for(;G<J;G++)for(U=this[G];U&&U!==N;U=U.parentNode)if(U.nodeType<11&&(ne?ne.index(U)>-1:U.nodeType===1&&A.find.matchesSelector(U,S))){Q.push(U);break}}return this.pushStack(Q.length>1?A.uniqueSort(Q):Q)},index:function(S){return S?typeof S=="string"?x.call(A(S),this[0]):x.call(this,S.jquery?S[0]:S):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(S,N){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(S,N))))},addBack:function(S){return this.add(S==null?this.prevObject:this.prevObject.filter(S))}});function hr(S,N){for(;(S=S[N])&&S.nodeType!==1;);return S}A.each({parent:function(S){var N=S.parentNode;return N&&N.nodeType!==11?N:null},parents:function(S){return et(S,"parentNode")},parentsUntil:function(S,N,U){return et(S,"parentNode",U)},next:function(S){return hr(S,"nextSibling")},prev:function(S){return hr(S,"previousSibling")},nextAll:function(S){return et(S,"nextSibling")},prevAll:function(S){return et(S,"previousSibling")},nextUntil:function(S,N,U){return et(S,"nextSibling",U)},prevUntil:function(S,N,U){return et(S,"previousSibling",U)},siblings:function(S){return ut((S.parentNode||{}).firstChild,S)},children:function(S){return ut(S.firstChild)},contents:function(S){return S.contentDocument!=null&&d(S.contentDocument)?S.contentDocument:(ue(S,"template")&&(S=S.content||S),A.merge([],S.childNodes))}},function(S,N){A.fn[S]=function(U,G){var J=A.map(this,N,U);return S.slice(-5)!=="Until"&&(G=U),G&&typeof G=="string"&&(J=A.filter(G,J)),this.length>1&&(Kt[S]||A.uniqueSort(J),Dn.test(S)&&J.reverse()),this.pushStack(J)}});var Bn=/[^\x20\t\r\n\f]+/g;function Yr(S){var N={};return A.each(S.match(Bn)||[],function(U,G){N[G]=!0}),N}A.Callbacks=function(S){S=typeof S=="string"?Yr(S):A.extend({},S);var N,U,G,J,Q=[],ne=[],ge=-1,fe=function(){for(J=J||S.once,G=N=!0;ne.length;ge=-1)for(U=ne.shift();++ge<Q.length;)Q[ge].apply(U[0],U[1])===!1&&S.stopOnFalse&&(ge=Q.length,U=!1);S.memory||(U=!1),N=!1,J&&(U?Q=[]:Q="")},be={add:function(){return Q&&(U&&!N&&(ge=Q.length-1,ne.push(U)),function We(Qe){A.each(Qe,function(Me,dt){k(dt)?(!S.unique||!be.has(dt))&&Q.push(dt):dt&&dt.length&&K(dt)!=="string"&&We(dt)})}(arguments),U&&!N&&fe()),this},remove:function(){return A.each(arguments,function(We,Qe){for(var Me;(Me=A.inArray(Qe,Q,Me))>-1;)Q.splice(Me,1),Me<=ge&&ge--}),this},has:function(We){return We?A.inArray(We,Q)>-1:Q.length>0},empty:function(){return Q&&(Q=[]),this},disable:function(){return J=ne=[],Q=U="",this},disabled:function(){return!Q},lock:function(){return J=ne=[],!U&&!N&&(Q=U=""),this},locked:function(){return!!J},fireWith:function(We,Qe){return J||(Qe=Qe||[],Qe=[We,Qe.slice?Qe.slice():Qe],ne.push(Qe),N||fe()),this},fire:function(){return be.fireWith(this,arguments),this},fired:function(){return!!G}};return be};function yr(S){return S}function cr(S){throw S}function ri(S,N,U,G){var J;try{S&&k(J=S.promise)?J.call(S).done(N).fail(U):S&&k(J=S.then)?J.call(S,N,U):N.apply(void 0,[S].slice(G))}catch(Q){U.apply(void 0,[Q])}}A.extend({Deferred:function(S){var N=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],U="pending",G={state:function(){return U},always:function(){return J.done(arguments).fail(arguments),this},catch:function(Q){return G.then(null,Q)},pipe:function(){var Q=arguments;return A.Deferred(function(ne){A.each(N,function(ge,fe){var be=k(Q[fe[4]])&&Q[fe[4]];J[fe[1]](function(){var We=be&&be.apply(this,arguments);We&&k(We.promise)?We.promise().progress(ne.notify).done(ne.resolve).fail(ne.reject):ne[fe[0]+"With"](this,be?[We]:arguments)})}),Q=null}).promise()},then:function(Q,ne,ge){var fe=0;function be(We,Qe,Me,dt){return function(){var on=this,Gn=arguments,un=function(){var Lr,Bo;if(!(We<fe)){if(Lr=Me.apply(on,Gn),Lr===Qe.promise())throw new TypeError("Thenable self-resolution");Bo=Lr&&(typeof Lr=="object"||typeof Lr=="function")&&Lr.then,k(Bo)?dt?Bo.call(Lr,be(fe,Qe,yr,dt),be(fe,Qe,cr,dt)):(fe++,Bo.call(Lr,be(fe,Qe,yr,dt),be(fe,Qe,cr,dt),be(fe,Qe,yr,Qe.notifyWith))):(Me!==yr&&(on=void 0,Gn=[Lr]),(dt||Qe.resolveWith)(on,Gn))}},Gi=dt?un:function(){try{un()}catch(Lr){A.Deferred.exceptionHook&&A.Deferred.exceptionHook(Lr,Gi.error),We+1>=fe&&(Me!==cr&&(on=void 0,Gn=[Lr]),Qe.rejectWith(on,Gn))}};We?Gi():(A.Deferred.getErrorHook?Gi.error=A.Deferred.getErrorHook():A.Deferred.getStackHook&&(Gi.error=A.Deferred.getStackHook()),i.setTimeout(Gi))}}return A.Deferred(function(We){N[0][3].add(be(0,We,k(ge)?ge:yr,We.notifyWith)),N[1][3].add(be(0,We,k(Q)?Q:yr)),N[2][3].add(be(0,We,k(ne)?ne:cr))}).promise()},promise:function(Q){return Q!=null?A.extend(Q,G):G}},J={};return A.each(N,function(Q,ne){var ge=ne[2],fe=ne[5];G[ne[1]]=ge.add,fe&&ge.add(function(){U=fe},N[3-Q][2].disable,N[3-Q][3].disable,N[0][2].lock,N[0][3].lock),ge.add(ne[3].fire),J[ne[0]]=function(){return J[ne[0]+"With"](this===J?void 0:this,arguments),this},J[ne[0]+"With"]=ge.fireWith}),G.promise(J),S&&S.call(J,J),J},when:function(S){var N=arguments.length,U=N,G=Array(U),J=f.call(arguments),Q=A.Deferred(),ne=function(ge){return function(fe){G[ge]=this,J[ge]=arguments.length>1?f.call(arguments):fe,--N||Q.resolveWith(G,J)}};if(N<=1&&(ri(S,Q.done(ne(U)).resolve,Q.reject,!N),Q.state()==="pending"||k(J[U]&&J[U].then)))return Q.then();for(;U--;)ri(J[U],ne(U),Q.reject);return Q.promise()}});var jo=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(S,N){i.console&&i.console.warn&&S&&jo.test(S.name)&&i.console.warn("jQuery.Deferred exception: "+S.message,S.stack,N)},A.readyException=function(S){i.setTimeout(function(){throw S})};var gi=A.Deferred();A.fn.ready=function(S){return gi.then(S).catch(function(N){A.readyException(N)}),this},A.extend({isReady:!1,readyWait:1,ready:function(S){(S===!0?--A.readyWait:A.isReady)||(A.isReady=!0,!(S!==!0&&--A.readyWait>0)&&gi.resolveWith(H,[A]))}}),A.ready.then=gi.then;function mn(){H.removeEventListener("DOMContentLoaded",mn),i.removeEventListener("load",mn),A.ready()}H.readyState==="complete"||H.readyState!=="loading"&&!H.documentElement.doScroll?i.setTimeout(A.ready):(H.addEventListener("DOMContentLoaded",mn),i.addEventListener("load",mn));var Pn=function(S,N,U,G,J,Q,ne){var ge=0,fe=S.length,be=U==null;if(K(U)==="object"){J=!0;for(ge in U)Pn(S,N,ge,U[ge],!0,Q,ne)}else if(G!==void 0&&(J=!0,k(G)||(ne=!0),be&&(ne?(N.call(S,G),N=null):(be=N,N=function(We,Qe,Me){return be.call(A(We),Me)})),N))for(;ge<fe;ge++)N(S[ge],U,ne?G:G.call(S[ge],ge,N(S[ge],U)));return J?S:be?N.call(S):fe?N(S[0],U):Q},$r=/^-ms-/,ve=/-([a-z])/g;function De(S,N){return N.toUpperCase()}function Ve(S){return S.replace($r,"ms-").replace(ve,De)}var gt=function(S){return S.nodeType===1||S.nodeType===9||!+S.nodeType};function ot(){this.expando=A.expando+ot.uid++}ot.uid=1,ot.prototype={cache:function(S){var N=S[this.expando];return N||(N={},gt(S)&&(S.nodeType?S[this.expando]=N:Object.defineProperty(S,this.expando,{value:N,configurable:!0}))),N},set:function(S,N,U){var G,J=this.cache(S);if(typeof N=="string")J[Ve(N)]=U;else for(G in N)J[Ve(G)]=N[G];return J},get:function(S,N){return N===void 0?this.cache(S):S[this.expando]&&S[this.expando][Ve(N)]},access:function(S,N,U){return N===void 0||N&&typeof N=="string"&&U===void 0?this.get(S,N):(this.set(S,N,U),U!==void 0?U:N)},remove:function(S,N){var U,G=S[this.expando];if(G!==void 0){if(N!==void 0)for(Array.isArray(N)?N=N.map(Ve):(N=Ve(N),N=N in G?[N]:N.match(Bn)||[]),U=N.length;U--;)delete G[N[U]];(N===void 0||A.isEmptyObject(G))&&(S.nodeType?S[this.expando]=void 0:delete S[this.expando])}},hasData:function(S){var N=S[this.expando];return N!==void 0&&!A.isEmptyObject(N)}};var Ue=new ot,St=new ot,dn=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,nr=/[A-Z]/g;function Ci(S){return S==="true"?!0:S==="false"?!1:S==="null"?null:S===+S+""?+S:dn.test(S)?JSON.parse(S):S}function Uo(S,N,U){var G;if(U===void 0&&S.nodeType===1)if(G="data-"+N.replace(nr,"-$&").toLowerCase(),U=S.getAttribute(G),typeof U=="string"){try{U=Ci(U)}catch{}St.set(S,N,U)}else U=void 0;return U}A.extend({hasData:function(S){return St.hasData(S)||Ue.hasData(S)},data:function(S,N,U){return St.access(S,N,U)},removeData:function(S,N){St.remove(S,N)},_data:function(S,N,U){return Ue.access(S,N,U)},_removeData:function(S,N){Ue.remove(S,N)}}),A.fn.extend({data:function(S,N){var U,G,J,Q=this[0],ne=Q&&Q.attributes;if(S===void 0){if(this.length&&(J=St.get(Q),Q.nodeType===1&&!Ue.get(Q,"hasDataAttrs"))){for(U=ne.length;U--;)ne[U]&&(G=ne[U].name,G.indexOf("data-")===0&&(G=Ve(G.slice(5)),Uo(Q,G,J[G])));Ue.set(Q,"hasDataAttrs",!0)}return J}return typeof S=="object"?this.each(function(){St.set(this,S)}):Pn(this,function(ge){var fe;if(Q&&ge===void 0)return fe=St.get(Q,S),fe!==void 0||(fe=Uo(Q,S),fe!==void 0)?fe:void 0;this.each(function(){St.set(this,S,ge)})},null,N,arguments.length>1,null,!0)},removeData:function(S){return this.each(function(){St.remove(this,S)})}}),A.extend({queue:function(S,N,U){var G;if(S)return N=(N||"fx")+"queue",G=Ue.get(S,N),U&&(!G||Array.isArray(U)?G=Ue.access(S,N,A.makeArray(U)):G.push(U)),G||[]},dequeue:function(S,N){N=N||"fx";var U=A.queue(S,N),G=U.length,J=U.shift(),Q=A._queueHooks(S,N),ne=function(){A.dequeue(S,N)};J==="inprogress"&&(J=U.shift(),G--),J&&(N==="fx"&&U.unshift("inprogress"),delete Q.stop,J.call(S,ne,Q)),!G&&Q&&Q.empty.fire()},_queueHooks:function(S,N){var U=N+"queueHooks";return Ue.get(S,U)||Ue.access(S,U,{empty:A.Callbacks("once memory").add(function(){Ue.remove(S,[N+"queue",U])})})}}),A.fn.extend({queue:function(S,N){var U=2;return typeof S!="string"&&(N=S,S="fx",U--),arguments.length<U?A.queue(this[0],S):N===void 0?this:this.each(function(){var G=A.queue(this,S,N);A._queueHooks(this,S),S==="fx"&&G[0]!=="inprogress"&&A.dequeue(this,S)})},dequeue:function(S){return this.each(function(){A.dequeue(this,S)})},clearQueue:function(S){return this.queue(S||"fx",[])},promise:function(S,N){var U,G=1,J=A.Deferred(),Q=this,ne=this.length,ge=function(){--G||J.resolveWith(Q,[Q])};for(typeof S!="string"&&(N=S,S=void 0),S=S||"fx";ne--;)U=Ue.get(Q[ne],S+"queueHooks"),U&&U.empty&&(G++,U.empty.add(ge));return ge(),J.promise(N)}});var Ri=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Rs=new RegExp("^(?:([+-])=|)("+Ri+")([a-z%]*)$","i"),Zi=["Top","Right","Bottom","Left"],_i=H.documentElement,lo=function(S){return A.contains(S.ownerDocument,S)},md={composed:!0};_i.getRootNode&&(lo=function(S){return A.contains(S.ownerDocument,S)||S.getRootNode(md)===S.ownerDocument});var Lc=function(S,N){return S=N||S,S.style.display==="none"||S.style.display===""&&lo(S)&&A.css(S,"display")==="none"};function Ys(S,N,U,G){var J,Q,ne=20,ge=G?function(){return G.cur()}:function(){return A.css(S,N,"")},fe=ge(),be=U&&U[3]||(A.cssNumber[N]?"":"px"),We=S.nodeType&&(A.cssNumber[N]||be!=="px"&&+fe)&&Rs.exec(A.css(S,N));if(We&&We[3]!==be){for(fe=fe/2,be=be||We[3],We=+fe||1;ne--;)A.style(S,N,We+be),(1-Q)*(1-(Q=ge()/fe||.5))<=0&&(ne=0),We=We/Q;We=We*2,A.style(S,N,We+be),U=U||[]}return U&&(We=+We||+fe||0,J=U[1]?We+(U[1]+1)*U[2]:+U[2],G&&(G.unit=be,G.start=We,G.end=J)),J}var Lu={};function Ap(S){var N,U=S.ownerDocument,G=S.nodeName,J=Lu[G];return J||(N=U.body.appendChild(U.createElement(G)),J=A.css(N,"display"),N.parentNode.removeChild(N),J==="none"&&(J="block"),Lu[G]=J,J)}function Mc(S,N){for(var U,G,J=[],Q=0,ne=S.length;Q<ne;Q++)G=S[Q],G.style&&(U=G.style.display,N?(U==="none"&&(J[Q]=Ue.get(G,"display")||null,J[Q]||(G.style.display="")),G.style.display===""&&Lc(G)&&(J[Q]=Ap(G))):U!=="none"&&(J[Q]="none",Ue.set(G,"display",U)));for(Q=0;Q<ne;Q++)J[Q]!=null&&(S[Q].style.display=J[Q]);return S}A.fn.extend({show:function(){return Mc(this,!0)},hide:function(){return Mc(this)},toggle:function(S){return typeof S=="boolean"?S?this.show():this.hide():this.each(function(){Lc(this)?A(this).show():A(this).hide()})}});var jc=/^(?:checkbox|radio)$/i,Np=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Uc=/^$|^module$|\/(?:java|ecma)script/i;(function(){var S=H.createDocumentFragment(),N=S.appendChild(H.createElement("div")),U=H.createElement("input");U.setAttribute("type","radio"),U.setAttribute("checked","checked"),U.setAttribute("name","t"),N.appendChild(U),P.checkClone=N.cloneNode(!0).cloneNode(!0).lastChild.checked,N.innerHTML="<textarea>x</textarea>",P.noCloneChecked=!!N.cloneNode(!0).lastChild.defaultValue,N.innerHTML="<option></option>",P.option=!!N.lastChild})();var As={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};As.tbody=As.tfoot=As.colgroup=As.caption=As.thead,As.th=As.td,P.option||(As.optgroup=As.option=[1,"<select multiple='multiple'>","</select>"]);function Xr(S,N){var U;return typeof S.getElementsByTagName<"u"?U=S.getElementsByTagName(N||"*"):typeof S.querySelectorAll<"u"?U=S.querySelectorAll(N||"*"):U=[],N===void 0||N&&ue(S,N)?A.merge([S],U):U}function Mu(S,N){for(var U=0,G=S.length;U<G;U++)Ue.set(S[U],"globalEval",!N||Ue.get(N[U],"globalEval"))}var a0=/<|&#?\w+;/;function ju(S,N,U,G,J){for(var Q,ne,ge,fe,be,We,Qe=N.createDocumentFragment(),Me=[],dt=0,on=S.length;dt<on;dt++)if(Q=S[dt],Q||Q===0)if(K(Q)==="object")A.merge(Me,Q.nodeType?[Q]:Q);else if(!a0.test(Q))Me.push(N.createTextNode(Q));else{for(ne=ne||Qe.appendChild(N.createElement("div")),ge=(Np.exec(Q)||["",""])[1].toLowerCase(),fe=As[ge]||As._default,ne.innerHTML=fe[1]+A.htmlPrefilter(Q)+fe[2],We=fe[0];We--;)ne=ne.lastChild;A.merge(Me,ne.childNodes),ne=Qe.firstChild,ne.textContent=""}for(Qe.textContent="",dt=0;Q=Me[dt++];){if(G&&A.inArray(Q,G)>-1){J&&J.push(Q);continue}if(be=lo(Q),ne=Xr(Qe.appendChild(Q),"script"),be&&Mu(ne),U)for(We=0;Q=ne[We++];)Uc.test(Q.type||"")&&U.push(Q)}return Qe}var Hi=/^([^.]*)(?:\.(.+)|)/;function Ka(){return!0}function Ei(){return!1}function ms(S,N,U,G,J,Q){var ne,ge;if(typeof N=="object"){typeof U!="string"&&(G=G||U,U=void 0);for(ge in N)ms(S,ge,U,G,N[ge],Q);return S}if(G==null&&J==null?(J=U,G=U=void 0):J==null&&(typeof U=="string"?(J=G,G=void 0):(J=G,G=U,U=void 0)),J===!1)J=Ei;else if(!J)return S;return Q===1&&(ne=J,J=function(fe){return A().off(fe),ne.apply(this,arguments)},J.guid=ne.guid||(ne.guid=A.guid++)),S.each(function(){A.event.add(this,N,J,G,U)})}A.event={global:{},add:function(S,N,U,G,J){var Q,ne,ge,fe,be,We,Qe,Me,dt,on,Gn,un=Ue.get(S);if(gt(S))for(U.handler&&(Q=U,U=Q.handler,J=Q.selector),J&&A.find.matchesSelector(_i,J),U.guid||(U.guid=A.guid++),(fe=un.events)||(fe=un.events=Object.create(null)),(ne=un.handle)||(ne=un.handle=function(Gi){return typeof A<"u"&&A.event.triggered!==Gi.type?A.event.dispatch.apply(S,arguments):void 0}),N=(N||"").match(Bn)||[""],be=N.length;be--;)ge=Hi.exec(N[be])||[],dt=Gn=ge[1],on=(ge[2]||"").split(".").sort(),dt&&(Qe=A.event.special[dt]||{},dt=(J?Qe.delegateType:Qe.bindType)||dt,Qe=A.event.special[dt]||{},We=A.extend({type:dt,origType:Gn,data:G,handler:U,guid:U.guid,selector:J,needsContext:J&&A.expr.match.needsContext.test(J),namespace:on.join(".")},Q),(Me=fe[dt])||(Me=fe[dt]=[],Me.delegateCount=0,(!Qe.setup||Qe.setup.call(S,G,on,ne)===!1)&&S.addEventListener&&S.addEventListener(dt,ne)),Qe.add&&(Qe.add.call(S,We),We.handler.guid||(We.handler.guid=U.guid)),J?Me.splice(Me.delegateCount++,0,We):Me.push(We),A.event.global[dt]=!0)},remove:function(S,N,U,G,J){var Q,ne,ge,fe,be,We,Qe,Me,dt,on,Gn,un=Ue.hasData(S)&&Ue.get(S);if(!(!un||!(fe=un.events))){for(N=(N||"").match(Bn)||[""],be=N.length;be--;){if(ge=Hi.exec(N[be])||[],dt=Gn=ge[1],on=(ge[2]||"").split(".").sort(),!dt){for(dt in fe)A.event.remove(S,dt+N[be],U,G,!0);continue}for(Qe=A.event.special[dt]||{},dt=(G?Qe.delegateType:Qe.bindType)||dt,Me=fe[dt]||[],ge=ge[2]&&new RegExp("(^|\\.)"+on.join("\\.(?:.*\\.|)")+"(\\.|$)"),ne=Q=Me.length;Q--;)We=Me[Q],(J||Gn===We.origType)&&(!U||U.guid===We.guid)&&(!ge||ge.test(We.namespace))&&(!G||G===We.selector||G==="**"&&We.selector)&&(Me.splice(Q,1),We.selector&&Me.delegateCount--,Qe.remove&&Qe.remove.call(S,We));ne&&!Me.length&&((!Qe.teardown||Qe.teardown.call(S,on,un.handle)===!1)&&A.removeEvent(S,dt,un.handle),delete fe[dt])}A.isEmptyObject(fe)&&Ue.remove(S,"handle events")}},dispatch:function(S){var N,U,G,J,Q,ne,ge=new Array(arguments.length),fe=A.event.fix(S),be=(Ue.get(this,"events")||Object.create(null))[fe.type]||[],We=A.event.special[fe.type]||{};for(ge[0]=fe,N=1;N<arguments.length;N++)ge[N]=arguments[N];if(fe.delegateTarget=this,!(We.preDispatch&&We.preDispatch.call(this,fe)===!1)){for(ne=A.event.handlers.call(this,fe,be),N=0;(J=ne[N++])&&!fe.isPropagationStopped();)for(fe.currentTarget=J.elem,U=0;(Q=J.handlers[U++])&&!fe.isImmediatePropagationStopped();)(!fe.rnamespace||Q.namespace===!1||fe.rnamespace.test(Q.namespace))&&(fe.handleObj=Q,fe.data=Q.data,G=((A.event.special[Q.origType]||{}).handle||Q.handler).apply(J.elem,ge),G!==void 0&&(fe.result=G)===!1&&(fe.preventDefault(),fe.stopPropagation()));return We.postDispatch&&We.postDispatch.call(this,fe),fe.result}},handlers:function(S,N){var U,G,J,Q,ne,ge=[],fe=N.delegateCount,be=S.target;if(fe&&be.nodeType&&!(S.type==="click"&&S.button>=1)){for(;be!==this;be=be.parentNode||this)if(be.nodeType===1&&!(S.type==="click"&&be.disabled===!0)){for(Q=[],ne={},U=0;U<fe;U++)G=N[U],J=G.selector+" ",ne[J]===void 0&&(ne[J]=G.needsContext?A(J,this).index(be)>-1:A.find(J,this,null,[be]).length),ne[J]&&Q.push(G);Q.length&&ge.push({elem:be,handlers:Q})}}return be=this,fe<N.length&&ge.push({elem:be,handlers:N.slice(fe)}),ge},addProp:function(S,N){Object.defineProperty(A.Event.prototype,S,{enumerable:!0,configurable:!0,get:k(N)?function(){if(this.originalEvent)return N(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[S]},set:function(U){Object.defineProperty(this,S,{enumerable:!0,configurable:!0,writable:!0,value:U})}})},fix:function(S){return S[A.expando]?S:new A.Event(S)},special:{load:{noBubble:!0},click:{setup:function(S){var N=this||S;return jc.test(N.type)&&N.click&&ue(N,"input")&&qa(N,"click",!0),!1},trigger:function(S){var N=this||S;return jc.test(N.type)&&N.click&&ue(N,"input")&&qa(N,"click"),!0},_default:function(S){var N=S.target;return jc.test(N.type)&&N.click&&ue(N,"input")&&Ue.get(N,"click")||ue(N,"a")}},beforeunload:{postDispatch:function(S){S.result!==void 0&&S.originalEvent&&(S.originalEvent.returnValue=S.result)}}}};function qa(S,N,U){if(!U){Ue.get(S,N)===void 0&&A.event.add(S,N,Ka);return}Ue.set(S,N,!1),A.event.add(S,N,{namespace:!1,handler:function(G){var J,Q=Ue.get(this,N);if(G.isTrigger&1&&this[N]){if(Q)(A.event.special[N]||{}).delegateType&&G.stopPropagation();else if(Q=f.call(arguments),Ue.set(this,N,Q),this[N](),J=Ue.get(this,N),Ue.set(this,N,!1),Q!==J)return G.stopImmediatePropagation(),G.preventDefault(),J}else Q&&(Ue.set(this,N,A.event.trigger(Q[0],Q.slice(1),this)),G.stopPropagation(),G.isImmediatePropagationStopped=Ka)}})}A.removeEvent=function(S,N,U){S.removeEventListener&&S.removeEventListener(N,U)},A.Event=function(S,N){if(!(this instanceof A.Event))return new A.Event(S,N);S&&S.type?(this.originalEvent=S,this.type=S.type,this.isDefaultPrevented=S.defaultPrevented||S.defaultPrevented===void 0&&S.returnValue===!1?Ka:Ei,this.target=S.target&&S.target.nodeType===3?S.target.parentNode:S.target,this.currentTarget=S.currentTarget,this.relatedTarget=S.relatedTarget):this.type=S,N&&A.extend(this,N),this.timeStamp=S&&S.timeStamp||Date.now(),this[A.expando]=!0},A.Event.prototype={constructor:A.Event,isDefaultPrevented:Ei,isPropagationStopped:Ei,isImmediatePropagationStopped:Ei,isSimulated:!1,preventDefault:function(){var S=this.originalEvent;this.isDefaultPrevented=Ka,S&&!this.isSimulated&&S.preventDefault()},stopPropagation:function(){var S=this.originalEvent;this.isPropagationStopped=Ka,S&&!this.isSimulated&&S.stopPropagation()},stopImmediatePropagation:function(){var S=this.originalEvent;this.isImmediatePropagationStopped=Ka,S&&!this.isSimulated&&S.stopImmediatePropagation(),this.stopPropagation()}},A.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},A.event.addProp),A.each({focus:"focusin",blur:"focusout"},function(S,N){function U(G){if(H.documentMode){var J=Ue.get(this,"handle"),Q=A.event.fix(G);Q.type=G.type==="focusin"?"focus":"blur",Q.isSimulated=!0,J(G),Q.target===Q.currentTarget&&J(Q)}else A.event.simulate(N,G.target,A.event.fix(G))}A.event.special[S]={setup:function(){var G;if(qa(this,S,!0),H.documentMode)G=Ue.get(this,N),G||this.addEventListener(N,U),Ue.set(this,N,(G||0)+1);else return!1},trigger:function(){return qa(this,S),!0},teardown:function(){var G;if(H.documentMode)G=Ue.get(this,N)-1,G?Ue.set(this,N,G):(this.removeEventListener(N,U),Ue.remove(this,N));else return!1},_default:function(G){return Ue.get(G.target,S)},delegateType:N},A.event.special[N]={setup:function(){var G=this.ownerDocument||this.document||this,J=H.documentMode?this:G,Q=Ue.get(J,N);Q||(H.documentMode?this.addEventListener(N,U):G.addEventListener(S,U,!0)),Ue.set(J,N,(Q||0)+1)},teardown:function(){var G=this.ownerDocument||this.document||this,J=H.documentMode?this:G,Q=Ue.get(J,N)-1;Q?Ue.set(J,N,Q):(H.documentMode?this.removeEventListener(N,U):G.removeEventListener(S,U,!0),Ue.remove(J,N))}}}),A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(S,N){A.event.special[S]={delegateType:N,bindType:N,handle:function(U){var G,J=this,Q=U.relatedTarget,ne=U.handleObj;return(!Q||Q!==J&&!A.contains(J,Q))&&(U.type=ne.origType,G=ne.handler.apply(this,arguments),U.type=N),G}}}),A.fn.extend({on:function(S,N,U,G){return ms(this,S,N,U,G)},one:function(S,N,U,G){return ms(this,S,N,U,G,1)},off:function(S,N,U){var G,J;if(S&&S.preventDefault&&S.handleObj)return G=S.handleObj,A(S.delegateTarget).off(G.namespace?G.origType+"."+G.namespace:G.origType,G.selector,G.handler),this;if(typeof S=="object"){for(J in S)this.off(J,N,S[J]);return this}return(N===!1||typeof N=="function")&&(U=N,N=void 0),U===!1&&(U=Ei),this.each(function(){A.event.remove(this,S,U,N)})}});var Uu=/<script|<style|<link/i,c0=/checked\s*(?:[^=]|=\s*.checked.)/i,nw=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function l0(S,N){return ue(S,"table")&&ue(N.nodeType!==11?N:N.firstChild,"tr")&&A(S).children("tbody")[0]||S}function OE(S){return S.type=(S.getAttribute("type")!==null)+"/"+S.type,S}function rw(S){return(S.type||"").slice(0,5)==="true/"?S.type=S.type.slice(5):S.removeAttribute("type"),S}function DE(S,N){var U,G,J,Q,ne,ge,fe;if(N.nodeType===1){if(Ue.hasData(S)&&(Q=Ue.get(S),fe=Q.events,fe)){Ue.remove(N,"handle events");for(J in fe)for(U=0,G=fe[J].length;U<G;U++)A.event.add(N,J,fe[J][U])}St.hasData(S)&&(ne=St.access(S),ge=A.extend({},ne),St.set(N,ge))}}function iw(S,N){var U=N.nodeName.toLowerCase();U==="input"&&jc.test(S.type)?N.checked=S.checked:(U==="input"||U==="textarea")&&(N.defaultValue=S.defaultValue)}function bl(S,N,U,G){N=_(N);var J,Q,ne,ge,fe,be,We=0,Qe=S.length,Me=Qe-1,dt=N[0],on=k(dt);if(on||Qe>1&&typeof dt=="string"&&!P.checkClone&&c0.test(dt))return S.each(function(Gn){var un=S.eq(Gn);on&&(N[0]=dt.call(this,Gn,un.html())),bl(un,N,U,G)});if(Qe&&(J=ju(N,S[0].ownerDocument,!1,S,G),Q=J.firstChild,J.childNodes.length===1&&(J=Q),Q||G)){for(ne=A.map(Xr(J,"script"),OE),ge=ne.length;We<Qe;We++)fe=J,We!==Me&&(fe=A.clone(fe,!0,!0),ge&&A.merge(ne,Xr(fe,"script"))),U.call(S[We],fe,We);if(ge)for(be=ne[ne.length-1].ownerDocument,A.map(ne,rw),We=0;We<ge;We++)fe=ne[We],Uc.test(fe.type||"")&&!Ue.access(fe,"globalEval")&&A.contains(be,fe)&&(fe.src&&(fe.type||"").toLowerCase()!=="module"?A._evalUrl&&!fe.noModule&&A._evalUrl(fe.src,{nonce:fe.nonce||fe.getAttribute("nonce")},be):V(fe.textContent.replace(nw,""),fe,be))}return S}function d0(S,N,U){for(var G,J=N?A.filter(N,S):S,Q=0;(G=J[Q])!=null;Q++)!U&&G.nodeType===1&&A.cleanData(Xr(G)),G.parentNode&&(U&&lo(G)&&Mu(Xr(G,"script")),G.parentNode.removeChild(G));return S}A.extend({htmlPrefilter:function(S){return S},clone:function(S,N,U){var G,J,Q,ne,ge=S.cloneNode(!0),fe=lo(S);if(!P.noCloneChecked&&(S.nodeType===1||S.nodeType===11)&&!A.isXMLDoc(S))for(ne=Xr(ge),Q=Xr(S),G=0,J=Q.length;G<J;G++)iw(Q[G],ne[G]);if(N)if(U)for(Q=Q||Xr(S),ne=ne||Xr(ge),G=0,J=Q.length;G<J;G++)DE(Q[G],ne[G]);else DE(S,ge);return ne=Xr(ge,"script"),ne.length>0&&Mu(ne,!fe&&Xr(S,"script")),ge},cleanData:function(S){for(var N,U,G,J=A.event.special,Q=0;(U=S[Q])!==void 0;Q++)if(gt(U)){if(N=U[Ue.expando]){if(N.events)for(G in N.events)J[G]?A.event.remove(U,G):A.removeEvent(U,G,N.handle);U[Ue.expando]=void 0}U[St.expando]&&(U[St.expando]=void 0)}}}),A.fn.extend({detach:function(S){return d0(this,S,!0)},remove:function(S){return d0(this,S)},text:function(S){return Pn(this,function(N){return N===void 0?A.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=N)})},null,S,arguments.length)},append:function(){return bl(this,arguments,function(S){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var N=l0(this,S);N.appendChild(S)}})},prepend:function(){return bl(this,arguments,function(S){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var N=l0(this,S);N.insertBefore(S,N.firstChild)}})},before:function(){return bl(this,arguments,function(S){this.parentNode&&this.parentNode.insertBefore(S,this)})},after:function(){return bl(this,arguments,function(S){this.parentNode&&this.parentNode.insertBefore(S,this.nextSibling)})},empty:function(){for(var S,N=0;(S=this[N])!=null;N++)S.nodeType===1&&(A.cleanData(Xr(S,!1)),S.textContent="");return this},clone:function(S,N){return S=S??!1,N=N??S,this.map(function(){return A.clone(this,S,N)})},html:function(S){return Pn(this,function(N){var U=this[0]||{},G=0,J=this.length;if(N===void 0&&U.nodeType===1)return U.innerHTML;if(typeof N=="string"&&!Uu.test(N)&&!As[(Np.exec(N)||["",""])[1].toLowerCase()]){N=A.htmlPrefilter(N);try{for(;G<J;G++)U=this[G]||{},U.nodeType===1&&(A.cleanData(Xr(U,!1)),U.innerHTML=N);U=0}catch{}}U&&this.empty().append(N)},null,S,arguments.length)},replaceWith:function(){var S=[];return bl(this,arguments,function(N){var U=this.parentNode;A.inArray(this,S)<0&&(A.cleanData(Xr(this)),U&&U.replaceChild(N,this))},S)}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(S,N){A.fn[S]=function(U){for(var G,J=[],Q=A(U),ne=Q.length-1,ge=0;ge<=ne;ge++)G=ge===ne?this:this.clone(!0),A(Q[ge])[N](G),v.apply(J,G.get());return this.pushStack(J)}});var Fu=new RegExp("^("+Ri+")(?!px)[a-z%]+$","i"),Ip=/^--/,Ya=function(S){var N=S.ownerDocument.defaultView;return(!N||!N.opener)&&(N=i),N.getComputedStyle(S)},PE=function(S,N,U){var G,J,Q={};for(J in N)Q[J]=S.style[J],S.style[J]=N[J];G=U.call(S);for(J in N)S.style[J]=Q[J];return G},sw=new RegExp(Zi.join("|"),"i");(function(){function S(){if(be){fe.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",be.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",_i.appendChild(fe).appendChild(be);var We=i.getComputedStyle(be);U=We.top!=="1%",ge=N(We.marginLeft)===12,be.style.right="60%",Q=N(We.right)===36,G=N(We.width)===36,be.style.position="absolute",J=N(be.offsetWidth/3)===12,_i.removeChild(fe),be=null}}function N(We){return Math.round(parseFloat(We))}var U,G,J,Q,ne,ge,fe=H.createElement("div"),be=H.createElement("div");be.style&&(be.style.backgroundClip="content-box",be.cloneNode(!0).style.backgroundClip="",P.clearCloneStyle=be.style.backgroundClip==="content-box",A.extend(P,{boxSizingReliable:function(){return S(),G},pixelBoxStyles:function(){return S(),Q},pixelPosition:function(){return S(),U},reliableMarginLeft:function(){return S(),ge},scrollboxSize:function(){return S(),J},reliableTrDimensions:function(){var We,Qe,Me,dt;return ne==null&&(We=H.createElement("table"),Qe=H.createElement("tr"),Me=H.createElement("div"),We.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Qe.style.cssText="box-sizing:content-box;border:1px solid",Qe.style.height="1px",Me.style.height="9px",Me.style.display="block",_i.appendChild(We).appendChild(Qe).appendChild(Me),dt=i.getComputedStyle(Qe),ne=parseInt(dt.height,10)+parseInt(dt.borderTopWidth,10)+parseInt(dt.borderBottomWidth,10)===Qe.offsetHeight,_i.removeChild(We)),ne}}))})();function Ns(S,N,U){var G,J,Q,ne,ge=Ip.test(N),fe=S.style;return U=U||Ya(S),U&&(ne=U.getPropertyValue(N)||U[N],ge&&ne&&(ne=ne.replace(Oe,"$1")||void 0),ne===""&&!lo(S)&&(ne=A.style(S,N)),!P.pixelBoxStyles()&&Fu.test(ne)&&sw.test(N)&&(G=fe.width,J=fe.minWidth,Q=fe.maxWidth,fe.minWidth=fe.maxWidth=fe.width=ne,ne=U.width,fe.width=G,fe.minWidth=J,fe.maxWidth=Q)),ne!==void 0?ne+"":ne}function kE(S,N){return{get:function(){if(S()){delete this.get;return}return(this.get=N).apply(this,arguments)}}}var LE=["Webkit","Moz","ms"],ii=H.createElement("div").style,ME={};function ow(S){for(var N=S[0].toUpperCase()+S.slice(1),U=LE.length;U--;)if(S=LE[U]+N,S in ii)return S}function u0(S){var N=A.cssProps[S]||ME[S];return N||(S in ii?S:ME[S]=ow(S)||S)}var aw=/^(none|table(?!-c[ea]).+)/,h0={position:"absolute",visibility:"hidden",display:"block"},jE={letterSpacing:"0",fontWeight:"400"};function p0(S,N,U){var G=Rs.exec(N);return G?Math.max(0,G[2]-(U||0))+(G[3]||"px"):N}function f0(S,N,U,G,J,Q){var ne=N==="width"?1:0,ge=0,fe=0,be=0;if(U===(G?"border":"content"))return 0;for(;ne<4;ne+=2)U==="margin"&&(be+=A.css(S,U+Zi[ne],!0,J)),G?(U==="content"&&(fe-=A.css(S,"padding"+Zi[ne],!0,J)),U!=="margin"&&(fe-=A.css(S,"border"+Zi[ne]+"Width",!0,J))):(fe+=A.css(S,"padding"+Zi[ne],!0,J),U!=="padding"?fe+=A.css(S,"border"+Zi[ne]+"Width",!0,J):ge+=A.css(S,"border"+Zi[ne]+"Width",!0,J));return!G&&Q>=0&&(fe+=Math.max(0,Math.ceil(S["offset"+N[0].toUpperCase()+N.slice(1)]-Q-fe-ge-.5))||0),fe+be}function UE(S,N,U){var G=Ya(S),J=!P.boxSizingReliable()||U,Q=J&&A.css(S,"boxSizing",!1,G)==="border-box",ne=Q,ge=Ns(S,N,G),fe="offset"+N[0].toUpperCase()+N.slice(1);if(Fu.test(ge)){if(!U)return ge;ge="auto"}return(!P.boxSizingReliable()&&Q||!P.reliableTrDimensions()&&ue(S,"tr")||ge==="auto"||!parseFloat(ge)&&A.css(S,"display",!1,G)==="inline")&&S.getClientRects().length&&(Q=A.css(S,"boxSizing",!1,G)==="border-box",ne=fe in S,ne&&(ge=S[fe])),ge=parseFloat(ge)||0,ge+f0(S,N,U||(Q?"border":"content"),ne,G,ge)+"px"}A.extend({cssHooks:{opacity:{get:function(S,N){if(N){var U=Ns(S,"opacity");return U===""?"1":U}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(S,N,U,G){if(!(!S||S.nodeType===3||S.nodeType===8||!S.style)){var J,Q,ne,ge=Ve(N),fe=Ip.test(N),be=S.style;if(fe||(N=u0(ge)),ne=A.cssHooks[N]||A.cssHooks[ge],U!==void 0){if(Q=typeof U,Q==="string"&&(J=Rs.exec(U))&&J[1]&&(U=Ys(S,N,J),Q="number"),U==null||U!==U)return;Q==="number"&&!fe&&(U+=J&&J[3]||(A.cssNumber[ge]?"":"px")),!P.clearCloneStyle&&U===""&&N.indexOf("background")===0&&(be[N]="inherit"),(!ne||!("set"in ne)||(U=ne.set(S,U,G))!==void 0)&&(fe?be.setProperty(N,U):be[N]=U)}else return ne&&"get"in ne&&(J=ne.get(S,!1,G))!==void 0?J:be[N]}},css:function(S,N,U,G){var J,Q,ne,ge=Ve(N),fe=Ip.test(N);return fe||(N=u0(ge)),ne=A.cssHooks[N]||A.cssHooks[ge],ne&&"get"in ne&&(J=ne.get(S,!0,U)),J===void 0&&(J=Ns(S,N,G)),J==="normal"&&N in jE&&(J=jE[N]),U===""||U?(Q=parseFloat(J),U===!0||isFinite(Q)?Q||0:J):J}}),A.each(["height","width"],function(S,N){A.cssHooks[N]={get:function(U,G,J){if(G)return aw.test(A.css(U,"display"))&&(!U.getClientRects().length||!U.getBoundingClientRect().width)?PE(U,h0,function(){return UE(U,N,J)}):UE(U,N,J)},set:function(U,G,J){var Q,ne=Ya(U),ge=!P.scrollboxSize()&&ne.position==="absolute",fe=ge||J,be=fe&&A.css(U,"boxSizing",!1,ne)==="border-box",We=J?f0(U,N,J,be,ne):0;return be&&ge&&(We-=Math.ceil(U["offset"+N[0].toUpperCase()+N.slice(1)]-parseFloat(ne[N])-f0(U,N,"border",!1,ne)-.5)),We&&(Q=Rs.exec(G))&&(Q[3]||"px")!=="px"&&(U.style[N]=G,G=A.css(U,N)),p0(U,G,We)}}}),A.cssHooks.marginLeft=kE(P.reliableMarginLeft,function(S,N){if(N)return(parseFloat(Ns(S,"marginLeft"))||S.getBoundingClientRect().left-PE(S,{marginLeft:0},function(){return S.getBoundingClientRect().left}))+"px"}),A.each({margin:"",padding:"",border:"Width"},function(S,N){A.cssHooks[S+N]={expand:function(U){for(var G=0,J={},Q=typeof U=="string"?U.split(" "):[U];G<4;G++)J[S+Zi[G]+N]=Q[G]||Q[G-2]||Q[0];return J}},S!=="margin"&&(A.cssHooks[S+N].set=p0)}),A.fn.extend({css:function(S,N){return Pn(this,function(U,G,J){var Q,ne,ge={},fe=0;if(Array.isArray(G)){for(Q=Ya(U),ne=G.length;fe<ne;fe++)ge[G[fe]]=A.css(U,G[fe],!1,Q);return ge}return J!==void 0?A.style(U,G,J):A.css(U,G)},S,N,arguments.length>1)}});function Is(S,N,U,G,J){return new Is.prototype.init(S,N,U,G,J)}A.Tween=Is,Is.prototype={constructor:Is,init:function(S,N,U,G,J,Q){this.elem=S,this.prop=U,this.easing=J||A.easing._default,this.options=N,this.start=this.now=this.cur(),this.end=G,this.unit=Q||(A.cssNumber[U]?"":"px")},cur:function(){var S=Is.propHooks[this.prop];return S&&S.get?S.get(this):Is.propHooks._default.get(this)},run:function(S){var N,U=Is.propHooks[this.prop];return this.options.duration?this.pos=N=A.easing[this.easing](S,this.options.duration*S,0,1,this.options.duration):this.pos=N=S,this.now=(this.end-this.start)*N+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),U&&U.set?U.set(this):Is.propHooks._default.set(this),this}},Is.prototype.init.prototype=Is.prototype,Is.propHooks={_default:{get:function(S){var N;return S.elem.nodeType!==1||S.elem[S.prop]!=null&&S.elem.style[S.prop]==null?S.elem[S.prop]:(N=A.css(S.elem,S.prop,""),!N||N==="auto"?0:N)},set:function(S){A.fx.step[S.prop]?A.fx.step[S.prop](S):S.elem.nodeType===1&&(A.cssHooks[S.prop]||S.elem.style[u0(S.prop)]!=null)?A.style(S.elem,S.prop,S.now+S.unit):S.elem[S.prop]=S.now}}},Is.propHooks.scrollTop=Is.propHooks.scrollLeft={set:function(S){S.elem.nodeType&&S.elem.parentNode&&(S.elem[S.prop]=S.now)}},A.easing={linear:function(S){return S},swing:function(S){return .5-Math.cos(S*Math.PI)/2},_default:"swing"},A.fx=Is.prototype.init,A.fx.step={};var Fo,gd,cw=/^(?:toggle|show|hide)$/,Sr=/queueHooks$/;function m0(){gd&&(H.hidden===!1&&i.requestAnimationFrame?i.requestAnimationFrame(m0):i.setTimeout(m0,A.fx.interval),A.fx.tick())}function g0(){return i.setTimeout(function(){Fo=void 0}),Fo=Date.now()}function Vu(S,N){var U,G=0,J={height:S};for(N=N?1:0;G<4;G+=2-N)U=Zi[G],J["margin"+U]=J["padding"+U]=S;return N&&(J.opacity=J.width=S),J}function FE(S,N,U){for(var G,J=(Vo.tweeners[N]||[]).concat(Vo.tweeners["*"]),Q=0,ne=J.length;Q<ne;Q++)if(G=J[Q].call(U,N,S))return G}function lw(S,N,U){var G,J,Q,ne,ge,fe,be,We,Qe="width"in N||"height"in N,Me=this,dt={},on=S.style,Gn=S.nodeType&&Lc(S),un=Ue.get(S,"fxshow");U.queue||(ne=A._queueHooks(S,"fx"),ne.unqueued==null&&(ne.unqueued=0,ge=ne.empty.fire,ne.empty.fire=function(){ne.unqueued||ge()}),ne.unqueued++,Me.always(function(){Me.always(function(){ne.unqueued--,A.queue(S,"fx").length||ne.empty.fire()})}));for(G in N)if(J=N[G],cw.test(J)){if(delete N[G],Q=Q||J==="toggle",J===(Gn?"hide":"show"))if(J==="show"&&un&&un[G]!==void 0)Gn=!0;else continue;dt[G]=un&&un[G]||A.style(S,G)}if(fe=!A.isEmptyObject(N),!(!fe&&A.isEmptyObject(dt))){Qe&&S.nodeType===1&&(U.overflow=[on.overflow,on.overflowX,on.overflowY],be=un&&un.display,be==null&&(be=Ue.get(S,"display")),We=A.css(S,"display"),We==="none"&&(be?We=be:(Mc([S],!0),be=S.style.display||be,We=A.css(S,"display"),Mc([S]))),(We==="inline"||We==="inline-block"&&be!=null)&&A.css(S,"float")==="none"&&(fe||(Me.done(function(){on.display=be}),be==null&&(We=on.display,be=We==="none"?"":We)),on.display="inline-block")),U.overflow&&(on.overflow="hidden",Me.always(function(){on.overflow=U.overflow[0],on.overflowX=U.overflow[1],on.overflowY=U.overflow[2]})),fe=!1;for(G in dt)fe||(un?"hidden"in un&&(Gn=un.hidden):un=Ue.access(S,"fxshow",{display:be}),Q&&(un.hidden=!Gn),Gn&&Mc([S],!0),Me.done(function(){Gn||Mc([S]),Ue.remove(S,"fxshow");for(G in dt)A.style(S,G,dt[G])})),fe=FE(Gn?un[G]:0,G,Me),G in un||(un[G]=fe.start,Gn&&(fe.end=fe.start,fe.start=0))}}function dw(S,N){var U,G,J,Q,ne;for(U in S)if(G=Ve(U),J=N[G],Q=S[U],Array.isArray(Q)&&(J=Q[1],Q=S[U]=Q[0]),U!==G&&(S[G]=Q,delete S[U]),ne=A.cssHooks[G],ne&&"expand"in ne){Q=ne.expand(Q),delete S[G];for(U in Q)U in S||(S[U]=Q[U],N[U]=J)}else N[G]=J}function Vo(S,N,U){var G,J,Q=0,ne=Vo.prefilters.length,ge=A.Deferred().always(function(){delete fe.elem}),fe=function(){if(J)return!1;for(var Qe=Fo||g0(),Me=Math.max(0,be.startTime+be.duration-Qe),dt=Me/be.duration||0,on=1-dt,Gn=0,un=be.tweens.length;Gn<un;Gn++)be.tweens[Gn].run(on);return ge.notifyWith(S,[be,on,Me]),on<1&&un?Me:(un||ge.notifyWith(S,[be,1,0]),ge.resolveWith(S,[be]),!1)},be=ge.promise({elem:S,props:A.extend({},N),opts:A.extend(!0,{specialEasing:{},easing:A.easing._default},U),originalProperties:N,originalOptions:U,startTime:Fo||g0(),duration:U.duration,tweens:[],createTween:function(Qe,Me){var dt=A.Tween(S,be.opts,Qe,Me,be.opts.specialEasing[Qe]||be.opts.easing);return be.tweens.push(dt),dt},stop:function(Qe){var Me=0,dt=Qe?be.tweens.length:0;if(J)return this;for(J=!0;Me<dt;Me++)be.tweens[Me].run(1);return Qe?(ge.notifyWith(S,[be,1,0]),ge.resolveWith(S,[be,Qe])):ge.rejectWith(S,[be,Qe]),this}}),We=be.props;for(dw(We,be.opts.specialEasing);Q<ne;Q++)if(G=Vo.prefilters[Q].call(be,S,We,be.opts),G)return k(G.stop)&&(A._queueHooks(be.elem,be.opts.queue).stop=G.stop.bind(G)),G;return A.map(We,FE,be),k(be.opts.start)&&be.opts.start.call(S,be),be.progress(be.opts.progress).done(be.opts.done,be.opts.complete).fail(be.opts.fail).always(be.opts.always),A.fx.timer(A.extend(fe,{elem:S,anim:be,queue:be.opts.queue})),be}A.Animation=A.extend(Vo,{tweeners:{"*":[function(S,N){var U=this.createTween(S,N);return Ys(U.elem,S,Rs.exec(N),U),U}]},tweener:function(S,N){k(S)?(N=S,S=["*"]):S=S.match(Bn);for(var U,G=0,J=S.length;G<J;G++)U=S[G],Vo.tweeners[U]=Vo.tweeners[U]||[],Vo.tweeners[U].unshift(N)},prefilters:[lw],prefilter:function(S,N){N?Vo.prefilters.unshift(S):Vo.prefilters.push(S)}}),A.speed=function(S,N,U){var G=S&&typeof S=="object"?A.extend({},S):{complete:U||!U&&N||k(S)&&S,duration:S,easing:U&&N||N&&!k(N)&&N};return A.fx.off?G.duration=0:typeof G.duration!="number"&&(G.duration in A.fx.speeds?G.duration=A.fx.speeds[G.duration]:G.duration=A.fx.speeds._default),(G.queue==null||G.queue===!0)&&(G.queue="fx"),G.old=G.complete,G.complete=function(){k(G.old)&&G.old.call(this),G.queue&&A.dequeue(this,G.queue)},G},A.fn.extend({fadeTo:function(S,N,U,G){return this.filter(Lc).css("opacity",0).show().end().animate({opacity:N},S,U,G)},animate:function(S,N,U,G){var J=A.isEmptyObject(S),Q=A.speed(N,U,G),ne=function(){var ge=Vo(this,A.extend({},S),Q);(J||Ue.get(this,"finish"))&&ge.stop(!0)};return ne.finish=ne,J||Q.queue===!1?this.each(ne):this.queue(Q.queue,ne)},stop:function(S,N,U){var G=function(J){var Q=J.stop;delete J.stop,Q(U)};return typeof S!="string"&&(U=N,N=S,S=void 0),N&&this.queue(S||"fx",[]),this.each(function(){var J=!0,Q=S!=null&&S+"queueHooks",ne=A.timers,ge=Ue.get(this);if(Q)ge[Q]&&ge[Q].stop&&G(ge[Q]);else for(Q in ge)ge[Q]&&ge[Q].stop&&Sr.test(Q)&&G(ge[Q]);for(Q=ne.length;Q--;)ne[Q].elem===this&&(S==null||ne[Q].queue===S)&&(ne[Q].anim.stop(U),J=!1,ne.splice(Q,1));(J||!U)&&A.dequeue(this,S)})},finish:function(S){return S!==!1&&(S=S||"fx"),this.each(function(){var N,U=Ue.get(this),G=U[S+"queue"],J=U[S+"queueHooks"],Q=A.timers,ne=G?G.length:0;for(U.finish=!0,A.queue(this,S,[]),J&&J.stop&&J.stop.call(this,!0),N=Q.length;N--;)Q[N].elem===this&&Q[N].queue===S&&(Q[N].anim.stop(!0),Q.splice(N,1));for(N=0;N<ne;N++)G[N]&&G[N].finish&&G[N].finish.call(this);delete U.finish})}}),A.each(["toggle","show","hide"],function(S,N){var U=A.fn[N];A.fn[N]=function(G,J,Q){return G==null||typeof G=="boolean"?U.apply(this,arguments):this.animate(Vu(N,!0),G,J,Q)}}),A.each({slideDown:Vu("show"),slideUp:Vu("hide"),slideToggle:Vu("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(S,N){A.fn[S]=function(U,G,J){return this.animate(N,U,G,J)}}),A.timers=[],A.fx.tick=function(){var S,N=0,U=A.timers;for(Fo=Date.now();N<U.length;N++)S=U[N],!S()&&U[N]===S&&U.splice(N--,1);U.length||A.fx.stop(),Fo=void 0},A.fx.timer=function(S){A.timers.push(S),A.fx.start()},A.fx.interval=13,A.fx.start=function(){gd||(gd=!0,m0())},A.fx.stop=function(){gd=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(S,N){return S=A.fx&&A.fx.speeds[S]||S,N=N||"fx",this.queue(N,function(U,G){var J=i.setTimeout(U,S);G.stop=function(){i.clearTimeout(J)}})},function(){var S=H.createElement("input"),N=H.createElement("select"),U=N.appendChild(H.createElement("option"));S.type="checkbox",P.checkOn=S.value!=="",P.optSelected=U.selected,S=H.createElement("input"),S.value="t",S.type="radio",P.radioValue=S.value==="t"}();var VE,Bu=A.expr.attrHandle;A.fn.extend({attr:function(S,N){return Pn(this,A.attr,S,N,arguments.length>1)},removeAttr:function(S){return this.each(function(){A.removeAttr(this,S)})}}),A.extend({attr:function(S,N,U){var G,J,Q=S.nodeType;if(!(Q===3||Q===8||Q===2)){if(typeof S.getAttribute>"u")return A.prop(S,N,U);if((Q!==1||!A.isXMLDoc(S))&&(J=A.attrHooks[N.toLowerCase()]||(A.expr.match.bool.test(N)?VE:void 0)),U!==void 0){if(U===null){A.removeAttr(S,N);return}return J&&"set"in J&&(G=J.set(S,U,N))!==void 0?G:(S.setAttribute(N,U+""),U)}return J&&"get"in J&&(G=J.get(S,N))!==null?G:(G=A.find.attr(S,N),G??void 0)}},attrHooks:{type:{set:function(S,N){if(!P.radioValue&&N==="radio"&&ue(S,"input")){var U=S.value;return S.setAttribute("type",N),U&&(S.value=U),N}}}},removeAttr:function(S,N){var U,G=0,J=N&&N.match(Bn);if(J&&S.nodeType===1)for(;U=J[G++];)S.removeAttribute(U)}}),VE={set:function(S,N,U){return N===!1?A.removeAttr(S,U):S.setAttribute(U,U),U}},A.each(A.expr.match.bool.source.match(/\w+/g),function(S,N){var U=Bu[N]||A.find.attr;Bu[N]=function(G,J,Q){var ne,ge,fe=J.toLowerCase();return Q||(ge=Bu[fe],Bu[fe]=ne,ne=U(G,J,Q)!=null?fe:null,Bu[fe]=ge),ne}});var _0=/^(?:input|select|textarea|button)$/i,BE=/^(?:a|area)$/i;A.fn.extend({prop:function(S,N){return Pn(this,A.prop,S,N,arguments.length>1)},removeProp:function(S){return this.each(function(){delete this[A.propFix[S]||S]})}}),A.extend({prop:function(S,N,U){var G,J,Q=S.nodeType;if(!(Q===3||Q===8||Q===2))return(Q!==1||!A.isXMLDoc(S))&&(N=A.propFix[N]||N,J=A.propHooks[N]),U!==void 0?J&&"set"in J&&(G=J.set(S,U,N))!==void 0?G:S[N]=U:J&&"get"in J&&(G=J.get(S,N))!==null?G:S[N]},propHooks:{tabIndex:{get:function(S){var N=A.find.attr(S,"tabindex");return N?parseInt(N,10):_0.test(S.nodeName)||BE.test(S.nodeName)&&S.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),P.optSelected||(A.propHooks.selected={get:function(S){var N=S.parentNode;return N&&N.parentNode&&N.parentNode.selectedIndex,null},set:function(S){var N=S.parentNode;N&&(N.selectedIndex,N.parentNode&&N.parentNode.selectedIndex)}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this});function $a(S){var N=S.match(Bn)||[];return N.join(" ")}function wl(S){return S.getAttribute&&S.getAttribute("class")||""}function Wu(S){return Array.isArray(S)?S:typeof S=="string"?S.match(Bn)||[]:[]}A.fn.extend({addClass:function(S){var N,U,G,J,Q,ne;return k(S)?this.each(function(ge){A(this).addClass(S.call(this,ge,wl(this)))}):(N=Wu(S),N.length?this.each(function(){if(G=wl(this),U=this.nodeType===1&&" "+$a(G)+" ",U){for(Q=0;Q<N.length;Q++)J=N[Q],U.indexOf(" "+J+" ")<0&&(U+=J+" ");ne=$a(U),G!==ne&&this.setAttribute("class",ne)}}):this)},removeClass:function(S){var N,U,G,J,Q,ne;return k(S)?this.each(function(ge){A(this).removeClass(S.call(this,ge,wl(this)))}):arguments.length?(N=Wu(S),N.length?this.each(function(){if(G=wl(this),U=this.nodeType===1&&" "+$a(G)+" ",U){for(Q=0;Q<N.length;Q++)for(J=N[Q];U.indexOf(" "+J+" ")>-1;)U=U.replace(" "+J+" "," ");ne=$a(U),G!==ne&&this.setAttribute("class",ne)}}):this):this.attr("class","")},toggleClass:function(S,N){var U,G,J,Q,ne=typeof S,ge=ne==="string"||Array.isArray(S);return k(S)?this.each(function(fe){A(this).toggleClass(S.call(this,fe,wl(this),N),N)}):typeof N=="boolean"&&ge?N?this.addClass(S):this.removeClass(S):(U=Wu(S),this.each(function(){if(ge)for(Q=A(this),J=0;J<U.length;J++)G=U[J],Q.hasClass(G)?Q.removeClass(G):Q.addClass(G);else(S===void 0||ne==="boolean")&&(G=wl(this),G&&Ue.set(this,"__className__",G),this.setAttribute&&this.setAttribute("class",G||S===!1?"":Ue.get(this,"__className__")||""))}))},hasClass:function(S){var N,U,G=0;for(N=" "+S+" ";U=this[G++];)if(U.nodeType===1&&(" "+$a(wl(U))+" ").indexOf(N)>-1)return!0;return!1}});var uw=/\r/g;A.fn.extend({val:function(S){var N,U,G,J=this[0];return arguments.length?(G=k(S),this.each(function(Q){var ne;this.nodeType===1&&(G?ne=S.call(this,Q,A(this).val()):ne=S,ne==null?ne="":typeof ne=="number"?ne+="":Array.isArray(ne)&&(ne=A.map(ne,function(ge){return ge==null?"":ge+""})),N=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()],(!N||!("set"in N)||N.set(this,ne,"value")===void 0)&&(this.value=ne))})):J?(N=A.valHooks[J.type]||A.valHooks[J.nodeName.toLowerCase()],N&&"get"in N&&(U=N.get(J,"value"))!==void 0?U:(U=J.value,typeof U=="string"?U.replace(uw,""):U??"")):void 0}}),A.extend({valHooks:{option:{get:function(S){var N=A.find.attr(S,"value");return N??$a(A.text(S))}},select:{get:function(S){var N,U,G,J=S.options,Q=S.selectedIndex,ne=S.type==="select-one",ge=ne?null:[],fe=ne?Q+1:J.length;for(Q<0?G=fe:G=ne?Q:0;G<fe;G++)if(U=J[G],(U.selected||G===Q)&&!U.disabled&&(!U.parentNode.disabled||!ue(U.parentNode,"optgroup"))){if(N=A(U).val(),ne)return N;ge.push(N)}return ge},set:function(S,N){for(var U,G,J=S.options,Q=A.makeArray(N),ne=J.length;ne--;)G=J[ne],(G.selected=A.inArray(A.valHooks.option.get(G),Q)>-1)&&(U=!0);return U||(S.selectedIndex=-1),Q}}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(S,N){if(Array.isArray(N))return S.checked=A.inArray(A(S).val(),N)>-1}},P.checkOn||(A.valHooks[this].get=function(S){return S.getAttribute("value")===null?"on":S.value})});var _d=i.location,WE={guid:Date.now()},E0=/\?/;A.parseXML=function(S){var N,U;if(!S||typeof S!="string")return null;try{N=new i.DOMParser().parseFromString(S,"text/xml")}catch{}return U=N&&N.getElementsByTagName("parsererror")[0],(!N||U)&&A.error("Invalid XML: "+(U?A.map(U.childNodes,function(G){return G.textContent}).join(`
`):S)),N};var HE=/^(?:focusinfocus|focusoutblur)$/,GE=function(S){S.stopPropagation()};A.extend(A.event,{trigger:function(S,N,U,G){var J,Q,ne,ge,fe,be,We,Qe,Me=[U||H],dt=R.call(S,"type")?S.type:S,on=R.call(S,"namespace")?S.namespace.split("."):[];if(Q=Qe=ne=U=U||H,!(U.nodeType===3||U.nodeType===8)&&!HE.test(dt+A.event.triggered)&&(dt.indexOf(".")>-1&&(on=dt.split("."),dt=on.shift(),on.sort()),fe=dt.indexOf(":")<0&&"on"+dt,S=S[A.expando]?S:new A.Event(dt,typeof S=="object"&&S),S.isTrigger=G?2:3,S.namespace=on.join("."),S.rnamespace=S.namespace?new RegExp("(^|\\.)"+on.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,S.result=void 0,S.target||(S.target=U),N=N==null?[S]:A.makeArray(N,[S]),We=A.event.special[dt]||{},!(!G&&We.trigger&&We.trigger.apply(U,N)===!1))){if(!G&&!We.noBubble&&!W(U)){for(ge=We.delegateType||dt,HE.test(ge+dt)||(Q=Q.parentNode);Q;Q=Q.parentNode)Me.push(Q),ne=Q;ne===(U.ownerDocument||H)&&Me.push(ne.defaultView||ne.parentWindow||i)}for(J=0;(Q=Me[J++])&&!S.isPropagationStopped();)Qe=Q,S.type=J>1?ge:We.bindType||dt,be=(Ue.get(Q,"events")||Object.create(null))[S.type]&&Ue.get(Q,"handle"),be&&be.apply(Q,N),be=fe&&Q[fe],be&&be.apply&&gt(Q)&&(S.result=be.apply(Q,N),S.result===!1&&S.preventDefault());return S.type=dt,!G&&!S.isDefaultPrevented()&&(!We._default||We._default.apply(Me.pop(),N)===!1)&&gt(U)&&fe&&k(U[dt])&&!W(U)&&(ne=U[fe],ne&&(U[fe]=null),A.event.triggered=dt,S.isPropagationStopped()&&Qe.addEventListener(dt,GE),U[dt](),S.isPropagationStopped()&&Qe.removeEventListener(dt,GE),A.event.triggered=void 0,ne&&(U[fe]=ne)),S.result}},simulate:function(S,N,U){var G=A.extend(new A.Event,U,{type:S,isSimulated:!0});A.event.trigger(G,null,N)}}),A.fn.extend({trigger:function(S,N){return this.each(function(){A.event.trigger(S,N,this)})},triggerHandler:function(S,N){var U=this[0];if(U)return A.event.trigger(S,N,U,!0)}});var hw=/\[\]$/,zE=/\r?\n/g,pw=/^(?:submit|button|image|reset|file)$/i,fw=/^(?:input|select|textarea|keygen)/i;function Op(S,N,U,G){var J;if(Array.isArray(N))A.each(N,function(Q,ne){U||hw.test(S)?G(S,ne):Op(S+"["+(typeof ne=="object"&&ne!=null?Q:"")+"]",ne,U,G)});else if(!U&&K(N)==="object")for(J in N)Op(S+"["+J+"]",N[J],U,G);else G(S,N)}A.param=function(S,N){var U,G=[],J=function(Q,ne){var ge=k(ne)?ne():ne;G[G.length]=encodeURIComponent(Q)+"="+encodeURIComponent(ge??"")};if(S==null)return"";if(Array.isArray(S)||S.jquery&&!A.isPlainObject(S))A.each(S,function(){J(this.name,this.value)});else for(U in S)Op(U,S[U],N,J);return G.join("&")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var S=A.prop(this,"elements");return S?A.makeArray(S):this}).filter(function(){var S=this.type;return this.name&&!A(this).is(":disabled")&&fw.test(this.nodeName)&&!pw.test(S)&&(this.checked||!jc.test(S))}).map(function(S,N){var U=A(this).val();return U==null?null:Array.isArray(U)?A.map(U,function(G){return{name:N.name,value:G.replace(zE,`\r
`)}}):{name:N.name,value:U.replace(zE,`\r
`)}}).get()}});var mw=/%20/g,gw=/#.*$/,_w=/([?&])_=[^&]*/,Hu=/^(.*?):[ \t]*([^\r\n]*)$/mg,Ew=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,vw=/^(?:GET|HEAD)$/,yw=/^\/\//,KE={},Dp={},qE="*/".concat("*"),v0=H.createElement("a");v0.href=_d.href;function YE(S){return function(N,U){typeof N!="string"&&(U=N,N="*");var G,J=0,Q=N.toLowerCase().match(Bn)||[];if(k(U))for(;G=Q[J++];)G[0]==="+"?(G=G.slice(1)||"*",(S[G]=S[G]||[]).unshift(U)):(S[G]=S[G]||[]).push(U)}}function Xa(S,N,U,G){var J={},Q=S===Dp;function ne(ge){var fe;return J[ge]=!0,A.each(S[ge]||[],function(be,We){var Qe=We(N,U,G);if(typeof Qe=="string"&&!Q&&!J[Qe])return N.dataTypes.unshift(Qe),ne(Qe),!1;if(Q)return!(fe=Qe)}),fe}return ne(N.dataTypes[0])||!J["*"]&&ne("*")}function Os(S,N){var U,G,J=A.ajaxSettings.flatOptions||{};for(U in N)N[U]!==void 0&&((J[U]?S:G||(G={}))[U]=N[U]);return G&&A.extend(!0,S,G),S}function $E(S,N,U){for(var G,J,Q,ne,ge=S.contents,fe=S.dataTypes;fe[0]==="*";)fe.shift(),G===void 0&&(G=S.mimeType||N.getResponseHeader("Content-Type"));if(G){for(J in ge)if(ge[J]&&ge[J].test(G)){fe.unshift(J);break}}if(fe[0]in U)Q=fe[0];else{for(J in U){if(!fe[0]||S.converters[J+" "+fe[0]]){Q=J;break}ne||(ne=J)}Q=Q||ne}if(Q)return Q!==fe[0]&&fe.unshift(Q),U[Q]}function Sw(S,N,U,G){var J,Q,ne,ge,fe,be={},We=S.dataTypes.slice();if(We[1])for(ne in S.converters)be[ne.toLowerCase()]=S.converters[ne];for(Q=We.shift();Q;)if(S.responseFields[Q]&&(U[S.responseFields[Q]]=N),!fe&&G&&S.dataFilter&&(N=S.dataFilter(N,S.dataType)),fe=Q,Q=We.shift(),Q){if(Q==="*")Q=fe;else if(fe!=="*"&&fe!==Q){if(ne=be[fe+" "+Q]||be["* "+Q],!ne){for(J in be)if(ge=J.split(" "),ge[1]===Q&&(ne=be[fe+" "+ge[0]]||be["* "+ge[0]],ne)){ne===!0?ne=be[J]:be[J]!==!0&&(Q=ge[0],We.unshift(ge[1]));break}}if(ne!==!0)if(ne&&S.throws)N=ne(N);else try{N=ne(N)}catch(Qe){return{state:"parsererror",error:ne?Qe:"No conversion from "+fe+" to "+Q}}}}return{state:"success",data:N}}A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_d.href,type:"GET",isLocal:Ew.test(_d.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":qE,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(S,N){return N?Os(Os(S,A.ajaxSettings),N):Os(A.ajaxSettings,S)},ajaxPrefilter:YE(KE),ajaxTransport:YE(Dp),ajax:function(S,N){typeof S=="object"&&(N=S,S=void 0),N=N||{};var U,G,J,Q,ne,ge,fe,be,We,Qe,Me=A.ajaxSetup({},N),dt=Me.context||Me,on=Me.context&&(dt.nodeType||dt.jquery)?A(dt):A.event,Gn=A.Deferred(),un=A.Callbacks("once memory"),Gi=Me.statusCode||{},Lr={},Bo={},da="canceled",yt={readyState:0,getResponseHeader:function(Kn){var Jr;if(fe){if(!Q)for(Q={};Jr=Hu.exec(J);)Q[Jr[1].toLowerCase()+" "]=(Q[Jr[1].toLowerCase()+" "]||[]).concat(Jr[2]);Jr=Q[Kn.toLowerCase()+" "]}return Jr==null?null:Jr.join(", ")},getAllResponseHeaders:function(){return fe?J:null},setRequestHeader:function(Kn,Jr){return fe==null&&(Kn=Bo[Kn.toLowerCase()]=Bo[Kn.toLowerCase()]||Kn,Lr[Kn]=Jr),this},overrideMimeType:function(Kn){return fe==null&&(Me.mimeType=Kn),this},statusCode:function(Kn){var Jr;if(Kn)if(fe)yt.always(Kn[yt.status]);else for(Jr in Kn)Gi[Jr]=[Gi[Jr],Kn[Jr]];return this},abort:function(Kn){var Jr=Kn||da;return U&&U.abort(Jr),Cl(0,Jr),this}};if(Gn.promise(yt),Me.url=((S||Me.url||_d.href)+"").replace(yw,_d.protocol+"//"),Me.type=N.method||N.type||Me.method||Me.type,Me.dataTypes=(Me.dataType||"*").toLowerCase().match(Bn)||[""],Me.crossDomain==null){ge=H.createElement("a");try{ge.href=Me.url,ge.href=ge.href,Me.crossDomain=v0.protocol+"//"+v0.host!=ge.protocol+"//"+ge.host}catch{Me.crossDomain=!0}}if(Me.data&&Me.processData&&typeof Me.data!="string"&&(Me.data=A.param(Me.data,Me.traditional)),Xa(KE,Me,N,yt),fe)return yt;be=A.event&&Me.global,be&&A.active++===0&&A.event.trigger("ajaxStart"),Me.type=Me.type.toUpperCase(),Me.hasContent=!vw.test(Me.type),G=Me.url.replace(gw,""),Me.hasContent?Me.data&&Me.processData&&(Me.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Me.data=Me.data.replace(mw,"+")):(Qe=Me.url.slice(G.length),Me.data&&(Me.processData||typeof Me.data=="string")&&(G+=(E0.test(G)?"&":"?")+Me.data,delete Me.data),Me.cache===!1&&(G=G.replace(_w,"$1"),Qe=(E0.test(G)?"&":"?")+"_="+WE.guid+++Qe),Me.url=G+Qe),Me.ifModified&&(A.lastModified[G]&&yt.setRequestHeader("If-Modified-Since",A.lastModified[G]),A.etag[G]&&yt.setRequestHeader("If-None-Match",A.etag[G])),(Me.data&&Me.hasContent&&Me.contentType!==!1||N.contentType)&&yt.setRequestHeader("Content-Type",Me.contentType),yt.setRequestHeader("Accept",Me.dataTypes[0]&&Me.accepts[Me.dataTypes[0]]?Me.accepts[Me.dataTypes[0]]+(Me.dataTypes[0]!=="*"?", "+qE+"; q=0.01":""):Me.accepts["*"]);for(We in Me.headers)yt.setRequestHeader(We,Me.headers[We]);if(Me.beforeSend&&(Me.beforeSend.call(dt,yt,Me)===!1||fe))return yt.abort();if(da="abort",un.add(Me.complete),yt.done(Me.success),yt.fail(Me.error),U=Xa(Dp,Me,N,yt),!U)Cl(-1,"No Transport");else{if(yt.readyState=1,be&&on.trigger("ajaxSend",[yt,Me]),fe)return yt;Me.async&&Me.timeout>0&&(ne=i.setTimeout(function(){yt.abort("timeout")},Me.timeout));try{fe=!1,U.send(Lr,Cl)}catch(Kn){if(fe)throw Kn;Cl(-1,Kn)}}function Cl(Kn,Jr,zu,Ku){var ua,qu,ha,pa,Fc,uo=Jr;fe||(fe=!0,ne&&i.clearTimeout(ne),U=void 0,J=Ku||"",yt.readyState=Kn>0?4:0,ua=Kn>=200&&Kn<300||Kn===304,zu&&(pa=$E(Me,yt,zu)),!ua&&A.inArray("script",Me.dataTypes)>-1&&A.inArray("json",Me.dataTypes)<0&&(Me.converters["text script"]=function(){}),pa=Sw(Me,pa,yt,ua),ua?(Me.ifModified&&(Fc=yt.getResponseHeader("Last-Modified"),Fc&&(A.lastModified[G]=Fc),Fc=yt.getResponseHeader("etag"),Fc&&(A.etag[G]=Fc)),Kn===204||Me.type==="HEAD"?uo="nocontent":Kn===304?uo="notmodified":(uo=pa.state,qu=pa.data,ha=pa.error,ua=!ha)):(ha=uo,(Kn||!uo)&&(uo="error",Kn<0&&(Kn=0))),yt.status=Kn,yt.statusText=(Jr||uo)+"",ua?Gn.resolveWith(dt,[qu,uo,yt]):Gn.rejectWith(dt,[yt,uo,ha]),yt.statusCode(Gi),Gi=void 0,be&&on.trigger(ua?"ajaxSuccess":"ajaxError",[yt,Me,ua?qu:ha]),un.fireWith(dt,[yt,uo]),be&&(on.trigger("ajaxComplete",[yt,Me]),--A.active||A.event.trigger("ajaxStop")))}return yt},getJSON:function(S,N,U){return A.get(S,N,U,"json")},getScript:function(S,N){return A.get(S,void 0,N,"script")}}),A.each(["get","post"],function(S,N){A[N]=function(U,G,J,Q){return k(G)&&(Q=Q||J,J=G,G=void 0),A.ajax(A.extend({url:U,type:N,dataType:Q,data:G,success:J},A.isPlainObject(U)&&U))}}),A.ajaxPrefilter(function(S){var N;for(N in S.headers)N.toLowerCase()==="content-type"&&(S.contentType=S.headers[N]||"")}),A._evalUrl=function(S,N,U){return A.ajax({url:S,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(G){A.globalEval(G,N,U)}})},A.fn.extend({wrapAll:function(S){var N;return this[0]&&(k(S)&&(S=S.call(this[0])),N=A(S,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&N.insertBefore(this[0]),N.map(function(){for(var U=this;U.firstElementChild;)U=U.firstElementChild;return U}).append(this)),this},wrapInner:function(S){return k(S)?this.each(function(N){A(this).wrapInner(S.call(this,N))}):this.each(function(){var N=A(this),U=N.contents();U.length?U.wrapAll(S):N.append(S)})},wrap:function(S){var N=k(S);return this.each(function(U){A(this).wrapAll(N?S.call(this,U):S)})},unwrap:function(S){return this.parent(S).not("body").each(function(){A(this).replaceWith(this.childNodes)}),this}}),A.expr.pseudos.hidden=function(S){return!A.expr.pseudos.visible(S)},A.expr.pseudos.visible=function(S){return!!(S.offsetWidth||S.offsetHeight||S.getClientRects().length)},A.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch{}};var xw={0:200,1223:204},Gu=A.ajaxSettings.xhr();P.cors=!!Gu&&"withCredentials"in Gu,P.ajax=Gu=!!Gu,A.ajaxTransport(function(S){var N,U;if(P.cors||Gu&&!S.crossDomain)return{send:function(G,J){var Q,ne=S.xhr();if(ne.open(S.type,S.url,S.async,S.username,S.password),S.xhrFields)for(Q in S.xhrFields)ne[Q]=S.xhrFields[Q];S.mimeType&&ne.overrideMimeType&&ne.overrideMimeType(S.mimeType),!S.crossDomain&&!G["X-Requested-With"]&&(G["X-Requested-With"]="XMLHttpRequest");for(Q in G)ne.setRequestHeader(Q,G[Q]);N=function(ge){return function(){N&&(N=U=ne.onload=ne.onerror=ne.onabort=ne.ontimeout=ne.onreadystatechange=null,ge==="abort"?ne.abort():ge==="error"?typeof ne.status!="number"?J(0,"error"):J(ne.status,ne.statusText):J(xw[ne.status]||ne.status,ne.statusText,(ne.responseType||"text")!=="text"||typeof ne.responseText!="string"?{binary:ne.response}:{text:ne.responseText},ne.getAllResponseHeaders()))}},ne.onload=N(),U=ne.onerror=ne.ontimeout=N("error"),ne.onabort!==void 0?ne.onabort=U:ne.onreadystatechange=function(){ne.readyState===4&&i.setTimeout(function(){N&&U()})},N=N("abort");try{ne.send(S.hasContent&&S.data||null)}catch(ge){if(N)throw ge}},abort:function(){N&&N()}}}),A.ajaxPrefilter(function(S){S.crossDomain&&(S.contents.script=!1)}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(S){return A.globalEval(S),S}}}),A.ajaxPrefilter("script",function(S){S.cache===void 0&&(S.cache=!1),S.crossDomain&&(S.type="GET")}),A.ajaxTransport("script",function(S){if(S.crossDomain||S.scriptAttrs){var N,U;return{send:function(G,J){N=A("<script>").attr(S.scriptAttrs||{}).prop({charset:S.scriptCharset,src:S.url}).on("load error",U=function(Q){N.remove(),U=null,Q&&J(Q.type==="error"?404:200,Q.type)}),H.head.appendChild(N[0])},abort:function(){U&&U()}}}});var es=[],y0=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var S=es.pop()||A.expando+"_"+WE.guid++;return this[S]=!0,S}}),A.ajaxPrefilter("json jsonp",function(S,N,U){var G,J,Q,ne=S.jsonp!==!1&&(y0.test(S.url)?"url":typeof S.data=="string"&&(S.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&y0.test(S.data)&&"data");if(ne||S.dataTypes[0]==="jsonp")return G=S.jsonpCallback=k(S.jsonpCallback)?S.jsonpCallback():S.jsonpCallback,ne?S[ne]=S[ne].replace(y0,"$1"+G):S.jsonp!==!1&&(S.url+=(E0.test(S.url)?"&":"?")+S.jsonp+"="+G),S.converters["script json"]=function(){return Q||A.error(G+" was not called"),Q[0]},S.dataTypes[0]="json",J=i[G],i[G]=function(){Q=arguments},U.always(function(){J===void 0?A(i).removeProp(G):i[G]=J,S[G]&&(S.jsonpCallback=N.jsonpCallback,es.push(G)),Q&&k(J)&&J(Q[0]),Q=J=void 0}),"script"}),P.createHTMLDocument=function(){var S=H.implementation.createHTMLDocument("").body;return S.innerHTML="<form></form><form></form>",S.childNodes.length===2}(),A.parseHTML=function(S,N,U){if(typeof S!="string")return[];typeof N=="boolean"&&(U=N,N=!1);var G,J,Q;return N||(P.createHTMLDocument?(N=H.implementation.createHTMLDocument(""),G=N.createElement("base"),G.href=H.location.href,N.head.appendChild(G)):N=H),J=Le.exec(S),Q=!U&&[],J?[N.createElement(J[1])]:(J=ju([S],N,Q),Q&&Q.length&&A(Q).remove(),A.merge([],J.childNodes))},A.fn.load=function(S,N,U){var G,J,Q,ne=this,ge=S.indexOf(" ");return ge>-1&&(G=$a(S.slice(ge)),S=S.slice(0,ge)),k(N)?(U=N,N=void 0):N&&typeof N=="object"&&(J="POST"),ne.length>0&&A.ajax({url:S,type:J||"GET",dataType:"html",data:N}).done(function(fe){Q=arguments,ne.html(G?A("<div>").append(A.parseHTML(fe)).find(G):fe)}).always(U&&function(fe,be){ne.each(function(){U.apply(this,Q||[fe.responseText,be,fe])})}),this},A.expr.pseudos.animated=function(S){return A.grep(A.timers,function(N){return S===N.elem}).length},A.offset={setOffset:function(S,N,U){var G,J,Q,ne,ge,fe,be,We=A.css(S,"position"),Qe=A(S),Me={};We==="static"&&(S.style.position="relative"),ge=Qe.offset(),Q=A.css(S,"top"),fe=A.css(S,"left"),be=(We==="absolute"||We==="fixed")&&(Q+fe).indexOf("auto")>-1,be?(G=Qe.position(),ne=G.top,J=G.left):(ne=parseFloat(Q)||0,J=parseFloat(fe)||0),k(N)&&(N=N.call(S,U,A.extend({},ge))),N.top!=null&&(Me.top=N.top-ge.top+ne),N.left!=null&&(Me.left=N.left-ge.left+J),"using"in N?N.using.call(S,Me):Qe.css(Me)}},A.fn.extend({offset:function(S){if(arguments.length)return S===void 0?this:this.each(function(J){A.offset.setOffset(this,S,J)});var N,U,G=this[0];if(G)return G.getClientRects().length?(N=G.getBoundingClientRect(),U=G.ownerDocument.defaultView,{top:N.top+U.pageYOffset,left:N.left+U.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var S,N,U,G=this[0],J={top:0,left:0};if(A.css(G,"position")==="fixed")N=G.getBoundingClientRect();else{for(N=this.offset(),U=G.ownerDocument,S=G.offsetParent||U.documentElement;S&&(S===U.body||S===U.documentElement)&&A.css(S,"position")==="static";)S=S.parentNode;S&&S!==G&&S.nodeType===1&&(J=A(S).offset(),J.top+=A.css(S,"borderTopWidth",!0),J.left+=A.css(S,"borderLeftWidth",!0))}return{top:N.top-J.top-A.css(G,"marginTop",!0),left:N.left-J.left-A.css(G,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var S=this.offsetParent;S&&A.css(S,"position")==="static";)S=S.offsetParent;return S||_i})}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(S,N){var U=N==="pageYOffset";A.fn[S]=function(G){return Pn(this,function(J,Q,ne){var ge;if(W(J)?ge=J:J.nodeType===9&&(ge=J.defaultView),ne===void 0)return ge?ge[N]:J[Q];ge?ge.scrollTo(U?ge.pageXOffset:ne,U?ne:ge.pageYOffset):J[Q]=ne},S,G,arguments.length)}}),A.each(["top","left"],function(S,N){A.cssHooks[N]=kE(P.pixelPosition,function(U,G){if(G)return G=Ns(U,N),Fu.test(G)?A(U).position()[N]+"px":G})}),A.each({Height:"height",Width:"width"},function(S,N){A.each({padding:"inner"+S,content:N,"":"outer"+S},function(U,G){A.fn[G]=function(J,Q){var ne=arguments.length&&(U||typeof J!="boolean"),ge=U||(J===!0||Q===!0?"margin":"border");return Pn(this,function(fe,be,We){var Qe;return W(fe)?G.indexOf("outer")===0?fe["inner"+S]:fe.document.documentElement["client"+S]:fe.nodeType===9?(Qe=fe.documentElement,Math.max(fe.body["scroll"+S],Qe["scroll"+S],fe.body["offset"+S],Qe["offset"+S],Qe["client"+S])):We===void 0?A.css(fe,be,ge):A.style(fe,be,We,ge)},N,ne?J:void 0,ne)}})}),A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(S,N){A.fn[N]=function(U){return this.on(N,U)}}),A.fn.extend({bind:function(S,N,U){return this.on(S,null,N,U)},unbind:function(S,N){return this.off(S,null,N)},delegate:function(S,N,U,G){return this.on(N,S,U,G)},undelegate:function(S,N,U){return arguments.length===1?this.off(S,"**"):this.off(N,S||"**",U)},hover:function(S,N){return this.on("mouseenter",S).on("mouseleave",N||S)}}),A.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(S,N){A.fn[N]=function(U,G){return arguments.length>0?this.on(N,null,U,G):this.trigger(N)}});var Tw=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;A.proxy=function(S,N){var U,G,J;if(typeof N=="string"&&(U=S[N],N=S,S=U),!!k(S))return G=f.call(arguments,2),J=function(){return S.apply(N||this,G.concat(f.call(arguments)))},J.guid=S.guid=S.guid||A.guid++,J},A.holdReady=function(S){S?A.readyWait++:A.ready(!0)},A.isArray=Array.isArray,A.parseJSON=JSON.parse,A.nodeName=ue,A.isFunction=k,A.isWindow=W,A.camelCase=Ve,A.type=K,A.now=Date.now,A.isNumeric=function(S){var N=A.type(S);return(N==="number"||N==="string")&&!isNaN(S-parseFloat(S))},A.trim=function(S){return S==null?"":(S+"").replace(Tw,"$1")};var bw=i.jQuery,Pp=i.$;return A.noConflict=function(S){return i.$===A&&(i.$=Pp),S&&i.jQuery===A&&(i.jQuery=bw),A},typeof o>"u"&&(i.jQuery=i.$=A),A})}(xI)),xI.exports}(function(n){(function(i){i(["jquery"],function(o){return function(){var c,d,f=0,_={error:"error",info:"info",success:"success",warning:"warning"},v={clear:k,remove:W,error:T,getContainer:w,info:R,options:{},subscribe:I,success:j,version:"2.1.4",warning:P},x;return v;function T(ue,oe,ye){return ie({type:_.error,iconClass:A().iconClasses.error,message:ue,optionsOverride:ye,title:oe})}function w(ue,oe){return ue||(ue=A()),c=o("#"+ue.containerId),c.length||oe&&(c=V(ue)),c}function R(ue,oe,ye){return ie({type:_.info,iconClass:A().iconClasses.info,message:ue,optionsOverride:ye,title:oe})}function I(ue){d=ue}function j(ue,oe,ye){return ie({type:_.success,iconClass:A().iconClasses.success,message:ue,optionsOverride:ye,title:oe})}function P(ue,oe,ye){return ie({type:_.warning,iconClass:A().iconClasses.warning,message:ue,optionsOverride:ye,title:oe})}function k(ue,oe){var ye=A();c||w(ye),L(ue,ye,oe)||H(ye)}function W(ue){var oe=A();if(c||w(oe),ue&&o(":focus",ue).length===0){de(ue);return}c.children().length&&c.remove()}function H(ue){for(var oe=c.children(),ye=oe.length-1;ye>=0;ye--)L(o(oe[ye]),ue)}function L(ue,oe,ye){var Ee=ye&&ye.force?ye.force:!1;return ue&&(Ee||o(":focus",ue).length===0)?(ue[oe.hideMethod]({duration:oe.hideDuration,easing:oe.hideEasing,complete:function(){de(ue)}}),!0):!1}function V(ue){return c=o("<div/>").attr("id",ue.containerId).addClass(ue.positionClass),c.appendTo(o(ue.target)),c}function K(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1}}function te(ue){d&&d(ue)}function ie(ue){var oe=A(),ye=ue.iconClass||oe.iconClass;if(typeof ue.optionsOverride<"u"&&(oe=o.extend(oe,ue.optionsOverride),ye=ue.optionsOverride.iconClass||ye),yr(oe,ue))return;f++,c=w(oe,!0);var Ee=null,xe=o("<div/>"),Oe=o("<div/>"),ct=o("<div/>"),at=o("<div/>"),lt=o(oe.closeHtml),He={intervalId:null,hideEta:null,maxHideTime:null},et={toastId:f,state:"visible",startTime:new Date,options:oe,map:ue};return Ae(),qe(),ze(),te(et),oe.debug&&console&&console.log(et),xe;function ut(mn){return mn==null&&(mn=""),mn.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ae(){fn(),Dn(),Kt(),hr(),Bn(),Yr(),qt(),Le()}function Le(){var mn="";switch(ue.iconClass){case"toast-success":case"toast-info":mn="polite";break;default:mn="assertive"}xe.attr("aria-live",mn)}function ze(){oe.closeOnHover&&xe.hover(jo,ri),!oe.onclick&&oe.tapToDismiss&&xe.click(cr),oe.closeButton&&lt&&lt.click(function(mn){mn.stopPropagation?mn.stopPropagation():mn.cancelBubble!==void 0&&mn.cancelBubble!==!0&&(mn.cancelBubble=!0),oe.onCloseClick&&oe.onCloseClick(mn),cr(!0)}),oe.onclick&&xe.click(function(mn){oe.onclick(mn),cr()})}function qe(){xe.hide(),xe[oe.showMethod]({duration:oe.showDuration,easing:oe.showEasing,complete:oe.onShown}),oe.timeOut>0&&(Ee=setTimeout(cr,oe.timeOut),He.maxHideTime=parseFloat(oe.timeOut),He.hideEta=new Date().getTime()+He.maxHideTime,oe.progressBar&&(He.intervalId=setInterval(gi,10)))}function fn(){ue.iconClass&&xe.addClass(oe.toastClass).addClass(ye)}function qt(){oe.newestOnTop?c.prepend(xe):c.append(xe)}function Dn(){if(ue.title){var mn=ue.title;oe.escapeHtml&&(mn=ut(ue.title)),Oe.append(mn).addClass(oe.titleClass),xe.append(Oe)}}function Kt(){if(ue.message){var mn=ue.message;oe.escapeHtml&&(mn=ut(ue.message)),ct.append(mn).addClass(oe.messageClass),xe.append(ct)}}function hr(){oe.closeButton&&(lt.addClass(oe.closeClass).attr("role","button"),xe.prepend(lt))}function Bn(){oe.progressBar&&(at.addClass(oe.progressClass),xe.prepend(at))}function Yr(){oe.rtl&&xe.addClass("rtl")}function yr(mn,Pn){if(mn.preventDuplicates){if(Pn.message===x)return!0;x=Pn.message}return!1}function cr(mn){var Pn=mn&&oe.closeMethod!==!1?oe.closeMethod:oe.hideMethod,$r=mn&&oe.closeDuration!==!1?oe.closeDuration:oe.hideDuration,ve=mn&&oe.closeEasing!==!1?oe.closeEasing:oe.hideEasing;if(!(o(":focus",xe).length&&!mn))return clearTimeout(He.intervalId),xe[Pn]({duration:$r,easing:ve,complete:function(){de(xe),clearTimeout(Ee),oe.onHidden&&et.state!=="hidden"&&oe.onHidden(),et.state="hidden",et.endTime=new Date,te(et)}})}function ri(){(oe.timeOut>0||oe.extendedTimeOut>0)&&(Ee=setTimeout(cr,oe.extendedTimeOut),He.maxHideTime=parseFloat(oe.extendedTimeOut),He.hideEta=new Date().getTime()+He.maxHideTime)}function jo(){clearTimeout(Ee),He.hideEta=0,xe.stop(!0,!0)[oe.showMethod]({duration:oe.showDuration,easing:oe.showEasing})}function gi(){var mn=(He.hideEta-new Date().getTime())/He.maxHideTime*100;at.width(mn+"%")}}function A(){return o.extend({},K(),v.options)}function de(ue){c||(c=w()),!ue.is(":visible")&&(ue.remove(),ue=null,c.children().length===0&&(c.remove(),x=void 0))}}()})})(function(i,o){n.exports?n.exports=o(nAe()):window.toastr=o(window.jQuery)})})(JJ);var rAe=JJ.exports;const No=$T(rAe);const mx=({title:n,value:i,icon:o,bgColor:c="bg-red-100",textColor:d="text-red-700"})=>h.jsxs(Dt.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.4},className:`p-4 rounded-lg shadow ${c}`,role:"region","aria-label":`${n} statistics`,children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsx("p",{className:`text-sm font-medium ${d}`,children:n}),o&&h.jsx(o,{className:`h-5 w-5 ${d}`})]}),h.jsx("p",{className:`text-2xl font-bold ${d}`,children:i})]}),h_=({label:n,icon:i,onClick:o,variant:c="default",className:d="",disabled:f=!1})=>{const _=n.toLowerCase().includes("disable")||n.toLowerCase().includes("enable");return h.jsxs(vt,{onClick:o,variant:c,className:`w-full flex items-center justify-center py-3 ${d}`,disabled:f,"aria-pressed":_?!!n.toLowerCase().includes("disable"):void 0,children:[i&&h.jsx(i,{className:"mr-2 h-5 w-5"}),n]})},Qd=({title:n,description:i,icon:o})=>{const c=d=>{(d.key==="Enter"||d.key===" ")&&d.preventDefault()};return h.jsxs(Dt.div,{className:"p-4 bg-rose-50 rounded-lg hover:bg-rose-100 transition-colors cursor-pointer border border-rose-200",whileHover:{scale:1.03},initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},role:"button",tabIndex:0,"aria-label":`${n}: ${i}`,onKeyDown:c,children:[h.jsxs("div",{className:"flex items-center mb-2",children:[o&&h.jsx(o,{className:"h-6 w-6 text-red-500 mr-3"}),h.jsx("h3",{className:"text-md font-semibold text-gray-700",children:n})]}),h.jsx("p",{className:"text-xs text-gray-600",children:i})]})},iAe=()=>{const[n,i]=X.useState(!0),[o,c]=X.useState(!0),[d,f]=X.useState(!1);console.log("https://astro-talk-backend.onrender.com");const v=Qi(),x=JSON.parse(localStorage.getItem("astroUser")||"{}");X.useEffect(()=>{localStorage.getItem("astroToken")||v("/astro-login")},[v]);const T=()=>{localStorage.removeItem("astroToken"),localStorage.removeItem("astroUser"),v("/astro-login")},w=localStorage.getItem("astroUser"),R=JSON.parse(w),[I,j]=X.useState(!1),[P,k]=X.useState(R.wallet),W=()=>{j(!0)};console.log("astrologer encripted data",R);const H=async L=>{var V,K;L.preventDefault();try{const te=await Jn.post("http://localhost:8000/create-order",{amount:Number(P),astrologerId:R._id});console.log(te),te.data.status?(j(!1),No.success("Withdrawal request submitted successfully.")):(j(!1),No.error(te.data.message||"Request failed."))}catch(te){j(!1),console.error("Payment request error:",te),No.error(((K=(V=te.response)==null?void 0:V.data)==null?void 0:K.message)||"Withdrawal request submission failed.")}};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-rose-50 to-red-50 p-4 md:p-8",children:[h.jsxs(Dt.div,{className:"container mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-4 md:mb-0",children:["Welcome, ",(x==null?void 0:x.astroName)||(x==null?void 0:x.name)||"Astrologer"]}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(vt,{variant:"outline",size:"icon",className:"text-red-500 border-red-300 hover:bg-red-100","aria-label":"Notifications",children:h.jsx(fd,{className:"h-5 w-5"})}),h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white","aria-label":"Profile Settings",children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"})," Profile Settings"]}),h.jsxs(vt,{variant:"destructive",size:"sm",onClick:T,"aria-label":"Logout",children:[h.jsx(DEe,{className:"mr-1 h-4 w-4"})," Logout"]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[h.jsx("div",{onClick:W,children:h.jsx(mx,{title:"Today's Earnings",value:` ${R.wallet}  `,icon:$N,bgColor:"bg-green-100",textColor:"text-green-700",style:{cursor:"pointer"}})}),h.jsx(mx,{title:"Total Earnings",value:"85,600",icon:$N}),h.jsx(mx,{title:"Followers",value:"1.2K",icon:cd}),h.jsx(mx,{title:"Profile Shares",value:"350",icon:LEe,bgColor:"bg-blue-100",textColor:"text-blue-700"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[h.jsxs(ur,{className:"md:col-span-1 shadow-xl rounded-xl",children:[h.jsx(qr,{children:h.jsx(ni,{className:"text-xl font-semibold text-gray-700",children:"Controls"})}),h.jsxs(vr,{className:"space-y-4",children:[h.jsx(h_,{label:n?"Disable Calls":"Enable Calls",icon:Iu,onClick:()=>i(!n),variant:n?"destructive":"default",className:n?"":"bg-green-500 hover:bg-green-600"}),h.jsx(h_,{label:o?"Disable Chat":"Enable Chat",icon:dp,onClick:()=>c(!o),variant:o?"destructive":"default",className:o?"":"bg-green-500 hover:bg-green-600"}),h.jsx(h_,{label:d?"Disable Video":"Enable Video Call",icon:bT,onClick:()=>f(!d),variant:d?"destructive":"default",className:d?"":"bg-green-500 hover:bg-green-600"}),h.jsx(n2,{channel:R==null?void 0:R.agoraChannel,uid:Math.floor(Math.random()*1e6)}),h.jsx(h_,{label:"Go Live",icon:uEe,className:"bg-red-500 hover:bg-red-600 text-white"}),h.jsx(h_,{label:"Boost My Profile",icon:fk,variant:"outline",className:"text-red-500 border-red-500 hover:bg-red-50"})]})]}),h.jsxs(ur,{className:"md:col-span-2 shadow-xl rounded-xl",children:[h.jsx(qr,{children:h.jsx(ni,{className:"text-xl font-semibold text-gray-700",children:"Performance & Tools"})}),h.jsxs(vr,{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[h.jsx(Qd,{title:"View Performance",description:"Track your earnings and ratings.",icon:dEe}),h.jsx(Qd,{title:"Chat History",description:"Review past client conversations.",icon:dp}),h.jsx(Qd,{title:"Call History",description:"Access records of previous calls.",icon:bT}),h.jsx(Qd,{title:"Support Center",description:"Get help and report issues.",icon:SY}),h.jsx(Qd,{title:"Edit Profile",description:"Update your details and expertise.",icon:NEe}),h.jsx(Qd,{title:"Free Chat/Call Offers",description:"Manage promotional offers.",icon:yEe}),h.jsx(Qd,{title:"Get Birth Details",description:"Access client birth information.",icon:cd}),h.jsx(Qd,{title:"Set Your Rate",description:"Adjust your consultation charges.",icon:$N})]})]})]}),h.jsxs(ur,{className:"shadow-lg rounded-xl",children:[h.jsxs(qr,{children:[h.jsx(ni,{className:"text-xl font-semibold text-gray-700",children:"Recent Activity"}),h.jsx(qs,{className:"text-sm text-gray-500",children:"Latest interactions and notifications."})]}),h.jsx(vr,{children:h.jsx("div",{className:"h-40 flex items-center justify-center bg-gray-50 rounded-md",children:h.jsx("p",{className:"text-gray-400",children:"No new activity."})})})]})]}),I&&h.jsxs(WJ,{open:I,onOpenChange:j,children:[h.jsx(HJ,{asChild:!0,children:h.jsx("button",{className:"cursor-pointer bg-green-100 text-green-700 px-4 py-2 rounded",children:"Update Wallet"})}),h.jsxs(GJ,{children:[h.jsx(o2,{className:"fixed inset-0 bg-black/50 z-40"}),h.jsxs(a2,{className:"fixed left-1/2 top-1/2 w-[90%] max-w-sm -translate-x-1/2 -translate-y-1/2 bg-white p-6 rounded-lg shadow-xl z-50",children:[h.jsx(c2,{className:"text-lg font-semibold mb-4",children:"Update Wallet"}),h.jsxs("form",{onSubmit:H,children:[h.jsx("input",{type:"number",className:"w-full p-2 border border-gray-300 rounded mb-4",value:P,onChange:L=>k(L.target.value),placeholder:"Enter new wallet amount",name:"paymentValue"}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx(KJ,{asChild:!0,children:h.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded",children:"Cancel"})}),h.jsx("button",{type:"submit",className:"bg-green-600 text-white px-4 py-2 rounded",children:"Save"})]})]})]})]})]})]})},HD=wt.forwardRef(({className:n="",...i},o)=>h.jsx("textarea",{ref:o,className:`border rounded-md px-3 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 w-full ${n}`,...i})),sAe=()=>{const{register:n,handleSubmit:i,reset:o,watch:c,formState:{errors:d}}=Mb();c("password");const[f,_]=X.useState(!1),[v,x]=X.useState(""),T=Qi(),w=async R=>{var I,j,P;_(!0),x("");try{const k={astroName:R.astroName.trim(),astroDob:R.astroDob,mobile:R.mobile.trim(),email:R.email.trim(),password:R.password,city:R.city.trim(),experience:Number(R.experience),expertise:R.expertise.trim(),language:R.language.trim()||"Hindi",shortBio:R.shortBio.trim(),chargePerSession:R.chargePerSession||"500",availableTime:R.availableTime||"10:00 AM - 6:00 PM",bankDetails:R.bankDetails.trim(),userType:R.userType};await Jn.post("https://astro-talk-backend.onrender.com/web/astro",k,{headers:{"Content-Type":"application/json"},maxRedirects:0}),alert("Astrologer registered successfully!"),o()}catch(k){console.error("Submission error:",k),((I=k.response)==null?void 0:I.status)===302?x("Request redirected. Please check the API endpoint or authentication."):x(((P=(j=k.response)==null?void 0:j.data)==null?void 0:P.message)||k.message||"Something went wrong.")}finally{_(!1)}};return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-yellow-100 via-amber-50 to-white p-6",children:h.jsx(Dt.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-3xl",children:h.jsx("form",{onSubmit:i(w),noValidate:!0,className:"register-m-t",children:h.jsxs(ur,{className:"shadow-2xl rounded-xl border border-yellow-300 overflow-hidden relative",children:[h.jsx("button",{onClick:()=>T("/"),className:"absolute top-4 right-4 text-gray-400 hover:text-red-600 z-10","aria-label":"Close",children:h.jsx(xp,{className:"w-5 h-5"})}),h.jsxs(qr,{className:"bg-gradient-to-r from-yellow-400 to-amber-500 text-center p-10",children:[h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg",children:h.jsx(WEe,{className:"h-14 w-14 text-yellow-600"})}),h.jsx(ni,{className:"text-4xl font-extrabold text-gray-900 mt-5",children:"Join as an Astrologer"}),h.jsx(qs,{className:"text-amber-900 mt-1",children:"Share your wisdom with the world. Register on Astrotruth!"})]}),h.jsxs(vr,{className:"bg-white p-8 space-y-6",children:[v&&h.jsx("p",{className:"text-center text-red-700 font-semibold mb-4",children:v}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"astroName",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx($h,{className:"w-5 h-5"})," Full Name"]}),h.jsx(Vt,{id:"astroName",placeholder:"Enter Full Name",...n("astroName",{required:"Full name is required"}),disabled:f,className:"mt-1"}),d.astroName&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.astroName.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"email",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(ad,{className:"w-5 h-5"})," Email Address"]}),h.jsx(Vt,{id:"email",type:"email",...n("email",{required:"Email is required",pattern:{value:/^\S+@\S+$/,message:"Invalid email address"}}),disabled:f,className:"mt-1"}),d.email&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.email.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"mobile",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(Iu,{className:"w-5 h-5"})," Mobile Number"]}),h.jsx(Vt,{id:"mobile",placeholder:"Enter Mobile Number",type:"tel",...n("mobile",{required:"Mobile number is required",pattern:{value:/^[0-9]{10,15}$/,message:"Invalid mobile number"}}),disabled:f,className:"mt-1"}),d.mobile&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.mobile.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"astroDob",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(pEe,{className:"w-5 h-5"})," Date of Birth"]}),h.jsx(Vt,{id:"astroDob",type:"date",...n("astroDob",{required:"Date of birth is required"}),disabled:f,className:"mt-1"}),d.astroDob&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.astroDob.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"city",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(pk,{className:"w-5 h-5"})," City"]}),h.jsx(Vt,{id:"city",placeholder:"Enter City Name",...n("city",{required:"City is required"}),disabled:f,className:"mt-1"}),d.city&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.city.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"experience",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(EY,{className:"w-5 h-5"})," Experience (years)"]}),h.jsx(Vt,{id:"experience",type:"number",min:0,...n("experience",{required:"Experience is required"}),disabled:f,className:"mt-1"}),d.experience&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.experience.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"expertise",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(oo,{className:"w-5 h-5"})," Expertise"]}),h.jsx(Vt,{id:"expertise",placeholder:"Vedic, Tarot, etc.",...n("expertise",{required:"Expertise is required"}),disabled:f,className:"mt-1"}),d.expertise&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.expertise.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx(Ut,{htmlFor:"language",className:"font-semibold text-yellow-600",children:"Language"}),h.jsx(Vt,{id:"language",placeholder:"Hindi, English, etc.",...n("language",{required:"Language is required"}),disabled:f,className:"mt-1"}),d.language&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.language.message})]})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx(Ut,{htmlFor:"shortBio",className:"font-semibold text-yellow-600",children:"Short Bio"}),h.jsx(HD,{id:"shortBio",rows:4,placeholder:"Describe your approach...",...n("shortBio"),disabled:f,className:"mt-1"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsx(Ut,{htmlFor:"chargePerSession",className:"font-semibold text-yellow-600",children:"Charge Per Session ()"}),h.jsx(Vt,{id:"chargePerSession",type:"number",placeholder:"500",...n("chargePerSession"),disabled:f,className:"mt-1"})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx(Ut,{htmlFor:"availableTime",className:"font-semibold text-yellow-600",children:"Available Time"}),h.jsx(Vt,{id:"availableTime",placeholder:"10:00 AM - 6:00 PM",...n("availableTime"),disabled:f,className:"mt-1"})]})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx(Ut,{htmlFor:"bankDetails",className:"font-semibold text-yellow-600",children:"Bank Details"}),h.jsx(HD,{id:"bankDetails",rows:3,placeholder:"Bank Name, Account Number, IFSC",...n("bankDetails",{required:"Bank details are required"}),disabled:f,className:"mt-1"}),d.bankDetails&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.bankDetails.message})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsxs(Ut,{htmlFor:"password",className:"flex items-center gap-2 text-yellow-600 font-semibold",children:[h.jsx(xY,{className:"w-5 h-5"})," Password"]}),h.jsx(Vt,{id:"password",type:"password",...n("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),disabled:f,className:"mt-1"}),d.password&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.password.message})]}),h.jsxs("div",{className:"flex flex-col register-padding mt-4",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"radio",value:"Karmkandi",...n("userType",{required:"Please select a type"}),disabled:f}),"Karmkandi"]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"radio",value:"Astrologer",...n("userType",{required:"Please select a type"}),disabled:f}),"Astrologer"]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"radio",value:"Both",...n("userType",{required:"Please select a type"}),disabled:f}),"Both"]})]}),d.userType&&h.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.userType.message})]}),h.jsx("div",{className:"register-padding",children:h.jsx(vt,{type:"submit",disabled:f,className:"w-full cosmic-gradient text-white",children:f?"Submitting...":"Register"})})]}),h.jsx(r0,{className:"bg-yellow-200 flex flex-col md:flex-row justify-between items-center gap-4 p-6",children:h.jsx(Xn,{to:"/astro-login",className:"text-yellow-700 hover:underline font-semibold",children:"Already have an account? Login"})})]})})})})};var oAe={exports:{}};function aAe(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var TI={exports:{}};const cAe={},lAe=Object.freeze(Object.defineProperty({__proto__:null,default:cAe},Symbol.toStringTag,{value:"Module"})),dAe=pfe(lAe);var dG;function Qn(){return dG||(dG=1,function(n,i){(function(o,c){n.exports=c()})(En,function(){var o=o||function(c,d){var f;if(typeof window<"u"&&window.crypto&&(f=window.crypto),typeof self<"u"&&self.crypto&&(f=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(f=globalThis.crypto),!f&&typeof window<"u"&&window.msCrypto&&(f=window.msCrypto),!f&&typeof En<"u"&&En.crypto&&(f=En.crypto),!f&&typeof aAe=="function")try{f=dAe}catch{}var _=function(){if(f){if(typeof f.getRandomValues=="function")try{return f.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof f.randomBytes=="function")try{return f.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},v=Object.create||function(){function L(){}return function(V){var K;return L.prototype=V,K=new L,L.prototype=null,K}}(),x={},T=x.lib={},w=T.Base=function(){return{extend:function(L){var V=v(this);return L&&V.mixIn(L),(!V.hasOwnProperty("init")||this.init===V.init)&&(V.init=function(){V.$super.init.apply(this,arguments)}),V.init.prototype=V,V.$super=this,V},create:function(){var L=this.extend();return L.init.apply(L,arguments),L},init:function(){},mixIn:function(L){for(var V in L)L.hasOwnProperty(V)&&(this[V]=L[V]);L.hasOwnProperty("toString")&&(this.toString=L.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),R=T.WordArray=w.extend({init:function(L,V){L=this.words=L||[],V!=d?this.sigBytes=V:this.sigBytes=L.length*4},toString:function(L){return(L||j).stringify(this)},concat:function(L){var V=this.words,K=L.words,te=this.sigBytes,ie=L.sigBytes;if(this.clamp(),te%4)for(var A=0;A<ie;A++){var de=K[A>>>2]>>>24-A%4*8&255;V[te+A>>>2]|=de<<24-(te+A)%4*8}else for(var ue=0;ue<ie;ue+=4)V[te+ue>>>2]=K[ue>>>2];return this.sigBytes+=ie,this},clamp:function(){var L=this.words,V=this.sigBytes;L[V>>>2]&=4294967295<<32-V%4*8,L.length=c.ceil(V/4)},clone:function(){var L=w.clone.call(this);return L.words=this.words.slice(0),L},random:function(L){for(var V=[],K=0;K<L;K+=4)V.push(_());return new R.init(V,L)}}),I=x.enc={},j=I.Hex={stringify:function(L){for(var V=L.words,K=L.sigBytes,te=[],ie=0;ie<K;ie++){var A=V[ie>>>2]>>>24-ie%4*8&255;te.push((A>>>4).toString(16)),te.push((A&15).toString(16))}return te.join("")},parse:function(L){for(var V=L.length,K=[],te=0;te<V;te+=2)K[te>>>3]|=parseInt(L.substr(te,2),16)<<24-te%8*4;return new R.init(K,V/2)}},P=I.Latin1={stringify:function(L){for(var V=L.words,K=L.sigBytes,te=[],ie=0;ie<K;ie++){var A=V[ie>>>2]>>>24-ie%4*8&255;te.push(String.fromCharCode(A))}return te.join("")},parse:function(L){for(var V=L.length,K=[],te=0;te<V;te++)K[te>>>2]|=(L.charCodeAt(te)&255)<<24-te%4*8;return new R.init(K,V)}},k=I.Utf8={stringify:function(L){try{return decodeURIComponent(escape(P.stringify(L)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(L){return P.parse(unescape(encodeURIComponent(L)))}},W=T.BufferedBlockAlgorithm=w.extend({reset:function(){this._data=new R.init,this._nDataBytes=0},_append:function(L){typeof L=="string"&&(L=k.parse(L)),this._data.concat(L),this._nDataBytes+=L.sigBytes},_process:function(L){var V,K=this._data,te=K.words,ie=K.sigBytes,A=this.blockSize,de=A*4,ue=ie/de;L?ue=c.ceil(ue):ue=c.max((ue|0)-this._minBufferSize,0);var oe=ue*A,ye=c.min(oe*4,ie);if(oe){for(var Ee=0;Ee<oe;Ee+=A)this._doProcessBlock(te,Ee);V=te.splice(0,oe),K.sigBytes-=ye}return new R.init(V,ye)},clone:function(){var L=w.clone.call(this);return L._data=this._data.clone(),L},_minBufferSize:0});T.Hasher=W.extend({cfg:w.extend(),init:function(L){this.cfg=this.cfg.extend(L),this.reset()},reset:function(){W.reset.call(this),this._doReset()},update:function(L){return this._append(L),this._process(),this},finalize:function(L){L&&this._append(L);var V=this._doFinalize();return V},blockSize:16,_createHelper:function(L){return function(V,K){return new L.init(K).finalize(V)}},_createHmacHelper:function(L){return function(V,K){return new H.HMAC.init(L,K).finalize(V)}}});var H=x.algo={};return x}(Math);return o})}(TI)),TI.exports}var bI={exports:{}},uG;function Gb(){return uG||(uG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(c){var d=o,f=d.lib,_=f.Base,v=f.WordArray,x=d.x64={};x.Word=_.extend({init:function(T,w){this.high=T,this.low=w}}),x.WordArray=_.extend({init:function(T,w){T=this.words=T||[],w!=c?this.sigBytes=w:this.sigBytes=T.length*8},toX32:function(){for(var T=this.words,w=T.length,R=[],I=0;I<w;I++){var j=T[I];R.push(j.high),R.push(j.low)}return v.create(R,this.sigBytes)},clone:function(){for(var T=_.clone.call(this),w=T.words=this.words.slice(0),R=w.length,I=0;I<R;I++)w[I]=w[I].clone();return T}})}(),o})}(bI)),bI.exports}var wI={exports:{}},hG;function uAe(){return hG||(hG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(){if(typeof ArrayBuffer=="function"){var c=o,d=c.lib,f=d.WordArray,_=f.init,v=f.init=function(x){if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),(x instanceof Int8Array||typeof Uint8ClampedArray<"u"&&x instanceof Uint8ClampedArray||x instanceof Int16Array||x instanceof Uint16Array||x instanceof Int32Array||x instanceof Uint32Array||x instanceof Float32Array||x instanceof Float64Array)&&(x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength)),x instanceof Uint8Array){for(var T=x.byteLength,w=[],R=0;R<T;R++)w[R>>>2]|=x[R]<<24-R%4*8;_.call(this,w,T)}else _.apply(this,arguments)};v.prototype=f}}(),o.lib.WordArray})}(wI)),wI.exports}var CI={exports:{}},pG;function hAe(){return pG||(pG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(){var c=o,d=c.lib,f=d.WordArray,_=c.enc;_.Utf16=_.Utf16BE={stringify:function(x){for(var T=x.words,w=x.sigBytes,R=[],I=0;I<w;I+=2){var j=T[I>>>2]>>>16-I%4*8&65535;R.push(String.fromCharCode(j))}return R.join("")},parse:function(x){for(var T=x.length,w=[],R=0;R<T;R++)w[R>>>1]|=x.charCodeAt(R)<<16-R%2*16;return f.create(w,T*2)}},_.Utf16LE={stringify:function(x){for(var T=x.words,w=x.sigBytes,R=[],I=0;I<w;I+=2){var j=v(T[I>>>2]>>>16-I%4*8&65535);R.push(String.fromCharCode(j))}return R.join("")},parse:function(x){for(var T=x.length,w=[],R=0;R<T;R++)w[R>>>1]|=v(x.charCodeAt(R)<<16-R%2*16);return f.create(w,T*2)}};function v(x){return x<<8&4278255360|x>>>8&16711935}}(),o.enc.Utf16})}(CI)),CI.exports}var RI={exports:{}},fG;function wp(){return fG||(fG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(){var c=o,d=c.lib,f=d.WordArray,_=c.enc;_.Base64={stringify:function(x){var T=x.words,w=x.sigBytes,R=this._map;x.clamp();for(var I=[],j=0;j<w;j+=3)for(var P=T[j>>>2]>>>24-j%4*8&255,k=T[j+1>>>2]>>>24-(j+1)%4*8&255,W=T[j+2>>>2]>>>24-(j+2)%4*8&255,H=P<<16|k<<8|W,L=0;L<4&&j+L*.75<w;L++)I.push(R.charAt(H>>>6*(3-L)&63));var V=R.charAt(64);if(V)for(;I.length%4;)I.push(V);return I.join("")},parse:function(x){var T=x.length,w=this._map,R=this._reverseMap;if(!R){R=this._reverseMap=[];for(var I=0;I<w.length;I++)R[w.charCodeAt(I)]=I}var j=w.charAt(64);if(j){var P=x.indexOf(j);P!==-1&&(T=P)}return v(x,T,R)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function v(x,T,w){for(var R=[],I=0,j=0;j<T;j++)if(j%4){var P=w[x.charCodeAt(j-1)]<<j%4*2,k=w[x.charCodeAt(j)]>>>6-j%4*2,W=P|k;R[I>>>2]|=W<<24-I%4*8,I++}return f.create(R,I)}}(),o.enc.Base64})}(RI)),RI.exports}var AI={exports:{}},mG;function pAe(){return mG||(mG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(){var c=o,d=c.lib,f=d.WordArray,_=c.enc;_.Base64url={stringify:function(x,T){T===void 0&&(T=!0);var w=x.words,R=x.sigBytes,I=T?this._safe_map:this._map;x.clamp();for(var j=[],P=0;P<R;P+=3)for(var k=w[P>>>2]>>>24-P%4*8&255,W=w[P+1>>>2]>>>24-(P+1)%4*8&255,H=w[P+2>>>2]>>>24-(P+2)%4*8&255,L=k<<16|W<<8|H,V=0;V<4&&P+V*.75<R;V++)j.push(I.charAt(L>>>6*(3-V)&63));var K=I.charAt(64);if(K)for(;j.length%4;)j.push(K);return j.join("")},parse:function(x,T){T===void 0&&(T=!0);var w=x.length,R=T?this._safe_map:this._map,I=this._reverseMap;if(!I){I=this._reverseMap=[];for(var j=0;j<R.length;j++)I[R.charCodeAt(j)]=j}var P=R.charAt(64);if(P){var k=x.indexOf(P);k!==-1&&(w=k)}return v(x,w,I)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function v(x,T,w){for(var R=[],I=0,j=0;j<T;j++)if(j%4){var P=w[x.charCodeAt(j-1)]<<j%4*2,k=w[x.charCodeAt(j)]>>>6-j%4*2,W=P|k;R[I>>>2]|=W<<24-I%4*8,I++}return f.create(R,I)}}(),o.enc.Base64url})}(AI)),AI.exports}var NI={exports:{}},gG;function Cp(){return gG||(gG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(c){var d=o,f=d.lib,_=f.WordArray,v=f.Hasher,x=d.algo,T=[];(function(){for(var k=0;k<64;k++)T[k]=c.abs(c.sin(k+1))*4294967296|0})();var w=x.MD5=v.extend({_doReset:function(){this._hash=new _.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(k,W){for(var H=0;H<16;H++){var L=W+H,V=k[L];k[L]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}var K=this._hash.words,te=k[W+0],ie=k[W+1],A=k[W+2],de=k[W+3],ue=k[W+4],oe=k[W+5],ye=k[W+6],Ee=k[W+7],xe=k[W+8],Oe=k[W+9],ct=k[W+10],at=k[W+11],lt=k[W+12],He=k[W+13],et=k[W+14],ut=k[W+15],Ae=K[0],Le=K[1],ze=K[2],qe=K[3];Ae=R(Ae,Le,ze,qe,te,7,T[0]),qe=R(qe,Ae,Le,ze,ie,12,T[1]),ze=R(ze,qe,Ae,Le,A,17,T[2]),Le=R(Le,ze,qe,Ae,de,22,T[3]),Ae=R(Ae,Le,ze,qe,ue,7,T[4]),qe=R(qe,Ae,Le,ze,oe,12,T[5]),ze=R(ze,qe,Ae,Le,ye,17,T[6]),Le=R(Le,ze,qe,Ae,Ee,22,T[7]),Ae=R(Ae,Le,ze,qe,xe,7,T[8]),qe=R(qe,Ae,Le,ze,Oe,12,T[9]),ze=R(ze,qe,Ae,Le,ct,17,T[10]),Le=R(Le,ze,qe,Ae,at,22,T[11]),Ae=R(Ae,Le,ze,qe,lt,7,T[12]),qe=R(qe,Ae,Le,ze,He,12,T[13]),ze=R(ze,qe,Ae,Le,et,17,T[14]),Le=R(Le,ze,qe,Ae,ut,22,T[15]),Ae=I(Ae,Le,ze,qe,ie,5,T[16]),qe=I(qe,Ae,Le,ze,ye,9,T[17]),ze=I(ze,qe,Ae,Le,at,14,T[18]),Le=I(Le,ze,qe,Ae,te,20,T[19]),Ae=I(Ae,Le,ze,qe,oe,5,T[20]),qe=I(qe,Ae,Le,ze,ct,9,T[21]),ze=I(ze,qe,Ae,Le,ut,14,T[22]),Le=I(Le,ze,qe,Ae,ue,20,T[23]),Ae=I(Ae,Le,ze,qe,Oe,5,T[24]),qe=I(qe,Ae,Le,ze,et,9,T[25]),ze=I(ze,qe,Ae,Le,de,14,T[26]),Le=I(Le,ze,qe,Ae,xe,20,T[27]),Ae=I(Ae,Le,ze,qe,He,5,T[28]),qe=I(qe,Ae,Le,ze,A,9,T[29]),ze=I(ze,qe,Ae,Le,Ee,14,T[30]),Le=I(Le,ze,qe,Ae,lt,20,T[31]),Ae=j(Ae,Le,ze,qe,oe,4,T[32]),qe=j(qe,Ae,Le,ze,xe,11,T[33]),ze=j(ze,qe,Ae,Le,at,16,T[34]),Le=j(Le,ze,qe,Ae,et,23,T[35]),Ae=j(Ae,Le,ze,qe,ie,4,T[36]),qe=j(qe,Ae,Le,ze,ue,11,T[37]),ze=j(ze,qe,Ae,Le,Ee,16,T[38]),Le=j(Le,ze,qe,Ae,ct,23,T[39]),Ae=j(Ae,Le,ze,qe,He,4,T[40]),qe=j(qe,Ae,Le,ze,te,11,T[41]),ze=j(ze,qe,Ae,Le,de,16,T[42]),Le=j(Le,ze,qe,Ae,ye,23,T[43]),Ae=j(Ae,Le,ze,qe,Oe,4,T[44]),qe=j(qe,Ae,Le,ze,lt,11,T[45]),ze=j(ze,qe,Ae,Le,ut,16,T[46]),Le=j(Le,ze,qe,Ae,A,23,T[47]),Ae=P(Ae,Le,ze,qe,te,6,T[48]),qe=P(qe,Ae,Le,ze,Ee,10,T[49]),ze=P(ze,qe,Ae,Le,et,15,T[50]),Le=P(Le,ze,qe,Ae,oe,21,T[51]),Ae=P(Ae,Le,ze,qe,lt,6,T[52]),qe=P(qe,Ae,Le,ze,de,10,T[53]),ze=P(ze,qe,Ae,Le,ct,15,T[54]),Le=P(Le,ze,qe,Ae,ie,21,T[55]),Ae=P(Ae,Le,ze,qe,xe,6,T[56]),qe=P(qe,Ae,Le,ze,ut,10,T[57]),ze=P(ze,qe,Ae,Le,ye,15,T[58]),Le=P(Le,ze,qe,Ae,He,21,T[59]),Ae=P(Ae,Le,ze,qe,ue,6,T[60]),qe=P(qe,Ae,Le,ze,at,10,T[61]),ze=P(ze,qe,Ae,Le,A,15,T[62]),Le=P(Le,ze,qe,Ae,Oe,21,T[63]),K[0]=K[0]+Ae|0,K[1]=K[1]+Le|0,K[2]=K[2]+ze|0,K[3]=K[3]+qe|0},_doFinalize:function(){var k=this._data,W=k.words,H=this._nDataBytes*8,L=k.sigBytes*8;W[L>>>5]|=128<<24-L%32;var V=c.floor(H/4294967296),K=H;W[(L+64>>>9<<4)+15]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,W[(L+64>>>9<<4)+14]=(K<<8|K>>>24)&16711935|(K<<24|K>>>8)&4278255360,k.sigBytes=(W.length+1)*4,this._process();for(var te=this._hash,ie=te.words,A=0;A<4;A++){var de=ie[A];ie[A]=(de<<8|de>>>24)&16711935|(de<<24|de>>>8)&4278255360}return te},clone:function(){var k=v.clone.call(this);return k._hash=this._hash.clone(),k}});function R(k,W,H,L,V,K,te){var ie=k+(W&H|~W&L)+V+te;return(ie<<K|ie>>>32-K)+W}function I(k,W,H,L,V,K,te){var ie=k+(W&L|H&~L)+V+te;return(ie<<K|ie>>>32-K)+W}function j(k,W,H,L,V,K,te){var ie=k+(W^H^L)+V+te;return(ie<<K|ie>>>32-K)+W}function P(k,W,H,L,V,K,te){var ie=k+(H^(W|~L))+V+te;return(ie<<K|ie>>>32-K)+W}d.MD5=v._createHelper(w),d.HmacMD5=v._createHmacHelper(w)}(Math),o.MD5})}(NI)),NI.exports}var II={exports:{}},_G;function QJ(){return _G||(_G=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(){var c=o,d=c.lib,f=d.WordArray,_=d.Hasher,v=c.algo,x=[],T=v.SHA1=_.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(w,R){for(var I=this._hash.words,j=I[0],P=I[1],k=I[2],W=I[3],H=I[4],L=0;L<80;L++){if(L<16)x[L]=w[R+L]|0;else{var V=x[L-3]^x[L-8]^x[L-14]^x[L-16];x[L]=V<<1|V>>>31}var K=(j<<5|j>>>27)+H+x[L];L<20?K+=(P&k|~P&W)+1518500249:L<40?K+=(P^k^W)+1859775393:L<60?K+=(P&k|P&W|k&W)-1894007588:K+=(P^k^W)-899497514,H=W,W=k,k=P<<30|P>>>2,P=j,j=K}I[0]=I[0]+j|0,I[1]=I[1]+P|0,I[2]=I[2]+k|0,I[3]=I[3]+W|0,I[4]=I[4]+H|0},_doFinalize:function(){var w=this._data,R=w.words,I=this._nDataBytes*8,j=w.sigBytes*8;return R[j>>>5]|=128<<24-j%32,R[(j+64>>>9<<4)+14]=Math.floor(I/4294967296),R[(j+64>>>9<<4)+15]=I,w.sigBytes=R.length*4,this._process(),this._hash},clone:function(){var w=_.clone.call(this);return w._hash=this._hash.clone(),w}});c.SHA1=_._createHelper(T),c.HmacSHA1=_._createHmacHelper(T)}(),o.SHA1})}(II)),II.exports}var OI={exports:{}},EG;function l2(){return EG||(EG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){return function(c){var d=o,f=d.lib,_=f.WordArray,v=f.Hasher,x=d.algo,T=[],w=[];(function(){function j(H){for(var L=c.sqrt(H),V=2;V<=L;V++)if(!(H%V))return!1;return!0}function P(H){return(H-(H|0))*4294967296|0}for(var k=2,W=0;W<64;)j(k)&&(W<8&&(T[W]=P(c.pow(k,1/2))),w[W]=P(c.pow(k,1/3)),W++),k++})();var R=[],I=x.SHA256=v.extend({_doReset:function(){this._hash=new _.init(T.slice(0))},_doProcessBlock:function(j,P){for(var k=this._hash.words,W=k[0],H=k[1],L=k[2],V=k[3],K=k[4],te=k[5],ie=k[6],A=k[7],de=0;de<64;de++){if(de<16)R[de]=j[P+de]|0;else{var ue=R[de-15],oe=(ue<<25|ue>>>7)^(ue<<14|ue>>>18)^ue>>>3,ye=R[de-2],Ee=(ye<<15|ye>>>17)^(ye<<13|ye>>>19)^ye>>>10;R[de]=oe+R[de-7]+Ee+R[de-16]}var xe=K&te^~K&ie,Oe=W&H^W&L^H&L,ct=(W<<30|W>>>2)^(W<<19|W>>>13)^(W<<10|W>>>22),at=(K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25),lt=A+at+xe+w[de]+R[de],He=ct+Oe;A=ie,ie=te,te=K,K=V+lt|0,V=L,L=H,H=W,W=lt+He|0}k[0]=k[0]+W|0,k[1]=k[1]+H|0,k[2]=k[2]+L|0,k[3]=k[3]+V|0,k[4]=k[4]+K|0,k[5]=k[5]+te|0,k[6]=k[6]+ie|0,k[7]=k[7]+A|0},_doFinalize:function(){var j=this._data,P=j.words,k=this._nDataBytes*8,W=j.sigBytes*8;return P[W>>>5]|=128<<24-W%32,P[(W+64>>>9<<4)+14]=c.floor(k/4294967296),P[(W+64>>>9<<4)+15]=k,j.sigBytes=P.length*4,this._process(),this._hash},clone:function(){var j=v.clone.call(this);return j._hash=this._hash.clone(),j}});d.SHA256=v._createHelper(I),d.HmacSHA256=v._createHmacHelper(I)}(Math),o.SHA256})}(OI)),OI.exports}var DI={exports:{}},vG;function fAe(){return vG||(vG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),l2())})(En,function(o){return function(){var c=o,d=c.lib,f=d.WordArray,_=c.algo,v=_.SHA256,x=_.SHA224=v.extend({_doReset:function(){this._hash=new f.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var T=v._doFinalize.call(this);return T.sigBytes-=4,T}});c.SHA224=v._createHelper(x),c.HmacSHA224=v._createHmacHelper(x)}(),o.SHA224})}(DI)),DI.exports}var PI={exports:{}},yG;function ZJ(){return yG||(yG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),Gb())})(En,function(o){return function(){var c=o,d=c.lib,f=d.Hasher,_=c.x64,v=_.Word,x=_.WordArray,T=c.algo;function w(){return v.create.apply(v,arguments)}var R=[w(1116352408,3609767458),w(1899447441,602891725),w(3049323471,3964484399),w(3921009573,2173295548),w(961987163,4081628472),w(1508970993,3053834265),w(2453635748,2937671579),w(2870763221,3664609560),w(3624381080,2734883394),w(310598401,1164996542),w(607225278,1323610764),w(1426881987,3590304994),w(1925078388,4068182383),w(2162078206,991336113),w(2614888103,633803317),w(3248222580,3479774868),w(3835390401,2666613458),w(4022224774,944711139),w(264347078,2341262773),w(604807628,2007800933),w(770255983,1495990901),w(1249150122,1856431235),w(1555081692,3175218132),w(1996064986,2198950837),w(2554220882,3999719339),w(2821834349,766784016),w(2952996808,2566594879),w(3210313671,3203337956),w(3336571891,1034457026),w(3584528711,2466948901),w(113926993,3758326383),w(338241895,168717936),w(666307205,1188179964),w(773529912,1546045734),w(1294757372,1522805485),w(1396182291,2643833823),w(1695183700,2343527390),w(1986661051,1014477480),w(2177026350,1206759142),w(2456956037,344077627),w(2730485921,1290863460),w(2820302411,3158454273),w(3259730800,3505952657),w(3345764771,106217008),w(3516065817,3606008344),w(3600352804,1432725776),w(4094571909,1467031594),w(275423344,851169720),w(430227734,3100823752),w(506948616,1363258195),w(659060556,3750685593),w(883997877,3785050280),w(958139571,3318307427),w(1322822218,3812723403),w(1537002063,2003034995),w(1747873779,3602036899),w(1955562222,1575990012),w(2024104815,1125592928),w(2227730452,2716904306),w(2361852424,442776044),w(2428436474,593698344),w(2756734187,3733110249),w(3204031479,2999351573),w(3329325298,3815920427),w(3391569614,3928383900),w(3515267271,566280711),w(3940187606,3454069534),w(4118630271,4000239992),w(116418474,1914138554),w(174292421,2731055270),w(289380356,3203993006),w(460393269,320620315),w(685471733,587496836),w(852142971,1086792851),w(1017036298,365543100),w(1126000580,2618297676),w(1288033470,3409855158),w(1501505948,4234509866),w(1607167915,987167468),w(1816402316,1246189591)],I=[];(function(){for(var P=0;P<80;P++)I[P]=w()})();var j=T.SHA512=f.extend({_doReset:function(){this._hash=new x.init([new v.init(1779033703,4089235720),new v.init(3144134277,2227873595),new v.init(1013904242,4271175723),new v.init(2773480762,1595750129),new v.init(1359893119,2917565137),new v.init(2600822924,725511199),new v.init(528734635,4215389547),new v.init(1541459225,327033209)])},_doProcessBlock:function(P,k){for(var W=this._hash.words,H=W[0],L=W[1],V=W[2],K=W[3],te=W[4],ie=W[5],A=W[6],de=W[7],ue=H.high,oe=H.low,ye=L.high,Ee=L.low,xe=V.high,Oe=V.low,ct=K.high,at=K.low,lt=te.high,He=te.low,et=ie.high,ut=ie.low,Ae=A.high,Le=A.low,ze=de.high,qe=de.low,fn=ue,qt=oe,Dn=ye,Kt=Ee,hr=xe,Bn=Oe,Yr=ct,yr=at,cr=lt,ri=He,jo=et,gi=ut,mn=Ae,Pn=Le,$r=ze,ve=qe,De=0;De<80;De++){var Ve,gt,ot=I[De];if(De<16)gt=ot.high=P[k+De*2]|0,Ve=ot.low=P[k+De*2+1]|0;else{var Ue=I[De-15],St=Ue.high,dn=Ue.low,nr=(St>>>1|dn<<31)^(St>>>8|dn<<24)^St>>>7,Ci=(dn>>>1|St<<31)^(dn>>>8|St<<24)^(dn>>>7|St<<25),Uo=I[De-2],Ri=Uo.high,Rs=Uo.low,Zi=(Ri>>>19|Rs<<13)^(Ri<<3|Rs>>>29)^Ri>>>6,_i=(Rs>>>19|Ri<<13)^(Rs<<3|Ri>>>29)^(Rs>>>6|Ri<<26),lo=I[De-7],md=lo.high,Lc=lo.low,Ys=I[De-16],Lu=Ys.high,Ap=Ys.low;Ve=Ci+Lc,gt=nr+md+(Ve>>>0<Ci>>>0?1:0),Ve=Ve+_i,gt=gt+Zi+(Ve>>>0<_i>>>0?1:0),Ve=Ve+Ap,gt=gt+Lu+(Ve>>>0<Ap>>>0?1:0),ot.high=gt,ot.low=Ve}var Mc=cr&jo^~cr&mn,jc=ri&gi^~ri&Pn,Np=fn&Dn^fn&hr^Dn&hr,Uc=qt&Kt^qt&Bn^Kt&Bn,As=(fn>>>28|qt<<4)^(fn<<30|qt>>>2)^(fn<<25|qt>>>7),Xr=(qt>>>28|fn<<4)^(qt<<30|fn>>>2)^(qt<<25|fn>>>7),Mu=(cr>>>14|ri<<18)^(cr>>>18|ri<<14)^(cr<<23|ri>>>9),a0=(ri>>>14|cr<<18)^(ri>>>18|cr<<14)^(ri<<23|cr>>>9),ju=R[De],Hi=ju.high,Ka=ju.low,Ei=ve+a0,ms=$r+Mu+(Ei>>>0<ve>>>0?1:0),Ei=Ei+jc,ms=ms+Mc+(Ei>>>0<jc>>>0?1:0),Ei=Ei+Ka,ms=ms+Hi+(Ei>>>0<Ka>>>0?1:0),Ei=Ei+Ve,ms=ms+gt+(Ei>>>0<Ve>>>0?1:0),qa=Xr+Uc,Uu=As+Np+(qa>>>0<Xr>>>0?1:0);$r=mn,ve=Pn,mn=jo,Pn=gi,jo=cr,gi=ri,ri=yr+Ei|0,cr=Yr+ms+(ri>>>0<yr>>>0?1:0)|0,Yr=hr,yr=Bn,hr=Dn,Bn=Kt,Dn=fn,Kt=qt,qt=Ei+qa|0,fn=ms+Uu+(qt>>>0<Ei>>>0?1:0)|0}oe=H.low=oe+qt,H.high=ue+fn+(oe>>>0<qt>>>0?1:0),Ee=L.low=Ee+Kt,L.high=ye+Dn+(Ee>>>0<Kt>>>0?1:0),Oe=V.low=Oe+Bn,V.high=xe+hr+(Oe>>>0<Bn>>>0?1:0),at=K.low=at+yr,K.high=ct+Yr+(at>>>0<yr>>>0?1:0),He=te.low=He+ri,te.high=lt+cr+(He>>>0<ri>>>0?1:0),ut=ie.low=ut+gi,ie.high=et+jo+(ut>>>0<gi>>>0?1:0),Le=A.low=Le+Pn,A.high=Ae+mn+(Le>>>0<Pn>>>0?1:0),qe=de.low=qe+ve,de.high=ze+$r+(qe>>>0<ve>>>0?1:0)},_doFinalize:function(){var P=this._data,k=P.words,W=this._nDataBytes*8,H=P.sigBytes*8;k[H>>>5]|=128<<24-H%32,k[(H+128>>>10<<5)+30]=Math.floor(W/4294967296),k[(H+128>>>10<<5)+31]=W,P.sigBytes=k.length*4,this._process();var L=this._hash.toX32();return L},clone:function(){var P=f.clone.call(this);return P._hash=this._hash.clone(),P},blockSize:1024/32});c.SHA512=f._createHelper(j),c.HmacSHA512=f._createHmacHelper(j)}(),o.SHA512})}(PI)),PI.exports}var kI={exports:{}},SG;function mAe(){return SG||(SG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),Gb(),ZJ())})(En,function(o){return function(){var c=o,d=c.x64,f=d.Word,_=d.WordArray,v=c.algo,x=v.SHA512,T=v.SHA384=x.extend({_doReset:function(){this._hash=new _.init([new f.init(3418070365,3238371032),new f.init(1654270250,914150663),new f.init(2438529370,812702999),new f.init(355462360,4144912697),new f.init(1731405415,4290775857),new f.init(2394180231,1750603025),new f.init(3675008525,1694076839),new f.init(1203062813,3204075428)])},_doFinalize:function(){var w=x._doFinalize.call(this);return w.sigBytes-=16,w}});c.SHA384=x._createHelper(T),c.HmacSHA384=x._createHmacHelper(T)}(),o.SHA384})}(kI)),kI.exports}var LI={exports:{}},xG;function gAe(){return xG||(xG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),Gb())})(En,function(o){return function(c){var d=o,f=d.lib,_=f.WordArray,v=f.Hasher,x=d.x64,T=x.Word,w=d.algo,R=[],I=[],j=[];(function(){for(var W=1,H=0,L=0;L<24;L++){R[W+5*H]=(L+1)*(L+2)/2%64;var V=H%5,K=(2*W+3*H)%5;W=V,H=K}for(var W=0;W<5;W++)for(var H=0;H<5;H++)I[W+5*H]=H+(2*W+3*H)%5*5;for(var te=1,ie=0;ie<24;ie++){for(var A=0,de=0,ue=0;ue<7;ue++){if(te&1){var oe=(1<<ue)-1;oe<32?de^=1<<oe:A^=1<<oe-32}te&128?te=te<<1^113:te<<=1}j[ie]=T.create(A,de)}})();var P=[];(function(){for(var W=0;W<25;W++)P[W]=T.create()})();var k=w.SHA3=v.extend({cfg:v.cfg.extend({outputLength:512}),_doReset:function(){for(var W=this._state=[],H=0;H<25;H++)W[H]=new T.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(W,H){for(var L=this._state,V=this.blockSize/2,K=0;K<V;K++){var te=W[H+2*K],ie=W[H+2*K+1];te=(te<<8|te>>>24)&16711935|(te<<24|te>>>8)&4278255360,ie=(ie<<8|ie>>>24)&16711935|(ie<<24|ie>>>8)&4278255360;var A=L[K];A.high^=ie,A.low^=te}for(var de=0;de<24;de++){for(var ue=0;ue<5;ue++){for(var oe=0,ye=0,Ee=0;Ee<5;Ee++){var A=L[ue+5*Ee];oe^=A.high,ye^=A.low}var xe=P[ue];xe.high=oe,xe.low=ye}for(var ue=0;ue<5;ue++)for(var Oe=P[(ue+4)%5],ct=P[(ue+1)%5],at=ct.high,lt=ct.low,oe=Oe.high^(at<<1|lt>>>31),ye=Oe.low^(lt<<1|at>>>31),Ee=0;Ee<5;Ee++){var A=L[ue+5*Ee];A.high^=oe,A.low^=ye}for(var He=1;He<25;He++){var oe,ye,A=L[He],et=A.high,ut=A.low,Ae=R[He];Ae<32?(oe=et<<Ae|ut>>>32-Ae,ye=ut<<Ae|et>>>32-Ae):(oe=ut<<Ae-32|et>>>64-Ae,ye=et<<Ae-32|ut>>>64-Ae);var Le=P[I[He]];Le.high=oe,Le.low=ye}var ze=P[0],qe=L[0];ze.high=qe.high,ze.low=qe.low;for(var ue=0;ue<5;ue++)for(var Ee=0;Ee<5;Ee++){var He=ue+5*Ee,A=L[He],fn=P[He],qt=P[(ue+1)%5+5*Ee],Dn=P[(ue+2)%5+5*Ee];A.high=fn.high^~qt.high&Dn.high,A.low=fn.low^~qt.low&Dn.low}var A=L[0],Kt=j[de];A.high^=Kt.high,A.low^=Kt.low}},_doFinalize:function(){var W=this._data,H=W.words;this._nDataBytes*8;var L=W.sigBytes*8,V=this.blockSize*32;H[L>>>5]|=1<<24-L%32,H[(c.ceil((L+1)/V)*V>>>5)-1]|=128,W.sigBytes=H.length*4,this._process();for(var K=this._state,te=this.cfg.outputLength/8,ie=te/8,A=[],de=0;de<ie;de++){var ue=K[de],oe=ue.high,ye=ue.low;oe=(oe<<8|oe>>>24)&16711935|(oe<<24|oe>>>8)&4278255360,ye=(ye<<8|ye>>>24)&16711935|(ye<<24|ye>>>8)&4278255360,A.push(ye),A.push(oe)}return new _.init(A,te)},clone:function(){for(var W=v.clone.call(this),H=W._state=this._state.slice(0),L=0;L<25;L++)H[L]=H[L].clone();return W}});d.SHA3=v._createHelper(k),d.HmacSHA3=v._createHmacHelper(k)}(Math),o.SHA3})}(LI)),LI.exports}var MI={exports:{}},TG;function _Ae(){return TG||(TG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(c){var d=o,f=d.lib,_=f.WordArray,v=f.Hasher,x=d.algo,T=_.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),w=_.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),R=_.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),I=_.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),j=_.create([0,1518500249,1859775393,2400959708,2840853838]),P=_.create([1352829926,1548603684,1836072691,2053994217,0]),k=x.RIPEMD160=v.extend({_doReset:function(){this._hash=_.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(ie,A){for(var de=0;de<16;de++){var ue=A+de,oe=ie[ue];ie[ue]=(oe<<8|oe>>>24)&16711935|(oe<<24|oe>>>8)&4278255360}var ye=this._hash.words,Ee=j.words,xe=P.words,Oe=T.words,ct=w.words,at=R.words,lt=I.words,He,et,ut,Ae,Le,ze,qe,fn,qt,Dn;ze=He=ye[0],qe=et=ye[1],fn=ut=ye[2],qt=Ae=ye[3],Dn=Le=ye[4];for(var Kt,de=0;de<80;de+=1)Kt=He+ie[A+Oe[de]]|0,de<16?Kt+=W(et,ut,Ae)+Ee[0]:de<32?Kt+=H(et,ut,Ae)+Ee[1]:de<48?Kt+=L(et,ut,Ae)+Ee[2]:de<64?Kt+=V(et,ut,Ae)+Ee[3]:Kt+=K(et,ut,Ae)+Ee[4],Kt=Kt|0,Kt=te(Kt,at[de]),Kt=Kt+Le|0,He=Le,Le=Ae,Ae=te(ut,10),ut=et,et=Kt,Kt=ze+ie[A+ct[de]]|0,de<16?Kt+=K(qe,fn,qt)+xe[0]:de<32?Kt+=V(qe,fn,qt)+xe[1]:de<48?Kt+=L(qe,fn,qt)+xe[2]:de<64?Kt+=H(qe,fn,qt)+xe[3]:Kt+=W(qe,fn,qt)+xe[4],Kt=Kt|0,Kt=te(Kt,lt[de]),Kt=Kt+Dn|0,ze=Dn,Dn=qt,qt=te(fn,10),fn=qe,qe=Kt;Kt=ye[1]+ut+qt|0,ye[1]=ye[2]+Ae+Dn|0,ye[2]=ye[3]+Le+ze|0,ye[3]=ye[4]+He+qe|0,ye[4]=ye[0]+et+fn|0,ye[0]=Kt},_doFinalize:function(){var ie=this._data,A=ie.words,de=this._nDataBytes*8,ue=ie.sigBytes*8;A[ue>>>5]|=128<<24-ue%32,A[(ue+64>>>9<<4)+14]=(de<<8|de>>>24)&16711935|(de<<24|de>>>8)&4278255360,ie.sigBytes=(A.length+1)*4,this._process();for(var oe=this._hash,ye=oe.words,Ee=0;Ee<5;Ee++){var xe=ye[Ee];ye[Ee]=(xe<<8|xe>>>24)&16711935|(xe<<24|xe>>>8)&4278255360}return oe},clone:function(){var ie=v.clone.call(this);return ie._hash=this._hash.clone(),ie}});function W(ie,A,de){return ie^A^de}function H(ie,A,de){return ie&A|~ie&de}function L(ie,A,de){return(ie|~A)^de}function V(ie,A,de){return ie&de|A&~de}function K(ie,A,de){return ie^(A|~de)}function te(ie,A){return ie<<A|ie>>>32-A}d.RIPEMD160=v._createHelper(k),d.HmacRIPEMD160=v._createHmacHelper(k)}(),o.RIPEMD160})}(MI)),MI.exports}var jI={exports:{}},bG;function d2(){return bG||(bG=1,function(n,i){(function(o,c){n.exports=c(Qn())})(En,function(o){(function(){var c=o,d=c.lib,f=d.Base,_=c.enc,v=_.Utf8,x=c.algo;x.HMAC=f.extend({init:function(T,w){T=this._hasher=new T.init,typeof w=="string"&&(w=v.parse(w));var R=T.blockSize,I=R*4;w.sigBytes>I&&(w=T.finalize(w)),w.clamp();for(var j=this._oKey=w.clone(),P=this._iKey=w.clone(),k=j.words,W=P.words,H=0;H<R;H++)k[H]^=1549556828,W[H]^=909522486;j.sigBytes=P.sigBytes=I,this.reset()},reset:function(){var T=this._hasher;T.reset(),T.update(this._iKey)},update:function(T){return this._hasher.update(T),this},finalize:function(T){var w=this._hasher,R=w.finalize(T);w.reset();var I=w.finalize(this._oKey.clone().concat(R));return I}})})()})}(jI)),jI.exports}var UI={exports:{}},wG;function EAe(){return wG||(wG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),l2(),d2())})(En,function(o){return function(){var c=o,d=c.lib,f=d.Base,_=d.WordArray,v=c.algo,x=v.SHA256,T=v.HMAC,w=v.PBKDF2=f.extend({cfg:f.extend({keySize:128/32,hasher:x,iterations:25e4}),init:function(R){this.cfg=this.cfg.extend(R)},compute:function(R,I){for(var j=this.cfg,P=T.create(j.hasher,R),k=_.create(),W=_.create([1]),H=k.words,L=W.words,V=j.keySize,K=j.iterations;H.length<V;){var te=P.update(I).finalize(W);P.reset();for(var ie=te.words,A=ie.length,de=te,ue=1;ue<K;ue++){de=P.finalize(de),P.reset();for(var oe=de.words,ye=0;ye<A;ye++)ie[ye]^=oe[ye]}k.concat(te),L[0]++}return k.sigBytes=V*4,k}});c.PBKDF2=function(R,I,j){return w.create(j).compute(R,I)}}(),o.PBKDF2})}(UI)),UI.exports}var FI={exports:{}},CG;function Pu(){return CG||(CG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),QJ(),d2())})(En,function(o){return function(){var c=o,d=c.lib,f=d.Base,_=d.WordArray,v=c.algo,x=v.MD5,T=v.EvpKDF=f.extend({cfg:f.extend({keySize:128/32,hasher:x,iterations:1}),init:function(w){this.cfg=this.cfg.extend(w)},compute:function(w,R){for(var I,j=this.cfg,P=j.hasher.create(),k=_.create(),W=k.words,H=j.keySize,L=j.iterations;W.length<H;){I&&P.update(I),I=P.update(w).finalize(R),P.reset();for(var V=1;V<L;V++)I=P.finalize(I),P.reset();k.concat(I)}return k.sigBytes=H*4,k}});c.EvpKDF=function(w,R,I){return T.create(I).compute(w,R)}}(),o.EvpKDF})}(FI)),FI.exports}var VI={exports:{}},RG;function fs(){return RG||(RG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),Pu())})(En,function(o){o.lib.Cipher||function(c){var d=o,f=d.lib,_=f.Base,v=f.WordArray,x=f.BufferedBlockAlgorithm,T=d.enc;T.Utf8;var w=T.Base64,R=d.algo,I=R.EvpKDF,j=f.Cipher=x.extend({cfg:_.extend(),createEncryptor:function(oe,ye){return this.create(this._ENC_XFORM_MODE,oe,ye)},createDecryptor:function(oe,ye){return this.create(this._DEC_XFORM_MODE,oe,ye)},init:function(oe,ye,Ee){this.cfg=this.cfg.extend(Ee),this._xformMode=oe,this._key=ye,this.reset()},reset:function(){x.reset.call(this),this._doReset()},process:function(oe){return this._append(oe),this._process()},finalize:function(oe){oe&&this._append(oe);var ye=this._doFinalize();return ye},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function oe(ye){return typeof ye=="string"?ue:ie}return function(ye){return{encrypt:function(Ee,xe,Oe){return oe(xe).encrypt(ye,Ee,xe,Oe)},decrypt:function(Ee,xe,Oe){return oe(xe).decrypt(ye,Ee,xe,Oe)}}}}()});f.StreamCipher=j.extend({_doFinalize:function(){var oe=this._process(!0);return oe},blockSize:1});var P=d.mode={},k=f.BlockCipherMode=_.extend({createEncryptor:function(oe,ye){return this.Encryptor.create(oe,ye)},createDecryptor:function(oe,ye){return this.Decryptor.create(oe,ye)},init:function(oe,ye){this._cipher=oe,this._iv=ye}}),W=P.CBC=function(){var oe=k.extend();oe.Encryptor=oe.extend({processBlock:function(Ee,xe){var Oe=this._cipher,ct=Oe.blockSize;ye.call(this,Ee,xe,ct),Oe.encryptBlock(Ee,xe),this._prevBlock=Ee.slice(xe,xe+ct)}}),oe.Decryptor=oe.extend({processBlock:function(Ee,xe){var Oe=this._cipher,ct=Oe.blockSize,at=Ee.slice(xe,xe+ct);Oe.decryptBlock(Ee,xe),ye.call(this,Ee,xe,ct),this._prevBlock=at}});function ye(Ee,xe,Oe){var ct,at=this._iv;at?(ct=at,this._iv=c):ct=this._prevBlock;for(var lt=0;lt<Oe;lt++)Ee[xe+lt]^=ct[lt]}return oe}(),H=d.pad={},L=H.Pkcs7={pad:function(oe,ye){for(var Ee=ye*4,xe=Ee-oe.sigBytes%Ee,Oe=xe<<24|xe<<16|xe<<8|xe,ct=[],at=0;at<xe;at+=4)ct.push(Oe);var lt=v.create(ct,xe);oe.concat(lt)},unpad:function(oe){var ye=oe.words[oe.sigBytes-1>>>2]&255;oe.sigBytes-=ye}};f.BlockCipher=j.extend({cfg:j.cfg.extend({mode:W,padding:L}),reset:function(){var oe;j.reset.call(this);var ye=this.cfg,Ee=ye.iv,xe=ye.mode;this._xformMode==this._ENC_XFORM_MODE?oe=xe.createEncryptor:(oe=xe.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==oe?this._mode.init(this,Ee&&Ee.words):(this._mode=oe.call(xe,this,Ee&&Ee.words),this._mode.__creator=oe)},_doProcessBlock:function(oe,ye){this._mode.processBlock(oe,ye)},_doFinalize:function(){var oe,ye=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(ye.pad(this._data,this.blockSize),oe=this._process(!0)):(oe=this._process(!0),ye.unpad(oe)),oe},blockSize:128/32});var V=f.CipherParams=_.extend({init:function(oe){this.mixIn(oe)},toString:function(oe){return(oe||this.formatter).stringify(this)}}),K=d.format={},te=K.OpenSSL={stringify:function(oe){var ye,Ee=oe.ciphertext,xe=oe.salt;return xe?ye=v.create([1398893684,1701076831]).concat(xe).concat(Ee):ye=Ee,ye.toString(w)},parse:function(oe){var ye,Ee=w.parse(oe),xe=Ee.words;return xe[0]==1398893684&&xe[1]==1701076831&&(ye=v.create(xe.slice(2,4)),xe.splice(0,4),Ee.sigBytes-=16),V.create({ciphertext:Ee,salt:ye})}},ie=f.SerializableCipher=_.extend({cfg:_.extend({format:te}),encrypt:function(oe,ye,Ee,xe){xe=this.cfg.extend(xe);var Oe=oe.createEncryptor(Ee,xe),ct=Oe.finalize(ye),at=Oe.cfg;return V.create({ciphertext:ct,key:Ee,iv:at.iv,algorithm:oe,mode:at.mode,padding:at.padding,blockSize:oe.blockSize,formatter:xe.format})},decrypt:function(oe,ye,Ee,xe){xe=this.cfg.extend(xe),ye=this._parse(ye,xe.format);var Oe=oe.createDecryptor(Ee,xe).finalize(ye.ciphertext);return Oe},_parse:function(oe,ye){return typeof oe=="string"?ye.parse(oe,this):oe}}),A=d.kdf={},de=A.OpenSSL={execute:function(oe,ye,Ee,xe,Oe){if(xe||(xe=v.random(64/8)),Oe)var ct=I.create({keySize:ye+Ee,hasher:Oe}).compute(oe,xe);else var ct=I.create({keySize:ye+Ee}).compute(oe,xe);var at=v.create(ct.words.slice(ye),Ee*4);return ct.sigBytes=ye*4,V.create({key:ct,iv:at,salt:xe})}},ue=f.PasswordBasedCipher=ie.extend({cfg:ie.cfg.extend({kdf:de}),encrypt:function(oe,ye,Ee,xe){xe=this.cfg.extend(xe);var Oe=xe.kdf.execute(Ee,oe.keySize,oe.ivSize,xe.salt,xe.hasher);xe.iv=Oe.iv;var ct=ie.encrypt.call(this,oe,ye,Oe.key,xe);return ct.mixIn(Oe),ct},decrypt:function(oe,ye,Ee,xe){xe=this.cfg.extend(xe),ye=this._parse(ye,xe.format);var Oe=xe.kdf.execute(Ee,oe.keySize,oe.ivSize,ye.salt,xe.hasher);xe.iv=Oe.iv;var ct=ie.decrypt.call(this,oe,ye,Oe.key,xe);return ct}})}()})}(VI)),VI.exports}var BI={exports:{}},AG;function vAe(){return AG||(AG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.mode.CFB=function(){var c=o.lib.BlockCipherMode.extend();c.Encryptor=c.extend({processBlock:function(f,_){var v=this._cipher,x=v.blockSize;d.call(this,f,_,x,v),this._prevBlock=f.slice(_,_+x)}}),c.Decryptor=c.extend({processBlock:function(f,_){var v=this._cipher,x=v.blockSize,T=f.slice(_,_+x);d.call(this,f,_,x,v),this._prevBlock=T}});function d(f,_,v,x){var T,w=this._iv;w?(T=w.slice(0),this._iv=void 0):T=this._prevBlock,x.encryptBlock(T,0);for(var R=0;R<v;R++)f[_+R]^=T[R]}return c}(),o.mode.CFB})}(BI)),BI.exports}var WI={exports:{}},NG;function yAe(){return NG||(NG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.mode.CTR=function(){var c=o.lib.BlockCipherMode.extend(),d=c.Encryptor=c.extend({processBlock:function(f,_){var v=this._cipher,x=v.blockSize,T=this._iv,w=this._counter;T&&(w=this._counter=T.slice(0),this._iv=void 0);var R=w.slice(0);v.encryptBlock(R,0),w[x-1]=w[x-1]+1|0;for(var I=0;I<x;I++)f[_+I]^=R[I]}});return c.Decryptor=d,c}(),o.mode.CTR})}(WI)),WI.exports}var HI={exports:{}},IG;function SAe(){return IG||(IG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return o.mode.CTRGladman=function(){var c=o.lib.BlockCipherMode.extend();function d(v){if((v>>24&255)===255){var x=v>>16&255,T=v>>8&255,w=v&255;x===255?(x=0,T===255?(T=0,w===255?w=0:++w):++T):++x,v=0,v+=x<<16,v+=T<<8,v+=w}else v+=1<<24;return v}function f(v){return(v[0]=d(v[0]))===0&&(v[1]=d(v[1])),v}var _=c.Encryptor=c.extend({processBlock:function(v,x){var T=this._cipher,w=T.blockSize,R=this._iv,I=this._counter;R&&(I=this._counter=R.slice(0),this._iv=void 0),f(I);var j=I.slice(0);T.encryptBlock(j,0);for(var P=0;P<w;P++)v[x+P]^=j[P]}});return c.Decryptor=_,c}(),o.mode.CTRGladman})}(HI)),HI.exports}var GI={exports:{}},OG;function xAe(){return OG||(OG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.mode.OFB=function(){var c=o.lib.BlockCipherMode.extend(),d=c.Encryptor=c.extend({processBlock:function(f,_){var v=this._cipher,x=v.blockSize,T=this._iv,w=this._keystream;T&&(w=this._keystream=T.slice(0),this._iv=void 0),v.encryptBlock(w,0);for(var R=0;R<x;R++)f[_+R]^=w[R]}});return c.Decryptor=d,c}(),o.mode.OFB})}(GI)),GI.exports}var zI={exports:{}},DG;function TAe(){return DG||(DG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.mode.ECB=function(){var c=o.lib.BlockCipherMode.extend();return c.Encryptor=c.extend({processBlock:function(d,f){this._cipher.encryptBlock(d,f)}}),c.Decryptor=c.extend({processBlock:function(d,f){this._cipher.decryptBlock(d,f)}}),c}(),o.mode.ECB})}(zI)),zI.exports}var KI={exports:{}},PG;function bAe(){return PG||(PG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.pad.AnsiX923={pad:function(c,d){var f=c.sigBytes,_=d*4,v=_-f%_,x=f+v-1;c.clamp(),c.words[x>>>2]|=v<<24-x%4*8,c.sigBytes+=v},unpad:function(c){var d=c.words[c.sigBytes-1>>>2]&255;c.sigBytes-=d}},o.pad.Ansix923})}(KI)),KI.exports}var qI={exports:{}},kG;function wAe(){return kG||(kG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.pad.Iso10126={pad:function(c,d){var f=d*4,_=f-c.sigBytes%f;c.concat(o.lib.WordArray.random(_-1)).concat(o.lib.WordArray.create([_<<24],1))},unpad:function(c){var d=c.words[c.sigBytes-1>>>2]&255;c.sigBytes-=d}},o.pad.Iso10126})}(qI)),qI.exports}var YI={exports:{}},LG;function CAe(){return LG||(LG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.pad.Iso97971={pad:function(c,d){c.concat(o.lib.WordArray.create([2147483648],1)),o.pad.ZeroPadding.pad(c,d)},unpad:function(c){o.pad.ZeroPadding.unpad(c),c.sigBytes--}},o.pad.Iso97971})}(YI)),YI.exports}var $I={exports:{}},MG;function RAe(){return MG||(MG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.pad.ZeroPadding={pad:function(c,d){var f=d*4;c.clamp(),c.sigBytes+=f-(c.sigBytes%f||f)},unpad:function(c){for(var d=c.words,f=c.sigBytes-1,f=c.sigBytes-1;f>=0;f--)if(d[f>>>2]>>>24-f%4*8&255){c.sigBytes=f+1;break}}},o.pad.ZeroPadding})}($I)),$I.exports}var XI={exports:{}},jG;function AAe(){return jG||(jG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return o.pad.NoPadding={pad:function(){},unpad:function(){}},o.pad.NoPadding})}(XI)),XI.exports}var JI={exports:{}},UG;function NAe(){return UG||(UG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),fs())})(En,function(o){return function(c){var d=o,f=d.lib,_=f.CipherParams,v=d.enc,x=v.Hex,T=d.format;T.Hex={stringify:function(w){return w.ciphertext.toString(x)},parse:function(w){var R=x.parse(w);return _.create({ciphertext:R})}}}(),o.format.Hex})}(JI)),JI.exports}var QI={exports:{}},FG;function IAe(){return FG||(FG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),wp(),Cp(),Pu(),fs())})(En,function(o){return function(){var c=o,d=c.lib,f=d.BlockCipher,_=c.algo,v=[],x=[],T=[],w=[],R=[],I=[],j=[],P=[],k=[],W=[];(function(){for(var V=[],K=0;K<256;K++)K<128?V[K]=K<<1:V[K]=K<<1^283;for(var te=0,ie=0,K=0;K<256;K++){var A=ie^ie<<1^ie<<2^ie<<3^ie<<4;A=A>>>8^A&255^99,v[te]=A,x[A]=te;var de=V[te],ue=V[de],oe=V[ue],ye=V[A]*257^A*16843008;T[te]=ye<<24|ye>>>8,w[te]=ye<<16|ye>>>16,R[te]=ye<<8|ye>>>24,I[te]=ye;var ye=oe*16843009^ue*65537^de*257^te*16843008;j[A]=ye<<24|ye>>>8,P[A]=ye<<16|ye>>>16,k[A]=ye<<8|ye>>>24,W[A]=ye,te?(te=de^V[V[V[oe^de]]],ie^=V[V[ie]]):te=ie=1}})();var H=[0,1,2,4,8,16,32,64,128,27,54],L=_.AES=f.extend({_doReset:function(){var V;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var K=this._keyPriorReset=this._key,te=K.words,ie=K.sigBytes/4,A=this._nRounds=ie+6,de=(A+1)*4,ue=this._keySchedule=[],oe=0;oe<de;oe++)oe<ie?ue[oe]=te[oe]:(V=ue[oe-1],oe%ie?ie>6&&oe%ie==4&&(V=v[V>>>24]<<24|v[V>>>16&255]<<16|v[V>>>8&255]<<8|v[V&255]):(V=V<<8|V>>>24,V=v[V>>>24]<<24|v[V>>>16&255]<<16|v[V>>>8&255]<<8|v[V&255],V^=H[oe/ie|0]<<24),ue[oe]=ue[oe-ie]^V);for(var ye=this._invKeySchedule=[],Ee=0;Ee<de;Ee++){var oe=de-Ee;if(Ee%4)var V=ue[oe];else var V=ue[oe-4];Ee<4||oe<=4?ye[Ee]=V:ye[Ee]=j[v[V>>>24]]^P[v[V>>>16&255]]^k[v[V>>>8&255]]^W[v[V&255]]}}},encryptBlock:function(V,K){this._doCryptBlock(V,K,this._keySchedule,T,w,R,I,v)},decryptBlock:function(V,K){var te=V[K+1];V[K+1]=V[K+3],V[K+3]=te,this._doCryptBlock(V,K,this._invKeySchedule,j,P,k,W,x);var te=V[K+1];V[K+1]=V[K+3],V[K+3]=te},_doCryptBlock:function(V,K,te,ie,A,de,ue,oe){for(var ye=this._nRounds,Ee=V[K]^te[0],xe=V[K+1]^te[1],Oe=V[K+2]^te[2],ct=V[K+3]^te[3],at=4,lt=1;lt<ye;lt++){var He=ie[Ee>>>24]^A[xe>>>16&255]^de[Oe>>>8&255]^ue[ct&255]^te[at++],et=ie[xe>>>24]^A[Oe>>>16&255]^de[ct>>>8&255]^ue[Ee&255]^te[at++],ut=ie[Oe>>>24]^A[ct>>>16&255]^de[Ee>>>8&255]^ue[xe&255]^te[at++],Ae=ie[ct>>>24]^A[Ee>>>16&255]^de[xe>>>8&255]^ue[Oe&255]^te[at++];Ee=He,xe=et,Oe=ut,ct=Ae}var He=(oe[Ee>>>24]<<24|oe[xe>>>16&255]<<16|oe[Oe>>>8&255]<<8|oe[ct&255])^te[at++],et=(oe[xe>>>24]<<24|oe[Oe>>>16&255]<<16|oe[ct>>>8&255]<<8|oe[Ee&255])^te[at++],ut=(oe[Oe>>>24]<<24|oe[ct>>>16&255]<<16|oe[Ee>>>8&255]<<8|oe[xe&255])^te[at++],Ae=(oe[ct>>>24]<<24|oe[Ee>>>16&255]<<16|oe[xe>>>8&255]<<8|oe[Oe&255])^te[at++];V[K]=He,V[K+1]=et,V[K+2]=ut,V[K+3]=Ae},keySize:256/32});c.AES=f._createHelper(L)}(),o.AES})}(QI)),QI.exports}var ZI={exports:{}},VG;function OAe(){return VG||(VG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),wp(),Cp(),Pu(),fs())})(En,function(o){return function(){var c=o,d=c.lib,f=d.WordArray,_=d.BlockCipher,v=c.algo,x=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],T=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],w=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],R=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],I=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],j=v.DES=_.extend({_doReset:function(){for(var H=this._key,L=H.words,V=[],K=0;K<56;K++){var te=x[K]-1;V[K]=L[te>>>5]>>>31-te%32&1}for(var ie=this._subKeys=[],A=0;A<16;A++){for(var de=ie[A]=[],ue=w[A],K=0;K<24;K++)de[K/6|0]|=V[(T[K]-1+ue)%28]<<31-K%6,de[4+(K/6|0)]|=V[28+(T[K+24]-1+ue)%28]<<31-K%6;de[0]=de[0]<<1|de[0]>>>31;for(var K=1;K<7;K++)de[K]=de[K]>>>(K-1)*4+3;de[7]=de[7]<<5|de[7]>>>27}for(var oe=this._invSubKeys=[],K=0;K<16;K++)oe[K]=ie[15-K]},encryptBlock:function(H,L){this._doCryptBlock(H,L,this._subKeys)},decryptBlock:function(H,L){this._doCryptBlock(H,L,this._invSubKeys)},_doCryptBlock:function(H,L,V){this._lBlock=H[L],this._rBlock=H[L+1],P.call(this,4,252645135),P.call(this,16,65535),k.call(this,2,858993459),k.call(this,8,16711935),P.call(this,1,1431655765);for(var K=0;K<16;K++){for(var te=V[K],ie=this._lBlock,A=this._rBlock,de=0,ue=0;ue<8;ue++)de|=R[ue][((A^te[ue])&I[ue])>>>0];this._lBlock=A,this._rBlock=ie^de}var oe=this._lBlock;this._lBlock=this._rBlock,this._rBlock=oe,P.call(this,1,1431655765),k.call(this,8,16711935),k.call(this,2,858993459),P.call(this,16,65535),P.call(this,4,252645135),H[L]=this._lBlock,H[L+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function P(H,L){var V=(this._lBlock>>>H^this._rBlock)&L;this._rBlock^=V,this._lBlock^=V<<H}function k(H,L){var V=(this._rBlock>>>H^this._lBlock)&L;this._lBlock^=V,this._rBlock^=V<<H}c.DES=_._createHelper(j);var W=v.TripleDES=_.extend({_doReset:function(){var H=this._key,L=H.words;if(L.length!==2&&L.length!==4&&L.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var V=L.slice(0,2),K=L.length<4?L.slice(0,2):L.slice(2,4),te=L.length<6?L.slice(0,2):L.slice(4,6);this._des1=j.createEncryptor(f.create(V)),this._des2=j.createEncryptor(f.create(K)),this._des3=j.createEncryptor(f.create(te))},encryptBlock:function(H,L){this._des1.encryptBlock(H,L),this._des2.decryptBlock(H,L),this._des3.encryptBlock(H,L)},decryptBlock:function(H,L){this._des3.decryptBlock(H,L),this._des2.encryptBlock(H,L),this._des1.decryptBlock(H,L)},keySize:192/32,ivSize:64/32,blockSize:64/32});c.TripleDES=_._createHelper(W)}(),o.TripleDES})}(ZI)),ZI.exports}var eO={exports:{}},BG;function DAe(){return BG||(BG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),wp(),Cp(),Pu(),fs())})(En,function(o){return function(){var c=o,d=c.lib,f=d.StreamCipher,_=c.algo,v=_.RC4=f.extend({_doReset:function(){for(var w=this._key,R=w.words,I=w.sigBytes,j=this._S=[],P=0;P<256;P++)j[P]=P;for(var P=0,k=0;P<256;P++){var W=P%I,H=R[W>>>2]>>>24-W%4*8&255;k=(k+j[P]+H)%256;var L=j[P];j[P]=j[k],j[k]=L}this._i=this._j=0},_doProcessBlock:function(w,R){w[R]^=x.call(this)},keySize:256/32,ivSize:0});function x(){for(var w=this._S,R=this._i,I=this._j,j=0,P=0;P<4;P++){R=(R+1)%256,I=(I+w[R])%256;var k=w[R];w[R]=w[I],w[I]=k,j|=w[(w[R]+w[I])%256]<<24-P*8}return this._i=R,this._j=I,j}c.RC4=f._createHelper(v);var T=_.RC4Drop=v.extend({cfg:v.cfg.extend({drop:192}),_doReset:function(){v._doReset.call(this);for(var w=this.cfg.drop;w>0;w--)x.call(this)}});c.RC4Drop=f._createHelper(T)}(),o.RC4})}(eO)),eO.exports}var tO={exports:{}},WG;function PAe(){return WG||(WG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),wp(),Cp(),Pu(),fs())})(En,function(o){return function(){var c=o,d=c.lib,f=d.StreamCipher,_=c.algo,v=[],x=[],T=[],w=_.Rabbit=f.extend({_doReset:function(){for(var I=this._key.words,j=this.cfg.iv,P=0;P<4;P++)I[P]=(I[P]<<8|I[P]>>>24)&16711935|(I[P]<<24|I[P]>>>8)&4278255360;var k=this._X=[I[0],I[3]<<16|I[2]>>>16,I[1],I[0]<<16|I[3]>>>16,I[2],I[1]<<16|I[0]>>>16,I[3],I[2]<<16|I[1]>>>16],W=this._C=[I[2]<<16|I[2]>>>16,I[0]&4294901760|I[1]&65535,I[3]<<16|I[3]>>>16,I[1]&4294901760|I[2]&65535,I[0]<<16|I[0]>>>16,I[2]&4294901760|I[3]&65535,I[1]<<16|I[1]>>>16,I[3]&4294901760|I[0]&65535];this._b=0;for(var P=0;P<4;P++)R.call(this);for(var P=0;P<8;P++)W[P]^=k[P+4&7];if(j){var H=j.words,L=H[0],V=H[1],K=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,te=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,ie=K>>>16|te&4294901760,A=te<<16|K&65535;W[0]^=K,W[1]^=ie,W[2]^=te,W[3]^=A,W[4]^=K,W[5]^=ie,W[6]^=te,W[7]^=A;for(var P=0;P<4;P++)R.call(this)}},_doProcessBlock:function(I,j){var P=this._X;R.call(this),v[0]=P[0]^P[5]>>>16^P[3]<<16,v[1]=P[2]^P[7]>>>16^P[5]<<16,v[2]=P[4]^P[1]>>>16^P[7]<<16,v[3]=P[6]^P[3]>>>16^P[1]<<16;for(var k=0;k<4;k++)v[k]=(v[k]<<8|v[k]>>>24)&16711935|(v[k]<<24|v[k]>>>8)&4278255360,I[j+k]^=v[k]},blockSize:128/32,ivSize:64/32});function R(){for(var I=this._X,j=this._C,P=0;P<8;P++)x[P]=j[P];j[0]=j[0]+1295307597+this._b|0,j[1]=j[1]+3545052371+(j[0]>>>0<x[0]>>>0?1:0)|0,j[2]=j[2]+886263092+(j[1]>>>0<x[1]>>>0?1:0)|0,j[3]=j[3]+1295307597+(j[2]>>>0<x[2]>>>0?1:0)|0,j[4]=j[4]+3545052371+(j[3]>>>0<x[3]>>>0?1:0)|0,j[5]=j[5]+886263092+(j[4]>>>0<x[4]>>>0?1:0)|0,j[6]=j[6]+1295307597+(j[5]>>>0<x[5]>>>0?1:0)|0,j[7]=j[7]+3545052371+(j[6]>>>0<x[6]>>>0?1:0)|0,this._b=j[7]>>>0<x[7]>>>0?1:0;for(var P=0;P<8;P++){var k=I[P]+j[P],W=k&65535,H=k>>>16,L=((W*W>>>17)+W*H>>>15)+H*H,V=((k&4294901760)*k|0)+((k&65535)*k|0);T[P]=L^V}I[0]=T[0]+(T[7]<<16|T[7]>>>16)+(T[6]<<16|T[6]>>>16)|0,I[1]=T[1]+(T[0]<<8|T[0]>>>24)+T[7]|0,I[2]=T[2]+(T[1]<<16|T[1]>>>16)+(T[0]<<16|T[0]>>>16)|0,I[3]=T[3]+(T[2]<<8|T[2]>>>24)+T[1]|0,I[4]=T[4]+(T[3]<<16|T[3]>>>16)+(T[2]<<16|T[2]>>>16)|0,I[5]=T[5]+(T[4]<<8|T[4]>>>24)+T[3]|0,I[6]=T[6]+(T[5]<<16|T[5]>>>16)+(T[4]<<16|T[4]>>>16)|0,I[7]=T[7]+(T[6]<<8|T[6]>>>24)+T[5]|0}c.Rabbit=f._createHelper(w)}(),o.Rabbit})}(tO)),tO.exports}var nO={exports:{}},HG;function kAe(){return HG||(HG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),wp(),Cp(),Pu(),fs())})(En,function(o){return function(){var c=o,d=c.lib,f=d.StreamCipher,_=c.algo,v=[],x=[],T=[],w=_.RabbitLegacy=f.extend({_doReset:function(){var I=this._key.words,j=this.cfg.iv,P=this._X=[I[0],I[3]<<16|I[2]>>>16,I[1],I[0]<<16|I[3]>>>16,I[2],I[1]<<16|I[0]>>>16,I[3],I[2]<<16|I[1]>>>16],k=this._C=[I[2]<<16|I[2]>>>16,I[0]&4294901760|I[1]&65535,I[3]<<16|I[3]>>>16,I[1]&4294901760|I[2]&65535,I[0]<<16|I[0]>>>16,I[2]&4294901760|I[3]&65535,I[1]<<16|I[1]>>>16,I[3]&4294901760|I[0]&65535];this._b=0;for(var W=0;W<4;W++)R.call(this);for(var W=0;W<8;W++)k[W]^=P[W+4&7];if(j){var H=j.words,L=H[0],V=H[1],K=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,te=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,ie=K>>>16|te&4294901760,A=te<<16|K&65535;k[0]^=K,k[1]^=ie,k[2]^=te,k[3]^=A,k[4]^=K,k[5]^=ie,k[6]^=te,k[7]^=A;for(var W=0;W<4;W++)R.call(this)}},_doProcessBlock:function(I,j){var P=this._X;R.call(this),v[0]=P[0]^P[5]>>>16^P[3]<<16,v[1]=P[2]^P[7]>>>16^P[5]<<16,v[2]=P[4]^P[1]>>>16^P[7]<<16,v[3]=P[6]^P[3]>>>16^P[1]<<16;for(var k=0;k<4;k++)v[k]=(v[k]<<8|v[k]>>>24)&16711935|(v[k]<<24|v[k]>>>8)&4278255360,I[j+k]^=v[k]},blockSize:128/32,ivSize:64/32});function R(){for(var I=this._X,j=this._C,P=0;P<8;P++)x[P]=j[P];j[0]=j[0]+1295307597+this._b|0,j[1]=j[1]+3545052371+(j[0]>>>0<x[0]>>>0?1:0)|0,j[2]=j[2]+886263092+(j[1]>>>0<x[1]>>>0?1:0)|0,j[3]=j[3]+1295307597+(j[2]>>>0<x[2]>>>0?1:0)|0,j[4]=j[4]+3545052371+(j[3]>>>0<x[3]>>>0?1:0)|0,j[5]=j[5]+886263092+(j[4]>>>0<x[4]>>>0?1:0)|0,j[6]=j[6]+1295307597+(j[5]>>>0<x[5]>>>0?1:0)|0,j[7]=j[7]+3545052371+(j[6]>>>0<x[6]>>>0?1:0)|0,this._b=j[7]>>>0<x[7]>>>0?1:0;for(var P=0;P<8;P++){var k=I[P]+j[P],W=k&65535,H=k>>>16,L=((W*W>>>17)+W*H>>>15)+H*H,V=((k&4294901760)*k|0)+((k&65535)*k|0);T[P]=L^V}I[0]=T[0]+(T[7]<<16|T[7]>>>16)+(T[6]<<16|T[6]>>>16)|0,I[1]=T[1]+(T[0]<<8|T[0]>>>24)+T[7]|0,I[2]=T[2]+(T[1]<<16|T[1]>>>16)+(T[0]<<16|T[0]>>>16)|0,I[3]=T[3]+(T[2]<<8|T[2]>>>24)+T[1]|0,I[4]=T[4]+(T[3]<<16|T[3]>>>16)+(T[2]<<16|T[2]>>>16)|0,I[5]=T[5]+(T[4]<<8|T[4]>>>24)+T[3]|0,I[6]=T[6]+(T[5]<<16|T[5]>>>16)+(T[4]<<16|T[4]>>>16)|0,I[7]=T[7]+(T[6]<<8|T[6]>>>24)+T[5]|0}c.RabbitLegacy=f._createHelper(w)}(),o.RabbitLegacy})}(nO)),nO.exports}var rO={exports:{}},GG;function LAe(){return GG||(GG=1,function(n,i){(function(o,c,d){n.exports=c(Qn(),wp(),Cp(),Pu(),fs())})(En,function(o){return function(){var c=o,d=c.lib,f=d.BlockCipher,_=c.algo;const v=16,x=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],T=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var w={pbox:[],sbox:[]};function R(W,H){let L=H>>24&255,V=H>>16&255,K=H>>8&255,te=H&255,ie=W.sbox[0][L]+W.sbox[1][V];return ie=ie^W.sbox[2][K],ie=ie+W.sbox[3][te],ie}function I(W,H,L){let V=H,K=L,te;for(let ie=0;ie<v;++ie)V=V^W.pbox[ie],K=R(W,V)^K,te=V,V=K,K=te;return te=V,V=K,K=te,K=K^W.pbox[v],V=V^W.pbox[v+1],{left:V,right:K}}function j(W,H,L){let V=H,K=L,te;for(let ie=v+1;ie>1;--ie)V=V^W.pbox[ie],K=R(W,V)^K,te=V,V=K,K=te;return te=V,V=K,K=te,K=K^W.pbox[1],V=V^W.pbox[0],{left:V,right:K}}function P(W,H,L){for(let A=0;A<4;A++){W.sbox[A]=[];for(let de=0;de<256;de++)W.sbox[A][de]=T[A][de]}let V=0;for(let A=0;A<v+2;A++)W.pbox[A]=x[A]^H[V],V++,V>=L&&(V=0);let K=0,te=0,ie=0;for(let A=0;A<v+2;A+=2)ie=I(W,K,te),K=ie.left,te=ie.right,W.pbox[A]=K,W.pbox[A+1]=te;for(let A=0;A<4;A++)for(let de=0;de<256;de+=2)ie=I(W,K,te),K=ie.left,te=ie.right,W.sbox[A][de]=K,W.sbox[A][de+1]=te;return!0}var k=_.Blowfish=f.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var W=this._keyPriorReset=this._key,H=W.words,L=W.sigBytes/4;P(w,H,L)}},encryptBlock:function(W,H){var L=I(w,W[H],W[H+1]);W[H]=L.left,W[H+1]=L.right},decryptBlock:function(W,H){var L=j(w,W[H],W[H+1]);W[H]=L.left,W[H+1]=L.right},blockSize:64/32,keySize:128/32,ivSize:64/32});c.Blowfish=f._createHelper(k)}(),o.Blowfish})}(rO)),rO.exports}(function(n,i){(function(o,c,d){n.exports=c(Qn(),Gb(),uAe(),hAe(),wp(),pAe(),Cp(),QJ(),l2(),fAe(),ZJ(),mAe(),gAe(),_Ae(),d2(),EAe(),Pu(),fs(),vAe(),yAe(),SAe(),xAe(),TAe(),bAe(),wAe(),CAe(),RAe(),AAe(),NAe(),IAe(),OAe(),DAe(),PAe(),kAe(),LAe())})(En,function(o){return o})})(oAe);const MAe=()=>{const[n,i]=X.useState(""),[o,c]=X.useState(""),[d,f]=X.useState(!1),[_,v]=X.useState(!1),{toast:x}=gk(),T=Qi(),w=async R=>{var I,j;if(R.preventDefault(),!n||!o){x({title:"Missing Fields",description:"Please enter both email and password.",variant:"destructive"});return}v(!0);try{const P=await Jn.post("https://astro-talk-backend.onrender.com/web/astro/login",{email:n,password:o}),k="AstroTruthSecret123!",W=P.data,H=W.data;W!=null&&W.token?(localStorage.setItem("astroToken",W.token),localStorage.setItem("astroUser",JSON.stringify(H||{})),x({title:"Login Successful!",description:"Welcome back to Astro Truth!"}),T("/astro-dashboard")):x({title:"Invalid Credentials",description:(W==null?void 0:W.message)||"Please check your email and password.",variant:"destructive"})}catch(P){x({title:"Login Failed",description:((j=(I=P.response)==null?void 0:I.data)==null?void 0:j.message)||"Your account is pending verification by the administrator. Please wait for approval before logging in.",variant:"destructive"})}finally{v(!1)}};return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-astro-indigo via-astro-purple to-astro-pink p-4 pt-24 star-bg",children:h.jsx(Dt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:h.jsxs(ur,{className:"w-full max-w-md shadow-2xl relative",children:[h.jsx("button",{onClick:()=>T("/"),className:"absolute top-4 right-4 text-gray-400 hover:text-red-500","aria-label":"Close login form",children:h.jsx(xp,{className:"w-5 h-5"})}),h.jsxs(qr,{className:"text-center",children:[h.jsx(ni,{className:"text-3xl font-bold cosmic-text",children:"Welcome Back!"}),h.jsx(qs,{children:"Log in to continue your cosmic journey."})]}),h.jsx(vr,{children:h.jsxs("form",{onSubmit:w,className:"space-y-6",noValidate:!0,children:[h.jsxs("div",{className:"space-y-2 relative",children:[h.jsx(Ut,{htmlFor:"email",children:"Email Address"}),h.jsx(ad,{className:"absolute left-3 top-10 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{id:"email",type:"email",placeholder:"you@example.com",value:n,onChange:R=>i(R.target.value),required:!0,className:"pl-10"})]}),h.jsxs("div",{className:"space-y-2 relative",children:[h.jsx(Ut,{htmlFor:"password",children:"Password"}),h.jsx(Vm,{className:"absolute left-3 top-10 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),h.jsx(Vt,{id:"password",type:d?"text":"password",placeholder:"",value:o,onChange:R=>c(R.target.value),required:!0,className:"pl-10 pr-10"}),h.jsx("button",{type:"button",onClick:()=>f(R=>!R),className:"absolute right-3 top-10 transform -translate-y-1/2 text-gray-500",children:d?h.jsx(vY,{className:"h-5 w-5"}):h.jsx(yY,{className:"h-5 w-5"})})]}),h.jsx(vt,{type:"submit",className:"w-full cosmic-gradient text-white",disabled:_,children:_?"Logging in...":"Log In"})]})}),h.jsxs(r0,{className:"flex flex-col items-center space-y-2",children:[h.jsx(Xn,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:"Forgot your password?"}),h.jsxs("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",h.jsx(Xn,{to:"/astro-register",className:"font-medium text-primary hover:underline",children:"Sign up"})]})]})]})})})},jAe=[{name:"Priya Sharma",location:"Mumbai",rating:5,text:"I was skeptical at first, but the astrologer's predictions were incredibly accurate. The career guidance I received helped me make a life-changing decision.",image:"PS"},{name:"Rahul Verma",location:"Delhi",rating:5,text:"The relationship compatibility reading was eye-opening. It helped me understand my partner better and improved our communication significantly.",image:"RV"},{name:"Ananya Patel",location:"Bangalore",rating:4,text:"The financial forecast was spot on! Following the astrologer's advice, I made some investments that have already started showing positive returns.",image:"AP"},{name:"Vikram Singh",location:"Pune",rating:5,text:"I consulted about my marriage prospects and within the predicted timeframe, I met my soulmate. The accuracy was astonishing!",image:"VS"}],UAe=()=>h.jsx("section",{id:"testimonials",className:"py-16 bg-gradient-to-b from-gray-50 to-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["What Our ",h.jsx("span",{className:"cosmic-text",children:"Clients Say"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Real stories from people who found guidance and clarity through our astrology services"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:jAe.map((n,i)=>h.jsxs(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:i*.1},viewport:{once:!0},className:"testimonial-card rounded-xl p-6 shadow-md",children:[h.jsxs("div",{className:"flex items-center mb-4",children:[h.jsx(jb,{className:"h-12 w-12 border-2 border-primary",children:h.jsx(Ub,{className:"bg-primary text-white",children:n.image})}),h.jsxs("div",{className:"ml-3",children:[h.jsx("h4",{className:"font-semibold",children:n.name}),h.jsx("p",{className:"text-sm text-gray-500",children:n.location})]})]}),h.jsxs("div",{className:"flex mb-3",children:[[...Array(n.rating)].map((o,c)=>h.jsx(oo,{className:"h-4 w-4 text-yellow-500",fill:"currentColor"},c)),[...Array(5-n.rating)].map((o,c)=>h.jsx(oo,{className:"h-4 w-4 text-gray-300",fill:"currentColor"},c+n.rating))]}),h.jsx("p",{className:"text-gray-700",children:n.text})]},i))})]})}),FAe=()=>h.jsx("div",{className:"min-h-screen p-4 md:p-8 bg-yellow-50 common-margin-top",children:h.jsx(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-yellow-400",children:[h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-yellow-400 via-amber-400 to-orange-300",children:[h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg mb-4",children:h.jsx(ad,{className:"h-16 w-16 text-yellow-600"})}),h.jsx(ni,{className:"text-4xl font-bold text-gray-800",children:"Get In Touch"}),h.jsx(qs,{className:"text-lg text-gray-700 mt-2",children:"We'd love to hear from you! Reach out with any questions or feedback."})]}),h.jsxs(vr,{className:"p-6 md:p-10 grid grid-cols-1 md:grid-cols-2 gap-8 bg-white",children:[h.jsxs("div",{className:"space-y-6",children:[h.jsx("h2",{className:"text-2xl font-semibold text-yellow-600",children:"Contact Information"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(pk,{className:"h-6 w-6 text-yellow-500"}),h.jsx("p",{className:"text-gray-700",children:"SA.5/136,SANJAY NAGAR RAMAREY PUR,Varanasi Cantt, 221002,UttarPradesh, India"})]}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Iu,{className:"h-6 w-6 text-yellow-500"}),h.jsx("p",{className:"text-gray-700",children:"+91 94156 95659"})]}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(ad,{className:"h-6 w-6 text-yellow-500"}),h.jsx("p",{className:"text-gray-700",children:"support@astrotruth.com"})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-yellow-600 mb-2",children:"Office Hours"}),h.jsx("p",{className:"text-gray-700",children:"Monday - Friday: 9:00 AM - 6:00 PM"}),h.jsx("p",{className:"text-gray-700",children:"Saturday: 10:00 AM - 4:00 PM"}),h.jsx("p",{className:"text-gray-700",children:"Sunday: Closed"})]})]}),h.jsxs("form",{className:"space-y-6",children:[h.jsx("h2",{className:"text-2xl font-semibold text-yellow-600",children:"Send Us a Message"}),h.jsxs("div",{children:[h.jsx(Ut,{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Full Name"}),h.jsx(Vt,{id:"name",placeholder:"Your Name",className:"mt-1 focus:ring-yellow-500 focus:border-yellow-500"})]}),h.jsxs("div",{children:[h.jsx(Ut,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email Address"}),h.jsx(Vt,{id:"email",type:"email",placeholder:"you@example.com",className:"mt-1 focus:ring-yellow-500 focus:border-yellow-500"})]}),h.jsxs("div",{children:[h.jsx(Ut,{htmlFor:"subject",className:"text-sm font-medium text-gray-700",children:"Subject"}),h.jsx(Vt,{id:"subject",placeholder:"Regarding...",className:"mt-1 focus:ring-yellow-500 focus:border-yellow-500"})]}),h.jsxs("div",{children:[h.jsx(Ut,{htmlFor:"message",className:"text-sm font-medium text-gray-700",children:"Message"}),h.jsx(HD,{id:"message",placeholder:"Your message...",rows:5,className:"mt-1 focus:ring-yellow-500 focus:border-yellow-500"})]}),h.jsxs(vt,{type:"submit",className:"w-full btn-primary-theme text-gray-800 font-semibold text-lg py-3",children:[h.jsx(kEe,{className:"mr-2 h-5 w-5"})," Send Message"]})]})]})]})})}),VAe=()=>h.jsx("div",{className:"min-h-screen p-4 md:p-8 bg-yellow-50 common-margin-top",children:h.jsx(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-yellow-400",children:[h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-yellow-400 via-amber-400 to-orange-300",children:[h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg mb-4",children:h.jsx(_Ee,{className:"h-16 w-16 text-yellow-600"})}),h.jsx(ni,{className:"text-4xl font-bold text-gray-800",children:"Terms & Conditions"}),h.jsxs(qs,{className:"text-lg text-gray-700 mt-2",children:["Please read these terms carefully before using our services. Last updated: ",new Date().toLocaleDateString(),"."]})]}),h.jsxs(vr,{className:"p-6 md:p-10 space-y-6 bg-white text-gray-700 leading-relaxed",children:[h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"1. Acceptance of Terms"}),h.jsx("p",{children:'By accessing or using Astrotruth ("the Service"), you agree to be bound by these Terms and Conditions ("Terms"). If you disagree with any part of the terms, then you may not access the Service.'})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"2. Description of Service"}),h.jsx("p",{children:"Astrotruth provides astrological consultations, reports, and related products. The information provided is for guidance and entertainment purposes only and should not be considered as a substitute for professional advice (legal, medical, financial, etc.)."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"3. User Accounts"}),h.jsx("p",{children:"To access certain features, you may need to create an account. You are responsible for maintaining the confidentiality of your account information and for all activities that occur under your account. You agree to notify us immediately of any unauthorized use of your account."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"4. Payments and Refunds"}),h.jsx("p",{children:"All payments for services and products are to be made through the payment methods provided on the platform. Refund policies for consultations, reports, and products will be specified at the point of purchase or in a separate refund policy document. Generally, services once rendered are non-refundable."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"5. User Conduct"}),h.jsx("p",{children:"You agree not to use the Service for any unlawful purpose or in any way that interrupts, damages, or impairs the service. You agree to be respectful to astrologers and other users."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"6. Intellectual Property"}),h.jsx("p",{children:"The Service and its original content (excluding content provided by users), features, and functionality are and will remain the exclusive property of Astrotruth and its licensors. Our trademarks and trade dress may not be used in connection with any product or service without the prior written consent of Astrotruth."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"7. Disclaimer of Warranties"}),h.jsx("p",{children:'The Service is provided on an "AS IS" and "AS AVAILABLE" basis. Astrotruth makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including, without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights.'})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"8. Limitation of Liability"}),h.jsx("p",{children:"In no event shall Astrotruth or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on Astrotruth's website, even if Astrotruth or an Astrotruth authorized representative has been notified orally or in writing of the possibility of such damage."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"9. Changes to Terms"}),h.jsx("p",{children:"We reserve the right, at our sole discretion, to modify or replace these Terms at any time. If a revision is material, we will try to provide at least 30 days' notice prior to any new terms taking effect. What constitutes a material change will be determined at our sole discretion."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"10. Contact Us"}),h.jsx("p",{children:"If you have any questions about these Terms, please contact us at legal@astrotruth.com."})]})]})]})})}),BAe=()=>h.jsx("div",{className:"min-h-screen p-4 md:p-8 bg-yellow-50 common-margin-top",children:h.jsx(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-yellow-400",children:[h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-yellow-400 via-amber-400 to-orange-300",children:[h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg mb-4",children:h.jsx(fk,{className:"h-16 w-16 text-yellow-600"})}),h.jsx(ni,{className:"text-4xl font-bold text-gray-800",children:"Privacy Policy"}),h.jsxs(qs,{className:"text-lg text-gray-700 mt-2",children:["Your privacy is important to us. Last updated: ",new Date().toLocaleDateString(),"."]})]}),h.jsxs(vr,{className:"p-6 md:p-10 space-y-6 bg-white text-gray-700 leading-relaxed",children:[h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"1. Introduction"}),h.jsx("p",{children:"Welcome to Astrotruth. We are committed to protecting your personal information and your right to privacy. If you have any questions or concerns about our policy, or our practices with regards to your personal information, please contact us."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"2. Information We Collect"}),h.jsx("p",{children:"We collect personal information that you voluntarily provide to us when registering at the Astrotruth, expressing an interest in obtaining information about us or our products and services, when participating in activities on the Astrotruth or otherwise contacting us. This may include name, birth details, email address, phone number, and payment information."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"3. How We Use Your Information"}),h.jsx("p",{children:"We use personal information collected via our Astrotruth for a variety of business purposes described below. We process your personal information for these purposes in reliance on our legitimate business interests, in order to enter into or perform a contract with you, with your consent, and/or for compliance with our legal obligations."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"4. Will Your Information Be Shared With Anyone?"}),h.jsx("p",{children:"We only share information with your consent, to comply with laws, to provide you with services, to protect your rights, or to fulfill business obligations. We may share your data with third-party vendors, service providers, contractors or agents who perform services for us or on our behalf and require access to such information to do that work."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"5. How Long Do We Keep Your Information?"}),h.jsx("p",{children:"We will only keep your personal information for as long as it is necessary for the purposes set out in this privacy policy, unless a longer retention period is required or permitted by law (such as tax, accounting or other legal requirements)."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"6. How Do We Keep Your Information Safe?"}),h.jsx("p",{children:"We have implemented appropriate technical and organizational security measures designed to protect the security of any personal information we process. However, please also remember that we cannot guarantee that the internet itself is 100% secure."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"7. Your Privacy Rights"}),h.jsx("p",{children:"In some regions (like the European Economic Area), you have rights that allow you greater access to and control over your personal information. You may review, change, or terminate your account at any time."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"8. Updates To This Policy"}),h.jsx("p",{children:"We may update this privacy policy from time to time. The updated version will be indicated by an updated Revised date and the updated version will be effective as soon as it is accessible."})]}),h.jsxs("section",{children:[h.jsx("h2",{className:"text-xl font-semibold text-yellow-600 mb-2",children:"9. How Can You Contact Us About This Policy?"}),h.jsx("p",{children:"If you have questions or comments about this policy, you may email us at privacy@astrotruth.com or by post to: Astrotruth, Attn: Privacy Officer, 123 Astro Lane, Cosmic City, Universe 78901."})]})]})]})})}),WAe=()=>{const[n,i]=X.useState([]),o=Qi(),c=async()=>{var d;try{const f=await Jn.get("https://astro-talk-backend.onrender.com/web/astro/astrolist");i(((d=f.data)==null?void 0:d.data)||[])}catch(f){console.error("Error fetching astrologers:",f)}};return X.useEffect(()=>{c()},[]),h.jsx("section",{className:"py-16 bg-gray-50",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-4xl font-bold mb-2",children:["Our Expert ",h.jsx("span",{className:"cosmic-text",children:"Astrologers"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-xl mx-auto",children:"Connect with India's most trusted astrologers for personalized guidance"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.length>0?n.filter(d=>d.role==="karamkandi"||d.role==="both").map((d,f)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.4,delay:f*.1},viewport:{once:!0},children:h.jsxs(ur,{className:"overflow-hidden h-full shadow-sm",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:d.image?`https://astro-talk-backend.onrender.com/${d.image.replace(/^\/?/,"")}`:"https://via.placeholder.com/300x200?text=No+Image",onError:_=>{_.target.onerror=null,_.target.src="https://via.placeholder.com/300x200?text=Image+Not+Found"},alt:d.astroName||"Astrologer",className:"w-full h-48 object-cover"}),h.jsx(np,{className:"absolute top-3 right-3",variant:d.status==="Online"?"cosmic":"secondary",children:d.status||"Offline"})]}),h.jsxs(vr,{className:"p-5",children:[h.jsxs("div",{className:"flex justify-between mb-2",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-lg",children:d.astroName||"No Name"}),h.jsx("p",{className:"text-sm text-gray-500",children:d.specialty||"N/A"})]}),h.jsxs("div",{className:"flex items-center bg-yellow-100 px-2 py-1 rounded",children:[h.jsx(oo,{className:"h-4 w-4 text-yellow-500 mr-1",fill:"currentColor"}),h.jsx("span",{className:"text-sm font-semibold",children:d.rating||"4.5"})]})]}),h.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[h.jsx("strong",{children:"Experience:"})," ",d.experience||"N/A"]}),h.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[h.jsx("strong",{children:"Languages:"})," ",d.langauge||"N/A"]}),h.jsx("div",{className:"flex flex-wrap gap-1 my-2",children:Array.isArray(d.expertise)&&d.expertise.length>0?d.expertise.map((_,v)=>h.jsx(np,{variant:"outline",children:_},v)):h.jsx(np,{variant:"outline",children:"No Expertise"})}),h.jsx("div",{className:"flex justify-between items-center mt-4",children:h.jsx(vt,{size:"sm",variant:"outline",className:"rounded-full",onClick:()=>o(`/karmkandidet/${d._id}`),children:"Book for Puja"})})]})]})},d._id)):h.jsx("div",{className:"col-span-full text-center text-gray-500 text-lg",children:"No Astrologers Found"})}),h.jsx("div",{className:"text-center mt-10",children:h.jsx(vt,{size:"lg",className:"cosmic-gradient",children:"View All Astrologers"})})]})})},HAe=({id:n,image:i,title:o,price:c,oldPrice:d})=>h.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[h.jsx("img",{src:i,alt:o,className:"w-full h-48 object-cover rounded"}),h.jsx("h3",{className:"text-lg font-bold mt-2",children:o}),h.jsxs("p",{className:"text-red-600 font-semibold",children:["",c]}),h.jsxs("p",{className:"text-gray-500 line-through",children:["",d]}),h.jsx(Xn,{to:`/product/${n}`,children:h.jsx("button",{className:"mt-3 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-all",children:"Book Now"})})]}),GAe="/assets/mala-cf4bdab2.jpeg",om="/assets/card1-a81d9715.jpg",Bx="/assets/card2-b618d582.jpg",j_="/assets/card3-96beafa1.jpg",zAe=[{id:"1",image:GAe,title:"Dhan Yog Bracelet",price:599,oldPrice:1499},{id:"2",image:om,title:"Raw Pyrite Bracelet",price:599,oldPrice:1499},{id:"3",image:Bx,title:"Maha Dhan Yog Combo",price:799,oldPrice:5997},{id:"4",image:j_,title:"Energised Dhan Yog Bracelet",price:699,oldPrice:1499},{id:"5",image:om,title:"Raw Pyrite Bracelet",price:599,oldPrice:1499},{id:"6",image:Bx,title:"Maha Dhan Yog Combo",price:799,oldPrice:5997},{id:"7",image:om,title:"Raw Pyrite Bracelet",price:599,oldPrice:1499},{id:"8",image:Bx,title:"Maha Dhan Yog Combo",price:799,oldPrice:5997},{id:"9",image:j_,title:"Energised Dhan Yog Bracelet",price:699,oldPrice:1499},{id:"10",image:om,title:"Raw Pyrite Bracelet",price:599,oldPrice:1499},{id:"11",image:j_,title:"Energised Dhan Yog Bracelet",price:699,oldPrice:1499},{id:"12",image:om,title:"Raw Pyrite Bracelet",price:599,oldPrice:1499}],KAe=()=>{const n=Qi(),i=JSON.parse(localStorage.getItem("user")||"{}");X.useEffect(()=>{localStorage.getItem("userToken")||n("/user-login")},[n]);const o=()=>{localStorage.removeItem("userToken"),localStorage.removeItem("user"),n("/user-login")};return h.jsxs("section",{className:"bg-white min-h-screen py-10",children:[h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 mb-6",children:h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-4 md:mb-0",children:["Welcome to Store, ",(i==null?void 0:i.user_name)||"User","!"]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:()=>n("/user-dashboard"),children:[h.jsx(hk,{className:"mr-2 h-4 w-4"}),"Go to Dashboard"]}),h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:()=>n("/user-update"),children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Account Settings"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:o,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"})," Logout"]})]})]})}),h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our ",h.jsx("span",{className:"cosmic-text",children:"Store"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Comprehensive astrological solutions for every aspect of your life"})]}),h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Bracelet Store"}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:zAe.map(c=>h.jsx(HAe,{...c},c.id))})]})]})},qAe=[{id:"1",image:j_,title:"Dhan Yog Bracelet",price:599,oldPrice:1499},{id:"2",image:om,title:"Raw Pyrite Bracelet",price:599,oldPrice:1499},{id:"3",image:Bx,title:"Maha Dhan Yog Combo",price:799,oldPrice:5997},{id:"4",image:j_,title:"Energised Dhan Yog Bracelet",price:699,oldPrice:1499}],YAe=()=>{const{id:n}=vE(),i=Qi(),o=JSON.parse(localStorage.getItem("user")||"{}"),c=qAe.find(_=>_.id===n);X.useEffect(()=>{localStorage.getItem("userToken")||i("/user-login")},[i]);const d=()=>{localStorage.getItem("userToken")?i(`/checkout/${c.id}`,{state:{product:c}}):(alert("Please login first to buy the product."),i("/user-login",{state:{from:`/product/${c.id}`}}))},f=()=>{localStorage.removeItem("userToken"),localStorage.removeItem("user"),i("/user-login")};return c?h.jsxs("section",{className:"bg-white min-h-screen py-10",children:[h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 mb-6",children:h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-4 md:mb-0",children:["Welcome, ",(o==null?void 0:o.user_name)||"User","!"]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:()=>i("/user-dashboard"),children:[h.jsx(hk,{className:"mr-2 h-4 w-4"}),"Go to Dashboard"]}),h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:()=>i("/user-update"),children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Account Settings"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:f,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"})," Logout"]})]})]})}),h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our ",h.jsx("span",{className:"cosmic-text",children:"Product Details"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Comprehensive astrological solutions for every aspect of your life"})]}),h.jsxs("div",{className:"max-w-2xl mx-auto bg-white shadow-lg rounded-xl overflow-hidden",children:[h.jsx("img",{src:c.image,alt:c.title,className:"w-full h-80 object-cover"}),h.jsxs("div",{className:"p-6",children:[h.jsx("h2",{className:"text-2xl font-bold mb-2",children:c.title}),h.jsxs("p",{className:"text-red-600 text-xl font-semibold",children:["",c.price]}),h.jsxs("p",{className:"line-through text-gray-500",children:["",c.oldPrice]}),h.jsx("p",{className:"mt-4 text-gray-700",children:"This powerful bracelet is designed to bring prosperity, good fortune, and positive energy."}),h.jsx("button",{onClick:d,className:"mt-6 w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-all",children:"Buy Now"})]})]})]})]}):h.jsx("div",{className:"p-8 text-center text-red-600",children:"Product Not Found"})},$Ae=()=>{var d;vE();const i=(d=Oc().state)==null?void 0:d.product;if(!i)return h.jsx("div",{className:"p-8 text-center text-red-600",children:"No product found in checkout."});const o=()=>new Promise(f=>{const _=document.createElement("script");_.src="https://checkout.razorpay.com/v1/checkout.js",_.onload=()=>f(!0),_.onerror=()=>f(!1),document.body.appendChild(_)}),c=async()=>{if(!await o()){alert("Razorpay SDK failed to load. Are you online?");return}try{const{data:_}=await Jn.post("http://localhost:8000/paynow",{amount:i.price*100,currency:"INR"}),{amount:v,id:x,currency:T}=_.order,w={key:"rzp_test_HC49LHGAmCT33i",amount:v.toString(),currency:T,name:"AstroTruth",description:"Astrology Consultation Payment",image:"/logo.svg",order_id:x,handler:function(I){alert("Payment successful!"),console.log("Payment Response:",I)},prefill:{name:"Narad Bhardwaj",email:"narad@example.com",contact:"9999999999"},theme:{color:"#3399cc"}};new window.Razorpay(w).open()}catch(_){console.error(_),alert("Something went wrong")}};return h.jsx("section",{className:"py-16 bg-white star-bg common-margin-top",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:["Our ",h.jsx("span",{className:"cosmic-text",children:"Checkout"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Comprehensive astrological solutions for every aspect of your life"})]}),h.jsx("div",{className:"min-h-screen p-8 bg-gray-100",children:h.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 shadow-md rounded",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:i.image,alt:i.title,className:"w-32 h-32 object-cover rounded"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-semibold",children:i.title}),h.jsxs("p",{className:"text-red-600 font-bold text-lg",children:["",i.price]}),h.jsxs("p",{className:"line-through text-gray-500 text-sm",children:["",i.oldPrice]})]})]}),h.jsxs("div",{className:"mt-6",children:[h.jsx("label",{className:"block font-medium mb-1",children:"Your Name"}),h.jsx("input",{type:"text",placeholder:"Enter your full name",className:"w-full p-3 border rounded mb-4"}),h.jsx("label",{className:"block font-medium mb-1",children:"Email"}),h.jsx("input",{type:"email",placeholder:"Enter your email",className:"w-full p-3 border rounded mb-4"}),h.jsx("label",{className:"block font-medium mb-1",children:"Shipping Address"}),h.jsx("textarea",{placeholder:"Enter delivery address",className:"w-full p-3 border rounded mb-6"}),h.jsx("button",{onClick:c,className:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold",children:"Confirm Order"})]})]})})]})})},XAe=()=>{const{id:n}=vE(),[i,o]=X.useState(null),[c,d]=X.useState(!0);if(X.useEffect(()=>{(async()=>{var v;try{const w=(((v=(await Jn.get("https://astro-talk-backend.onrender.com/web/astro/astrolist")).data)==null?void 0:v.data)||[]).find(R=>R._id===n);o(w||null)}catch(x){console.error("Error fetching astrologer list:",x),o(null)}finally{d(!1)}})()},[n]),c)return h.jsx("div",{className:"min-h-screen flex items-center justify-center text-lg font-medium text-gray-700",children:"Loading astrologer details..."});if(!i)return h.jsx("div",{className:"min-h-screen flex items-center justify-center text-red-500 text-xl",children:"Astrologer not found."});const f=i.image?`https://astro-talk-backend.onrender.com/${i.image.replace(/^\/?/,"")}`:"https://via.placeholder.com/600x400?text=No+Image";return h.jsxs("section",{className:"p-6 max-w-4xl mx-auto bg-white shadow-md rounded-lg mt-10",children:[h.jsx("img",{src:f,onError:_=>{_.target.onerror=null,_.target.src="https://via.placeholder.com/600x400?text=Image+Not+Found"},alt:i.astroName||"Astrologer",className:"w-full h-64 object-cover rounded-md mb-4"}),h.jsx("h2",{className:"text-2xl font-bold mb-2",children:i.astroName}),h.jsxs("p",{className:"text-gray-600 mb-1",children:[h.jsx("strong",{children:"Specialty:"})," ",i.specialty||"N/A"]}),h.jsxs("p",{className:"text-gray-600 mb-1",children:[h.jsx("strong",{children:"Experience:"})," ",i.experience||"N/A"]}),h.jsxs("p",{className:"text-gray-600 mb-1",children:[h.jsx("strong",{children:"Languages:"})," ",i.langauge||"N/A"]}),h.jsxs("p",{className:"text-gray-600 mb-1",children:[h.jsx("strong",{children:"Expertise:"})," ",Array.isArray(i.expertise)?i.expertise.join(", "):i.expertise||"N/A"]}),h.jsxs("p",{className:"text-gray-600 mt-4",children:[h.jsx("strong",{children:"Short Bio:"})," ",i.shortBio||"N/A"]})]})},ku=()=>h.jsxs("div",{className:"w-64 h-screen bg-red-50 p-4",children:[h.jsx("h2",{className:"text-xl font-bold mb-6",children:"Admin Panel"}),h.jsxs("nav",{className:"flex flex-col gap-4",children:[h.jsxs(Lh,{to:"/admin",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(bEe,{})," Dashboard"]}),h.jsxs(Lh,{to:"/admin/astrologer",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(oo,{})," Astrologers"]}),h.jsxs(Lh,{to:"/admin/users",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(cd,{})," Users"]}),h.jsxs(Lh,{to:"/admin/karmkandy",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(Eb,{})," Karmkandi"]}),h.jsxs(Lh,{to:"/admin/addproduct",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(yW,{})," Add Product"]}),h.jsxs(Lh,{to:"/admin/productlist",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(yW,{}),"Product List"]}),h.jsxs(Lh,{to:"/admin/paymentrequest",className:"flex items-center gap-2 text-gray-800",children:[h.jsx(HEe,{}),"Payment Request"]})]})]}),zb=({userName:n="Admin",onLogout:i})=>h.jsxs("div",{className:"w-full flex items-center justify-between px-6 py-3 bg-white shadow-md z-10",children:[h.jsx("div",{className:"text-xl font-bold text-gray-800",children:"Admin Panel"}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[h.jsx(ea,{className:"w-6 h-6"}),h.jsx("span",{children:n})]}),h.jsx("button",{className:"text-gray-600 hover:text-red-500",children:h.jsx(fd,{className:"w-6 h-6"})}),h.jsx("button",{onClick:i,className:"text-gray-600 hover:text-red-500",children:h.jsx(Tl,{className:"w-6 h-6"})})]})]}),JAe=({title:n,value:i,icon:o,color:c="bg-gray-200"})=>h.jsxs("div",{className:`p-4 rounded-xl shadow flex items-center gap-4 ${c}`,children:[h.jsx(o,{className:"w-10 h-10 text-gray-700"}),h.jsxs("div",{children:[h.jsx("div",{className:"text-sm text-gray-600",children:n}),h.jsx("div",{className:"text-xl font-bold text-gray-800",children:i})]})]}),QAe=()=>{const n=()=>{localStorage.clear(),window.location.href="/admin-login"},i=[{title:"Total Astrologers",value:32,icon:oo,color:"bg-red-200"},{title:"Total Users",value:120,icon:cd,color:"bg-green-200"},{title:"Karmkandi Services",value:15,icon:Eb,color:"bg-yellow-200"},{title:"Appointments Today",value:7,icon:hEe,color:"bg-blue-200"}],o=Oc();return console.log(o.pathname),h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1 ml-64 min-h-screen bg-gray-50",children:[h.jsx(zb,{userName:"Admin",onLogout:n}),h.jsxs("div",{className:"p-8",children:[h.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin Dashboard"}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:i.map((c,d)=>h.jsx(JAe,{title:c.title,value:c.value,icon:c.icon,color:c.color},d))})]})]})]})};var Oo=function(){return Oo=Object.assign||function(i){for(var o,c=1,d=arguments.length;c<d;c++){o=arguments[c];for(var f in o)Object.prototype.hasOwnProperty.call(o,f)&&(i[f]=o[f])}return i},Oo.apply(this,arguments)};function dE(n,i,o){if(o||arguments.length===2)for(var c=0,d=i.length,f;c<d;c++)(f||!(c in i))&&(f||(f=Array.prototype.slice.call(i,0,c)),f[c]=i[c]);return n.concat(f||Array.prototype.slice.call(i))}var Hr="-ms-",U_="-moz-",Er="-webkit-",eQ="comm",Kb="rule",u2="decl",ZAe="@import",tQ="@keyframes",e1e="@layer",nQ=Math.abs,h2=String.fromCharCode,GD=Object.assign;function t1e(n,i){return hs(n,0)^45?(((i<<2^hs(n,0))<<2^hs(n,1))<<2^hs(n,2))<<2^hs(n,3):0}function rQ(n){return n.trim()}function Yl(n,i){return(n=i.exec(n))?n[0]:n}function On(n,i,o){return n.replace(i,o)}function Wx(n,i,o){return n.indexOf(i,o)}function hs(n,i){return n.charCodeAt(i)|0}function Gm(n,i,o){return n.slice(i,o)}function fl(n){return n.length}function iQ(n){return n.length}function v_(n,i){return i.push(n),n}function n1e(n,i){return n.map(i).join("")}function zG(n,i){return n.filter(function(o){return!Yl(o,i)})}var qb=1,zm=1,sQ=0,za=0,Ui=0,o0="";function Yb(n,i,o,c,d,f,_,v){return{value:n,root:i,parent:o,type:c,props:d,children:f,line:qb,column:zm,length:_,return:"",siblings:v}}function tu(n,i){return GD(Yb("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},i)}function rm(n){for(;n.root;)n=tu(n.root,{children:[n]});v_(n,n.siblings)}function r1e(){return Ui}function i1e(){return Ui=za>0?hs(o0,--za):0,zm--,Ui===10&&(zm=1,qb--),Ui}function Nc(){return Ui=za<sQ?hs(o0,za++):0,zm++,Ui===10&&(zm=1,qb++),Ui}function rp(){return hs(o0,za)}function Hx(){return za}function $b(n,i){return Gm(o0,n,i)}function zD(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function s1e(n){return qb=zm=1,sQ=fl(o0=n),za=0,[]}function o1e(n){return o0="",n}function iO(n){return rQ($b(za-1,KD(n===91?n+2:n===40?n+1:n)))}function a1e(n){for(;(Ui=rp())&&Ui<33;)Nc();return zD(n)>2||zD(Ui)>3?"":" "}function c1e(n,i){for(;--i&&Nc()&&!(Ui<48||Ui>102||Ui>57&&Ui<65||Ui>70&&Ui<97););return $b(n,Hx()+(i<6&&rp()==32&&Nc()==32))}function KD(n){for(;Nc();)switch(Ui){case n:return za;case 34:case 39:n!==34&&n!==39&&KD(Ui);break;case 40:n===41&&KD(n);break;case 92:Nc();break}return za}function l1e(n,i){for(;Nc()&&n+Ui!==47+10;)if(n+Ui===42+42&&rp()===47)break;return"/*"+$b(i,za-1)+"*"+h2(n===47?n:Nc())}function d1e(n){for(;!zD(rp());)Nc();return $b(n,za)}function u1e(n){return o1e(Gx("",null,null,null,[""],n=s1e(n),0,[0],n))}function Gx(n,i,o,c,d,f,_,v,x){for(var T=0,w=0,R=_,I=0,j=0,P=0,k=1,W=1,H=1,L=0,V="",K=d,te=f,ie=c,A=V;W;)switch(P=L,L=Nc()){case 40:if(P!=108&&hs(A,R-1)==58){Wx(A+=On(iO(L),"&","&\f"),"&\f",nQ(T?v[T-1]:0))!=-1&&(H=-1);break}case 34:case 39:case 91:A+=iO(L);break;case 9:case 10:case 13:case 32:A+=a1e(P);break;case 92:A+=c1e(Hx()-1,7);continue;case 47:switch(rp()){case 42:case 47:v_(h1e(l1e(Nc(),Hx()),i,o,x),x);break;default:A+="/"}break;case 123*k:v[T++]=fl(A)*H;case 125*k:case 59:case 0:switch(L){case 0:case 125:W=0;case 59+w:H==-1&&(A=On(A,/\f/g,"")),j>0&&fl(A)-R&&v_(j>32?qG(A+";",c,o,R-1,x):qG(On(A," ","")+";",c,o,R-2,x),x);break;case 59:A+=";";default:if(v_(ie=KG(A,i,o,T,w,d,v,V,K=[],te=[],R,f),f),L===123)if(w===0)Gx(A,i,ie,ie,K,f,R,v,te);else switch(I===99&&hs(A,3)===110?100:I){case 100:case 108:case 109:case 115:Gx(n,ie,ie,c&&v_(KG(n,ie,ie,0,0,d,v,V,d,K=[],R,te),te),d,te,R,v,c?K:te);break;default:Gx(A,ie,ie,ie,[""],te,0,v,te)}}T=w=j=0,k=H=1,V=A="",R=_;break;case 58:R=1+fl(A),j=P;default:if(k<1){if(L==123)--k;else if(L==125&&k++==0&&i1e()==125)continue}switch(A+=h2(L),L*k){case 38:H=w>0?1:(A+="\f",-1);break;case 44:v[T++]=(fl(A)-1)*H,H=1;break;case 64:rp()===45&&(A+=iO(Nc())),I=rp(),w=R=fl(V=A+=d1e(Hx())),L++;break;case 45:P===45&&fl(A)==2&&(k=0)}}return f}function KG(n,i,o,c,d,f,_,v,x,T,w,R){for(var I=d-1,j=d===0?f:[""],P=iQ(j),k=0,W=0,H=0;k<c;++k)for(var L=0,V=Gm(n,I+1,I=nQ(W=_[k])),K=n;L<P;++L)(K=rQ(W>0?j[L]+" "+V:On(V,/&\f/g,j[L])))&&(x[H++]=K);return Yb(n,i,o,d===0?Kb:v,x,T,w,R)}function h1e(n,i,o,c){return Yb(n,i,o,eQ,h2(r1e()),Gm(n,2,-2),0,c)}function qG(n,i,o,c,d){return Yb(n,i,o,u2,Gm(n,0,c),Gm(n,c+1,-1),c,d)}function oQ(n,i,o){switch(t1e(n,i)){case 5103:return Er+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Er+n+n;case 4789:return U_+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Er+n+U_+n+Hr+n+n;case 5936:switch(hs(n,i+11)){case 114:return Er+n+Hr+On(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Er+n+Hr+On(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Er+n+Hr+On(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return Er+n+Hr+n+n;case 6165:return Er+n+Hr+"flex-"+n+n;case 5187:return Er+n+On(n,/(\w+).+(:[^]+)/,Er+"box-$1$2"+Hr+"flex-$1$2")+n;case 5443:return Er+n+Hr+"flex-item-"+On(n,/flex-|-self/g,"")+(Yl(n,/flex-|baseline/)?"":Hr+"grid-row-"+On(n,/flex-|-self/g,""))+n;case 4675:return Er+n+Hr+"flex-line-pack"+On(n,/align-content|flex-|-self/g,"")+n;case 5548:return Er+n+Hr+On(n,"shrink","negative")+n;case 5292:return Er+n+Hr+On(n,"basis","preferred-size")+n;case 6060:return Er+"box-"+On(n,"-grow","")+Er+n+Hr+On(n,"grow","positive")+n;case 4554:return Er+On(n,/([^-])(transform)/g,"$1"+Er+"$2")+n;case 6187:return On(On(On(n,/(zoom-|grab)/,Er+"$1"),/(image-set)/,Er+"$1"),n,"")+n;case 5495:case 3959:return On(n,/(image-set\([^]*)/,Er+"$1$`$1");case 4968:return On(On(n,/(.+:)(flex-)?(.*)/,Er+"box-pack:$3"+Hr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Er+n+n;case 4200:if(!Yl(n,/flex-|baseline/))return Hr+"grid-column-align"+Gm(n,i)+n;break;case 2592:case 3360:return Hr+On(n,"template-","")+n;case 4384:case 3616:return o&&o.some(function(c,d){return i=d,Yl(c.props,/grid-\w+-end/)})?~Wx(n+(o=o[i].value),"span",0)?n:Hr+On(n,"-start","")+n+Hr+"grid-row-span:"+(~Wx(o,"span",0)?Yl(o,/\d+/):+Yl(o,/\d+/)-+Yl(n,/\d+/))+";":Hr+On(n,"-start","")+n;case 4896:case 4128:return o&&o.some(function(c){return Yl(c.props,/grid-\w+-start/)})?n:Hr+On(On(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return On(n,/(.+)-inline(.+)/,Er+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(fl(n)-1-i>6)switch(hs(n,i+1)){case 109:if(hs(n,i+4)!==45)break;case 102:return On(n,/(.+:)(.+)-([^]+)/,"$1"+Er+"$2-$3$1"+U_+(hs(n,i+3)==108?"$3":"$2-$3"))+n;case 115:return~Wx(n,"stretch",0)?oQ(On(n,"stretch","fill-available"),i,o)+n:n}break;case 5152:case 5920:return On(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(c,d,f,_,v,x,T){return Hr+d+":"+f+T+(_?Hr+d+"-span:"+(v?x:+x-+f)+T:"")+n});case 4949:if(hs(n,i+6)===121)return On(n,":",":"+Er)+n;break;case 6444:switch(hs(n,hs(n,14)===45?18:11)){case 120:return On(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Er+(hs(n,14)===45?"inline-":"")+"box$3$1"+Er+"$2$3$1"+Hr+"$2box$3")+n;case 100:return On(n,":",":"+Hr)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return On(n,"scroll-","scroll-snap-")+n}return n}function BT(n,i){for(var o="",c=0;c<n.length;c++)o+=i(n[c],c,n,i)||"";return o}function p1e(n,i,o,c){switch(n.type){case e1e:if(n.children.length)break;case ZAe:case u2:return n.return=n.return||n.value;case eQ:return"";case tQ:return n.return=n.value+"{"+BT(n.children,c)+"}";case Kb:if(!fl(n.value=n.props.join(",")))return""}return fl(o=BT(n.children,c))?n.return=n.value+"{"+o+"}":""}function f1e(n){var i=iQ(n);return function(o,c,d,f){for(var _="",v=0;v<i;v++)_+=n[v](o,c,d,f)||"";return _}}function m1e(n){return function(i){i.root||(i=i.return)&&n(i)}}function g1e(n,i,o,c){if(n.length>-1&&!n.return)switch(n.type){case u2:n.return=oQ(n.value,n.length,o);return;case tQ:return BT([tu(n,{value:On(n.value,"@","@"+Er)})],c);case Kb:if(n.length)return n1e(o=n.props,function(d){switch(Yl(d,c=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":rm(tu(n,{props:[On(d,/:(read-\w+)/,":"+U_+"$1")]})),rm(tu(n,{props:[d]})),GD(n,{props:zG(o,c)});break;case"::placeholder":rm(tu(n,{props:[On(d,/:(plac\w+)/,":"+Er+"input-$1")]})),rm(tu(n,{props:[On(d,/:(plac\w+)/,":"+U_+"$1")]})),rm(tu(n,{props:[On(d,/:(plac\w+)/,Hr+"input-$1")]})),rm(tu(n,{props:[d]})),GD(n,{props:zG(o,c)});break}return""})}}var _1e={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Km=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",aQ="active",cQ="data-styled-version",Xb="6.1.19",p2=`/*!sc*/
`,WT=typeof window<"u"&&typeof document<"u",E1e=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY),Jb=Object.freeze([]),qm=Object.freeze({});function v1e(n,i,o){return o===void 0&&(o=qm),n.theme!==o.theme&&n.theme||i||o.theme}var lQ=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),y1e=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,S1e=/(^-|-$)/g;function YG(n){return n.replace(y1e,"-").replace(S1e,"")}var x1e=/(a)(d)/gi,gx=52,$G=function(n){return String.fromCharCode(n+(n>25?39:97))};function qD(n){var i,o="";for(i=Math.abs(n);i>gx;i=i/gx|0)o=$G(i%gx)+o;return($G(i%gx)+o).replace(x1e,"$1-$2")}var sO,dQ=5381,Tm=function(n,i){for(var o=i.length;o;)n=33*n^i.charCodeAt(--o);return n},uQ=function(n){return Tm(dQ,n)};function hQ(n){return qD(uQ(n)>>>0)}function T1e(n){return n.displayName||n.name||"Component"}function oO(n){return typeof n=="string"&&!0}var pQ=typeof Symbol=="function"&&Symbol.for,fQ=pQ?Symbol.for("react.memo"):60115,b1e=pQ?Symbol.for("react.forward_ref"):60112,w1e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},C1e={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},mQ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},R1e=((sO={})[b1e]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},sO[fQ]=mQ,sO);function XG(n){return("type"in(i=n)&&i.type.$$typeof)===fQ?mQ:"$$typeof"in n?R1e[n.$$typeof]:w1e;var i}var A1e=Object.defineProperty,N1e=Object.getOwnPropertyNames,JG=Object.getOwnPropertySymbols,I1e=Object.getOwnPropertyDescriptor,O1e=Object.getPrototypeOf,QG=Object.prototype;function gQ(n,i,o){if(typeof i!="string"){if(QG){var c=O1e(i);c&&c!==QG&&gQ(n,c,o)}var d=N1e(i);JG&&(d=d.concat(JG(i)));for(var f=XG(n),_=XG(i),v=0;v<d.length;++v){var x=d[v];if(!(x in C1e||o&&o[x]||_&&x in _||f&&x in f)){var T=I1e(i,x);try{A1e(n,x,T)}catch{}}}}return n}function Ym(n){return typeof n=="function"}function f2(n){return typeof n=="object"&&"styledComponentId"in n}function Zh(n,i){return n&&i?"".concat(n," ").concat(i):n||i||""}function YD(n,i){if(n.length===0)return"";for(var o=n[0],c=1;c<n.length;c++)o+=i?i+n[c]:n[c];return o}function uE(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function $D(n,i,o){if(o===void 0&&(o=!1),!o&&!uE(n)&&!Array.isArray(n))return i;if(Array.isArray(i))for(var c=0;c<i.length;c++)n[c]=$D(n[c],i[c]);else if(uE(i))for(var c in i)n[c]=$D(n[c],i[c]);return n}function m2(n,i){Object.defineProperty(n,"toString",{value:i})}function AE(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(i.length>0?" Args: ".concat(i.join(", ")):""))}var D1e=function(){function n(i){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=i}return n.prototype.indexOfGroup=function(i){for(var o=0,c=0;c<i;c++)o+=this.groupSizes[c];return o},n.prototype.insertRules=function(i,o){if(i>=this.groupSizes.length){for(var c=this.groupSizes,d=c.length,f=d;i>=f;)if((f<<=1)<0)throw AE(16,"".concat(i));this.groupSizes=new Uint32Array(f),this.groupSizes.set(c),this.length=f;for(var _=d;_<f;_++)this.groupSizes[_]=0}for(var v=this.indexOfGroup(i+1),x=(_=0,o.length);_<x;_++)this.tag.insertRule(v,o[_])&&(this.groupSizes[i]++,v++)},n.prototype.clearGroup=function(i){if(i<this.length){var o=this.groupSizes[i],c=this.indexOfGroup(i),d=c+o;this.groupSizes[i]=0;for(var f=c;f<d;f++)this.tag.deleteRule(c)}},n.prototype.getGroup=function(i){var o="";if(i>=this.length||this.groupSizes[i]===0)return o;for(var c=this.groupSizes[i],d=this.indexOfGroup(i),f=d+c,_=d;_<f;_++)o+="".concat(this.tag.getRule(_)).concat(p2);return o},n}(),zx=new Map,HT=new Map,Kx=1,_x=function(n){if(zx.has(n))return zx.get(n);for(;HT.has(Kx);)Kx++;var i=Kx++;return zx.set(n,i),HT.set(i,n),i},P1e=function(n,i){Kx=i+1,zx.set(n,i),HT.set(i,n)},k1e="style[".concat(Km,"][").concat(cQ,'="').concat(Xb,'"]'),L1e=new RegExp("^".concat(Km,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),M1e=function(n,i,o){for(var c,d=o.split(","),f=0,_=d.length;f<_;f++)(c=d[f])&&n.registerName(i,c)},j1e=function(n,i){for(var o,c=((o=i.textContent)!==null&&o!==void 0?o:"").split(p2),d=[],f=0,_=c.length;f<_;f++){var v=c[f].trim();if(v){var x=v.match(L1e);if(x){var T=0|parseInt(x[1],10),w=x[2];T!==0&&(P1e(w,T),M1e(n,w,x[3]),n.getTag().insertRules(T,d)),d.length=0}else d.push(v)}}},ZG=function(n){for(var i=document.querySelectorAll(k1e),o=0,c=i.length;o<c;o++){var d=i[o];d&&d.getAttribute(Km)!==aQ&&(j1e(n,d),d.parentNode&&d.parentNode.removeChild(d))}};function U1e(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var _Q=function(n){var i=document.head,o=n||i,c=document.createElement("style"),d=function(v){var x=Array.from(v.querySelectorAll("style[".concat(Km,"]")));return x[x.length-1]}(o),f=d!==void 0?d.nextSibling:null;c.setAttribute(Km,aQ),c.setAttribute(cQ,Xb);var _=U1e();return _&&c.setAttribute("nonce",_),o.insertBefore(c,f),c},F1e=function(){function n(i){this.element=_Q(i),this.element.appendChild(document.createTextNode("")),this.sheet=function(o){if(o.sheet)return o.sheet;for(var c=document.styleSheets,d=0,f=c.length;d<f;d++){var _=c[d];if(_.ownerNode===o)return _}throw AE(17)}(this.element),this.length=0}return n.prototype.insertRule=function(i,o){try{return this.sheet.insertRule(o,i),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(i){this.sheet.deleteRule(i),this.length--},n.prototype.getRule=function(i){var o=this.sheet.cssRules[i];return o&&o.cssText?o.cssText:""},n}(),V1e=function(){function n(i){this.element=_Q(i),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(i,o){if(i<=this.length&&i>=0){var c=document.createTextNode(o);return this.element.insertBefore(c,this.nodes[i]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(i){this.element.removeChild(this.nodes[i]),this.length--},n.prototype.getRule=function(i){return i<this.length?this.nodes[i].textContent:""},n}(),B1e=function(){function n(i){this.rules=[],this.length=0}return n.prototype.insertRule=function(i,o){return i<=this.length&&(this.rules.splice(i,0,o),this.length++,!0)},n.prototype.deleteRule=function(i){this.rules.splice(i,1),this.length--},n.prototype.getRule=function(i){return i<this.length?this.rules[i]:""},n}(),ez=WT,W1e={isServer:!WT,useCSSOMInjection:!E1e},EQ=function(){function n(i,o,c){i===void 0&&(i=qm),o===void 0&&(o={});var d=this;this.options=Oo(Oo({},W1e),i),this.gs=o,this.names=new Map(c),this.server=!!i.isServer,!this.server&&WT&&ez&&(ez=!1,ZG(this)),m2(this,function(){return function(f){for(var _=f.getTag(),v=_.length,x="",T=function(R){var I=function(H){return HT.get(H)}(R);if(I===void 0)return"continue";var j=f.names.get(I),P=_.getGroup(R);if(j===void 0||!j.size||P.length===0)return"continue";var k="".concat(Km,".g").concat(R,'[id="').concat(I,'"]'),W="";j!==void 0&&j.forEach(function(H){H.length>0&&(W+="".concat(H,","))}),x+="".concat(P).concat(k,'{content:"').concat(W,'"}').concat(p2)},w=0;w<v;w++)T(w);return x}(d)})}return n.registerId=function(i){return _x(i)},n.prototype.rehydrate=function(){!this.server&&WT&&ZG(this)},n.prototype.reconstructWithOptions=function(i,o){return o===void 0&&(o=!0),new n(Oo(Oo({},this.options),i),this.gs,o&&this.names||void 0)},n.prototype.allocateGSInstance=function(i){return this.gs[i]=(this.gs[i]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(i=function(o){var c=o.useCSSOMInjection,d=o.target;return o.isServer?new B1e(d):c?new F1e(d):new V1e(d)}(this.options),new D1e(i)));var i},n.prototype.hasNameForId=function(i,o){return this.names.has(i)&&this.names.get(i).has(o)},n.prototype.registerName=function(i,o){if(_x(i),this.names.has(i))this.names.get(i).add(o);else{var c=new Set;c.add(o),this.names.set(i,c)}},n.prototype.insertRules=function(i,o,c){this.registerName(i,o),this.getTag().insertRules(_x(i),c)},n.prototype.clearNames=function(i){this.names.has(i)&&this.names.get(i).clear()},n.prototype.clearRules=function(i){this.getTag().clearGroup(_x(i)),this.clearNames(i)},n.prototype.clearTag=function(){this.tag=void 0},n}(),H1e=/&/g,G1e=/^\s*\/\/.*$/gm;function vQ(n,i){return n.map(function(o){return o.type==="rule"&&(o.value="".concat(i," ").concat(o.value),o.value=o.value.replaceAll(",",",".concat(i," ")),o.props=o.props.map(function(c){return"".concat(i," ").concat(c)})),Array.isArray(o.children)&&o.type!=="@keyframes"&&(o.children=vQ(o.children,i)),o})}function z1e(n){var i,o,c,d=n===void 0?qm:n,f=d.options,_=f===void 0?qm:f,v=d.plugins,x=v===void 0?Jb:v,T=function(I,j,P){return P.startsWith(o)&&P.endsWith(o)&&P.replaceAll(o,"").length>0?".".concat(i):I},w=x.slice();w.push(function(I){I.type===Kb&&I.value.includes("&")&&(I.props[0]=I.props[0].replace(H1e,o).replace(c,T))}),_.prefix&&w.push(g1e),w.push(p1e);var R=function(I,j,P,k){j===void 0&&(j=""),P===void 0&&(P=""),k===void 0&&(k="&"),i=k,o=j,c=new RegExp("\\".concat(o,"\\b"),"g");var W=I.replace(G1e,""),H=u1e(P||j?"".concat(P," ").concat(j," { ").concat(W," }"):W);_.namespace&&(H=vQ(H,_.namespace));var L=[];return BT(H,f1e(w.concat(m1e(function(V){return L.push(V)})))),L};return R.hash=x.length?x.reduce(function(I,j){return j.name||AE(15),Tm(I,j.name)},dQ).toString():"",R}var K1e=new EQ,XD=z1e(),yQ=wt.createContext({shouldForwardProp:void 0,styleSheet:K1e,stylis:XD});yQ.Consumer;wt.createContext(void 0);function tz(){return X.useContext(yQ)}var SQ=function(){function n(i,o){var c=this;this.inject=function(d,f){f===void 0&&(f=XD);var _=c.name+f.hash;d.hasNameForId(c.id,_)||d.insertRules(c.id,_,f(c.rules,_,"@keyframes"))},this.name=i,this.id="sc-keyframes-".concat(i),this.rules=o,m2(this,function(){throw AE(12,String(c.name))})}return n.prototype.getName=function(i){return i===void 0&&(i=XD),this.name+i.hash},n}(),q1e=function(n){return n>="A"&&n<="Z"};function nz(n){for(var i="",o=0;o<n.length;o++){var c=n[o];if(o===1&&c==="-"&&n[0]==="-")return n;q1e(c)?i+="-"+c.toLowerCase():i+=c}return i.startsWith("ms-")?"-"+i:i}var xQ=function(n){return n==null||n===!1||n===""},TQ=function(n){var i,o,c=[];for(var d in n){var f=n[d];n.hasOwnProperty(d)&&!xQ(f)&&(Array.isArray(f)&&f.isCss||Ym(f)?c.push("".concat(nz(d),":"),f,";"):uE(f)?c.push.apply(c,dE(dE(["".concat(d," {")],TQ(f),!1),["}"],!1)):c.push("".concat(nz(d),": ").concat((i=d,(o=f)==null||typeof o=="boolean"||o===""?"":typeof o!="number"||o===0||i in _1e||i.startsWith("--")?String(o).trim():"".concat(o,"px")),";")))}return c};function ip(n,i,o,c){if(xQ(n))return[];if(f2(n))return[".".concat(n.styledComponentId)];if(Ym(n)){if(!Ym(f=n)||f.prototype&&f.prototype.isReactComponent||!i)return[n];var d=n(i);return ip(d,i,o,c)}var f;return n instanceof SQ?o?(n.inject(o,c),[n.getName(c)]):[n]:uE(n)?TQ(n):Array.isArray(n)?Array.prototype.concat.apply(Jb,n.map(function(_){return ip(_,i,o,c)})):[n.toString()]}function Y1e(n){for(var i=0;i<n.length;i+=1){var o=n[i];if(Ym(o)&&!f2(o))return!1}return!0}var $1e=uQ(Xb),X1e=function(){function n(i,o,c){this.rules=i,this.staticRulesId="",this.isStatic=(c===void 0||c.isStatic)&&Y1e(i),this.componentId=o,this.baseHash=Tm($1e,o),this.baseStyle=c,EQ.registerId(o)}return n.prototype.generateAndInjectStyles=function(i,o,c){var d=this.baseStyle?this.baseStyle.generateAndInjectStyles(i,o,c):"";if(this.isStatic&&!c.hash)if(this.staticRulesId&&o.hasNameForId(this.componentId,this.staticRulesId))d=Zh(d,this.staticRulesId);else{var f=YD(ip(this.rules,i,o,c)),_=qD(Tm(this.baseHash,f)>>>0);if(!o.hasNameForId(this.componentId,_)){var v=c(f,".".concat(_),void 0,this.componentId);o.insertRules(this.componentId,_,v)}d=Zh(d,_),this.staticRulesId=_}else{for(var x=Tm(this.baseHash,c.hash),T="",w=0;w<this.rules.length;w++){var R=this.rules[w];if(typeof R=="string")T+=R;else if(R){var I=YD(ip(R,i,o,c));x=Tm(x,I+w),T+=I}}if(T){var j=qD(x>>>0);o.hasNameForId(this.componentId,j)||o.insertRules(this.componentId,j,c(T,".".concat(j),void 0,this.componentId)),d=Zh(d,j)}}return d},n}(),bQ=wt.createContext(void 0);bQ.Consumer;var aO={};function J1e(n,i,o){var c=f2(n),d=n,f=!oO(n),_=i.attrs,v=_===void 0?Jb:_,x=i.componentId,T=x===void 0?function(K,te){var ie=typeof K!="string"?"sc":YG(K);aO[ie]=(aO[ie]||0)+1;var A="".concat(ie,"-").concat(hQ(Xb+ie+aO[ie]));return te?"".concat(te,"-").concat(A):A}(i.displayName,i.parentComponentId):x,w=i.displayName,R=w===void 0?function(K){return oO(K)?"styled.".concat(K):"Styled(".concat(T1e(K),")")}(n):w,I=i.displayName&&i.componentId?"".concat(YG(i.displayName),"-").concat(i.componentId):i.componentId||T,j=c&&d.attrs?d.attrs.concat(v).filter(Boolean):v,P=i.shouldForwardProp;if(c&&d.shouldForwardProp){var k=d.shouldForwardProp;if(i.shouldForwardProp){var W=i.shouldForwardProp;P=function(K,te){return k(K,te)&&W(K,te)}}else P=k}var H=new X1e(o,I,c?d.componentStyle:void 0);function L(K,te){return function(ie,A,de){var ue=ie.attrs,oe=ie.componentStyle,ye=ie.defaultProps,Ee=ie.foldedComponentIds,xe=ie.styledComponentId,Oe=ie.target,ct=wt.useContext(bQ),at=tz(),lt=ie.shouldForwardProp||at.shouldForwardProp,He=v1e(A,ct,ye)||qm,et=function(fn,qt,Dn){for(var Kt,hr=Oo(Oo({},qt),{className:void 0,theme:Dn}),Bn=0;Bn<fn.length;Bn+=1){var Yr=Ym(Kt=fn[Bn])?Kt(hr):Kt;for(var yr in Yr)hr[yr]=yr==="className"?Zh(hr[yr],Yr[yr]):yr==="style"?Oo(Oo({},hr[yr]),Yr[yr]):Yr[yr]}return qt.className&&(hr.className=Zh(hr.className,qt.className)),hr}(ue,A,He),ut=et.as||Oe,Ae={};for(var Le in et)et[Le]===void 0||Le[0]==="$"||Le==="as"||Le==="theme"&&et.theme===He||(Le==="forwardedAs"?Ae.as=et.forwardedAs:lt&&!lt(Le,ut)||(Ae[Le]=et[Le]));var ze=function(fn,qt){var Dn=tz(),Kt=fn.generateAndInjectStyles(qt,Dn.styleSheet,Dn.stylis);return Kt}(oe,et),qe=Zh(Ee,xe);return ze&&(qe+=" "+ze),et.className&&(qe+=" "+et.className),Ae[oO(ut)&&!lQ.has(ut)?"class":"className"]=qe,de&&(Ae.ref=de),X.createElement(ut,Ae)}(V,K,te)}L.displayName=R;var V=wt.forwardRef(L);return V.attrs=j,V.componentStyle=H,V.displayName=R,V.shouldForwardProp=P,V.foldedComponentIds=c?Zh(d.foldedComponentIds,d.styledComponentId):"",V.styledComponentId=I,V.target=c?d.target:n,Object.defineProperty(V,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(K){this._foldedDefaultProps=c?function(te){for(var ie=[],A=1;A<arguments.length;A++)ie[A-1]=arguments[A];for(var de=0,ue=ie;de<ue.length;de++)$D(te,ue[de],!0);return te}({},d.defaultProps,K):K}}),m2(V,function(){return".".concat(V.styledComponentId)}),f&&gQ(V,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),V}function rz(n,i){for(var o=[n[0]],c=0,d=i.length;c<d;c+=1)o.push(i[c],n[c+1]);return o}var iz=function(n){return Object.assign(n,{isCss:!0})};function wQ(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(Ym(n)||uE(n))return iz(ip(rz(Jb,dE([n],i,!0))));var c=n;return i.length===0&&c.length===1&&typeof c[0]=="string"?ip(c):iz(ip(rz(c,i)))}function JD(n,i,o){if(o===void 0&&(o=qm),!i)throw AE(1,i);var c=function(d){for(var f=[],_=1;_<arguments.length;_++)f[_-1]=arguments[_];return n(i,o,wQ.apply(void 0,dE([d],f,!1)))};return c.attrs=function(d){return JD(n,i,Oo(Oo({},o),{attrs:Array.prototype.concat(o.attrs,d).filter(Boolean)}))},c.withConfig=function(d){return JD(n,i,Oo(Oo({},o),d))},c}var CQ=function(n){return JD(J1e,n)},Rp=CQ;lQ.forEach(function(n){Rp[n]=CQ(n)});function g2(n){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var c=YD(wQ.apply(void 0,dE([n],i,!1))),d=hQ(c);return new SQ(d,c)}const Q1e="#4fa94d",Z1e={"aria-busy":!0,role:"progressbar"};Rp.div`
  display: ${n=>n.$visible?"flex":"none"};
`;const eNe="http://www.w3.org/2000/svg",vc=242.776657104492,tNe=1.6,nNe=g2`
12.5% {
  stroke-dasharray: ${vc*.14}px, ${vc}px;
  stroke-dashoffset: -${vc*.11}px;
}
43.75% {
  stroke-dasharray: ${vc*.35}px, ${vc}px;
  stroke-dashoffset: -${vc*.35}px;
}
100% {
  stroke-dasharray: ${vc*.01}px, ${vc}px;
  stroke-dashoffset: -${vc*.99}px;
}
`;Rp.path`
  stroke-dasharray: ${vc*.01}px, ${vc};
  stroke-dashoffset: 0;
  animation: ${nNe} ${tNe}s linear infinite;
`;const rNe=[0,30,60,90,120,150,180,210,240,270,300,330],iNe=g2`
to {
   transform: rotate(360deg);
 }
`,sNe=Rp.svg`
  animation: ${iNe} 0.75s steps(12, end) infinite;
  animation-duration: 0.75s;
`,oNe=Rp.polyline`
  stroke-width: ${n=>n.width}px;
  stroke-linecap: round;

  &:nth-child(12n + 0) {
    stroke-opacity: 0.08;
  }

  &:nth-child(12n + 1) {
    stroke-opacity: 0.17;
  }

  &:nth-child(12n + 2) {
    stroke-opacity: 0.25;
  }

  &:nth-child(12n + 3) {
    stroke-opacity: 0.33;
  }

  &:nth-child(12n + 4) {
    stroke-opacity: 0.42;
  }

  &:nth-child(12n + 5) {
    stroke-opacity: 0.5;
  }

  &:nth-child(12n + 6) {
    stroke-opacity: 0.58;
  }

  &:nth-child(12n + 7) {
    stroke-opacity: 0.66;
  }

  &:nth-child(12n + 8) {
    stroke-opacity: 0.75;
  }

  &:nth-child(12n + 9) {
    stroke-opacity: 0.83;
  }

  &:nth-child(12n + 11) {
    stroke-opacity: 0.92;
  }
`,NE=({strokeColor:n=Q1e,strokeWidth:i="5",animationDuration:o="0.75",width:c="96",visible:d=!0,ariaLabel:f="rotating-lines-loading"})=>{const _=X.useCallback(()=>rNe.map(v=>h.jsx(oNe,{points:"24,12 24,4",width:i,transform:`rotate(${v}, 24, 24)`},v)),[i]);return d?h.jsx(sNe,{xmlns:eNe,viewBox:"0 0 48 48",width:c,stroke:n,speed:o,"data-testid":"rotating-lines-svg","aria-label":f,...Z1e,children:_()}):null},aNe=g2`
to {
   stroke-dashoffset: 136;
 }
`;Rp.polygon`
  stroke-dasharray: 17;
  animation: ${aNe} 2.5s cubic-bezier(0.35, 0.04, 0.63, 0.95) infinite;
`;Rp.svg`
  transform-origin: 50% 65%;
`;const cNe=()=>{const[n,i]=X.useState([]),[o,c]=X.useState(!0),d="http://localhost:8000",[f,_]=X.useState(null),[v,x]=X.useState(!1),T=async()=>{try{const A=await Jn.get(`${d}/web/astro/astrolist`);i(A.data.data||[])}catch(A){console.error("Error fetching astrologers:",A),i([])}finally{c(!1)}},[w,R]=X.useState(!1),I=async A=>{console.log(A),c(!0);try{(await Jn.post(`${d}/admin/astroUpdate`,{astroId:A,status:!w})).data.status&&(R(!w),T())}catch(de){console.error("Error updating status:",de)}finally{c(!1)}},[j,P]=X.useState(!1),[k,W]=X.useState(10),[H,L]=X.useState(),[V,K]=X.useState(null),te=async(A,de,ue)=>{P(!0),L(de),W(A),K(ue)},ie=async A=>{A.preventDefault();try{(await Jn.post(`${d}/admin/astroChargeUpdate`,{astroId:H,sessionCharge:k,accountType:V})).data.status?(P(!1),T()):alert("Update failed")}catch(de){console.error("Error:",de)}};return console.log(V),X.useEffect(()=>{T()},[]),h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1 p-8",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Astrologers"}),h.jsxs("table",{className:"min-w-full bg-white shadow rounded-xl",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-red-100 text-gray-800",children:[h.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Email"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),h.jsx("tbody",{children:o?h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-4 py-4",children:h.jsx("div",{className:"flex justify-center items-center",children:h.jsx(NE,{visible:!0,height:"30",width:"30",color:"grey",strokeWidth:"5",animationDuration:"0.75",ariaLabel:"rotating-lines-loading",wrapperStyle:{},wrapperClass:""})})})}):n.length>0?n.filter(A=>A.role==="astrologer").map(A=>h.jsxs("tr",{className:"border-b",children:[console.log(A.status,A.astroName),h.jsx("td",{className:"px-4 py-2",children:A.astroName}),h.jsx("td",{className:"px-4 py-2",children:A.email}),h.jsx("td",{className:"px-4 py-2 capitalize",children:A.status?h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-green-600 ",children:" Verified"}):h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-red-600 ",children:" Pending"})}),h.jsxs("td",{className:"px-4 py-2",children:[h.jsx("button",{className:"text-sm text-green-600",onClick:()=>{_(A),x(!0)},children:h.jsx(n0,{})}),h.jsx("button",{className:`ml-4 text-sm font-medium ${A.status?"text-red-600":"text-green-600"}`,onClick:()=>I(A._id),disabled:o,children:o?"Please wait...":A.status?h.jsx(mk,{}):h.jsx(dk,{})}),h.jsx("button",{className:"ml-4 text-sm text-red-600",onClick:()=>alert("Working Pending....."),children:h.jsx(VEe,{})})]})]},A._id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"text-center text-gray-600 px-4 py-4",children:"No astrologers found."})})})]}),h.jsx(pp,{open:v,onOpenChange:x,children:h.jsxs(Cu,{className:"max-w-md",children:[h.jsx(fp,{children:h.jsx(mp,{children:"Astrologer Details"})}),f&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Name:"})," ",f.astroName]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Email:"})," ",f.email]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Mobile:"})," ",f.mobile]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Status:"})," ",f.status]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Experience:"})," ",f.experience," years"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"City:"})," ",f.city]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Language:"})," ",f.language]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Expertise:"})," ",f.expertise]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Account Type:"})," ",h.jsxs("span",{className:"bg-red-500/20 backdrop-blur-md p-1 px-2 shadow-md border border-white/30 font-bold text-[.6rem] rounded-md ",children:[" ",f.accountType," "]})," "]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Charge per Session:"})," ",h.jsxs("span",{className:"  cursor-pointer",onClick:()=>te(f.chargePerSession,f._id,f.accountType),children:[" ",f.chargePerSession]})]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Account Status :"}),f.status?h.jsx("span",{className:"text-white px-2 py-1 text-[.6rem] bg-green-600 rounded-lg ",children:" Verified Astrologer "}):h.jsx("span",{className:"text-white px-3 py-1 bg-red-600 rounded-lg ",children:" Awaiting Verification "})]})]})]})}),h.jsx(pp,{open:j,onOpenChange:P,children:h.jsxs(Cu,{className:"max-w-sm",children:[h.jsx(fp,{children:h.jsx(mp,{children:"Set Charge per Session"})}),h.jsxs("form",{action:"",onSubmit:ie,children:[h.jsxs("div",{className:"space-y-3",children:[h.jsx("label",{htmlFor:"charge",className:"block text-sm font-medium text-gray-700",children:"New Charge ()"}),h.jsx("input",{type:"number",id:"charge",className:"w-full border px-3 py-2 rounded-md",placeholder:"Enter new charge",value:k,onChange:A=>W(A.target.value)})]}),h.jsxs("div",{className:"space-y-1 mt-4 mb-3 cursor-pointer ",children:[h.jsx("label",{htmlFor:"accountType",className:"block text-sm font-medium text-gray-700",children:"Account Type"}),h.jsxs("select",{name:"accountType",value:V,onChange:A=>K(A.target.value),id:"",className:"w-full border cursor-pointer px-3 py-2 rounded-md bg-white text-sm text-gray-800 shadow-sm focus:outline-none focus:ring-1 focus:ring-green-500 ",children:[h.jsx("option",{value:"Normal",children:"Normal"}),h.jsx("option",{value:"Premium",children:"Premium"}),h.jsx("option",{value:"Pending",children:"Pending"})]})]}),h.jsx("button",{type:"submit",className:"w-full bg-green-600 text-white py-2 rounded-md",children:"Save"})]})]})})]})]})},lNe=()=>{const n=()=>{localStorage.clear(),window.location.href="/admin-login"},[i,o]=X.useState([]),[c,d]=X.useState(!0),[f,_]=X.useState(null),[v,x]=X.useState(!1),T=async()=>{try{const j=await Jn.get("https://astro-talk-backend.onrender.com/web/user/userlist");console.log(j.data.data),o(j.data.data||[])}catch(j){console.error("Error fetching astrologers:",j),o([])}finally{d(!1)}};X.useEffect(()=>{T()},[]);const[w,R]=X.useState(!1),I=async j=>{d(!0);try{(await Jn.post("https://astro-talk-backend.onrender.com/admin/userupdate",{userId:j,status:!w})).data.status&&(R(!w),T())}catch(P){console.error("Error updating status:",P)}finally{d(!1)}};return h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1",children:[h.jsx(zb,{userName:"Admin",onLogout:n}),h.jsxs("div",{className:"p-6",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Users"}),h.jsxs("table",{className:"min-w-full bg-white shadow rounded-xl",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-red-100 text-gray-800",children:[h.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Email"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),h.jsx("tbody",{children:c?h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-4 py-4",children:h.jsx("div",{className:"flex justify-center items-center",children:h.jsx(NE,{visible:!0,height:"30",width:"30",color:"grey",strokeWidth:"5",animationDuration:"0.75",ariaLabel:"rotating-lines-loading",wrapperStyle:{},wrapperClass:""})})})}):i.length>0?i.map(j=>h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:j.user_name}),h.jsx("td",{className:"px-4 py-2",children:j.email}),h.jsx("td",{className:"px-4 py-2 capitalize",children:j.status?h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-green-600 ",children:" Verified"}):h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-red-600 ",children:" Pending"})}),h.jsxs("td",{className:"px-4 py-2",children:[h.jsx("button",{className:"text-sm text-blue-600",onClick:()=>{_(j),x(!0)},children:h.jsx(n0,{})}),h.jsx("button",{className:`ml-4 text-sm font-medium ${j.status?"text-red-600":"text-green-600"}`,onClick:()=>I(j._id),children:c?"Please wait...":j.status?h.jsx(mk,{}):h.jsx(dk,{})})]})]},j._id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"text-center text-gray-600 px-4 py-4",children:"No astrologers found."})})})]}),h.jsx(pp,{open:v,onOpenChange:x,children:h.jsxs(Cu,{className:"max-w-md",children:[h.jsx(fp,{children:h.jsx(mp,{children:"Users  Details"})}),f&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Name:"})," ",f.user_name]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Email:"})," ",f.email]})]})]})})]})]})]})},dNe=()=>{const[n,i]=X.useState([]),[o,c]=X.useState(!0),[d,f]=X.useState(null),[_,v]=X.useState(!1),x=async()=>{try{const I=await Jn.get("https://astro-talk-backend.onrender.com/web/astro/astrolist");i(I.data.data||[])}catch(I){console.error("Error fetching astrologers:",I),i([])}finally{c(!1)}},[T,w]=X.useState(!1),R=async I=>{c(!0);try{(await Jn.post("https://astro-talk-backend.onrender.com/admin/astroUpdate",{astroId:I,status:!T})).data.status&&(w(!T),x())}catch(j){console.error("Error updating status:",j)}finally{c(!1)}};return X.useEffect(()=>{x()},[]),h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1 p-8",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Astrologers"}),h.jsxs("table",{className:"min-w-full bg-white shadow rounded-xl",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-red-100 text-gray-800",children:[h.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Email"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),h.jsx("tbody",{children:o?h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-4 py-4",children:h.jsx("div",{className:"flex justify-center items-center",children:h.jsx(NE,{visible:!0,height:"30",width:"30",color:"grey",strokeWidth:"5",animationDuration:"0.75",ariaLabel:"rotating-lines-loading",wrapperStyle:{},wrapperClass:""})})})}):n.length>0?n.filter(I=>I.role==="Karmkandi"||I.role==="both").map(I=>h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:I.astroName}),h.jsx("td",{className:"px-4 py-2",children:I.email}),h.jsx("td",{className:"px-4 py-2 capitalize",children:I.status?h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-green-600 ",children:" Verified"}):h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-red-600 ",children:" Pending"})}),h.jsxs("td",{className:"px-4 py-2",children:[h.jsx("button",{className:"text-sm text-black-600",onClick:()=>{f(I),v(!0)},children:h.jsx(n0,{})}),h.jsx("button",{className:`ml-4 text-sm font-medium ${I.status?"text-red-600":"text-green-600"}`,onClick:()=>R(I._id),disabled:o,children:o?"Please wait...":I.status?h.jsx(mk,{}):h.jsx(dk,{})}),h.jsx("button",{className:"ml-4 text-sm text-red-600",children:"Delete"})]})]},I._id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"text-center text-gray-600 px-4 py-4",children:"No karamkandi found."})})})]}),h.jsx(pp,{open:_,onOpenChange:v,children:h.jsxs(Cu,{className:"max-w-md",children:[h.jsx(fp,{children:h.jsx(mp,{children:"Astrologer Details"})}),d&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Name:"})," ",d.astroName]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Email:"})," ",d.email]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Mobile:"})," ",d.mobile]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Status:"})," ",d.status]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Experience:"})," ",d.experience," years"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"City:"})," ",d.city]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Language:"})," ",d.language]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Expertise:"})," ",d.expertise]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Charge per Session:"})," ",d.chargePerSession]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Account Status:"})," ",d.chargePerSession]})]})]})})]})]})},uNe=()=>{const n=Qi(),[i,o]=X.useState(""),[c,d]=X.useState(""),[f,_]=X.useState(""),v=x=>{if(x.preventDefault(),i==="admin@astrotruth.in"&&c==="admin123"){const T=Math.random().toString(36).substr(2)+Date.now().toString(36);localStorage.setItem("admin_token",T),n("/admin")}else _("Invalid email or password")};return h.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100",children:h.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md w-full max-w-md",children:[h.jsx("h2",{className:"text-2xl font-bold mb-6 text-center text-gray-800",children:"Admin Login"}),f&&h.jsx("p",{className:"text-red-600 mb-4 text-sm text-center",children:f}),h.jsxs("form",{onSubmit:v,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Email"}),h.jsxs("div",{className:"flex items-center border rounded px-3 py-2",children:[h.jsx(ad,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("input",{type:"email",className:"w-full outline-none",placeholder:"admin@astro.com",value:i,onChange:x=>o(x.target.value),required:!0})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-sm text-gray-600",children:"Password"}),h.jsxs("div",{className:"flex items-center border rounded px-3 py-2",children:[h.jsx(Vm,{className:"w-5 h-5 text-gray-400 mr-2"}),h.jsx("input",{type:"password",className:"w-full outline-none",placeholder:"admin123",value:c,onChange:x=>d(x.target.value),required:!0})]})]}),h.jsx("button",{type:"submit",className:"w-full py-2 bg-red-500 text-white rounded hover:bg-red-600 transition",children:"Login"})]})]})})},hNe=()=>{const[n,i]=X.useState([]),o=Qi(),c=async()=>{var d;try{const f=await Jn.get("https://astro-talk-backend.onrender.com/web/astro/astrolist");i(((d=f.data)==null?void 0:d.data)||[])}catch(f){console.error("Error fetching astrologers:",f)}};return X.useEffect(()=>{c()},[]),h.jsxs(h.Fragment,{children:[h.jsx($J,{}),h.jsx("section",{className:"py-16 bg-gray-50",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsxs("h2",{className:"text-4xl font-bold mb-2",children:["Our Expert ",h.jsx("span",{className:"cosmic-text",children:"Astrologers"})]}),h.jsx("p",{className:"text-lg text-gray-600 max-w-xl mx-auto",children:"Connect with India's most trusted astrologers for personalized guidance"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.length>0?n.map((d,f)=>h.jsx(Dt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.4,delay:f*.1},viewport:{once:!0},children:h.jsxs(ur,{className:"overflow-hidden h-full shadow-sm",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:d.image||"https://via.placeholder.com/300x200?text=No+Image",alt:d.astroName,className:"w-full h-48 object-cover"}),h.jsx(np,{className:"absolute top-3 right-3",variant:d.status==="Online"?"cosmic":"secondary",children:d.status||"Offline"})]}),h.jsxs(vr,{className:"p-5",children:[h.jsxs("div",{className:"flex justify-between mb-2",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-lg",children:d.astroName||"No Name"}),h.jsx("p",{className:"text-sm text-gray-500",children:d.specialty||"N/A"})]}),h.jsxs("div",{className:"flex items-center bg-yellow-100 px-2 py-1 rounded",children:[h.jsx(oo,{className:"h-4 w-4 text-yellow-500 mr-1",fill:"currentColor"}),h.jsx("span",{className:"text-sm font-semibold",children:d.rating||"4.5"})]})]}),h.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[h.jsx("strong",{children:"Experience:"})," ",d.experience||"N/A"]}),h.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[h.jsx("strong",{children:"Languages:"})," ",d.langauge||"N/A"]}),h.jsx("div",{className:"flex flex-wrap gap-1 my-2",children:Array.isArray(d.expertise)&&d.expertise.length>0?d.expertise.map((_,v)=>h.jsx(np,{variant:"outline",children:_},v)):h.jsx(np,{variant:"outline",children:"No Expertise"})}),h.jsx("div",{className:"flex justify-between items-center mt-4",children:h.jsx(vt,{size:"sm",variant:"outline",className:"rounded-full",onClick:()=>o(`/karmkandidet/${d._id}`),children:"Book for Puja"})})]}),h.jsx(n2,{channel:d.agoraChannel,token:d.agoraToken,uid:d.agoraUID})]})},d._id)):h.jsx("div",{className:"col-span-full text-center text-gray-500 text-lg",children:"No Astrologers Found"})}),h.jsx("div",{className:"text-center mt-10",children:h.jsx(vt,{size:"lg",className:"cosmic-gradient",children:"View All Astrologers"})})]})}),h.jsx(XJ,{})]})},pNe=()=>h.jsx("div",{className:"min-h-screen p-4 md:p-8 mt-[4rem] ",style:{backgroundColor:"hsl(var(--light-red-secondary))"},children:h.jsxs(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-primary-theme",children:[h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-red-400 via-pink-400 to-rose-300",style:{backgroundColor:"hsl(var(--light-red-primary))"},children:[h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg mb-4"}),h.jsx(ni,{className:"text-4xl font-bold text-white",children:"Free Kundli Generator"}),h.jsx(qs,{className:"text-lg text-red-100 mt-2",children:"Discover your cosmic blueprint. Enter your birth details to generate your personalized Kundli."})]}),h.jsxs(vr,{className:"p-6 md:p-10 space-y-8 bg-white",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"gender",className:"text-md font-medium text-gray-700",children:"Select Category"}),h.jsxs("select",{id:"gender",className:"text-lg p-3 border rounded-md w-full focus:outline-none focus:ring-2 focus:ring-primary-theme focus:border-primary-theme",defaultValue:"",children:[h.jsx("option",{value:"",disabled:!0,children:"Select"}),h.jsx("option",{value:"horoscope",children:"Horoscope"}),h.jsx("option",{value:"female",children:"Female"}),h.jsx("option",{value:"other",children:"Other"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"maritalStatus",className:"text-md font-medium text-gray-700",children:"Marital Status"}),h.jsxs("select",{id:"maritalStatus",className:"text-lg p-3 border rounded-md w-full focus:outline-none focus:ring-2 focus:ring-primary-theme focus:border-primary-theme",defaultValue:"",children:[h.jsx("option",{value:"",disabled:!0,children:"Select marital status"}),h.jsx("option",{value:"single",children:"Single"}),h.jsx("option",{value:"married",children:"Married"}),h.jsx("option",{value:"divorced",children:"Divorced"}),h.jsx("option",{value:"widowed",children:"Widowed"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"name",className:"text-md font-medium text-gray-700",children:"Full Name"}),h.jsx(Vt,{id:"name",placeholder:"Enter your full name",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"gender",className:"text-md font-medium text-gray-700",children:"Gender"}),h.jsx(Vt,{id:"gender",placeholder:"Select gender (Male/Female/Other)",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"dob-day",className:"text-md font-medium text-gray-700",children:"Birth Day"}),h.jsx(Vt,{id:"dob-day",type:"number",placeholder:"DD",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"dob-month",className:"text-md font-medium text-gray-700",children:"Birth Month"}),h.jsx(Vt,{id:"dob-month",type:"number",placeholder:"MM",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"dob-year",className:"text-md font-medium text-gray-700",children:"Birth Year"}),h.jsx(Vt,{id:"dob-year",type:"number",placeholder:"YYYY",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"tob-hour",className:"text-md font-medium text-gray-700",children:"Birth Hour"}),h.jsx(Vt,{id:"tob-hour",type:"number",placeholder:"HH (24h)",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"tob-minute",className:"text-md font-medium text-gray-700",children:"Birth Minute"}),h.jsx(Vt,{id:"tob-minute",type:"number",placeholder:"MM",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"tob-second",className:"text-md font-medium text-gray-700",children:"Birth Second (Optional)"}),h.jsx(Vt,{id:"tob-second",type:"number",placeholder:"SS",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:"birthPlace",className:"text-md font-medium text-gray-700",children:"Place of Birth"}),h.jsx(Vt,{id:"birthPlace",placeholder:"Enter city and country",className:"text-lg p-3 focus:ring-primary-theme focus:border-primary-theme"})]}),h.jsx(Dt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:h.jsx(vt,{className:"w-full text-xl py-4 btn-primary-theme text-white font-semibold",size:"lg",children:"Generate My Kundli"})}),h.jsxs("p",{className:"text-center text-sm text-gray-600",children:["By generating your Kundli, you agree to our ",h.jsx("a",{href:"/terms-of-service",className:"text-primary-theme hover:underline",children:"Terms of Service"})," and ",h.jsx("a",{href:"/privacy-policy",className:"text-primary-theme hover:underline",children:"Privacy Policy"}),"."]})]})]}),h.jsxs(Dt.div,{className:"mt-10 p-6 bg-white rounded-xl shadow-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.5},children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-700 text-center mb-4",children:"Your Kundli Details Will Appear Here"}),h.jsx("div",{className:"h-64 flex items-center justify-center border-2 border-dashed border-red-300 rounded-lg",children:h.jsx("p",{className:"text-gray-400 text-lg",children:"Awaiting birth details..."})})]})]})}),fNe=()=>{X.useState([]);const[n,i]=X.useState(!0),[o,c]=X.useState({title:"",shorttitle:"",description:"",price:"",discount:"",status:"",image:null}),d=x=>{const{name:T,value:w,files:R}=x.target;console.log(x.target),c(T==="image"?I=>({...I,image:R[0]}):I=>({...I,[T]:w}))},f=()=>{const x=[{key:"title",label:"Title"},{key:"shorttitle",label:"Short Title"},{key:"description",label:"Description"},{key:"price",label:"Price"},{key:"discount",label:"Discount"},{key:"status",label:"Status"},{key:"image",label:"Image"}];for(let T of x){const w=o[T.key];if(!w||typeof w=="string"&&w.trim()==="")return No.error(`${T.label} is required`,"Validation Error"),!1}return!0},_=X.useRef(null),v=async x=>{var w,R;if(x.preventDefault(),!f())return;i(!0);const T=new FormData;T.append("title",o.title),T.append("shorttitle",o.shorttitle),T.append("description",o.description),T.append("price",o.price),T.append("discount",o.discount),T.append("status",o.status),T.append("image",o.image);try{const I=await Jn.post("https://astro-talk-backend.onrender.com/web/addproduct",T,{headers:{"Content-Type":"multipart/form-data"}});(w=I.data)!=null&&w.status?(i(!1),No.success(I.data.msg||"Product added successfully!"),c({title:"",shorttitle:"",description:"",price:"",discount:"",status:"",image:null}),_.current.reset(),window.location.href="/admin/productlist"):No.error(I.data.msg||"Something went wrong")}catch(I){console.error("Upload Error:",I),I.response?No.error(((R=I.response.data)==null?void 0:R.msg)||"Server error","Server Error"):I.request?No.error("No response from server","Network Error"):No.error(I.message||"Unexpected error","Error")}};return h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1 p-8",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Add Product"}),h.jsx("div",{className:"max-w-lg mx-auto bg-white p-8 rounded-2xl shadow-xl border",children:h.jsxs("form",{onSubmit:v,className:"space-y-5",encType:"multipart/form-data",ref:_,children:[h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsxs("div",{className:" w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"title",className:"text-gray-700 font-medium",children:"Product Title"}),h.jsx("input",{type:"text",name:"title",value:o.title,onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Product title"})]}),h.jsxs("div",{className:"w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"shorttitle",className:"text-gray-700 font-medium",children:"Product Short Title"}),h.jsx("input",{type:"text",name:"shorttitle",value:o.shorttitle,onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Short Title"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ws,{htmlFor:"description",className:"text-gray-700 font-medium",children:"Product Description"}),h.jsx("textarea",{name:"description",value:o.description,onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter product description"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ws,{htmlFor:"image",className:"text-gray-700 font-medium",children:"Product Image"}),h.jsx("input",{type:"file",name:"image",onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsxs("div",{className:"w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"price",className:"text-gray-700 font-medium",children:"Product Price"}),h.jsx("input",{type:"text",name:"price",value:o.price,onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"INR 200"})]}),h.jsxs("div",{className:"w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"discount",className:"text-gray-700 font-medium",children:"Product Discount"}),h.jsx("input",{type:"text",name:"discount",value:o.discount,onChange:d,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"INR 20"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ws,{className:"text-gray-700 font-medium",children:"Product Status"}),h.jsxs("div",{className:"flex items-center gap-6 mt-1",children:[h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"radio",name:"status",value:"1",onChange:d,className:"mr-2"}),"Active"]}),h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"radio",name:"status",value:"0",onChange:d,className:"mr-2"}),"Deactive"]})]})]}),h.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg text-lg font-semibold transition duration-200",children:"Submit Product"})]})})]})]})},mNe=()=>{const n=()=>{localStorage.clear(),window.location.href="/admin-login"},[i,o]=X.useState([]),[c,d]=X.useState(""),[f,_]=X.useState(!0),[v,x]=X.useState(null),[T,w]=X.useState(!1),R=async()=>{try{const I=await Jn.get("https://astro-talk-backend.onrender.com/web/productlist");o(I.data.data||[]),d(I.data.staticPath)}catch(I){console.error("Error fetching product:",I),o([])}finally{_(!1)}};return X.useEffect(()=>{R()},[]),X.useState(!1),h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1",children:[h.jsx(zb,{userName:"Admin",onLogout:n}),h.jsxs("div",{className:"p-6",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Users"}),h.jsxs("table",{className:"min-w-full bg-white shadow rounded-xl",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-red-100 text-gray-800",children:[h.jsx("th",{className:"px-4 py-2 text-left",children:"Name"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Image"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Price"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Discount"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),h.jsx("tbody",{children:f?h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-4 py-4",children:h.jsx("div",{className:"flex justify-center items-center",children:h.jsx(NE,{visible:!0,height:"30",width:"30",color:"grey",strokeWidth:"5",animationDuration:"0.75",ariaLabel:"rotating-lines-loading",wrapperStyle:{},wrapperClass:""})})})}):i.length>0?i.map(I=>h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:I.productName}),h.jsx("td",{className:"px-4 py-2",children:h.jsx("img",{src:`${c}/${I.productCoverImg}`,alt:"Product",height:100,width:100})}),h.jsxs("td",{className:"px-4 py-2",children:[" ",I.productPrice]}),h.jsxs("td",{className:"px-4 py-2",children:[" ",I.discount]}),h.jsx("td",{className:"px-4 py-2 capitalize",children:I.productStatus?h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-green-600 ",children:" Active"}):h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-red-600 ",children:" Deactive"})}),h.jsxs("td",{className:"px-4 py-2",children:[h.jsx("button",{className:"text-sm text-blue-600",onClick:()=>{x(I),w(!0)},children:h.jsx(n0,{})}),h.jsx(Xn,{to:`/admin/update/${I._id}`,children:h.jsxs("button",{className:"ml-4 text-sm font-medium text-green-600 ",children:["  ",h.jsx(IEe,{})," "]})})]})]},I._id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"text-center text-gray-600 px-4 py-4",children:"No Product found."})})})]}),h.jsx(pp,{open:T,onOpenChange:w,children:h.jsxs(Cu,{className:"max-w-md",children:[h.jsx(fp,{children:h.jsx(mp,{children:"Product  Details"})}),v&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{children:h.jsx("img",{src:`${c}/${v.productCoverImg}`,height:80,width:80,alt:"Product"})}),h.jsxs("p",{children:[h.jsx("strong",{children:"Product Name:"})," ",v.productName]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Short:"})," ",v.productSortTitle]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Description:"})," ",v.productDesc]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Price:"}),"  ",v.productPrice]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Discount :"}),"  ",v.discount]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Product Status :"}),v.productStatus?h.jsx("span",{className:"text-white px-2 py-1 text-[.6rem] bg-green-600 rounded-lg ",children:" Active Product "}):h.jsx("span",{className:"text-white px-3 py-1 bg-red-600 rounded-lg ",children:" Deactive Product "})]})]})]})})]})]})]})},gNe=()=>{const[n,i]=X.useState({title:"",shorttitle:"",description:"",price:"",discount:"",status:"",image:null}),{id:o}=vE();console.log(o);const[c,d]=X.useState({}),[f,_]=X.useState(!0),v=R=>{const{name:I,value:j,files:P}=R.target;i(I==="image"?k=>({...k,image:P[0]}):k=>({...k,[I]:j}))},x=X.useRef(null),T=async R=>{var j,P;R.preventDefault(),_(!0),console.log(c.productCoverImg);const I=new FormData;I.append("title",n.title),I.append("shorttitle",n.shorttitle),I.append("description",n.description),I.append("price",n.price),I.append("discount",n.discount),I.append("status",n.status),n.image?I.append("image",n.image):I.append("existingImage",c.productCoverImg),console.log("this is upded image",n.image);try{const k=await Jn.post(`https://astro-talk-backend.onrender.com/web/productUpdate/${o}`,I,{headers:{"Content-Type":"multipart/form-data"}});(j=k.data)!=null&&j.status?(_(!1),No.success(k.data.msg||"Product Update successfully!"),i({title:"",shorttitle:"",description:"",price:"",discount:"",status:"",image:null}),x.current.reset(),w()):No.error(k.data.msg||"Something went wrong")}catch(k){console.error("Upload Error:",k),k.response?No.error(((P=k.response.data)==null?void 0:P.msg)||"Server error","Server Error"):k.request?No.error("No response from server","Network Error"):No.error(k.message||"Unexpected error","Error")}},w=async()=>{var R;try{const j=(await Jn.get(`https://astro-talk-backend.onrender.com/web/getProductById/${o}`)).data.data;d(j),i({title:j.productName||"",shorttitle:j.productSortTitle||"",description:j.productDesc||"",price:j.productPrice||"",discount:j.discount||"",status:((R=j.status)==null?void 0:R.toString())||"",image:null})}catch(I){console.error("Error fetching product:",I),d({})}finally{_(!1)}};return X.useEffect(()=>{w()},[o]),h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1 p-8",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Add Product"}),h.jsx("div",{className:"max-w-lg mx-auto bg-white p-8 rounded-2xl shadow-xl border",children:h.jsxs("form",{ref:x,onSubmit:T,className:"space-y-5",encType:"multipart/form-data",children:[h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsxs("div",{className:" w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"title",className:"text-gray-700 font-medium",children:"Product Title"}),h.jsx("input",{type:"text",name:"title",value:n.title,onChange:v,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Product title"})]}),h.jsxs("div",{className:"w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"shorttitle",className:"text-gray-700 font-medium",children:"Product Short Title"}),h.jsx("input",{type:"text",name:"shorttitle",value:n.shorttitle,onChange:v,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Short Title"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ws,{htmlFor:"description",className:"text-gray-700 font-medium",children:"Product Description"}),h.jsx("textarea",{name:"description",value:n.description,onChange:v,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter product description"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ws,{htmlFor:"image",className:"text-gray-700 font-medium",children:"Product Image"}),h.jsx("input",{type:"file",name:"image",onChange:v,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),h.jsx("img",{src:`https://astro-talk-backend.onrender.com/upload/${c.productCoverImg}`,alt:"Current",className:"w-32 h-32 object-cover border rounded"})]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[h.jsxs("div",{className:"w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"price",className:"text-gray-700 font-medium",children:"Product Price"}),h.jsx("input",{type:"text",name:"price",value:n.price,onChange:v,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"INR 200"})]}),h.jsxs("div",{className:"w-full space-y-2",children:[h.jsx(Ws,{htmlFor:"discount",className:"text-gray-700 font-medium",children:"Product Discount"}),h.jsx("input",{type:"text",name:"discount",value:n.discount,onChange:v,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"INR 20"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ws,{className:"text-gray-700 font-medium",children:"Product Status"}),h.jsxs("div",{className:"flex items-center gap-6 mt-1",children:[h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"radio",name:"status",value:"1",onChange:v,className:"mr-2",checked:c.productStatus===1}),"Active"]}),h.jsxs("label",{className:"flex items-center",children:[h.jsx("input",{type:"radio",name:"status",value:"0",onChange:v,className:"mr-2",checked:c.productStatus===0}),"Deactive"]})]})]}),h.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg text-lg font-semibold transition duration-200",children:"Submit Product"})]})})]})]})},sz=[{name:"Aries",icon:ea,date:"Mar 21 - Apr 19"},{name:"Taurus",icon:ea,date:"Apr 20 - May 20"},{name:"Gemini",icon:ea,date:"May 21 - Jun 20"},{name:"Cancer",icon:ea,date:"Jun 21 - Jul 22"},{name:"Leo",icon:ea,date:"Jul 23 - Aug 22"},{name:"Virgo",icon:ea,date:"Aug 23 - Sep 22"},{name:"Libra",icon:ea,date:"Sep 23 - Oct 22"},{name:"Scorpio",icon:ea,date:"Oct 23 - Nov 21"},{name:"Sagittarius",icon:ea,date:"Nov 22 - Dec 21"},{name:"Capricorn",icon:ea,date:"Dec 22 - Jan 19"},{name:"Aquarius",icon:ea,date:"Jan 20 - Feb 18"},{name:"Pisces",icon:ea,date:"Feb 19 - Mar 20"}],_Ne=()=>{vE();const[n,i]=X.useState(sz[0]),[o,c]=X.useState(null),[d,f]=X.useState(!1),_=async v=>{var w;i(v),c(null),f(!0);const T=new Date().toLocaleDateString("en-GB");try{const R=await Jn.post("https://astro-talk-backend.onrender.com/prediction/daily",{zodiacName:v.name,date:T});c(R.data.response)}catch(R){console.error(" API Error:",((w=R==null?void 0:R.response)==null?void 0:w.data)||R.message),c(null)}finally{f(!1)}};return h.jsx("div",{className:"min-h-screen p-4 md:p-8 mt-14",style:{backgroundColor:"hsl(var(--light-red-secondary))"},children:h.jsx(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-primary-theme",children:[h.jsx(qr,{className:"text-center p-8 bg-gradient-to-br from-red-400 via-pink-400 to-rose-300",children:h.jsx(Dt.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:150},className:"mx-auto bg-white rounded-full p-4 inline-block shadow-lg mb-4",children:h.jsx(oo,{className:"h-16 w-16 text-primary-theme"})})}),h.jsxs(vr,{className:"p-6 md:p-10 bg-white",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-4 text-center",children:"   "}),h.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3",children:sz.map(v=>h.jsxs(Dt.div,{whileHover:{scale:1.05},className:`p-3 border-2 rounded-lg cursor-pointer text-center transition-all duration-200
                      ${n.name===v.name?"border-primary-theme bg-red-50 shadow-md":"border-gray-200 hover:border-red-300"}`,onClick:()=>_(v),children:[wt.createElement(v.icon,{className:`w-10 h-10 mx-auto mb-1 ${n.name===v.name?"text-primary-theme":"text-gray-500"}`}),h.jsx("p",{className:`font-medium text-sm ${n.name===v.name?"text-primary-theme":"text-gray-700"}`,children:v.name})]},v.name))})]}),d&&h.jsx("p",{className:"text-center text-gray-600 mt-4",children:"      ..."}),o&&h.jsxs(Dt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},className:"mt-8 p-6 border border-red-200 rounded-lg bg-rose-50 shadow-inner",children:[h.jsxs("div",{className:"flex items-center mb-6",children:[wt.createElement(n.icon,{className:"w-16 h-16 text-primary-theme mr-4"}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-primary-theme",children:n.name}),h.jsx("p",{className:"text-gray-600 text-md",children:new Date().toLocaleDateString("hi-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),h.jsxs("div",{className:"space-y-5",children:[h.jsx(im,{icon:uk,title:"Love",text:o.love,color:"text-pink-500"}),h.jsx(im,{icon:EY,title:"Career",text:o.career,color:"text-blue-500"}),h.jsx(im,{icon:bY,title:"Health",text:o.health,color:"text-green-500"}),h.jsx(im,{icon:TT,title:"Lucky color",text:o.lucky_color,color:"text-yellow-600"}),h.jsx("span",{className:"w-5 p-3 h-5 ",style:{backgroundColor:o.lucky_color_code}}),h.jsx(im,{icon:TT,title:"Finance",text:o.finances,color:"text-yellow-600"}),h.jsx(im,{icon:n0,title:"Information",text:o.bot_response,color:"text-yellow-600"})]}),o.tip&&h.jsxs("div",{className:"mt-6 p-4 bg-red-100 border-l-4 border-primary-theme rounded",children:[h.jsx("p",{className:"font-semibold text-red-700",children:"  :"}),h.jsx("p",{className:"text-gray-700",children:o.tip})]})]},n.name)]})]})})})},im=({icon:n,title:i,text:o,color:c})=>{const d=n;return h.jsxs("div",{className:"flex items-start",children:[h.jsx(d,{className:`w-7 h-7 ${c} mr-3 mt-1 flex-shrink-0`}),h.jsxs("div",{children:[h.jsx("h4",{className:`text-xl font-semibold ${c}`,children:i}),h.jsx("p",{className:"text-gray-700 leading-relaxed",children:o})]})]})},ENe=()=>{const n=()=>{localStorage.clear(),window.location.href="/admin-login"},[i,o]=X.useState([]),[c,d]=X.useState(""),[f,_]=X.useState(!0),[v,x]=X.useState(null),[T,w]=X.useState(!1),R=async()=>{try{const P=await Jn.get("http://localhost:8000/web/paymentRequest");console.log(P.data.data),o(P.data.data||[]),d(P.data.staticPath)}catch(P){console.error("Error fetching product:",P),o([])}finally{_(!1)}},I=async P=>{console.log(P);try{const W=await(await fetch("http://localhost:8000/web/astro/astrolinfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({astrologerId:P})})).json();W.status?(console.log("Astrologer Info:",W.data),console.log(W.data),x(W.data)):console.warn("Failed to fetch astrologer info:",W.message)}catch(k){console.error("Error fetching astrologer info:",k)}};console.log(v),X.useEffect(()=>{R()},[]);const j=async P=>{console.log(P);try{const k=await Jn.post("http://localhost:8000/create-order",{amount:P.requestAmount,astrologerId:P.astrologerId}),{order:W}=k.data,H={key:"rzp_test_6m5EFshHcmM2o1",amount:1e3,currency:"INR",name:"Your Brand",description:"Astrologer Payment",handler:async function(V){(await Jn.post("https://astro-talk-backend.onrender.com/verify-payment",{razorpay_order_id:V.razorpay_order_id,razorpay_payment_id:V.razorpay_payment_id,razorpay_signature:V.razorpay_signature,astrologerId:P.astrologerId,requestAmount:P.requestAmount})).data.success?alert("Payment Successful!"):alert("Payment verification failed")},prefill:{name:"Narad Bhardwaj",email:"narad@example.com",contact:"9999999999"},theme:{color:"#3399cc"}};new window.Razorpay(H).open()}catch(k){console.error("Payment Error:",k)}};return h.jsxs("div",{className:"flex",children:[h.jsx(ku,{}),h.jsxs("div",{className:"flex-1",children:[h.jsx(zb,{userName:"Admin",onLogout:n}),h.jsxs("div",{className:"p-6",children:[h.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Users"}),h.jsxs("table",{className:"min-w-full bg-white shadow rounded-xl",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-red-100 text-gray-800",children:[h.jsx("th",{className:"px-4 py-2 text-left",children:"Astrologer"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Amount"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Transaction Id"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),h.jsx("tbody",{children:f?h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-4 py-4",children:h.jsx("div",{className:"flex justify-center items-center",children:h.jsx(NE,{visible:!0,height:"30",width:"30",color:"grey",strokeWidth:"5",animationDuration:"0.75",ariaLabel:"rotating-lines-loading",wrapperStyle:{},wrapperClass:""})})})}):i.length>0?i.map(P=>h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:P.astrologerId}),h.jsxs("td",{className:"px-4 py-2",children:[" ",P.requestAmount]}),h.jsxs("td",{className:"px-4 py-2",children:[" ",P.transactionId]}),h.jsx("td",{className:"px-4 py-2 capitalize",children:P.paymentStatus?h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-green-600 ",children:" Active"}):h.jsx("span",{className:"p-1 px-2 text-white rounded-md text-[.6rem] font-bold bg-red-600 ",children:" Deactive"})}),h.jsxs("td",{className:"px-4 py-2",children:[h.jsx("button",{className:"text-sm text-blue-600",onClick:()=>{w(!0),I(P.astrologerId)},children:h.jsx(n0,{})}),h.jsx("button",{className:"ml-4 bg-purple-500 p-2 text-white rounded-md text-sm font-medium  ",onClick:()=>j(P),children:" PayNow "})]})]},P._id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"text-center text-gray-600 px-4 py-4",children:"No Product found."})})})]}),h.jsx(pp,{open:T,onOpenChange:w,children:h.jsxs(Cu,{className:"max-w-md",children:[h.jsx(fp,{children:h.jsx(mp,{children:"Product  Details"})}),v&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Astrologer Name:"})," ",v.astroName]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Avilable Amount :"})," ",v.wallet]})]})]})})]})]})]})},vNe=()=>{const[n,i]=X.useState(null),[o,c]=X.useState(!1),[d,f]=X.useState({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""}),[_,v]=X.useState({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""}),x=async w=>{var W;w.preventDefault(),c(!0);const R=`${d.day}/${d.month}/${d.year}`,I=`${d.hour}:${d.minute}`,j=`${_.day}/${_.month}/${_.year}`,P=`${_.hour}:${_.minute}`,k={boy_dob:R,boy_tob:I,girl_dob:j,girl_tob:P,boy_lat:1,boy_lon:1,boy_tz:5.5,girl_lat:1,girl_lon:1,girl_tz:5.5,lang:"en"};try{const H=await Jn.get("https://astro-talk-backend.onrender.com/matching/dashakoot",{params:k});console.log(" Match Result:",H.data),i(H.data.response),f({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""}),v({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""})}catch(H){console.error(" Failed to fetch matchmaking data:",((W=H==null?void 0:H.response)==null?void 0:W.data)||H.message),i(null)}finally{c(!1)}},T=["dina","gana","mahendra","rajju","rasi","rasiathi","sthree","vasya","vedha","yoni"];return h.jsx("div",{className:"min-h-screen p-4 md:p-8 mt-[4rem]",style:{backgroundColor:"hsl(var(--light-red-secondary))"},children:h.jsxs(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-primary-theme",children:[h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-red-400 via-pink-400 to-rose-300",children:[h.jsx(ni,{className:"text-4xl font-bold text-white",children:"Dashakoot Matching"}),h.jsx(qs,{className:"text-lg text-red-100 mt-2",children:"Discover your cosmic blueprint. Enter your birth details to generate your personalized Kundli."})]}),h.jsx("form",{onSubmit:x,children:h.jsxs(vr,{className:"p-6 md:p-10 space-y-8 bg-white",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsx(oz,{title:"Boy's Details",state:d,setState:f}),h.jsx(oz,{title:"Girl's Details",state:_,setState:v})]}),h.jsx(Dt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:h.jsx(vt,{type:"submit",className:"w-full text-xl py-4 btn-primary-theme text-white font-semibold",size:"lg",children:o?"Generating...":"Generate Matchmaking "})}),h.jsxs("p",{className:"text-center text-sm text-gray-600",children:["By generating Kundli, you agree to our ",h.jsx("a",{href:"/terms-of-service",className:"text-primary-theme hover:underline",children:"Terms of Service"})," and ",h.jsx("a",{href:"/privacy-policy",className:"text-primary-theme hover:underline",children:"Privacy Policy"}),"."]})]})})]}),n&&h.jsxs(Dt.div,{className:"mt-10 p-6 bg-white rounded-xl shadow-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.5},children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-700 text-center mb-4",children:"Summary of Matchmaking Results"}),h.jsx("p",{className:"text-center text-lg font-medium text-green-600 mb-6",children:n.bot_response}),h.jsxs("table",{className:"min-w-full border border-gray-300",children:[h.jsx("thead",{className:"bg-red-100 text-red-800",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-2 text-left",children:"Attribute"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Boy"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Girl"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Score"}),h.jsx("th",{className:"px-4 py-2 text-left",children:"Description"})]})}),h.jsx("tbody",{className:"bg-white text-gray-700",children:T.map(w=>{const R=n[w];return R?h.jsxs("tr",{className:"border-t border-gray-200",children:[h.jsx("td",{className:"px-4 py-3 font-semibold text-yellow-700",children:R.name}),h.jsx("td",{className:"px-4 py-3",children:R.boy_star||R.boy_gana||R.boy_rajju||R.boy_rasi||R.boy_lord||R.boy_yoni}),h.jsx("td",{className:"px-4 py-3",children:R.girl_star||R.girl_gana||R.girl_rajju||R.girl_rasi||R.girl_lord||R.girl_yoni}),h.jsx("td",{className:"px-4 py-3",children:R[w]}),h.jsx("td",{className:"px-4 py-3",children:R.description})]},w):null})})]})]})]})})},jh=({label:n,id:i,value:o,onChange:c})=>h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:i,children:n}),h.jsx(Vt,{id:i,value:o,onChange:d=>c(d.target.value),placeholder:n,type:"text"})]}),oz=({title:n,state:i,setState:o})=>h.jsxs("div",{className:"space-y-6 border border-primary-theme rounded-xl p-6 shadow-sm bg-slate-50",children:[h.jsx("h3",{className:"text-xl font-semibold text-primary-theme mb-4 text-center",children:n}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsx(jh,{label:"Day",id:`${n}-Day`,value:i.day,onChange:c=>o({...i,day:c})}),h.jsx(jh,{label:"Month",id:`${n}-Month`,value:i.month,onChange:c=>o({...i,month:c})}),h.jsx(jh,{label:"Year",id:`${n}-Year`,value:i.year,onChange:c=>o({...i,year:c})})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsx(jh,{label:"Hour",id:`${n}-Hour`,value:i.hour,onChange:c=>o({...i,hour:c})}),h.jsx(jh,{label:"Minute",id:`${n}-Minute`,value:i.minute,onChange:c=>o({...i,minute:c})}),h.jsx(jh,{label:"Second",id:`${n}-Second`,value:i.second,onChange:c=>o({...i,second:c})})]}),h.jsx(jh,{label:"Place of Birth",id:`${n}-Place`,value:i.place,onChange:c=>o({...i,place:c})})]}),yNe=()=>{var T,w,R,I,j,P;const[n,i]=X.useState(null),[o,c]=X.useState(!1),[d,f]=X.useState({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""}),[_,v]=X.useState({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""}),x=async k=>{var te;k.preventDefault(),c(!0);const W=`${d.day}/${d.month}/${d.year}`,H=`${d.hour}:${d.minute}`,L=`${_.day}/${_.month}/${_.year}`,V=`${_.hour}:${_.minute}`,K={boy_dob:W,boy_tob:H,girl_dob:L,girl_tob:V,boy_lat:1,boy_lon:1,boy_tz:5.5,girl_lat:1,girl_lon:1,girl_tz:5.5,lang:"en"};try{const ie=await Jn.get("https://astro-talk-backend.onrender.com/matching/ashakoot",{params:K});i(ie.data.response),f({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""}),v({day:"",month:"",year:"",hour:"",minute:"",second:"",place:""})}catch(ie){console.error(" Failed to fetch matchmaking data:",((te=ie==null?void 0:ie.response)==null?void 0:te.data)||ie.message),i(null)}finally{c(!1)}};return h.jsx("div",{className:"min-h-screen p-4 md:p-8 mt-[4rem]",style:{backgroundColor:"hsl(var(--light-red-secondary))"},children:h.jsxs(Dt.div,{className:"container mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[h.jsxs(ur,{className:"shadow-2xl rounded-xl overflow-hidden border-2 border-primary-theme",children:[h.jsxs(qr,{className:"text-center p-8 bg-gradient-to-br from-red-400 via-pink-400 to-rose-300",children:[h.jsx(ni,{className:"text-4xl font-bold text-white",children:"Aashakoot Matching"}),h.jsx(qs,{className:"text-lg text-red-100 mt-2",children:"Discover your cosmic blueprint. Enter your birth details to generate your personalized Kundli."})]}),h.jsx("form",{onSubmit:x,children:h.jsxs(vr,{className:"p-6 md:p-10 space-y-8 bg-white",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsx(az,{title:"Boy's Details",state:d,setState:f}),h.jsx(az,{title:"Girl's Details",state:_,setState:v})]}),h.jsx(Dt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:h.jsx(vt,{type:"submit",className:"w-full text-xl py-4 btn-primary-theme text-white font-semibold",size:"lg",children:o?"Generating...":"Generate Matchmaking"})}),h.jsxs("p",{className:"text-center text-sm text-gray-600",children:["By generating Kundli, you agree to our ",h.jsx("a",{href:"/terms-of-service",className:"text-primary-theme hover:underline",children:"Terms of Service"})," and ",h.jsx("a",{href:"/privacy-policy",className:"text-primary-theme hover:underline",children:"Privacy Policy"}),"."]})]})})]}),n&&h.jsxs(Dt.div,{className:"mt-10 p-6 bg-white rounded-xl shadow-lg",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.5},children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-700 text-center mb-4",children:"Summary of Matchmaking Results"}),h.jsx("p",{className:"text-center text-lg font-medium text-green-600 mb-6",children:n.bot_response}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-gray-700 mb-6",children:[h.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow-sm",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Ashtakoot Score:"})," ",n.ashtakoot_score]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Dashkoot Score:"})," ",n.dashkoot_score]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Overall Score:"})," ",n.score,"/100"]})]}),h.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow-sm",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Rajju Dosha:"})," ",n.rajjudosh?"Yes":"No"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Vedha Dosha:"})," ",n.vedhadosh?"Yes":"No"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Kaal Sarp Dosha:"})," ",n.kaalsarpdosh]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-gray-700 mb-6",children:[h.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Mangal Dosh:"})," ",n.mangaldosh]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Boy Points:"})," ",(T=n.mangaldosh_points)==null?void 0:T.boy]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Girl Points:"})," ",(w=n.mangaldosh_points)==null?void 0:w.girl]})]}),h.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Manglik by Saturn:"})," ",n.manglikdosh_saturn]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Boy:"})," ",(R=n.manglikdosh_saturn_points)!=null&&R.boy?"Yes":"No"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Girl:"})," ",(I=n.manglikdosh_saturn_points)!=null&&I.girl?"Yes":"No"]})]})]}),h.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg shadow-sm text-gray-700 mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Pitra Dosha"}),h.jsxs("p",{children:[h.jsx("strong",{children:"Description:"})," ",n.pitradosh]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Boy:"})," ",(j=n.pitradosh_points)!=null&&j.boy?"Yes":"No"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Girl:"})," ",(P=n.pitradosh_points)!=null&&P.girl?"Yes":"No"]})]}),h.jsxs("div",{className:"mt-6 bg-blue-50 p-4 rounded-lg text-gray-800",children:[h.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Extended Analysis"}),h.jsx("p",{children:n.extended_response})]})]})]})})},Uh=({label:n,id:i,value:o,onChange:c})=>h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ut,{htmlFor:i,children:n}),h.jsx(Vt,{id:i,value:o,onChange:d=>c(d.target.value),placeholder:n,type:"text"})]}),az=({title:n,state:i,setState:o})=>h.jsxs("div",{className:"space-y-6 border border-primary-theme rounded-xl p-6 shadow-sm bg-slate-50",children:[h.jsx("h3",{className:"text-xl font-semibold text-primary-theme mb-4 text-center",children:n}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsx(Uh,{label:"Day",id:`${n}-Day`,value:i.day,onChange:c=>o({...i,day:c})}),h.jsx(Uh,{label:"Month",id:`${n}-Month`,value:i.month,onChange:c=>o({...i,month:c})}),h.jsx(Uh,{label:"Year",id:`${n}-Year`,value:i.year,onChange:c=>o({...i,year:c})})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsx(Uh,{label:"Hour",id:`${n}-Hour`,value:i.hour,onChange:c=>o({...i,hour:c})}),h.jsx(Uh,{label:"Minute",id:`${n}-Minute`,value:i.minute,onChange:c=>o({...i,minute:c})}),h.jsx(Uh,{label:"Second",id:`${n}-Second`,value:i.second,onChange:c=>o({...i,second:c})})]}),h.jsx(Uh,{label:"Place of Birth",id:`${n}-Place`,value:i.place,onChange:c=>o({...i,place:c})})]}),SNe=()=>{var c;const n=JSON.parse(localStorage.getItem("user")||"{}"),i=Qi();X.useEffect(()=>{localStorage.getItem("userToken")||i("/user-login")},[i]);const o=()=>{localStorage.removeItem("userToken"),localStorage.removeItem("user"),i("/user-login")};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100 p-4 md:p-8",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 text-center md:text-left",children:["Welcome, ",(n==null?void 0:n.user_name)||"User","!"]}),h.jsxs("div",{className:"flex flex-wrap gap-2 justify-center md:justify-end",children:[h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:()=>i("/user-update"),children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Account Settings"]}),h.jsxs(vt,{variant:"outline",className:"border-gray-400 text-gray-600 hover:bg-gray-200",onClick:()=>i("/user-dashboard"),children:[h.jsx(Fm,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:o,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"}),"Logout"]})]})]}),h.jsx("div",{className:"flex justify-center",children:h.jsxs(ur,{className:"w-full max-w-2xl shadow-xl rounded-xl",children:[h.jsxs(qr,{className:"text-center",children:[h.jsx(ni,{className:"text-3xl font-bold text-gray-800",children:"User Profile"}),h.jsx(qs,{className:"text-sm text-gray-500",children:"Your personal information"})]}),h.jsxs(vr,{children:[h.jsxs("div",{className:"flex flex-col items-center mb-6",children:[n!=null&&n.user_img?h.jsx("img",{src:n.user_img,alt:"Profile",className:"w-28 h-28 rounded-full object-cover border-4 border-white shadow-md"}):h.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-300 flex items-center justify-center text-white text-3xl font-bold shadow-md",children:((c=n==null?void 0:n.user_name)==null?void 0:c.charAt(0).toUpperCase())||"U"}),h.jsx("p",{className:"mt-3 font-medium text-xl text-gray-700",children:(n==null?void 0:n.user_name)||"N/A"}),h.jsx("p",{className:"text-sm text-gray-500",children:(n==null?void 0:n.email)||"N/A"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-800 text-sm",children:[h.jsxs("div",{children:[h.jsx("strong",{children:"Full Name:"})," ",(n==null?void 0:n.user_name)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Email:"})," ",(n==null?void 0:n.email)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Phone:"})," ",(n==null?void 0:n.user_phone)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Date of Birth:"})," ",(n==null?void 0:n.dob)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"User ID:"})," ",(n==null?void 0:n._id)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Wallet Balance:"})," ",(n==null?void 0:n.wallet)??"0"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Status:"})," ",n!=null&&n.status?"Active":"Inactive"]})]})]})]})})]})},xNe=()=>{const n=Qi(),i=JSON.parse(localStorage.getItem("astroUser")||"{}");X.useEffect(()=>{localStorage.getItem("astroToken")||n("/astro-login")},[n]);const o=()=>{localStorage.removeItem("astroToken"),localStorage.removeItem("astroUser"),n("/astro-login")};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100 p-4 md:p-8",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 text-center md:text-left",children:["Welcome, ",(i==null?void 0:i.astroName)||"Astrologer","!"]}),h.jsxs("div",{className:"flex flex-wrap gap-2 justify-center md:justify-end",children:[h.jsxs(vt,{variant:"outline",onClick:()=>n("/astro-update"),className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Account Settings"]}),h.jsxs(vt,{variant:"outline",className:"border-gray-400 text-gray-600 hover:bg-gray-200",onClick:()=>n("/astro-dashboard"),children:[h.jsx(Fm,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:o,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"}),"Logout"]})]})]}),h.jsxs(ur,{className:"max-w-2xl mx-auto shadow-lg rounded-xl border border-gray-200 bg-white",children:[h.jsx(qr,{className:"text-center",children:h.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[h.jsx("img",{src:(i==null?void 0:i.profileimg)||"https://ui-avatars.com/api/?name=Astrologer",alt:"Profile",className:"w-28 h-28 rounded-full border-4 border-red-300 shadow"}),h.jsx(ni,{className:"text-3xl font-bold text-gray-800",children:"Astrologer Profile"})]})}),h.jsxs(vr,{className:"space-y-5 text-gray-800 text-sm",children:[h.jsxs("div",{children:[h.jsx("strong",{children:"Name:"})," ",(i==null?void 0:i.astroName)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Email:"})," ",(i==null?void 0:i.email)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Mobile:"})," ",(i==null?void 0:i.mobile)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Experience:"})," ",(i==null?void 0:i.experience)||"N/A"," years"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Languages:"})," ",(i==null?void 0:i.language)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Expertise:"})," ",(i==null?void 0:i.expertise)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Charge per Session:"})," ",(i==null?void 0:i.chargePerSession)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Available Time:"})," ",(i==null?void 0:i.availableTime)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"City:"})," ",(i==null?void 0:i.city)||"N/A"]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Short Bio:"})," ",(i==null?void 0:i.shortBio)||"N/A"]})]})]})]})},TNe=()=>{var w,R;const n=Qi(),i=JSON.parse(localStorage.getItem("user")||"{}"),[o,c]=X.useState({_id:(i==null?void 0:i._id)||"",user_name:(i==null?void 0:i.user_name)||"",email:(i==null?void 0:i.email)||"",user_phone:(i==null?void 0:i.user_phone)||"",dob:(i==null?void 0:i.dob)||"",password:"",user_image:(i==null?void 0:i.user_image)||""}),[d,f]=X.useState(!1);X.useEffect(()=>{localStorage.getItem("userToken")||n("/user-login")},[n]);const _=()=>{localStorage.removeItem("userToken"),localStorage.removeItem("user"),n("/user-login")},v=I=>{c(j=>({...j,[I.target.name]:I.target.value}))},x=I=>{const j=I.target.files[0];if(!j)return;const P=new FileReader;P.onloadend=()=>{c(k=>({...k,user_image:P.result}))},P.readAsDataURL(j)},T=async I=>{var j,P,k;I.preventDefault(),f(!0);try{const W=await Jn.post("https://astro-talk-backend.onrender.com/web/user/update",o);(j=W==null?void 0:W.data)!=null&&j.user?(localStorage.setItem("user",JSON.stringify(W.data.user)),alert(" Profile Updated Successfully!"),n("/user-profile")):vD({title:"Update Failed",description:"Something went wrong. Try again later.",variant:"destructive"})}catch(W){console.error(W),vD({title:"Error",description:((k=(P=W.response)==null?void 0:P.data)==null?void 0:k.message)||"Server error.",variant:"destructive"})}finally{f(!1)}};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100 p-4 md:p-8",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 text-center md:text-left",children:["Welcome, ",(i==null?void 0:i.user_name)||"User","!"]}),h.jsxs("div",{className:"flex flex-wrap gap-2 justify-center md:justify-end",children:[h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",onClick:()=>n("/user-profile"),children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Back to Profile"]}),h.jsxs(vt,{variant:"outline",className:"border-gray-400 text-gray-600 hover:bg-gray-200",onClick:()=>n("/user-dashboard"),children:[h.jsx(Fm,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:_,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"}),"Logout"]})]})]}),h.jsx("div",{className:"flex justify-center",children:h.jsxs(ur,{className:"w-full max-w-2xl shadow-xl rounded-xl",children:[h.jsxs(qr,{className:"text-center",children:[h.jsx(ni,{className:"text-3xl font-bold text-gray-800",children:"Update Profile"}),h.jsx(qs,{className:"text-sm text-gray-500",children:"Modify your information and save the changes"})]}),h.jsx(vr,{children:h.jsxs("form",{onSubmit:T,className:"space-y-5",children:[h.jsx("div",{className:"text-center",children:o.user_image?h.jsx("img",{src:o.user_image,alt:"Preview",className:"w-24 h-24 mx-auto rounded-full border-4 object-cover border-white shadow-md"}):h.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-gray-300 flex items-center justify-center text-white text-2xl font-bold shadow-md",children:((R=(w=o.user_name)==null?void 0:w.charAt(0))==null?void 0:R.toUpperCase())||"U"})}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Upload Photo"}),h.jsx(Vt,{type:"file",accept:"image/*",onChange:x})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Name"}),h.jsx(Vt,{name:"user_name",value:o.user_name,onChange:v,required:!0})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Email"}),h.jsx(Vt,{type:"email",name:"email",value:o.email,onChange:v,required:!0})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Phone"}),h.jsx(Vt,{name:"user_phone",value:o.user_phone,onChange:v,required:!0})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Date of Birth"}),h.jsx(Vt,{type:"date",name:"dob",value:o.dob,onChange:v,required:!0})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Password"}),h.jsx(Vt,{name:"password",type:"password",value:o.password,onChange:v,placeholder:"Enter new password"})]}),h.jsx(vt,{type:"submit",disabled:d,className:"w-full bg-red-500 hover:bg-red-600 text-white",children:d?"Updating...":"Update Profile"})]})})]})})]})},bNe=()=>{const n=Qi(),i=JSON.parse(localStorage.getItem("astroUser")||"{}"),{register:o,handleSubmit:c,setValue:d}=Mb(),[f,_]=X.useState((i==null?void 0:i.profileImg)||null);X.useEffect(()=>{localStorage.getItem("astroToken")||n("/astro-login"),Object.keys(i).forEach(R=>{i[R]!==void 0&&d(R,i[R])})},[i,n,d]);const v=()=>{localStorage.removeItem("astroToken"),localStorage.removeItem("astroUser"),n("/astro-login")},x=w=>{const R=w.target.files[0];if(!R)return;const I=new FileReader;I.onloadend=()=>{_(I.result),d("profileImg",I.result)},I.readAsDataURL(R)},T=async w=>{try{const R=await Jn.post(`https://astro-talk-backend.onrender.com/web/astro/updateById/${i._id}`,w);localStorage.setItem("astroUser",JSON.stringify(R.data)),alert("Profile updated successfully!"),n("/astro-profile")}catch(R){console.error("Update failed:",R),alert("Something went wrong!")}};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100 p-4 md:p-8",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 text-center md:text-left",children:["Welcome, ",(i==null?void 0:i.astroName)||"Astrologer","!"]}),h.jsxs("div",{className:"flex flex-wrap gap-2 justify-center md:justify-end",children:[h.jsxs(vt,{variant:"outline",className:"border-red-500 text-red-500 bg-red-200 cursor-not-allowed",disabled:!0,children:[h.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Account Settings"]}),h.jsxs(vt,{variant:"outline",className:"border-gray-400 text-gray-600 hover:bg-gray-200",onClick:()=>n("/astro-dashboard"),children:[h.jsx(Fm,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]}),h.jsx(vt,{variant:"ghost",size:"icon",className:"text-red-500 hover:bg-red-100",children:h.jsx(fd,{className:"h-6 w-6"})}),h.jsxs(vt,{variant:"destructive",size:"lg",onClick:v,children:[h.jsx(Tl,{className:"mr-2 h-5 w-5"}),"Logout"]})]})]}),h.jsxs(ur,{className:"max-w-3xl mx-auto shadow-lg rounded-xl border border-gray-200 bg-white",children:[h.jsx(qr,{children:h.jsx(ni,{className:"text-xl text-gray-800",children:"Update Astrologer Profile"})}),h.jsx(vr,{children:h.jsxs("form",{onSubmit:c(T),className:"space-y-5",children:[h.jsxs("div",{children:[h.jsx(Ut,{children:"Profile Image"}),f&&h.jsx("img",{src:f,alt:"Profile Preview",className:"w-24 h-24 rounded-full border my-2 object-cover"}),h.jsx(Vt,{type:"file",accept:"image/*",onChange:x}),h.jsx("input",{type:"hidden",...o("profileImg")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Name"}),h.jsx(Vt,{...o("astroName")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Date of Birth"}),h.jsx(Vt,{type:"date",...o("astroDob")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Email"}),h.jsx(Vt,{type:"email",...o("email")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Password"}),h.jsx(Vt,{type:"password",...o("password")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Phone"}),h.jsx(Vt,{...o("mobile")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"City"}),h.jsx(Vt,{...o("city")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Experience (Years)"}),h.jsx(Vt,{type:"number",...o("experience")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Expertise"}),h.jsx(Vt,{...o("expertise")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Languages"}),h.jsx(Vt,{...o("langauge")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Short Bio"}),h.jsx(Vt,{...o("shortBio")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Charge per Session"}),h.jsx(Vt,{type:"number",...o("chargePerSession")})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Available Time"}),h.jsx(Vt,{...o("availableTime")})]}),h.jsx(vt,{type:"submit",className:"w-full bg-red-500 hover:bg-red-600 text-white",children:"Update Profile"})]})})]})]})},Co=({children:n})=>{const i=Oc(),o=localStorage.getItem("userToken"),c=localStorage.getItem("astroToken"),d=localStorage.getItem("admin_token");return i.pathname.startsWith("/user")?o?n:h.jsx(qN,{to:"/user-login",replace:!0}):i.pathname.startsWith("/astro")?c?n:h.jsx(qN,{to:"/astro-login",replace:!0}):i.pathname.startsWith("/admin")?d?n:h.jsx("navigate",{to:"admin-login",replace:!0}):h.jsx(qN,{to:"/",replace:!0})},wNe=()=>{const[n,i]=X.useState(1),[o,c]=X.useState(""),{register:d,handleSubmit:f,reset:_,formState:{errors:v}}=Mb(),x=Qi();X.useEffect(()=>{_()},[n]);const T=async I=>{var P,k,W;const j=I.email.trim().toLowerCase();if(!j){alert("Please enter a valid email.");return}try{await Jn.post("https://astro-talk-backend.onrender.com/web/astro/sendOtp",{email:j}),c(j),alert("OTP sent to your email."),i(2)}catch(H){console.error("Send OTP Error:",((P=H.response)==null?void 0:P.data)||H.message),alert(((W=(k=H.response)==null?void 0:k.data)==null?void 0:W.message)||"Failed to send OTP.")}},w=async I=>{var k,W,H;const j=I.otp.trim(),P=o.trim();if(!P||!j){alert("Please enter both email and OTP.");return}try{await Jn.post("https://astro-talk-backend.onrender.com/web/astro/verifyOtp",{email:P,otp:j}),alert("OTP verified successfully."),i(3)}catch(L){console.error("Verify OTP Error:",((k=L.response)==null?void 0:k.data)||L.message),alert(((H=(W=L.response)==null?void 0:W.data)==null?void 0:H.message)||"Invalid OTP.")}},R=async I=>{var k,W,H;const{newPassword:j,confirmPassword:P}=I;if(j!==P){alert("Passwords do not match.");return}try{await Jn.post("https://astro-talk-backend.onrender.com/web/astro/resetPassword",{email:o,newPassword:j}),alert("Password reset successfully! Please login."),x("/astro-login")}catch(L){console.error("Reset Password Error:",((k=L.response)==null?void 0:k.data)||L.message),alert(((H=(W=L.response)==null?void 0:W.data)==null?void 0:H.message)||"Failed to reset password.")}};return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-100 to-rose-200 p-4",children:h.jsxs(ur,{className:"w-full max-w-md shadow-lg border border-gray-200 bg-white",children:[h.jsx(qr,{children:h.jsxs(ni,{className:"text-xl font-semibold text-center text-gray-800",children:[n===1&&"Forgot Password",n===2&&"Verify OTP",n===3&&"Reset Password"]})}),h.jsxs(vr,{children:[n===1&&h.jsxs("form",{onSubmit:f(T),className:"space-y-5",children:[h.jsxs("div",{children:[h.jsx(Ut,{children:"Email Address"}),h.jsxs("div",{className:"relative",children:[h.jsx(ad,{className:"absolute left-2 top-2.5 w-5 h-5 text-gray-400"}),h.jsx(Vt,{type:"email",placeholder:"you@example.com",...d("email",{required:"Email is required",pattern:{value:/^\S+@\S+$/i,message:"Invalid email format"}}),className:"pl-10"})]}),v.email&&h.jsx("p",{className:"text-red-500 text-sm",children:v.email.message})]}),h.jsx(vt,{type:"submit",className:"w-full bg-red-500 text-white hover:bg-red-600",children:"Send OTP"})]}),n===2&&h.jsxs("form",{onSubmit:f(w),className:"space-y-5",children:[h.jsxs("div",{children:[h.jsx(Ut,{children:"Enter OTP"}),h.jsxs("div",{className:"relative",children:[h.jsx(xY,{className:"absolute left-2 top-2.5 w-5 h-5 text-gray-400"}),h.jsx(Vt,{type:"text",placeholder:"Enter OTP",...d("otp",{required:"OTP is required"}),className:"pl-10"})]}),v.otp&&h.jsx("p",{className:"text-red-500 text-sm",children:v.otp.message})]}),h.jsx(vt,{type:"submit",className:"w-full bg-green-600 text-white hover:bg-green-700",children:"Verify OTP"}),h.jsx(vt,{type:"button",variant:"ghost",className:"w-full text-gray-600 hover:text-red-500",onClick:()=>i(1),children:"Change Email"})]}),n===3&&h.jsxs("form",{onSubmit:f(R),className:"space-y-5",children:[h.jsxs("div",{children:[h.jsx(Ut,{children:"New Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(Vm,{className:"absolute left-2 top-2.5 w-5 h-5 text-gray-400"}),h.jsx(Vt,{type:"password",placeholder:"New password",...d("newPassword",{required:"New password is required"}),className:"pl-10"})]}),v.newPassword&&h.jsx("p",{className:"text-red-500 text-sm",children:v.newPassword.message})]}),h.jsxs("div",{children:[h.jsx(Ut,{children:"Confirm Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(Vm,{className:"absolute left-2 top-2.5 w-5 h-5 text-gray-400"}),h.jsx(Vt,{type:"password",placeholder:"Confirm password",...d("confirmPassword",{required:"Confirm your password"}),className:"pl-10"})]}),v.confirmPassword&&h.jsx("p",{className:"text-red-500 text-sm",children:v.confirmPassword.message})]}),h.jsx(vt,{type:"submit",className:"w-full bg-blue-600 text-white hover:bg-blue-700",children:"Reset Password"})]})]})]})})},CNe=()=>{const[n,i]=X.useState(""),[o,c]=X.useState(Math.floor(Math.random()*1e6)),[d,f]=X.useState(!1),_=()=>{n.trim()?f(!0):alert("Please enter a valid channel name.")};return h.jsxs("div",{style:{padding:20,marginTop:"5rem"},children:[h.jsx("h2",{children:"Join Existing Video Call"}),d?h.jsx(n2,{channel:n,uid:o}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{marginBottom:10},children:[h.jsx("label",{htmlFor:"channel",children:"Channel Name:"}),h.jsx("br",{}),h.jsx("input",{type:"text",id:"channel",value:n,onChange:v=>i(v.target.value),placeholder:"Enter channel name",style:{width:300,padding:8}})]}),h.jsx("button",{onClick:_,style:{padding:"8px 16px",backgroundColor:"green",color:"white",border:"none",cursor:"pointer",marginTop:"5rem"},children:"Join Call"})]})]})},RNe=()=>{const n=Qi(),i=[{id:1,name:"Alice",img:"https://i.pravatar.cc/50?img=1",messages:[{sender:"Alice",text:"Hi there!"},{sender:"me",text:"Hello Alice "},{sender:"Alice",text:"How are you doing?"},{sender:"me",text:"I'm good, thanks! What about you?"}]},{id:2,name:"Bob",img:"https://i.pravatar.cc/50?img=2",messages:[{sender:"Bob",text:"Hey!"},{sender:"me",text:"Hi Bob, ready for the meeting?"},{sender:"Bob",text:"Yes, just give me 5 mins."}]},{id:3,name:"Charlie",img:"https://i.pravatar.cc/50?img=3",messages:[{sender:"Charlie",text:"Hello!"},{sender:"me",text:"Hey Charlie, long time!"},{sender:"Charlie",text:"Yeah, let's catch up soon."}]}],[o,c]=X.useState(null);return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-100 via-pink-100 to-rose-100 ",children:h.jsx(Dt.div,{className:"container md:mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:h.jsxs("div",{className:"h-screen w-full bg-transparent",children:[o===null&&h.jsx("div",{className:"h-full flex items-center justify-center",children:h.jsxs("div",{className:"md:w-[50%] w-full bg-white shadow-lg h-full rounded-xl",children:[h.jsxs("div",{className:"p-4 border-b-4 flex justify-between",children:[h.jsx("button",{onClick:()=>n("/user-dashboard"),className:"p-2 rounded-full hover:bg-gray-200",children:h.jsx(Fm,{size:20})}),h.jsx("h2",{className:"text-lg font-bold ",children:"Chat History"}),h.jsx("div",{children:" "})]}),h.jsx("ul",{children:i.map(d=>h.jsxs("li",{onClick:()=>c(d),className:"flex items-center gap-3 p-3 hover:bg-gray-200 cursor-pointer border-b-4",children:[h.jsx("img",{src:d.img,alt:d.name,className:"w-10 h-10 rounded-full"}),h.jsx("span",{className:"font-medium",children:d.name})]},d.id))})]})}),o&&h.jsxs("div",{className:"flex flex-col h-full w-full bg-white shadow-lg",children:[h.jsxs("div",{className:"p-4 border-b flex items-center gap-3 bg-white shadow",children:[h.jsx("button",{onClick:()=>c(null),className:"p-2 rounded-full hover:bg-gray-200",children:h.jsx(Fm,{size:20})}),h.jsx("img",{src:o.img,alt:o.name,className:"w-10 h-10 rounded-full"}),h.jsx("h2",{className:"font-bold text-lg",children:o.name})]}),h.jsx("div",{className:"flex-1 p-4 overflow-y-auto flex flex-col",children:o.messages.map((d,f)=>h.jsx("div",{className:`p-2 my-2 rounded-lg max-w-xs ${d.sender==="me"?"bg-blue-500 text-white self-end":"bg-gray-300 text-black self-start"}`,children:d.text},f))}),h.jsxs("div",{className:"p-3 border-t flex gap-2 bg-white",children:[h.jsx("input",{type:"text",placeholder:"Type a message...",className:"flex-1 border rounded-lg px-3 py-2"}),h.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-lg",children:"Send"})]})]})]})})})};function ANe(){return h.jsx(KCe,{children:h.jsxs("div",{className:"min-h-screen bg-background",children:[h.jsx(tAe,{children:h.jsxs(Age,{children:[h.jsx(In,{path:"/",element:h.jsx(GCe,{})}),h.jsx(In,{path:"/user-login",element:h.jsx(zbe,{})}),h.jsx(In,{path:"/astro-login",element:h.jsx(MAe,{})}),h.jsx(In,{path:"/user-register",element:h.jsx(pwe,{})}),h.jsx(In,{path:"/astro-register",element:h.jsx(sAe,{})}),h.jsx(In,{path:"/astrologers",element:h.jsx(hNe,{})}),h.jsx(In,{path:"/joinCall",element:h.jsx(CNe,{})}),h.jsx(In,{path:"/services",element:h.jsx(IX,{})}),h.jsx(In,{path:"/testimonials",element:h.jsx(UAe,{})}),h.jsx(In,{path:"/blog",element:h.jsx(dJ,{})}),h.jsx(In,{path:"/contact",element:h.jsx(FAe,{})}),h.jsx(In,{path:"/privacy-policy",element:h.jsx(BAe,{})}),h.jsx(In,{path:"/terms",element:h.jsx(VAe,{})}),h.jsx(In,{path:"/karamkandi",element:h.jsx(WAe,{})}),h.jsx(In,{path:"/store",element:h.jsx(KAe,{})}),h.jsx(In,{path:"/product/:id",element:h.jsx(YAe,{})}),h.jsx(In,{path:"/checkout/:id",element:h.jsx($Ae,{})}),h.jsx(In,{path:"/karmkandidet/:id",element:h.jsx(XAe,{})}),h.jsx(In,{path:"/kundalimatch",element:h.jsx(pNe,{})}),h.jsx(In,{path:"/horoscope",element:h.jsx(_Ne,{})}),h.jsx(In,{path:"/dashakoot",element:h.jsx(vNe,{})}),h.jsx(In,{path:"/ashtakoot",element:h.jsx(yNe,{})}),h.jsx(In,{path:"/admin/paymentrequest",element:h.jsx(ENe,{})}),h.jsx(In,{path:"/admin-login",element:h.jsx(uNe,{})}),h.jsx(In,{path:"/forgot-password",element:h.jsx(wNe,{})}),h.jsx(In,{path:"/admin",element:h.jsx(Co,{children:h.jsx(QAe,{})})}),h.jsx(In,{path:"/admin/astrologer",element:h.jsx(Co,{children:h.jsx(cNe,{})})}),h.jsx(In,{path:"/admin/users",element:h.jsx(Co,{children:h.jsx(lNe,{})})}),h.jsx(In,{path:"/admin/karmkandy",element:h.jsx(Co,{children:h.jsx(dNe,{})})}),h.jsx(In,{path:"/admin/addproduct",element:h.jsx(Co,{children:h.jsx(fNe,{})})}),h.jsx(In,{path:"/admin/productlist",element:h.jsx(Co,{children:h.jsx(mNe,{})})}),h.jsx(In,{path:"/admin/update/:id",element:h.jsx(Co,{children:h.jsx(gNe,{})})}),h.jsx(In,{path:"/user-dashboard",element:h.jsx(Co,{children:h.jsx(qCe,{})})}),h.jsx(In,{path:"/user-chats",element:h.jsx(Co,{children:h.jsx(RNe,{})})}),h.jsx(In,{path:"/astro-dashboard",element:h.jsx(Co,{children:h.jsx(iAe,{})})}),h.jsx(In,{path:"/user-profile",element:h.jsx(Co,{children:h.jsx(SNe,{})})}),h.jsx(In,{path:"/user-update",element:h.jsx(Co,{children:h.jsx(TNe,{})})}),h.jsx(In,{path:"/astro-profile",element:h.jsx(Co,{children:h.jsx(xNe,{})})}),h.jsx(In,{path:"/astro-update",element:h.jsx(Co,{children:h.jsx(bNe,{})})})]})}),h.jsx(JEe,{})]})})}function Ts(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var NNe=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),cz=NNe,cO=()=>Math.random().toString(36).substring(7).split("").join("."),INe={INIT:`@@redux/INIT${cO()}`,REPLACE:`@@redux/REPLACE${cO()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${cO()}`},GT=INe;function _2(n){if(typeof n!="object"||n===null)return!1;let i=n;for(;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return Object.getPrototypeOf(n)===i||Object.getPrototypeOf(n)===null}function RQ(n,i,o){if(typeof n!="function")throw new Error(Ts(2));if(typeof i=="function"&&typeof o=="function"||typeof o=="function"&&typeof arguments[3]=="function")throw new Error(Ts(0));if(typeof i=="function"&&typeof o>"u"&&(o=i,i=void 0),typeof o<"u"){if(typeof o!="function")throw new Error(Ts(1));return o(RQ)(n,i)}let c=n,d=i,f=new Map,_=f,v=0,x=!1;function T(){_===f&&(_=new Map,f.forEach((W,H)=>{_.set(H,W)}))}function w(){if(x)throw new Error(Ts(3));return d}function R(W){if(typeof W!="function")throw new Error(Ts(4));if(x)throw new Error(Ts(5));let H=!0;T();const L=v++;return _.set(L,W),function(){if(H){if(x)throw new Error(Ts(6));H=!1,T(),_.delete(L),f=null}}}function I(W){if(!_2(W))throw new Error(Ts(7));if(typeof W.type>"u")throw new Error(Ts(8));if(typeof W.type!="string")throw new Error(Ts(17));if(x)throw new Error(Ts(9));try{x=!0,d=c(d,W)}finally{x=!1}return(f=_).forEach(L=>{L()}),W}function j(W){if(typeof W!="function")throw new Error(Ts(10));c=W,I({type:GT.REPLACE})}function P(){const W=R;return{subscribe(H){if(typeof H!="object"||H===null)throw new Error(Ts(11));function L(){const K=H;K.next&&K.next(w())}return L(),{unsubscribe:W(L)}},[cz](){return this}}}return I({type:GT.INIT}),{dispatch:I,subscribe:R,getState:w,replaceReducer:j,[cz]:P}}function ONe(n){Object.keys(n).forEach(i=>{const o=n[i];if(typeof o(void 0,{type:GT.INIT})>"u")throw new Error(Ts(12));if(typeof o(void 0,{type:GT.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ts(13))})}function DNe(n){const i=Object.keys(n),o={};for(let f=0;f<i.length;f++){const _=i[f];typeof n[_]=="function"&&(o[_]=n[_])}const c=Object.keys(o);let d;try{ONe(o)}catch(f){d=f}return function(_={},v){if(d)throw d;let x=!1;const T={};for(let w=0;w<c.length;w++){const R=c[w],I=o[R],j=_[R],P=I(j,v);if(typeof P>"u")throw v&&v.type,new Error(Ts(14));T[R]=P,x=x||P!==j}return x=x||c.length!==Object.keys(_).length,x?T:_}}function zT(...n){return n.length===0?i=>i:n.length===1?n[0]:n.reduce((i,o)=>(...c)=>i(o(...c)))}function PNe(...n){return i=>(o,c)=>{const d=i(o,c);let f=()=>{throw new Error(Ts(15))};const _={getState:d.getState,dispatch:(x,...T)=>f(x,...T)},v=n.map(x=>x(_));return f=zT(...v)(d.dispatch),{...d,dispatch:f}}}function kNe(n){return _2(n)&&"type"in n&&typeof n.type=="string"}var AQ=Symbol.for("immer-nothing"),lz=Symbol.for("immer-draftable"),oa=Symbol.for("immer-state");function wc(n,...i){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var $m=Object.getPrototypeOf;function gp(n){return!!n&&!!n[oa]}function dd(n){var i;return n?NQ(n)||Array.isArray(n)||!!n[lz]||!!((i=n.constructor)!=null&&i[lz])||Zb(n)||ew(n):!1}var LNe=Object.prototype.constructor.toString();function NQ(n){if(!n||typeof n!="object")return!1;const i=$m(n);if(i===null)return!0;const o=Object.hasOwnProperty.call(i,"constructor")&&i.constructor;return o===Object?!0:typeof o=="function"&&Function.toString.call(o)===LNe}function KT(n,i){Qb(n)===0?Reflect.ownKeys(n).forEach(o=>{i(o,n[o],n)}):n.forEach((o,c)=>i(c,o,n))}function Qb(n){const i=n[oa];return i?i.type_:Array.isArray(n)?1:Zb(n)?2:ew(n)?3:0}function QD(n,i){return Qb(n)===2?n.has(i):Object.prototype.hasOwnProperty.call(n,i)}function IQ(n,i,o){const c=Qb(n);c===2?n.set(i,o):c===3?n.add(o):n[i]=o}function MNe(n,i){return n===i?n!==0||1/n===1/i:n!==n&&i!==i}function Zb(n){return n instanceof Map}function ew(n){return n instanceof Set}function Gh(n){return n.copy_||n.base_}function ZD(n,i){if(Zb(n))return new Map(n);if(ew(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const o=NQ(n);if(i===!0||i==="class_only"&&!o){const c=Object.getOwnPropertyDescriptors(n);delete c[oa];let d=Reflect.ownKeys(c);for(let f=0;f<d.length;f++){const _=d[f],v=c[_];v.writable===!1&&(v.writable=!0,v.configurable=!0),(v.get||v.set)&&(c[_]={configurable:!0,writable:!0,enumerable:v.enumerable,value:n[_]})}return Object.create($m(n),c)}else{const c=$m(n);if(c!==null&&o)return{...n};const d=Object.create(c);return Object.assign(d,n)}}function E2(n,i=!1){return tw(n)||gp(n)||!dd(n)||(Qb(n)>1&&(n.set=n.add=n.clear=n.delete=jNe),Object.freeze(n),i&&Object.entries(n).forEach(([o,c])=>E2(c,!0))),n}function jNe(){wc(2)}function tw(n){return Object.isFrozen(n)}var UNe={};function _p(n){const i=UNe[n];return i||wc(0,n),i}var hE;function OQ(){return hE}function FNe(n,i){return{drafts_:[],parent_:n,immer_:i,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function dz(n,i){i&&(_p("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=i)}function eP(n){tP(n),n.drafts_.forEach(VNe),n.drafts_=null}function tP(n){n===hE&&(hE=n.parent_)}function uz(n){return hE=FNe(hE,n)}function VNe(n){const i=n[oa];i.type_===0||i.type_===1?i.revoke_():i.revoked_=!0}function hz(n,i){i.unfinalizedDrafts_=i.drafts_.length;const o=i.drafts_[0];return n!==void 0&&n!==o?(o[oa].modified_&&(eP(i),wc(4)),dd(n)&&(n=qT(i,n),i.parent_||YT(i,n)),i.patches_&&_p("Patches").generateReplacementPatches_(o[oa].base_,n,i.patches_,i.inversePatches_)):n=qT(i,o,[]),eP(i),i.patches_&&i.patchListener_(i.patches_,i.inversePatches_),n!==AQ?n:void 0}function qT(n,i,o){if(tw(i))return i;const c=i[oa];if(!c)return KT(i,(d,f)=>pz(n,c,i,d,f,o)),i;if(c.scope_!==n)return i;if(!c.modified_)return YT(n,c.base_,!0),c.base_;if(!c.finalized_){c.finalized_=!0,c.scope_.unfinalizedDrafts_--;const d=c.copy_;let f=d,_=!1;c.type_===3&&(f=new Set(d),d.clear(),_=!0),KT(f,(v,x)=>pz(n,c,d,v,x,o,_)),YT(n,d,!1),o&&n.patches_&&_p("Patches").generatePatches_(c,o,n.patches_,n.inversePatches_)}return c.copy_}function pz(n,i,o,c,d,f,_){if(gp(d)){const v=f&&i&&i.type_!==3&&!QD(i.assigned_,c)?f.concat(c):void 0,x=qT(n,d,v);if(IQ(o,c,x),gp(x))n.canAutoFreeze_=!1;else return}else _&&o.add(d);if(dd(d)&&!tw(d)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;qT(n,d),(!i||!i.scope_.parent_)&&typeof c!="symbol"&&Object.prototype.propertyIsEnumerable.call(o,c)&&YT(n,d)}}function YT(n,i,o=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&E2(i,o)}function BNe(n,i){const o=Array.isArray(n),c={type_:o?1:0,scope_:i?i.scope_:OQ(),modified_:!1,finalized_:!1,assigned_:{},parent_:i,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let d=c,f=v2;o&&(d=[c],f=pE);const{revoke:_,proxy:v}=Proxy.revocable(d,f);return c.draft_=v,c.revoke_=_,v}var v2={get(n,i){if(i===oa)return n;const o=Gh(n);if(!QD(o,i))return WNe(n,o,i);const c=o[i];return n.finalized_||!dd(c)?c:c===lO(n.base_,i)?(dO(n),n.copy_[i]=rP(c,n)):c},has(n,i){return i in Gh(n)},ownKeys(n){return Reflect.ownKeys(Gh(n))},set(n,i,o){const c=DQ(Gh(n),i);if(c!=null&&c.set)return c.set.call(n.draft_,o),!0;if(!n.modified_){const d=lO(Gh(n),i),f=d==null?void 0:d[oa];if(f&&f.base_===o)return n.copy_[i]=o,n.assigned_[i]=!1,!0;if(MNe(o,d)&&(o!==void 0||QD(n.base_,i)))return!0;dO(n),nP(n)}return n.copy_[i]===o&&(o!==void 0||i in n.copy_)||Number.isNaN(o)&&Number.isNaN(n.copy_[i])||(n.copy_[i]=o,n.assigned_[i]=!0),!0},deleteProperty(n,i){return lO(n.base_,i)!==void 0||i in n.base_?(n.assigned_[i]=!1,dO(n),nP(n)):delete n.assigned_[i],n.copy_&&delete n.copy_[i],!0},getOwnPropertyDescriptor(n,i){const o=Gh(n),c=Reflect.getOwnPropertyDescriptor(o,i);return c&&{writable:!0,configurable:n.type_!==1||i!=="length",enumerable:c.enumerable,value:o[i]}},defineProperty(){wc(11)},getPrototypeOf(n){return $m(n.base_)},setPrototypeOf(){wc(12)}},pE={};KT(v2,(n,i)=>{pE[n]=function(){return arguments[0]=arguments[0][0],i.apply(this,arguments)}});pE.deleteProperty=function(n,i){return pE.set.call(this,n,i,void 0)};pE.set=function(n,i,o){return v2.set.call(this,n[0],i,o,n[0])};function lO(n,i){const o=n[oa];return(o?Gh(o):n)[i]}function WNe(n,i,o){var d;const c=DQ(i,o);return c?"value"in c?c.value:(d=c.get)==null?void 0:d.call(n.draft_):void 0}function DQ(n,i){if(!(i in n))return;let o=$m(n);for(;o;){const c=Object.getOwnPropertyDescriptor(o,i);if(c)return c;o=$m(o)}}function nP(n){n.modified_||(n.modified_=!0,n.parent_&&nP(n.parent_))}function dO(n){n.copy_||(n.copy_=ZD(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var HNe=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(i,o,c)=>{if(typeof i=="function"&&typeof o!="function"){const f=o;o=i;const _=this;return function(x=f,...T){return _.produce(x,w=>o.call(this,w,...T))}}typeof o!="function"&&wc(6),c!==void 0&&typeof c!="function"&&wc(7);let d;if(dd(i)){const f=uz(this),_=rP(i,void 0);let v=!0;try{d=o(_),v=!1}finally{v?eP(f):tP(f)}return dz(f,c),hz(d,f)}else if(!i||typeof i!="object"){if(d=o(i),d===void 0&&(d=i),d===AQ&&(d=void 0),this.autoFreeze_&&E2(d,!0),c){const f=[],_=[];_p("Patches").generateReplacementPatches_(i,d,f,_),c(f,_)}return d}else wc(1,i)},this.produceWithPatches=(i,o)=>{if(typeof i=="function")return(_,...v)=>this.produceWithPatches(_,x=>i(x,...v));let c,d;return[this.produce(i,o,(_,v)=>{c=_,d=v}),c,d]},typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof(n==null?void 0:n.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){dd(n)||wc(8),gp(n)&&(n=GNe(n));const i=uz(this),o=rP(n,void 0);return o[oa].isManual_=!0,tP(i),o}finishDraft(n,i){const o=n&&n[oa];(!o||!o.isManual_)&&wc(9);const{scope_:c}=o;return dz(c,i),hz(void 0,c)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,i){let o;for(o=i.length-1;o>=0;o--){const d=i[o];if(d.path.length===0&&d.op==="replace"){n=d.value;break}}o>-1&&(i=i.slice(o+1));const c=_p("Patches").applyPatches_;return gp(n)?c(n,i):this.produce(n,d=>c(d,i))}};function rP(n,i){const o=Zb(n)?_p("MapSet").proxyMap_(n,i):ew(n)?_p("MapSet").proxySet_(n,i):BNe(n,i);return(i?i.scope_:OQ()).drafts_.push(o),o}function GNe(n){return gp(n)||wc(10,n),PQ(n)}function PQ(n){if(!dd(n)||tw(n))return n;const i=n[oa];let o;if(i){if(!i.modified_)return i.base_;i.finalized_=!0,o=ZD(n,i.scope_.immer_.useStrictShallowCopy_)}else o=ZD(n,!0);return KT(o,(c,d)=>{IQ(o,c,PQ(d))}),i&&(i.finalized_=!1),o}var aa=new HNe,kQ=aa.produce;aa.produceWithPatches.bind(aa);aa.setAutoFreeze.bind(aa);aa.setUseStrictShallowCopy.bind(aa);aa.applyPatches.bind(aa);aa.createDraft.bind(aa);aa.finishDraft.bind(aa);function LQ(n){return({dispatch:o,getState:c})=>d=>f=>typeof f=="function"?f(o,c,n):d(f)}var zNe=LQ(),KNe=LQ,qNe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?zT:zT.apply(null,arguments)},YNe=n=>n&&typeof n.match=="function";function F_(n,i){function o(...c){if(i){let d=i(...c);if(!d)throw new Error(nd(0));return{type:n,payload:d.payload,..."meta"in d&&{meta:d.meta},..."error"in d&&{error:d.error}}}return{type:n,payload:c[0]}}return o.toString=()=>`${n}`,o.type=n,o.match=c=>kNe(c)&&c.type===n,o}var MQ=class y_ extends Array{constructor(...i){super(...i),Object.setPrototypeOf(this,y_.prototype)}static get[Symbol.species](){return y_}concat(...i){return super.concat.apply(this,i)}prepend(...i){return i.length===1&&Array.isArray(i[0])?new y_(...i[0].concat(this)):new y_(...i.concat(this))}};function fz(n){return dd(n)?kQ(n,()=>{}):n}function Ex(n,i,o){return n.has(i)?n.get(i):n.set(i,o(i)).get(i)}function $Ne(n){return typeof n=="boolean"}var XNe=()=>function(i){const{thunk:o=!0,immutableCheck:c=!0,serializableCheck:d=!0,actionCreatorCheck:f=!0}=i??{};let _=new MQ;return o&&($Ne(o)?_.push(zNe):_.push(KNe(o.extraArgument))),_},JNe="RTK_autoBatch",mz=n=>i=>{setTimeout(i,n)},QNe=(n={type:"raf"})=>i=>(...o)=>{const c=i(...o);let d=!0,f=!1,_=!1;const v=new Set,x=n.type==="tick"?queueMicrotask:n.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:mz(10):n.type==="callback"?n.queueNotification:mz(n.timeout),T=()=>{_=!1,f&&(f=!1,v.forEach(w=>w()))};return Object.assign({},c,{subscribe(w){const R=()=>d&&w(),I=c.subscribe(R);return v.add(w),()=>{I(),v.delete(w)}},dispatch(w){var R;try{return d=!((R=w==null?void 0:w.meta)!=null&&R[JNe]),f=!d,f&&(_||(_=!0,x(T))),c.dispatch(w)}finally{d=!0}}})},ZNe=n=>function(o){const{autoBatch:c=!0}=o??{};let d=new MQ(n);return c&&d.push(QNe(typeof c=="object"?c:void 0)),d};function eIe(n){const i=XNe(),{reducer:o=void 0,middleware:c,devTools:d=!0,duplicateMiddlewareCheck:f=!0,preloadedState:_=void 0,enhancers:v=void 0}=n||{};let x;if(typeof o=="function")x=o;else if(_2(o))x=DNe(o);else throw new Error(nd(1));let T;typeof c=="function"?T=c(i):T=i();let w=zT;d&&(w=qNe({trace:!1,...typeof d=="object"&&d}));const R=PNe(...T),I=ZNe(R);let j=typeof v=="function"?v(I):I();const P=w(...j);return RQ(x,_,P)}function jQ(n){const i={},o=[];let c;const d={addCase(f,_){const v=typeof f=="string"?f:f.type;if(!v)throw new Error(nd(28));if(v in i)throw new Error(nd(29));return i[v]=_,d},addMatcher(f,_){return o.push({matcher:f,reducer:_}),d},addDefaultCase(f){return c=f,d}};return n(d),[i,o,c]}function tIe(n){return typeof n=="function"}function nIe(n,i){let[o,c,d]=jQ(i),f;if(tIe(n))f=()=>fz(n());else{const v=fz(n);f=()=>v}function _(v=f(),x){let T=[o[x.type],...c.filter(({matcher:w})=>w(x)).map(({reducer:w})=>w)];return T.filter(w=>!!w).length===0&&(T=[d]),T.reduce((w,R)=>{if(R)if(gp(w)){const j=R(w,x);return j===void 0?w:j}else{if(dd(w))return kQ(w,I=>R(I,x));{const I=R(w,x);if(I===void 0){if(w===null)return w;throw Error("A case reducer on a non-draftable value must not return undefined")}return I}}return w},v)}return _.getInitialState=f,_}var rIe=(n,i)=>YNe(n)?n.match(i):n(i);function iIe(...n){return i=>n.some(o=>rIe(o,i))}var sIe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",oIe=(n=21)=>{let i="",o=n;for(;o--;)i+=sIe[Math.random()*64|0];return i},aIe=["name","message","stack","code"],uO=class{constructor(n,i){vN(this,"_type");this.payload=n,this.meta=i}},gz=class{constructor(n,i){vN(this,"_type");this.payload=n,this.meta=i}},cIe=n=>{if(typeof n=="object"&&n!==null){const i={};for(const o of aIe)typeof n[o]=="string"&&(i[o]=n[o]);return i}return{message:String(n)}},_z="External signal was aborted",UQ=(()=>{function n(i,o,c){const d=F_(i+"/fulfilled",(x,T,w,R)=>({payload:x,meta:{...R||{},arg:w,requestId:T,requestStatus:"fulfilled"}})),f=F_(i+"/pending",(x,T,w)=>({payload:void 0,meta:{...w||{},arg:T,requestId:x,requestStatus:"pending"}})),_=F_(i+"/rejected",(x,T,w,R,I)=>({payload:R,error:(c&&c.serializeError||cIe)(x||"Rejected"),meta:{...I||{},arg:w,requestId:T,rejectedWithValue:!!R,requestStatus:"rejected",aborted:(x==null?void 0:x.name)==="AbortError",condition:(x==null?void 0:x.name)==="ConditionError"}}));function v(x,{signal:T}={}){return(w,R,I)=>{const j=c!=null&&c.idGenerator?c.idGenerator(x):oIe(),P=new AbortController;let k,W;function H(V){W=V,P.abort()}T&&(T.aborted?H(_z):T.addEventListener("abort",()=>H(_z),{once:!0}));const L=async function(){var te,ie;let V;try{let A=(te=c==null?void 0:c.condition)==null?void 0:te.call(c,x,{getState:R,extra:I});if(dIe(A)&&(A=await A),A===!1||P.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const de=new Promise((ue,oe)=>{k=()=>{oe({name:"AbortError",message:W||"Aborted"})},P.signal.addEventListener("abort",k)});w(f(j,x,(ie=c==null?void 0:c.getPendingMeta)==null?void 0:ie.call(c,{requestId:j,arg:x},{getState:R,extra:I}))),V=await Promise.race([de,Promise.resolve(o(x,{dispatch:w,getState:R,extra:I,requestId:j,signal:P.signal,abort:H,rejectWithValue:(ue,oe)=>new uO(ue,oe),fulfillWithValue:(ue,oe)=>new gz(ue,oe)})).then(ue=>{if(ue instanceof uO)throw ue;return ue instanceof gz?d(ue.payload,j,x,ue.meta):d(ue,j,x)})])}catch(A){V=A instanceof uO?_(null,j,x,A.payload,A.meta):_(A,j,x)}finally{k&&P.signal.removeEventListener("abort",k)}return c&&!c.dispatchConditionRejection&&_.match(V)&&V.meta.condition||w(V),V}();return Object.assign(L,{abort:H,requestId:j,arg:x,unwrap(){return L.then(lIe)}})}}return Object.assign(v,{pending:f,rejected:_,fulfilled:d,settled:iIe(_,d),typePrefix:i})}return n.withTypes=()=>n,n})();function lIe(n){if(n.meta&&n.meta.rejectedWithValue)throw n.payload;if(n.error)throw n.error;return n.payload}function dIe(n){return n!==null&&typeof n=="object"&&typeof n.then=="function"}var uIe=Symbol.for("rtk-slice-createasyncthunk");function hIe(n,i){return`${n}/${i}`}function pIe({creators:n}={}){var o;const i=(o=n==null?void 0:n.asyncThunk)==null?void 0:o[uIe];return function(d){const{name:f,reducerPath:_=f}=d;if(!f)throw new Error(nd(11));typeof process<"u";const v=(typeof d.reducers=="function"?d.reducers(gIe()):d.reducers)||{},x=Object.keys(v),T={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},w={addCase(K,te){const ie=typeof K=="string"?K:K.type;if(!ie)throw new Error(nd(12));if(ie in T.sliceCaseReducersByType)throw new Error(nd(13));return T.sliceCaseReducersByType[ie]=te,w},addMatcher(K,te){return T.sliceMatchers.push({matcher:K,reducer:te}),w},exposeAction(K,te){return T.actionCreators[K]=te,w},exposeCaseReducer(K,te){return T.sliceCaseReducersByName[K]=te,w}};x.forEach(K=>{const te=v[K],ie={reducerName:K,type:hIe(f,K),createNotation:typeof d.reducers=="function"};EIe(te)?yIe(ie,te,w,i):_Ie(ie,te,w)});function R(){const[K={},te=[],ie=void 0]=typeof d.extraReducers=="function"?jQ(d.extraReducers):[d.extraReducers],A={...K,...T.sliceCaseReducersByType};return nIe(d.initialState,de=>{for(let ue in A)de.addCase(ue,A[ue]);for(let ue of T.sliceMatchers)de.addMatcher(ue.matcher,ue.reducer);for(let ue of te)de.addMatcher(ue.matcher,ue.reducer);ie&&de.addDefaultCase(ie)})}const I=K=>K,j=new Map,P=new WeakMap;let k;function W(K,te){return k||(k=R()),k(K,te)}function H(){return k||(k=R()),k.getInitialState()}function L(K,te=!1){function ie(de){let ue=de[K];return typeof ue>"u"&&te&&(ue=Ex(P,ie,H)),ue}function A(de=I){const ue=Ex(j,te,()=>new WeakMap);return Ex(ue,de,()=>{const oe={};for(const[ye,Ee]of Object.entries(d.selectors??{}))oe[ye]=fIe(Ee,de,()=>Ex(P,de,H),te);return oe})}return{reducerPath:K,getSelectors:A,get selectors(){return A(ie)},selectSlice:ie}}const V={name:f,reducer:W,actions:T.actionCreators,caseReducers:T.sliceCaseReducersByName,getInitialState:H,...L(_),injectInto(K,{reducerPath:te,...ie}={}){const A=te??_;return K.inject({reducerPath:A,reducer:W},ie),{...V,...L(A,!0)}}};return V}}function fIe(n,i,o,c){function d(f,..._){let v=i(f);return typeof v>"u"&&c&&(v=o()),n(v,..._)}return d.unwrapped=n,d}var mIe=pIe();function gIe(){function n(i,o){return{_reducerDefinitionType:"asyncThunk",payloadCreator:i,...o}}return n.withTypes=()=>n,{reducer(i){return Object.assign({[i.name](...o){return i(...o)}}[i.name],{_reducerDefinitionType:"reducer"})},preparedReducer(i,o){return{_reducerDefinitionType:"reducerWithPrepare",prepare:i,reducer:o}},asyncThunk:n}}function _Ie({type:n,reducerName:i,createNotation:o},c,d){let f,_;if("reducer"in c){if(o&&!vIe(c))throw new Error(nd(17));f=c.reducer,_=c.prepare}else f=c;d.addCase(n,f).exposeCaseReducer(i,f).exposeAction(i,_?F_(n,_):F_(n))}function EIe(n){return n._reducerDefinitionType==="asyncThunk"}function vIe(n){return n._reducerDefinitionType==="reducerWithPrepare"}function yIe({type:n,reducerName:i},o,c,d){if(!d)throw new Error(nd(18));const{payloadCreator:f,fulfilled:_,pending:v,rejected:x,settled:T,options:w}=o,R=d(n,f,w);c.exposeAction(i,R),_&&c.addCase(R.fulfilled,_),v&&c.addCase(R.pending,v),x&&c.addCase(R.rejected,x),T&&c.addMatcher(R.settled,T),c.exposeCaseReducer(i,{fulfilled:_||vx,pending:v||vx,rejected:x||vx,settled:T||vx})}function vx(){}function nd(n){return`Minified Redux Toolkit error #${n}; visit https://redux-toolkit.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}const hO=UQ("auth/astrologerLogin",async(n,{rejectWithValue:i})=>{var o;try{const c=await Jn.post("https://astro-talk-backend.onrender.com/web/astro/login",n),{token:d,user:f}=c.data;if(!d||!f)throw new Error("Invalid response format");return{token:d,user:f}}catch(c){let d="Astrologer login failed. Please try again.";return c.response?d=((o=c.response.data)==null?void 0:o.message)||`Error ${c.response.status}: ${c.response.statusText}`||d:c.request?d="No response from server. Please check your network connection.":c.message&&(d=c.message),i(d)}}),pO=UQ("auth/userLogin",async(n,{rejectWithValue:i})=>{var o;try{const c=await Jn.post("https://astro-talk-backend.onrender.com/web/login/",n),{token:d,user:f}=c.data;if(!d||!f)throw new Error("Invalid response format");return{token:d,user:f}}catch(c){let d="User login failed. Please try again.";return c.response?d=((o=c.response.data)==null?void 0:o.message)||`Error ${c.response.status}: ${c.response.statusText}`||d:c.request?d="No response from server. Please check your network connection.":c.message&&(d=c.message),i(d)}}),FQ=mIe({name:"auth",initialState:{user:JSON.parse(localStorage.getItem("user"))||null,token:localStorage.getItem("token")||null,loading:!1,error:null},reducers:{logout:n=>{n.user=null,n.token=null,n.error=null,localStorage.removeItem("user"),localStorage.removeItem("token")}},extraReducers:n=>{n.addCase(hO.pending,i=>{i.loading=!0,i.error=null}).addCase(hO.fulfilled,(i,o)=>{i.loading=!1,i.user=o.payload.user,i.token=o.payload.token,localStorage.setItem("user",JSON.stringify(o.payload.user)),localStorage.setItem("token",o.payload.token)}).addCase(hO.rejected,(i,o)=>{i.loading=!1,i.error=o.payload}).addCase(pO.pending,i=>{i.loading=!0,i.error=null}).addCase(pO.fulfilled,(i,o)=>{i.loading=!1,i.user=o.payload.user,i.token=o.payload.token,localStorage.setItem("user",JSON.stringify(o.payload.user)),localStorage.setItem("token",o.payload.token)}).addCase(pO.rejected,(i,o)=>{i.loading=!1,i.error=o.payload})}});FQ.actions;const SIe=FQ.reducer,xIe=eIe({reducer:{auth:SIe}});var TIe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE=X;function bIe(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var wIe=typeof Object.is=="function"?Object.is:bIe,CIe=IE.useSyncExternalStore,RIe=IE.useRef,AIe=IE.useEffect,NIe=IE.useMemo,IIe=IE.useDebugValue;TIe.useSyncExternalStoreWithSelector=function(n,i,o,c,d){var f=RIe(null);if(f.current===null){var _={hasValue:!1,value:null};f.current=_}else _=f.current;f=NIe(function(){function x(j){if(!T){if(T=!0,w=j,j=c(j),d!==void 0&&_.hasValue){var P=_.value;if(d(P,j))return R=P}return R=j}if(P=R,wIe(w,j))return P;var k=c(j);return d!==void 0&&d(P,k)?(w=j,P):(w=j,R=k)}var T=!1,w,R,I=o===void 0?null:o;return[function(){return x(i())},I===null?void 0:function(){return x(I())}]},[i,o,c,d]);var v=CIe(n,f[0],f[1]);return AIe(function(){_.hasValue=!0,_.value=v},[v]),IIe(v),v};function OIe(n){n()}function DIe(){let n=null,i=null;return{clear(){n=null,i=null},notify(){OIe(()=>{let o=n;for(;o;)o.callback(),o=o.next})},get(){const o=[];let c=n;for(;c;)o.push(c),c=c.next;return o},subscribe(o){let c=!0;const d=i={callback:o,next:null,prev:i};return d.prev?d.prev.next=d:n=d,function(){!c||n===null||(c=!1,d.next?d.next.prev=d.prev:i=d.prev,d.prev?d.prev.next=d.next:n=d.next)}}}}var Ez={notify(){},get:()=>[]};function PIe(n,i){let o,c=Ez,d=0,f=!1;function _(k){w();const W=c.subscribe(k);let H=!1;return()=>{H||(H=!0,W(),R())}}function v(){c.notify()}function x(){P.onStateChange&&P.onStateChange()}function T(){return f}function w(){d++,o||(o=i?i.addNestedSub(x):n.subscribe(x),c=DIe())}function R(){d--,o&&d===0&&(o(),o=void 0,c.clear(),c=Ez)}function I(){f||(f=!0,w())}function j(){f&&(f=!1,R())}const P={addNestedSub:_,notifyNestedSubs:v,handleChangeWrapper:x,isSubscribed:T,trySubscribe:I,tryUnsubscribe:j,getListeners:()=>c};return P}var kIe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LIe=kIe(),MIe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",jIe=MIe(),UIe=()=>LIe||jIe?X.useLayoutEffect:X.useEffect,FIe=UIe(),fO=Symbol.for("react-redux-context"),mO=typeof globalThis<"u"?globalThis:{};function VIe(){if(!X.createContext)return{};const n=mO[fO]??(mO[fO]=new Map);let i=n.get(X.createContext);return i||(i=X.createContext(null),n.set(X.createContext,i)),i}var BIe=VIe();function WIe(n){const{children:i,context:o,serverState:c,store:d}=n,f=X.useMemo(()=>{const x=PIe(d);return{store:d,subscription:x,getServerState:c?()=>c:void 0}},[d,c]),_=X.useMemo(()=>d.getState(),[d]);FIe(()=>{const{subscription:x}=f;return x.onStateChange=x.notifyNestedSubs,x.trySubscribe(),_!==d.getState()&&x.notifyNestedSubs(),()=>{x.tryUnsubscribe(),x.onStateChange=void 0}},[f,_]);const v=o||BIe;return X.createElement(v.Provider,{value:f},i)}var HIe=WIe;gO.createRoot(document.getElementById("root")).render(h.jsx(wt.StrictMode,{children:h.jsx(Mge,{children:h.jsx(HIe,{store:xIe,children:h.jsx(ANe,{})})})}));
